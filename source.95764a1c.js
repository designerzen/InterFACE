!function(e,t,n,r){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o="function"==typeof a.parcelRequire&&a.parcelRequire,i="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function s(n,r){if(!t[n]){if(!e[n]){var a="function"==typeof parcelRequire&&parcelRequire;if(!r&&a)return a(n,!0);if(o)return o(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}u.resolve=function(t){return e[n][1][t]||t},u.cache={};var l=t[n]=new s.Module(n);e[n][0].call(l.exports,u,l,l.exports,this)}return t[n].exports;function u(e){return s(u.resolve(e))}}s.isParcelRequire=!0,s.Module=function(e){this.id=e,this.bundle=s,this.exports={}},s.modules=e,s.cache=t,s.parent=o,s.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},a.parcelRequire=s;for(var c=0;c<n.length;c++)s(n[c]);if(n.length){var l=s(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd&&define((function(){return l}))}}({"2c01906a74607c172273de4db49de9f6":[function(e,t,n){e("./bundle-manifest").register(JSON.parse('{"6b4f3191f1147a9a":"source.95764a1c.js","67e0df2ea507acf8":"timing.settimeout.worker.c2963578.js","5e7afda96a044623":"manifest.2b9220b3.webmanifest","ab1218e7a40a8f20":"changes.f4c2d2e3.js","b25317a87243e7f7":"changes.1d86ef46.html","afee35552e3127ac":"service-worker.js","68f15ba4c459cde7":"body.a1347667.js","398cc1a82b51c7b0":"body.b699eb10.js","e863fa9238ad121c":"face.1d9415c0.js","5fc42901187e8545":"share-menu.971e8306.js"}'))},{"./bundle-manifest":"7bd0744a1d6e904180ae29467f4e3090"}],"7bd0744a1d6e904180ae29467f4e3090":[function(e,t,n){"use strict";var r={};t.exports.register=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)r[t[n]]=e[t[n]]},t.exports.resolve=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}},{}],"098cc988061dd902c257e1316c740bdd":[function(e,t,n){"use strict";var r=e("./store"),a=e("./audio/speech"),o=e("./audio/recorder"),i=e("./audio/audio"),s=e("./audio/synthesizers"),c=e("./audio/midi-out"),l=e("./timing/timing.js"),u=e("./dom/ui"),d=e("./dom/select"),h=e("./dom/toggle"),f=e("./dom/button"),p=e("./dom/text"),m=e("./dom/errors"),g=e("./dom/load-progress"),b=e("./dom/photographs"),v=e("./visual/canvas"),y=e("./visual/2d"),w=e("./visual/spectrograms"),E=e("./visual/quantise"),I=e("./location-handler"),S=e("./camera"),_=e("./timing/patterns"),T=e("./models/instructions"),M=e("./reporting"),C=e("./version"),A=e("./maths/maths"),O=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=R();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,t&&t.set(e,n);return n}(e("./person")),N=e("./i18n"),k=e("./settings"),x=e("./utils"),P=e("./pwa/pwa");function R(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return R=function(){return e},e}const L=(0,I.getReferer)(),D=(0,I.getRefererHostname)().split(".").pop(),B=(0,k.getDomainDefaults)(D);let j=(0,I.getLocationSettings)(B);const F=document.documentElement,V=document.querySelector("main"),U=document.querySelector("img");F.classList.toggle("loading",!0),F.classList.add(D);const{isRecording:$,startRecording:G,stopRecording:q}=(0,o.record)(),H=(0,r.createStore)(),W=(0,N.getBrowserLocales)()[0],z=[];let Y,K,Q,X,J,Z,ee,te,ne,re,ae=u.video,oe=!0,ie=!1,se=!1,ce=!1,le=!0,ue=!1,de=!1,he=0;const fe={lag:0,drift:0},pe={x:1,y:1};(0,I.forceSecure)(j.debug);const me=e=>{j.speak&&(0,a.hasSpeech)()&&(0,a.say)(e,!0)},ge=e=>{const t=(0,i.setVolume)(e);return H.setItem("audio",{volume:t}),(0,p.setToast)(`Volume ${Math.ceil(100*t)}%`,0),t},be=e=>(e=>{(0,l.setTimeBetween)(e);const t=(0,l.getBPM)();return(0,p.setToast)(`Tempo : Period set at ${e} milliseconds between bars<br>or ${t}BPM`),console.log({bpm:t,timer:Z,tempo:e}),H.setItem("tempo",{period:e,bpm:t}),e})(6e4/e),ve=async(e,t)=>z.map(async n=>{const r=await n[e](t);return(0,p.setToast)(`${n.name} has ${n.instrumentTitle} loaded`),r}),ye=async e=>await ve("loadRandomInstrument",e),we=e=>{if(null==z[e]){const t=((e,t)=>{j.duet;const n={dots:t,leftEyeIris:t,rightEyeIris:t,hue:360*Math.random(),debug:j.debug,photoSensitive:j.photoSensitive,instrumentPack:j.instrumentPack,stereoPan:j.stereo,drawMask:j.masks,drawEyes:j.eyes},r=H.has(e)?H.getItem(e):{},a=Object.assign({},n,r),o=new O.default(e,i.audioContext,Q,a),s=r.instrument||(0,i.randomInstrument)();return o.button.addEventListener(O.EVENT_INSTRUMENT_CHANGED,t=>{const{detail:n}=t;H.setItem(e,{instrument:n.instrumentName});(0,p.setToast)(n.instrument.title+" Loaded")}),o.loadInstrument(s,e=>{}),o})(k.NAMES[e],O.EYE_COLOURS[e]);return z.push(t),t}return z[e]},Ee=(e,t)=>{z.forEach(n=>{n.options[e]=t})},Ie=e=>{const t=Array.isArray(e);z.forEach((n,r)=>{const a=t?e[r]:e;n.options={...n.options,...a}})},Se=e=>{const t=e.length;if(t>0){let n=e.map(e=>e.name||"MIDI Instrument").join("<br>");t,V.classList.toggle("midi-no-devices",!1),V.classList.toggle("midi-connected",!0),V.classList.toggle("midi-devices-"+t,!0),V.classList.remove("midi-unavailable"),z.forEach((t,n)=>((e=0,t=[],n=0)=>{const r=we(e),a=t[e<t.length?e:0];a?r.setMIDI(a,n):console.error("No matching MIDI Instrument",j.midiChannel,r.hasMIDI?"Enabling":"Disabling",`MIDI #${n} for ${r.name}`,{ui:j,port:a,portIndex:n},X.outputs[n])})(n,e,j.midiChannel)),n="MIDI Available<br>"+n,(0,p.setToast)(n),J.setText("<span class='hide-text'>Click to </span>Disable"),J.setLabel(n)}else(0,p.setFeedback)(ce?"Lost MIDI Device connection":"MIDI Available but no instruments detected",0),(0,p.setToast)("No MIDI Devices connected"),V.classList.toggle("midi-no-devices",!0),V.classList.toggle("midi-connected",!1)},_e=async()=>(J=(0,f.setupMIDIButton)(document.getElementById("button-midi"),async e=>(await(async()=>{try{X=await(0,c.setupMIDI)(),X.addListener("connected",e=>Se(X.outputs)),X.addListener("disconnected",e=>Se(X.outputs)),Se(X.outputs),ce=X,V.classList.add("midi-available")}catch(e){return console.error("Total MIDI failure",e),(0,p.setFeedback)("MIDI NOT Available<br>"+e,0),V.classList.add("midi-unavailable"),!1}return!0})(),(0,p.setFeedback)("MIDI available<br>Connecting to instruments...",0),V.classList.add("midi-activated"),!1)),!0),Te=()=>{let e="";window.addEventListener("keydown",async t=>{const n=!isNaN(parseInt(t.key));switch(t.key){case"CapsLock":Ce("debug",!j.debug),z.forEach(e=>e.debug=j.debug),(0,p.setToast)("DEBUG : "+j.debug),me(j.debug?"secret mode unlocked":"disabling developer mode");break;case"Space":ye();break;case"ArrowLeft":(async e=>{await ve("loadPreviousInstrument",e)})();break;case"ArrowRight":(async e=>{await ve("loadNextInstrument",e)})();break;case"QuestionMark":case"?":me(document.getElementById("toast").innerText);break;case"ArrowUp":let e=(0,l.getBars)()+1,t=(0,l.setBars)(e),r=(0,l.setTimeBetween)((0,l.timePerBar)());console.error("bars---",t,e,r),(0,p.setToast)(`Bars : ${t} / BPM : ${(0,l.getBPM)()}`);break;case"ArrowDown":let a=(0,l.getBars)()-1,o=(0,l.setBars)(a),s=(0,l.setTimeBetween)((0,l.timePerBar)());console.error("bars---",o,a,s),(0,p.setToast)(`Bars ${o} / BPM : ${(0,l.getBPM)()}`);break;case",":(0,y.setNodeCount)(-1);break;case".":(0,y.setNodeCount)(1);break;case"a":te.kick();break;case"b":Ce("backingTrack",!j.backingTrack),(0,p.setToast)(j.backingTrack?"Backing track starting":"Ending Backing Track");break;case"c":Ce("clear",!j.clear);break;case"d":te.hat();break;case"e":te.clack();break;case"f":(0,u.toggleVisibility)(document.getElementById("shared-controls"));break;case"g":const c=(0,u.toggleVisibility)(document.getElementById("feedback"));(0,u.toggleVisibility)(document.getElementById("toast")),j.text=c;break;case"h":(0,u.toggleVisibility)(v.canvas);break;case"i":const d=await(0,i.setReverb)();(0,p.setToast)(`Reverb : '${d}' loaded`);break;case"j":(0,u.toggleVisibility)(u.video);break;case"k":break;case"l":Ce("speak",!j.speak),(0,p.setToast)(j.speak?"Reading out instructions":"Staying quiet");break;case"m":Ce("metronome",!j.metronome),(0,p.setToast)(j.metronome?"Quantised enabled":"Quantise disabled");break;case"q":Ce("muted",!j.muted),ge(j.muted?1:0);break;case"r":$()?(console.error("Recording END",re),(0,p.setToast)("Recording Ended - now encoding"),q().then(e=>{const t=encodeRecording(e,"audio/mp3;"),n=window.URL.createObjectURL(t);console.error("Recording END",{recording:e,audioSrc:n,mp3:t})})):((0,p.setToast)("Recording START"),console.error("Recording START",Q),re=await G(Q),console.error("Recording...",re));break;case"s":te.snare();break;case"t":Ce("text",!j.text);break;case"v":(0,u.toggleVisibility)(u.video);break;case"w":te.cowbell();break;case"x":const h=(0,l.tapTempo)();h>1&&be(h);break;case"z":he=0;break;case"Tab":break;default:n||(ye(),me("Loading random instruments"))}if(n){if(e+=t.key,3===e.length){const t=parseFloat(e);console.log("Setting tempo to ",t),be(t),e=""}}else e="";(0,I.addToHistory)(j,t.key)})},Me=()=>{Object.entries(j).forEach(([e,t])=>{V.classList.toggle("flag-"+e,t)})},Ce=(e,t,n=!0)=>{j[e]=t,n&&(0,I.addToHistory)(j,e),V.classList.toggle("flag-"+e,t)};(0,g.setLoadProgress)(0,"Initialising... Please wait"),ee=(0,M.setupReporting)("InterFACE"),F.classList.toggle("debug",j.debug);let Ae=!1;const Oe=async()=>{if(!Ae){Ae=!0;try{await e("share-menu")}catch(e){F.classList.add("sharing-disabled")}console.log("Loaded Webpage",C.VERSION)}},Ne=async()=>{oe?requestAnimationFrame(Ne):se?(F.classList.add("failure"),(0,f.showReloadButton)()):(async()=>{const e=()=>{if(de)return me("Hello! Open your mouth to begin!"),F.classList.toggle("searching-for-user",!1),we(0);requestAnimationFrame(e)};F.classList.toggle("loading",!1),F.classList.toggle("loaded",!0),Te(),F.classList.toggle("searching-for-user",!0),me("I am looking for your face");const t=await e();j.debug&&console.log(`InterFACE Version ${C.VERSION} from ${L} in ${W}`,t)})()},ke=Object.assign({},{maxFaces:j.duet?2:1,shouldLoadIrisModel:!0});(async(t,n)=>{let r,a,o=0;switch(n(o++/3),t.model){case"body":const{loadBodyModel:t}=await e("./models/body");r=t;break;default:const{loadFaceModel:n}=await e("./models/face");r=n}n(o++/3),(0,u.setupInterface)(j),n(o++/3),(0,h.setToggle)("button-quantise",e=>{Ce("quantise",e),(0,p.setToast)("Quantise "+(j.quantise?"enabled":"disabled"))},j.quantise),(0,h.setToggle)("button-settings",e=>{Ce("showSettings",e),(0,p.setToast)("Settings "+(e?"enabled":"disabled"))},j.showSettings),(0,h.setToggle)("button-metronome",e=>{Ce("metronome",e),(0,p.setToast)("Metronome "+(j.metronome?"enabled":"disabled"))},j.metronome),(0,h.setToggle)("button-percussion",e=>{Ce("backingTrack",e),(0,p.setToast)(j.backingTrack?"Backing track starting":"Ending Backing Track")},j.backingTrack),(0,h.setToggle)("button-spectrogram",e=>{Ce("spectrogram",e),(0,p.setToast)("Spectrogram "+(j.spectrogram?"enabled":"disabled"))},j.spectrogram),(0,h.setToggle)("button-speak",e=>{Ce("speak",e),(0,p.setToast)("Speaking "+(j.speak?"enabled":"disabled"))},j.speak),(0,h.setToggle)("button-transparent",e=>{Ce("transparent",!e),(0,p.setToast)("Video Synch "+(j.spectrogram?"enabled":"disabled"))},j.transparent),(0,h.setToggle)("button-clear",e=>{Ce("clear",e)},j.clear),(0,h.setToggle)("button-mute",e=>{Ce("muted",!j.muted),ge(j.muted?1:0)},j.muted),(0,h.setToggle)("button-disco",e=>{var t;Ce("masks",e),j.masks?(j.clear=!1,t=["drawMask","drawNodes","drawMesh","meshOnSing"],a=z.map(e=>t.reduce((t,n,r,a)=>(t[n]=e.options[n],t),{})),Ie({drawMask:!0,drawNodes:!1,drawMesh:!1,meshOnSing:!0})):(j.clear=!0,Ie(a),a=null)},j.muted),(0,h.setToggle)("button-meshes",e=>{Ce("masks",!j.masks),Ee("drawMask",j.masks)},j.masks),(0,h.setToggle)("button-eyes",e=>{Ce("eyes",!j.eyes),Ee("drawEyes",j.eyes)},j.eyes),(0,h.setToggle)("button-overlay",e=>(0,u.toggleVideoVisiblity)(),!(0,u.isVideoVisible)()),(0,h.setToggle)("button-subtitles",e=>{Ce("text",!j.text)}),(0,f.setButton)("button-photograph",e=>{(0,b.appendPhotographElement)()}),(0,f.setButton)("button-video",e=>ye()),(0,f.setButton)("button-reset",e=>{j={...B},Me()}),(0,d.connectSelect)("select-tempo",e=>{const t=parseInt(e.innerHTML);(0,u.updateTempo)(t),be(t)}),(0,d.connectSelect)("select-eyes",e=>{const t=e.value.split(","),n=(0,x.convertOptionToObject)(t);Ie({scleraRadius:n.s,irisRadius:n.i,pupilRadius:n.p,eyeRatio:n.a||1})}),(0,d.connectSelect)("select-samples",async e=>{const t=e.value;Ie({instrumentPack:t});await(async e=>await ve("reloadInstrument",e))();Ce("instrumentPack",t)}),(0,d.connectSelect)("select-palette",e=>{const t=e.value.split(","),n=(0,x.convertOptionToObject)(t);Ie({saturation:n.s,luminosity:n.l})}),(0,d.connectReverbControls)(async e=>{if(e&&e.value){const t=e.value;await(0,i.setReverb)(t)}else console.error(e,e.previousSibling)});const s=document.getElementById("link-about");return(0,x.addMouseTapAndHoldEvents)(s),s.addEventListener(x.MOUSE_TAP,e=>{console.log("Logo tapped")}),s.addEventListener(x.MOUSE_HELD,e=>{console.log("Logo held")}),Me(),n(o++/3),r(ae,t)})(ke,(e,t)=>{(0,g.setLoadProgress)(e,t)}).then(async e=>{(0,p.setFeedback)(""),(0,p.setToast)(""),F.classList.toggle("loading",!1),requestAnimationFrame(Oe);let t=setTimeout(()=>{(0,p.setToast)("Please select how many players you want to play"),t=setTimeout(()=>(0,p.setToast)("by clicking either button"),15e3)},6e4);try{const{players:e,advancedMode:t}=await(0,u.showPlayerSelector)(ke);Ce("duet",e>1),Ce("advancedMode",t)}catch(e){console.error("player selection failed",e)}return(0,p.setFeedback)("Please wait loading! This can take <strong>some</strong> time..."),clearInterval(t),F.classList.toggle("loading",!0),(0,p.setToast)(""),(async(e,t,n)=>{let r=0;V.classList.add(D);try{if((0,p.setFeedback)("Setting things up...<br>This can take a while!"),n(r++/7,"Setting things up..."),U&&((0,p.setFeedback)("Image downloaded...<br> Please wait"),K=await(0,y.setupImage)(U)),n(r++/7,"Looking for cameras"),u.video){(0,p.setFeedback)("Attempting to locate a camera...<br>Please click accept if you are prompted");const e=await(0,S.findBestCamera)(H,u.video),{videoCameraDevices:t}=e;Y=e.camera,le=!1,(0,p.setFeedback)(e.saved?"Found saved camera":t.length>1?"Located a Camera but you can change it in Settings > Camera":"Located front facing camera"),t.length>1&&((0,u.setupCameraForm)(t,async e=>{le=!0,Y=await(0,S.loadCamera)(u.video,e.value,e.label),le=!1,H.setItem("camera",{deviceId:e.value}),(0,p.setToast)(`Camera ${e.label} changed`,0)}),V.classList.toggle("multiple-cameras",!0)),(0,p.setFeedback)("Camera connected",0),n(r++/7,"Camera connected")}V.style.setProperty("--width",u.video.width),V.style.setProperty("--height",u.video.height),V.classList.toggle("landscape",u.video.width>u.video.height),V.classList.toggle("portrait",u.video.width<u.video.height),V.classList.toggle("square",u.video.width===u.video.height),(0,v.updateCanvasSize)(u.video.width,u.video.height),n(r++/7)}catch(e){const t=String(e).replace("NotAllowedError: ","");return(0,p.setFeedback)(`Camera could not be accessed<br><strong>${t}</strong>`,0),(0,p.setToast)(t),oe=!1,se=!0,void(0,M.trackError)("Camera Rejected or Not allowed")}try{const e=H.getItem("audio"),t=e?e.volume:1;Q=await(0,i.setupAudio)(),ge(t),n(r++/7),te=(0,s.createDrumkit)(),ne=(0,_.kitSequence)(),(0,p.setFeedback)("Audio available...<br>Instrument Sounds ready"),n(r++/7)}catch(e){return se=!0,void(0,p.setFeedback)("Something went wrong with the Audio<br>"+e,0)}if((0,c.testForMIDI)()){try{await _e()?V.classList.add("midi"):(V.classList.add("midi","no-instrument"),(0,p.setFeedback)("MIDI available<br>Connect a MIDI instrument <strong>and click the button</strong>",0))}catch(e){console.log("no MIDI!",e),V.classList.add("no-midi"),V.classList.add("midi-unavailable"),(0,p.setFeedback)("MIDI unavailable, or no instrument connected<br>"+e,0)}n(r++/7,"MIDI Located")}else n(r++/7),V.classList.add("midi-unavailable"),(0,p.setFeedback)("MIDI is not available in this browser,<br>It'll work better in Brave, Edge or Chrome",0);v.canvas.width=ae.width,v.canvas.height=ae.height,V.classList.add(ae.nodeName.toLowerCase()),(0,p.addToolTips)(document.getElementById("controls"));const a=H.getItem("audio")?parseFloat(H.getItem("audio").volume):1;(0,i.setVolume)(a>0?a:1),n(r++/7);e(ae===u.video,e=>{if(he++,oe&&(oe=!1),le)return;let t="";if(j.clear)(0,v.clear)(),j.transparent||(0,v.drawElement)(ae);else{const e=.01*he%A.TAU;(0,v.overdraw)(-7*pe.x+Math.sin(e),-4*pe.y+Math.cos(e))}j.quantise&&(0,E.drawQuantise)(ie,(0,l.getBar)(),(0,l.getBars)()),j.spectrogram&&((0,i.updateByteFrequencyData)(),(0,w.drawBars)(i.dataArray,i.bufferLength));let n=!1;if(e){for(let r=0,a=e.length;r<a;++r){const a=e[r],o=we(r);if(!(a&&a.faceInViewConfidence>.9))return void(ue||(V.classList.toggle(o.name+"-active",!1),V.classList.toggle("no-faces",!0),ue=!0));if(ue&&(ue=!1,V.classList.toggle(o.name+"-active",!0),V.classList.toggle("no-faces",!1)),de=!0,n=!0,o.update(a),o.draw(a,j.text,!1,ie),!j.quantise&&!j.muted){const e=o.sing();0===r&&(pe.x=e.eyeDirection,pe.y=e.pitch)}t+=`<br>PITCH:${a.pitch} ROLL:${a.roll} YAW:${a.yaw} MOUTH:${Math.ceil(100*a.mouthRange/O.DEFAULT_OPTIONS.LIPS_RANGE)}%`}n||(0,p.setFeedback)((0,T.getHelp)(Math.floor(he/100)))}e?(0,p.setFeedback)((0,T.getInstruction)(Math.floor(he/100))):(0,p.setFeedback)((0,T.getHelp)(Math.floor(he/100))),ie&&(ie=!1)},()=>!le),Z=(0,l.startTimer)(e=>{const{bar:t,bars:n,barsElapsed:r,timePassed:a,elapsed:o,expected:s,drift:c,level:l,intervals:u,lag:d}=e;if(fe.lag=d,fe.drift=c,!j.muted){if(j.metronome&&n){const e=.1;te.clack(e,n%4==0?.2:.1)}if(j.quantise)for(let e=0,t=z.length;e<t;++e){const t=we(e).sing();0===e&&(pe.x=t.eyeDirection,pe.y=t.pitch)}if(j.backingTrack&&t%2==0){(0,_.playNextPart)(ne.kick,te.kick),(0,_.playNextPart)(ne.snare,te.snare),(0,_.playNextPart)(ne.hat,te.hat)}i.playing,ie=!0}},(0,l.timePerBar)())})(e,0,e=>{(0,g.setLoadProgress)(e)})}).then(e=>{(0,u.focusApp)()}).catch(e=>{(0,m.showError)(e,"Try hard refresh")}),Ne(),window.onbeforeunload=()=>{(0,M.trackExit)(),(0,p.setToast)("bye bye!"),(0,p.setFeedback)("<strong>I hope you had fun!</strong>")},window.oncontextmenu=()=>{he=0},window.addEventListener("popstate",e=>{}),(0,P.installOrUpdate)(j.debug).then(e=>{if(F.classList.toggle("updates-available",e.updateAvailable),F.classList.toggle("first-run",e.isFirstRun),F.classList.toggle("installable",e.isInstallable),e.isInstallable){const t=document.getElementById("button-install");t.addEventListener("click",async n=>{const r=await e.install(t);console.log("installed",r.success,{installed:r}),(0,p.setToast)(r.success?"Installed to HomeScreen":"You can always install again in the future")}),t.hidden=!1}else if(e.updatesAvailable){document.getElementById("button-update")}}).catch(e=>console.error("PWA",e))},{"./store":"ba5de09267de7d76186951c3db0534d9","./audio/speech":"e8af3d260f46c788794db60dfc099141","./audio/recorder":"2835677e0840868d89a8831de691af50","./audio/audio":"0114cf8fd744b8dc84d80f331ac3468a","./audio/synthesizers":"4e1219d41defd988ca61bd227196d78f","./audio/midi-out":"8222951756ad5a01072ed811a2ba98f5","./timing/timing.js":"0899cc6a6b0eda25734a56aad670415f","./dom/ui":"b0fa31d0ac4fa682c4ae7d502ab9ee9b","./dom/select":"a81fae2e506d45649dac2138e254fd37","./dom/toggle":"a6b2e211a95018e31ccdcdf3ef303130","./dom/button":"1320e5768254984e98e2398c62d5c5f7","./dom/text":"822f913172339b3ead8fd4d6e71a954e","./dom/errors":"1e277403826e5d724af5bb5c8f06d220","./dom/load-progress":"a616ce4857bc1da6e5a499fc7a954ad3","./dom/photographs":"f65640eac8726b36f8f61e36879841ff","./visual/canvas":"041a34f0683a41bf466ce78a0fb7cc0c","./visual/2d":"f803e61e201bc53ab013db5ee5dd0610","./visual/spectrograms":"dba4aa4fd874962cbb2ad03795b3a24b","./visual/quantise":"f88cc042be3abc856bd0c7e33042a321","./location-handler":"99fcf05ce09eb6c13fde8b1abcb1879b","./camera":"ce693141997b2d2648718d5ab03d6662","./timing/patterns":"94673a9f225080d4eed255b4e849347b","./models/instructions":"e40e2877bdeb8c72986e028992ca18be","./reporting":"dad49c631de14c19376524e29b658dc1","./version":"25488683cc04bb43faf629e105172bc8","./maths/maths":"ce2f8ad85ead883d6119bddf22ec8710","./person":"dd6a1e56851684b1b1584ee092f2589f","./i18n":"cde67f52b564f0e95dce1a0eaa0cb214","./settings":"300693fbda54b9e9f6d7dbc70c6d85e0","./utils":"569dc304b7e08c7a087e8d733528b9ee","./pwa/pwa":"89a3b6041c1b1b1528848d21ce257e48","./models/body":"cfecc9fa9a81e04d3c647b955966e409","./models/face":"b5b67b38abb1ba44992301555178057b","share-menu":"283f33f850e985deba879d3ef80dccb5"}],ba5de09267de7d76186951c3db0534d9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createStore=void 0;var r=e("./utils");n.createStore=(e="InterFACE")=>{const t=localStorage.getItem(e),n=Object.assign({},JSON.parse(t)),a=(0,r.debounce)(t=>{const n=JSON.stringify(t);localStorage.setItem(e,n)},20);return{save:a,has:e=>!!n[e],removeItem:e=>{delete n[e]},getItem:e=>n[e],setItem:(e,t)=>(n[e]=Object.assign({},n[e],t),a(n),n)}}},{"./utils":"569dc304b7e08c7a087e8d733528b9ee"}],"569dc304b7e08c7a087e8d733528b9ee":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.decodeBase64=n.addMouseTapAndHoldEvents=n.MOUSE_TAP=n.MOUSE_HOLDING=n.MOUSE_HELD=n.debounce=n.convertOptionToObject=void 0;n.convertOptionToObject=e=>e.reduce((e,t)=>{const n=t.split(":");return e[n[0]]=parseFloat(n[1]),e},{});n.debounce=(e,t)=>{let n;return(...r)=>(clearTimeout(n),n=setTimeout(()=>e(...r),t),n)};const r=()=>performance.now()||Date.now();n.MOUSE_HELD="mouse_held";n.MOUSE_HOLDING="mouse_holding";n.MOUSE_TAP="mouse_tap";n.addMouseTapAndHoldEvents=(e,t=800)=>{let n=-1,a=!1,o=!1;const i=(t,n={})=>{e.dispatchEvent(new CustomEvent(t,{detail:n}))},s=()=>{if(a&&o){const e=r()-n;if(e<t){const n=1-e/t,r=100-Math.ceil(100*n);console.log("mouseDownFor",r,{elapsed:e,remaining:n}),i("mouse_holding",{elapsed:e,isMouseOver:a,remaining:n,percentageRemaining:r}),requestAnimationFrame(s)}else n=-1}};return e.addEventListener("mousedown",e=>{n=r(),o=!0,s(),e.preventDefault()}),e.addEventListener("mouseup",e=>{const s=r()-n;i(s<t?"mouse_tap":"mouse_held",{elapsed:s,isMouseOver:a}),n=-1,o=!1,e.preventDefault()}),e.addEventListener("mouseover",e=>{a=!0}),e.addEventListener("mouseout",e=>{a=!1}),{}};n.decodeBase64=(e,t)=>{const n=e.replace(/[^A-Za-z0-9\+\/]/g,""),r=n.length,a=t?Math.ceil((3*r+1>>2)/t)*t:3*r+1>>2,o=new Uint8Array(a);for(let e,t,s=0,c=0,l=0;l<r;l++)if(t=3&l,s|=((i=n.charCodeAt(l))>64&&i<91?i-65:i>96&&i<123?i-71:i>47&&i<58?i+4:43===i?62:47===i?63:0)<<18-6*t,3===t||r-l==1){for(e=0;e<3&&c<a;e++,c++)o[c]=s>>>(16>>>e&24)&255;s=0}var i;return o}},{}],e8af3d260f46c788794db60dfc099141:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isVoiceActive=n.stopSpeaking=n.say=n.hasSpeech=void 0;const r=()=>"speechSynthesis"in window;n.hasSpeech=r;const a=async()=>new Promise((e,t)=>{let n;const r=Date.now(),a=()=>{if(n=window.speechSynthesis.getVoices(),n.length>0)e(n);else{Date.now()-r<1e4?setTimeout(a,0):t("No voices found")}};a()});n.say=async(e,t=!0,n=1,o=1,i=1,s,c)=>new Promise((l,u)=>{if(r){(async()=>{try{const r=(s&&c?await(async(e="en-US",t="Zira")=>{const n=a(),r=n.filter(n=>n.lang===e&&n.name.indexOf(t)>-1);return r.length<1?n:r})(s,c):await a())[0],d=new SpeechSynthesisUtterance;d.lang="en-US",d.voice=r,d.voiceURI="native",d.onend=e=>{d.onend=null,l(e)},d.onerror=e=>{u()},d.volume=n,d.rate=o,d.pitch=i,d.text=e,t&&window.speechSynthesis.cancel(),window.speechSynthesis.speak(d)}catch(e){u(e)}})()}else u("Speech tech not available")});n.stopSpeaking=()=>window.speechSynthesis.cancel();n.isVoiceActive=()=>window.speechSynthesis.pending},{}],"2835677e0840868d89a8831de691af50":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.record=void 0;n.record=e=>{let t,n=!1;return{isAvailable:()=>!!(window&&window.MediaRecorder&&"function"==typeof window.MediaRecorder.isTypeSupported&&window.Blob),downloadRecording:()=>{var e=new Blob(recordedChunks,{type:"video/webm"}),t=URL.createObjectURL(e),n=document.createElement("a");document.body.appendChild(n),n.style="display: none",n.href=t,n.download="test.webm",n.click(),window.URL.revokeObjectURL(t)},encodeRecording:(e,t="audio/mp3;")=>new Blob(e,{type:t}),startRecording:e=>new Promise((r,a)=>{if(n)return a("already recording");t=[],mediaRecorder=new MediaRecorder(e),mediaRecorder.ondataavailable=n=>{t.push(n.data),r({mediaRecorder:mediaRecorder,dataArray:t,stream:e})},mediaRecorder.onwarning=function(e){console.log("onwarning fired")},mediaRecorder.onerror=e=>{switch(console.log("onerror fired"),e.name){case"InvalidState":case"OutOfMemory":case"IllegalStreamModification":case"OtherRecordingError":case"GenericError":break;default:console.error("MediaRecorder Error",e)}},mediaRecorder.start(),n=!0}),stopRecording:()=>new Promise((e,r)=>{if(!n)return r("Not recording");mediaRecorder.onstop=r=>{n=!1,e(t)},mediaRecorder.stop()}),isRecording:()=>n}}},{}],"0114cf8fd744b8dc84d80f331ac3468a":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.loadInstrumentPack=n.loadInstrumentParts=n.playTrack=n.loadAudio=n.setVolume=n.getVolume=n.setFrequency=n.setShape=n.createOscillator=n.playAudio=n.stopAudio=n.updateByteTimeDomainData=n.updateByteFrequencyData=n.setupAudio=n.setReverb=n.chooseFilters=n.active=n.playing=n.dataArray=n.bufferLength=n.audioContext=n.randomInstrument=void 0;e("../maths/maths");var r=e("./instruments"),a=e("./rack"),o=e("./effects/reverb"),i=(e("./effects/delay"),e("./effects/dub"),e("./effects/compressor")),s=e("./effects/distortion"),c=e("./effects/amplitude"),l=e("./notes");let u,d,h,f,p,m;n.randomInstrument=()=>r.INSTRUMENT_FOLDERS[Math.floor(Math.random()*r.INSTRUMENT_FOLDERS.length)],n.audioContext=u,n.bufferLength=d,n.dataArray=h;let g=!1;n.playing=g;let b=!1;n.active=b;n.chooseFilters=async e=>(0,a.chain)([m,await(0,i.createCompressor)(u),await(0,s.createDistortion)(u)],u);const v={reverb:.1,normalise:!0,smoothingTimeConstant:.45};n.setReverb=async e=>{const t=e||await(0,o.randomReverb)();return p.impulseFilter(t)};n.setupAudio=async e=>{const t=Object.assign({},v,e);return n.audioContext=u=new(window.AudioContext||window.webkitAudioContext),m=await(0,c.createAmplitude)(u,1),p=await(0,o.createReverb)(u,t.reverb,t.normalise),f=u.createAnalyser(),f.minDecibels=-90,f.maxDecibels=-10,f.smoothingTimeConstant=t.smoothingTimeConstant,n.bufferLength=d=f.frequencyBinCount,n.dataArray=h=new Uint8Array(d),(0,a.chain)([m,p,f],u)};n.updateByteFrequencyData=()=>{f.fftSize=2048,f.getByteFrequencyData(h),n.bufferLength=d=f.frequencyBinCount};n.updateByteTimeDomainData=()=>{f.fftSize=256,f.getByteTimeDomainData(h),n.bufferLength=d=f.frequencyBinCount};const y=()=>{const e=requestAnimationFrame(y);return f.getByteFrequencyData(h),e};n.stopAudio=()=>!!g&&(n.playing=g=!1,!0);n.playAudio=()=>!g&&("suspended"===u.state&&u.resume(),n.playing=g=!0,y(),!0);n.createOscillator=()=>{};n.setShape=e=>{(void 0).type=e};n.setFrequency=e=>{(void 0).frequency.value=e};n.getVolume=()=>m.volume();n.setVolume=e=>m.volume(e);const w=async e=>{const t=await fetch(e),n=await t.arrayBuffer();return await u.decodeAudioData(n)};n.loadAudio=w;n.playTrack=(e,t=0,r=delayNode,a={loop:!1})=>new Promise((o,i)=>{const s=u.createBufferSource();s.buffer=e,s.loop=a.loop,s.connect(r),s.onended=()=>{s.disconnect(),n.active=b=!1,o()},s.onerror=e=>{s.disconnect(),n.active=b=!1,i(e)},"suspended"===u.state&&u.resume(),0==t?s.start():s.start(0,u.currentTime-t),n.active=b=!0});const E=(e="alto_sax-mp3",t="FluidR3_GM")=>{const n=`${t}/${e}`;return(0,l.createInstrumentBanks)().map(e=>w(`./assets/audio/${n}/${e}`))};n.loadInstrumentParts=E;n.loadInstrumentPack=async(e="alto_sax-mp3",t="FluidR3_GM",n)=>{const a={title:(0,r.cleanTitle)(e),name:e},o=await Promise.all(E(e,t));return l.NOTE_NAMES.forEach((e,t)=>{a[e.split(".")[0]]=o[t]}),a}},{"../maths/maths":"ce2f8ad85ead883d6119bddf22ec8710","./instruments":"adb022073b84168965080f9f27da58ab","./rack":"5981e33044845d6ab95929f13d36a5e7","./effects/reverb":"f7dee7e6f6f6d14fee6166e1d4ca217f","./effects/delay":"b228250f32aadbe167ce1c5aa63cded4","./effects/dub":"a84df6d2e381977f8ee9e7135c7bd0c0","./effects/compressor":"c1c2dfc1866c7edd735d13f8281a8d0c","./effects/distortion":"980016edf903491cc696a88fa3db705a","./effects/amplitude":"b6bba6d20b2c2d60c9ea1344061da645","./notes":"f8a5579e8771521f023538f4c12b5f30"}],ce2f8ad85ead883d6119bddf22ec8710:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.twist=n.clamp=n.lerp=n.distance2D=n.distance3D=n.distanceBetween3Points=n.distanceBetween2Points=n.determineAngle=n.rescale=n.HALF_PI=n.TAU=void 0;const r=2*Math.PI;n.TAU=r;const a=.5*Math.PI;n.HALF_PI=a;const{PI:o,sqrt:i,atan2:s,tan:c}=Math;n.rescale=(e,t=1)=>{const n=1/(t-e);return t=>n*(t-e)};n.determineAngle=(e,t)=>{const n=e[1]-t[1],r=t[0]-e[0];return s(n,r)};n.distanceBetween2Points=(e,t)=>i((e[0]-t[0])**2+(e[1]-t[1])**2);n.distanceBetween3Points=(e,t)=>i((e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2);n.distance3D=(e,t,n,r,a,o)=>i((e-t)**2+(n-r)**2+(a-o)**2);n.distance2D=(e,t,n,r)=>i((e-t)**2+(n-r)**2);n.lerp=(e,t,n)=>(1-n)*e+n*t;const l=(e,t,n)=>e>n?n:e<t?t:e;n.clamp=l;n.twist=(e,t=0)=>l((e=e<0?-1*(e+1):1-e)+t,-1,1)},{}],adb022073b84168965080f9f27da58ab:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.storeInstrument=n.fetchInstrument=n.instrumentCache=n.INSTRUMENT_NAMES=n.cleanTitle=n.INSTRUMENT_FOLDERS=n.INSTRUMENT_PACKS=n.INSTRUMENT_PACK_MUSYNGKITE=n.INSTRUMENT_PACK_FATBOY=n.INSTRUMENT_PACK_FM=n.MUSICAL_NOTES=void 0;n.MUSICAL_NOTES=["♫","𝅗𝅥","𝅘𝅥","𝅘𝅥𝅮","𝅘𝅥𝅯","𝅘𝅥𝅰","𝅘𝅥𝅱","𝅘𝅥𝅲"];n.INSTRUMENT_PACK_FM="FluidR3_GM";n.INSTRUMENT_PACK_FATBOY="FatBoy";n.INSTRUMENT_PACK_MUSYNGKITE="MusyngKite";const r=["FluidR3_GM","FatBoy"];n.INSTRUMENT_PACKS=r;const a=["accordion-mp3","acoustic_bass-mp3","acoustic_grand_piano-mp3","acoustic_guitar_nylon-mp3","acoustic_guitar_steel-mp3","agogo-mp3","alto_sax-mp3","applause-mp3","bagpipe-mp3","banjo-mp3","baritone_sax-mp3","bassoon-mp3","bird_tweet-mp3","blown_bottle-mp3","brass_section-mp3","breath_noise-mp3","bright_acoustic_piano-mp3","celesta-mp3","cello-mp3","choir_aahs-mp3","church_organ-mp3","clarinet-mp3","clavinet-mp3","contrabass-mp3","distortion_guitar-mp3","drawbar_organ-mp3","dulcimer-mp3","electric_bass_finger-mp3","electric_bass_pick-mp3","electric_grand_piano-mp3","electric_guitar_clean-mp3","electric_guitar_jazz-mp3","electric_guitar_muted-mp3","electric_piano_1-mp3","electric_piano_2-mp3","english_horn-mp3","fiddle-mp3","flute-mp3","french_horn-mp3","fretless_bass-mp3","fx_1_rain-mp3","fx_2_soundtrack-mp3","fx_3_crystal-mp3","fx_4_atmosphere-mp3","fx_5_brightness-mp3","fx_6_goblins-mp3","fx_7_echoes-mp3","fx_8_scifi-mp3","glockenspiel-mp3","guitar_fret_noise-mp3","guitar_harmonics-mp3","gunshot-mp3","harmonica-mp3","harpsichord-mp3","helicopter-mp3","honkytonk_piano-mp3","kalimba-mp3","koto-mp3","lead_1_square-mp3","lead_2_sawtooth-mp3","lead_3_calliope-mp3","lead_4_chiff-mp3","lead_5_charang-mp3","lead_6_voice-mp3","lead_7_fifths-mp3","lead_8_bass__lead-mp3","marimba-mp3","melodic_tom-mp3","music_box-mp3","muted_trumpet-mp3","oboe-mp3","ocarina-mp3","orchestra_hit-mp3","orchestral_harp-mp3","overdriven_guitar-mp3","pad_1_new_age-mp3","pad_2_warm-mp3","pad_3_polysynth-mp3","pad_4_choir-mp3","pad_5_bowed-mp3","pad_6_metallic-mp3","pad_7_halo-mp3","pad_8_sweep-mp3","pan_flute-mp3","percussive_organ-mp3","piccolo-mp3","pizzicato_strings-mp3","recorder-mp3","reed_organ-mp3","reverse_cymbal-mp3","rock_organ-mp3","seashore-mp3","shakuhachi-mp3","shamisen-mp3","shanai-mp3","sitar-mp3","slap_bass_1-mp3","slap_bass_2-mp3","soprano_sax-mp3","steel_drums-mp3","string_ensemble_1-mp3","string_ensemble_2-mp3","synth_bass_1-mp3","synth_bass_2-mp3","synth_brass_1-mp3","synth_brass_2-mp3","synth_choir-mp3","synth_drum-mp3","synth_strings_1-mp3","synth_strings_2-mp3","taiko_drum-mp3","tango_accordion-mp3","telephone_ring-mp3","tenor_sax-mp3","timpani-mp3","tinkle_bell-mp3","tremolo_strings-mp3","trombone-mp3","trumpet-mp3","tuba-mp3","tubular_bells-mp3","vibraphone-mp3","viola-mp3","violin-mp3","voice_oohs-mp3","whistle-mp3","woodblock-mp3","xylophone-mp3"];n.INSTRUMENT_FOLDERS=a;const o=e=>e&&e.length>1?e.replaceAll("_"," ").replace("-mp3",""):"";n.cleanTitle=o;const i=a.map(e=>o(e));n.INSTRUMENT_NAMES=i;const s={};n.instrumentCache=s;n.fetchInstrument=e=>s[e];n.storeInstrument=(e,t)=>{s[e]=t}},{}],"5981e33044845d6ab95929f13d36a5e7":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.unchain=n.removeLink=n.chain=n.resolveRoute=n.inputDryNode=n.inputNode=void 0;let r=null,a=null,o=null,i=null;n.inputNode=()=>r.name?r.node:r;n.inputDryNode=()=>a;const s=e=>e.name?e.node:e;n.resolveRoute=s;n.chain=(e,t=null)=>{c();const n=e.length;if(n>1)for(let t=1;t<n;++t){const o=s(e[t-1]),i=s(e[t]);o.connect(i),1===t&&(r=o),t===n-1&&(a=i)}else r=a=s(e[0]);return t&&a.connect(t.destination),o=e,i=t,r};n.removeLink=e=>{};const c=()=>{if(o&&i){const e=o.length;if(e>1)for(let t=1;t<e;++t){const e=s(routes[t-1]),n=s(routes[t]);e.disconnect(n)}a.disconnect(audioContext.destination)}};n.unchain=c},{}],f7dee7e6f6f6d14fee6166e1d4ca217f:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createReverb=n.randomReverb=n.getImpulseList=n.loadImpulseList=n.loadImpulseJSON=n.REVERB_PATHS=n.DIRS=void 0;var r=e("./effect");const a=["EMT140-Plate","Voxengo"];n.DIRS=a;let o;const i="./assets/audio/acoustics/",s=a.map(e=>`${i}${e}/sampled.instrument.json`);n.REVERB_PATHS=s;const c={},l=async e=>{if(c[e])return c[e];const t=await fetch(`${i}${e}/sampled.instrument.json`),n=await t.json();return c[e]=n.files.map(t=>`${i}${e}/${t}`),c[e]};n.loadImpulseJSON=l;const u=async(e=a)=>{const t=e.map(async e=>{const t=await l(e);return console.error(t,e),t}),n=[].concat(...t);return console.error(e,t,n),n};n.loadImpulseList=u;const d=async()=>{if(o)return o;try{return o=await u(),o}catch(e){console.error({impulses:o})}};n.getImpulseList=d;n.randomReverb=async()=>{try{const e=await d();return e[Math.ceil((e.length-1)*Math.random())]}catch(e){throw Error("Random reverb failed to fetch list"+e)}};n.createReverb=async(e,t=.4,n=!0,a="./assets/audio/acoustics/ir-hall.mp3")=>{const o=async t=>{const n=await fetch(t),r=await n.arrayBuffer();return await e.decodeAudioData(r)},i=new DynamicsCompressorNode(e),s=new GainNode(e,{gain:t}),c=e.createConvolver();return c.buffer=await o(a),c.normalize=n,i.connect(e.destination),i.connect(c),c.connect(s).connect(e.destination),{name:"reverb",node:c,impulseFilter:async e=>(c.buffer=await o(e),c.normalize=n,e),gain:e=>(0,r.changeParameter)(s,"gain",e)}}},{"./effect":"f5d1a314a5d1ec7214ae26cad68db4cf"}],f5d1a314a5d1ec7214ae26cad68db4cf:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.changeParameter=void 0;n.changeParameter=(e,t,n)=>(n&&(e[t]=n),null!=n?n:e[t])},{}],b228250f32aadbe167ce1c5aa63cded4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createDelay=void 0;var r=e("./effect");n.createDelay=async(e,t=.05,n=.4)=>{const a=e.createDelay(t),o=e.createGain(n);return o.gain.value=n,o.connect(a),a.connect(e.destination),{name:"delay",node:o,feedback:e=>(0,r.changeParameter)(o,"gain",e),delayTime:e=>(0,r.changeParameter)(a,"delayTime",e)}}},{"./effect":"f5d1a314a5d1ec7214ae26cad68db4cf"}],a84df6d2e381977f8ee9e7135c7bd0c0:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createDub=void 0;var r=e("./effect");n.createDub=async(e,t=.5,n=.4,a=1e3,o=2.5)=>{const i=e.createDelay(o);i.delayTime.value=t;const s=e.createGain();s.gain.value=n;const c=e.createBiquadFilter();return c.frequency.value=a,i.connect(s),s.connect(c),c.connect(i),{name:"dub",node:i,delayTime:e=>(0,r.changeParameter)(i,"delayTime",e),feedback:e=>(0,r.changeParameter)(s,"gain",e),filter:e=>(0,r.changeParameter)(c,"frequency",e)}}},{"./effect":"f5d1a314a5d1ec7214ae26cad68db4cf"}],c1c2dfc1866c7edd735d13f8281a8d0c:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createCompressor=void 0;var r=e("./effect");n.createCompressor=async(e,t=-70,n=40,a=5,o=0,i=.5,s=0)=>{const c=e.createDynamicsCompressor();return c.threshold.value=t,c.knee.value=n,c.ratio.value=a,c.attack.value=o,c.release.value=i,{name:"compressor",node:c,knee:e=>(0,r.changeParameter)(c,"knee",e),threshold:e=>(0,r.changeParameter)(c,"threshold",e),ratio:e=>(0,r.changeParameter)(c,"ratio",e),attack:e=>(0,r.changeParameter)(c,"attack",e),release:e=>(0,r.changeParameter)(c,"release",e)}}},{"./effect":"f5d1a314a5d1ec7214ae26cad68db4cf"}],"980016edf903491cc696a88fa3db705a":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createDistortion=void 0;e("./effect");function r(e){for(var t,n="number"==typeof e?e:50,r=new Float32Array(44100),a=Math.PI/180,o=0;o<44100;++o)t=2*o/44100-1,r[o]=(3+n)*t*20*a/(Math.PI+n*Math.abs(t));return r}n.createDistortion=async(e,t=1,n="4x")=>{const a=e.createWaveShaper();return a.oversample=n,a.curve=r(t),{name:"distortion",node:a,curve:e=>a.curve=r(e),oversample:e=>a.oversample=e}}},{"./effect":"f5d1a314a5d1ec7214ae26cad68db4cf"}],b6bba6d20b2c2d60c9ea1344061da645:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createAmplitude=void 0;var r=e("../../maths/maths");n.createAmplitude=async(e,t=1,n=!1)=>{const a=e.createGain(),o=t=>{const n=a.gain.value,r=n+.1*(t-n);return a.gain.value.setValueAtTime(t,e.currentTime),n===t||requestAnimationFrame(o),r},i=e=>{n?o():a.gain.value=(0,r.clamp)(t,0,1)};return i(),{name:"amplitude",node:a,volume:e=>e?(i(),e):a.gain.value}}},{"../../maths/maths":"ce2f8ad85ead883d6119bddf22ec8710"}],f8a5579e8771521f023538f4c12b5f30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getNoteName=n.getNoteText=n.getNoteSound=n.NOTE_NAMES_FRIENDLY=n.NOTE_NAMES=n.createInstrumentBanks=n.SOLFEGE_SCALE=n.NOTES_WHITE_INDEXES=n.NOTES_BLACK_INDEXES=n.NOTES_WHITE=n.NOTES_BLACK=n.BANKS=void 0;var r=e("../maths/maths");const a=["A","Ab","B","Bb","C","D","Db","E","Eb","F","G","Gb"];n.BANKS=a;const o=["Ab","Bb","Db","Eb","Gb"];n.NOTES_BLACK=o;const i=["A","B","C","D","E","F","G"];n.NOTES_WHITE=i;const s=o.length-1;n.NOTES_BLACK_INDEXES=s;const c=i.length-1;n.NOTES_WHITE_INDEXES=c;const l=["Doe","Ray","Me","Far","Sew","La","Tea"];n.SOLFEGE_SCALE=l;const u=(e="mp3",t=".")=>{const n=[];for(let r=0;r<a.length;++r){const o=a[r];"A"===o&&n.push(`A0${t}${e}`);for(let r=1;r<8;++r)n.push(`${o}${r}${t}${e}`);"C"===o&&n.push(`C8${t}${e}`)}return n};n.createInstrumentBanks=u;const d=u("","");n.NOTE_NAMES=d;const h={};n.NOTE_NAMES_FRIENDLY=h,d.forEach(e=>{h[e]=e});n.getNoteSound=(e,t=!1)=>l[Math.floor(e*(l.length-1))];n.getNoteText=e=>{const t=e.charAt(0);let n;return 3===e.length?(n=parseInt(e.charAt(2))+1,`${t}#${n}`):(n=parseInt(e.charAt(1))+1,`${t}${n}`)};n.getNoteName=(e,t=3,n=!1)=>{let a,l;return n?(a=Math.floor(e*s),l=o[a]):(a=Math.floor(e*c),l=i[a]),`${l}${(0,r.clamp)(t,1,7)}`}},{"../maths/maths":"ce2f8ad85ead883d6119bddf22ec8710"}],"4e1219d41defd988ca61bd227196d78f":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createDrumkit=n.createClacks=n.createCowbells=n.createHihats=n.createSnares=n.createKicks=n.createCowbell=n.createClack=n.createHihat=n.createSnare=n.createKick=n.createQueue=void 0;var r=e("./audio"),a=e("./rack");const o=(e,t=5)=>{const n=[];for(let r=0;r<t;++r){const t=e();n.push(t)}let r=0;return(...e)=>{r=r+1<t?r+1:0;(0,n[r])(...e)}};n.createQueue=o;const i=()=>{const e=r.audioContext.createOscillator(),t=r.audioContext.createOscillator(),n=r.audioContext.createGain(),o=r.audioContext.createGain();e.type="triangle",t.type="sine";return e.connect(n),t.connect(o),n.connect((0,a.inputDryNode)()),o.connect((0,a.inputDryNode)()),(a=1,i=.05,s=.01,c=.5)=>{const l=r.audioContext.currentTime;n.gain.cancelScheduledValues(l),o.gain.cancelScheduledValues(l),e.frequency.cancelScheduledValues(l),t.frequency.cancelScheduledValues(l),n.gain.setValueAtTime(1,l),n.gain.exponentialRampToValueAtTime(1e-7,l+i),o.gain.setValueAtTime(1,r.audioContext.currentTime),o.gain.exponentialRampToValueAtTime(1e-7,l+i),e.frequency.setValueAtTime(90,r.audioContext.currentTime),e.frequency.exponentialRampToValueAtTime(s,l+i),t.frequency.setValueAtTime(50,r.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(s,l+i);try{e.start(l),t.start(l)}catch(e){}}};n.createKick=i;const s=()=>{const e=r.audioContext.createOscillator(),t=r.audioContext.createGain(),n=r.audioContext.createGain(),o=r.audioContext.createBufferSource(),i=r.audioContext.createBuffer(1,4096,r.audioContext.sampleRate),s=r.audioContext.createBiquadFilter();s.type="highpass",e.type="triangle",e.frequency.value=100;const c=i.getChannelData(0);for(var l=0;l<4096;l++)c[l]=Math.random();o.buffer=i,o.loop=!0,e.connect(t),t.connect((0,a.inputDryNode)()),o.connect(s),s.connect(n),n.connect((0,a.inputDryNode)());return(a=1,i=.2)=>{const c=r.audioContext.currentTime;n.gain.cancelScheduledValues(c),n.gain.setValueAtTime(1,c),n.gain.exponentialRampToValueAtTime(1e-7,c+i),t.gain.cancelScheduledValues(c),t.gain.setValueAtTime(1e-7,c),t.gain.exponentialRampToValueAtTime(1e-7,c+i/2),s.frequency.cancelScheduledValues(c),s.frequency.setValueAtTime(100,c),s.frequency.linearRampToValueAtTime(1e3,c+i);try{e.start(c),o.start(c)}catch(e){}}};n.createSnare=s;const c=()=>{const e=r.audioContext.createGain(),t=r.audioContext.createBiquadFilter();t.type="bandpass",t.frequency.value=1e4;const n=r.audioContext.createBiquadFilter();n.type="highpass",n.frequency.value=7e3;const o=[2,3,4.16,5.43,6.79,8.21].map(e=>{const n=r.audioContext.createOscillator();return n.type="square",n.frequency.value=40*e,n.connect(t),n});t.connect(n),n.connect(e),e.connect((0,a.inputDryNode)());return(t=1,n=.05)=>{const a=r.audioContext.currentTime;e.gain.cancelScheduledValues(a),o.forEach(e=>e.frequency.cancelScheduledValues(a)),e.gain.setValueAtTime(1,a),e.gain.exponentialRampToValueAtTime(1e-7,a+n);try{o.forEach(e=>e.start(a))}catch(e){}}};n.createHihat=c;const l=()=>{const e=r.audioContext.createGain(),t=r.audioContext.createBiquadFilter();t.type="bandpass",t.frequency.value=2640,t.Q.value=3.5;const n=r.audioContext.createBiquadFilter();n.type="highpass",n.frequency.value=7e3;const o=[587,845],i=o.map(e=>{const n=r.audioContext.createOscillator();return n.type="triangle",n.frequency.value=1*e,n.connect(t),n});t.connect(n),n.connect(e),e.connect((0,a.inputDryNode)());return(t=1,n=.05,a=1)=>{const s=r.audioContext.currentTime;e.gain.cancelScheduledValues(s),i.forEach((e,t)=>{e.frequency.cancelScheduledValues(s),e.frequency.value=a*o[t]}),e.gain.setValueAtTime(1,s),e.gain.exponentialRampToValueAtTime(1e-7,s+n);try{i.forEach(e=>e.start(s))}catch(e){}}};n.createClack=l;const u=()=>{const e=r.audioContext.createGain(),t=r.audioContext.createBiquadFilter();t.type="bandpass",t.frequency.value=2640,t.Q.value=3.5;const n=[587,845].map(e=>{const n=r.audioContext.createOscillator();return n.type="triangle",n.frequency.value=1*e,n.connect(t),n});t.connect(e),e.connect((0,a.inputDryNode)());return(t=1,a=.05)=>{const o=r.audioContext.currentTime;e.gain.cancelScheduledValues(o),n.forEach(e=>e.frequency.cancelScheduledValues(o)),e.gain.setValueAtTime(1,o),e.gain.exponentialRampToValueAtTime(1e-7,o+a);try{n.forEach(e=>e.start(o))}catch(e){}}};n.createCowbell=u;const d=(e=2)=>o(i,e);n.createKicks=d;const h=(e=3)=>o(s,e);n.createSnares=h;const f=(e=3)=>o(c,e);n.createHihats=f;n.createCowbells=(e=2)=>o(u,e);n.createClacks=(e=2)=>o(l,e);n.createDrumkit=()=>{const e=d(),t=f();return{kick:e,snare:h(),hat:t,cowbell:u(),clack:l()}}},{"./audio":"0114cf8fd744b8dc84d80f331ac3468a","./rack":"5981e33044845d6ab95929f13d36a5e7"}],"8222951756ad5a01072ed811a2ba98f5":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.setupMIDI=n.testForMIDI=void 0;var r=e("webmidi/dist/webmidi.esm");n.testForMIDI=()=>void 0!==navigator.requestMIDIAccess;n.setupMIDI=(e,t)=>new Promise((n,a)=>{r.WebMidi.enable().then(a=>{r.WebMidi.addListener("connected",(function(t){console.log(t),e&&e(t)})),r.WebMidi.addListener("disconnected",(function(e){console.log(e),t&&t()})),n(r.WebMidi)}).catch(e=>a(e))})},{"webmidi/dist/webmidi.esm":"334aec7d4e576dc12758c661787237f8"}],"334aec7d4e576dc12758c661787237f8":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.WebMidi=n.Note=void 0;var r=e("process");class a{constructor(e=!1){this.eventMap={},this.eventsSuspended=1==e}addListener(e,t,n={}){if("string"==typeof e&&e.length<1||e instanceof String&&e.length<1||"string"!=typeof e&&!(e instanceof String)&&e!==a.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if("function"!=typeof t)throw new TypeError("The callback must be a function.");const r=new o(e,this,t,n);return this.eventMap[e]||(this.eventMap[e]=[]),n.prepend?this.eventMap[e].unshift(r):this.eventMap[e].push(r),r}addOneTimeListener(e,t,n={}){n.remaining=1,this.addListener(e,t,n)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(e,t){return void 0===e?!!(this.eventMap[a.ANY_EVENT]&&this.eventMap[a.ANY_EVENT].length>0)||Object.entries(this.eventMap).some(([,e])=>e.length>0):!!(this.eventMap[e]&&this.eventMap[e].length>0)&&(t instanceof o?this.eventMap[e].filter(e=>e===t).length>0:"function"==typeof t?this.eventMap[e].filter(e=>e.callback===t).length>0:null==t)}get eventNames(){return Object.keys(this.eventMap)}getListeners(e){return this.eventMap[e]||[]}suspendEvent(e){this.getListeners(e).forEach(e=>{e.suspended=!0})}unsuspendEvent(e){this.getListeners(e).forEach(e=>{e.suspended=!1})}getListenerCount(e){return this.getListeners(e).length}emit(e,...t){if("string"!=typeof e&&!(e instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let n=[],r=this.eventMap[a.ANY_EVENT]||[];return this.eventMap[e]&&(r=r.concat(this.eventMap[e])),r.forEach(e=>{if(e.suspended)return;let r=[...t];Array.isArray(e.arguments)&&(r=r.concat(e.arguments)),e.remaining>0&&(n.push(e.callback.apply(e.context,r)),e.count++),--e.remaining<1&&e.remove()}),n}removeListener(e,t,n={}){if(void 0===e)return void(this.eventMap={});if(!this.eventMap[e])return;let r=this.eventMap[e].filter(e=>t&&e.callback!==t||n.remaining&&n.remaining!==e.remaining||n.context&&n.context!==e.context);r.length?this.eventMap[e]=r:delete this.eventMap[e]}async waitFor(e,t={}){return t.duration=parseInt(t.duration),(isNaN(t.duration)||t.duration<=0)&&(t.duration=1/0),new Promise((n,r)=>{let a,o=this.addListener(e,()=>{clearTimeout(a),n()},{remaining:1});t.duration!==1/0&&(a=setTimeout(()=>{o.remove(),r("The duration expired before the event was emitted.")},t.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class o{constructor(e,t,n,r={}){if("string"!=typeof e&&!(e instanceof String)&&e!==a.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!t)throw new ReferenceError("The 'target' parameter is mandatory.");if("function"!=typeof n)throw new TypeError("The 'callback' must be a function.");void 0===r.arguments||Array.isArray(r.arguments)||(r.arguments=[r.arguments]),(r=Object.assign({context:t,remaining:1/0,arguments:void 0,duration:1/0},r)).duration!==1/0&&setTimeout(()=>this.remove(),r.duration),this.event=e,this.target=t,this.callback=n,this.context=r.context,this.remaining=parseInt(r.remaining)>=1?parseInt(r.remaining):1/0,this.count=0,this.arguments=r.arguments,this.suspended=!1}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}class i extends a{constructor(e,t){super(),this.input=e,this.number=t,this._forwardTo=void 0}destroy(){this.input=null,this.number=null,this.removeListener()}_parseEvent(e){let t=null;e.data[0]!==d.MIDI_SYSTEM_MESSAGES.sysex&&(t=e.data.slice(1));let n={target:this,data:Array.from(e.data),rawData:e.data,statusByte:e.data[0],dataBytes:t,timestamp:e.timeStamp,type:"midimessage"};this.emit("midimessage",n),this._parseEventForStandardMessages(e)}getStructuredMidiMessage(e){return{command:e[0]>>4,data1:e.length>1?e[1]:void 0,data2:e.length>2?e[2]:void 0}}_parseEventForStandardMessages(e){let{command:t,data1:n,data2:r}=this.getStructuredMidiMessage(e.data),a={target:this,data:Array.from(e.data),rawData:e.data,timestamp:e.timeStamp};t===d.MIDI_CHANNEL_VOICE_MESSAGES.noteoff||t===d.MIDI_CHANNEL_VOICE_MESSAGES.noteon&&0===r?(a.type="noteoff",a.note=new u(n,{rawRelease:r}),a.release=a.note.release,a.rawRelease=a.note.rawRelease):t===d.MIDI_CHANNEL_VOICE_MESSAGES.noteon?(a.type="noteon",a.note=new u(n,{rawAttack:r}),a.attack=a.note.attack,a.rawAttack=a.note.rawAttack):t===d.MIDI_CHANNEL_VOICE_MESSAGES.keyaftertouch?(a.type="keyaftertouch",a.note=new u(n),a.value=r/127,a.rawValue=r):t===d.MIDI_CHANNEL_VOICE_MESSAGES.controlchange&&n>=0&&n<=119?(a.type="controlchange",a.controller={number:n,name:this.getCcNameByNumber(n)},a.value=r/127,a.rawValue=r):t===d.MIDI_CHANNEL_VOICE_MESSAGES.channelmode&&n>=120&&n<=127?(a.type="channelmode",a.controller={number:n,name:this.getChannelModeByNumber(n)},a.value=r,this._parseChannelModeMessage(e)):t===d.MIDI_CHANNEL_VOICE_MESSAGES.programchange?(a.type="programchange",a.value=n+1,a.rawValue=n):t===d.MIDI_CHANNEL_VOICE_MESSAGES.channelaftertouch?(a.type="channelaftertouch",a.value=n/127,a.rawValue=n):t===d.MIDI_CHANNEL_VOICE_MESSAGES.pitchbend?(a.type="pitchbend",a.value=((r<<7)+n-8192)/8192,a.rawValue=(r<<7)+n):a.type="unknownmessage",this.emit(a.type,a)}getChannelModeByNumber(e){if(d.validation&&(e=Math.floor(e)),!(e>=120&&e<=127))return!1;for(let t in d.MIDI_CHANNEL_MODE_MESSAGES)if(d.MIDI_CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===d.MIDI_CHANNEL_MODE_MESSAGES[t])return t;return!1}_parseChannelModeMessage(e){let t,n;e.data.length>1&&(t=e.data[1],n=e.data.length>2?e.data[2]:void 0);let r={target:this,data:Array.from(e.data),rawData:e.data,timestamp:e.timeStamp,type:this.getChannelModeByNumber(t)};"localcontrol"===r.type&&(r.value=127===n),"omnimodeon"===r.type?(r.type="omnimode",r.value=!0):"omnimodeoff"===r.type&&(r.type="omnimode",r.value=!1),"monomodeon"===r.type?(r.type="monomode",r.value=!0):"polymodeon"===r.type&&(r.type="monomode",r.value=!1),this.emit(r.type,r)}getCcNameByNumber(e){if(d.validation&&!((e=parseInt(e))>=0&&e<=119))throw new RangeError("Invalid control change number.");for(let t in d.MIDI_CONTROL_CHANGE_MESSAGES)if(d.MIDI_CONTROL_CHANGE_MESSAGES.hasOwnProperty(t)&&e===d.MIDI_CONTROL_CHANGE_MESSAGES[t])return t;return!1}}class s extends a{constructor(e){super(),this._midiInput=e,this.channels=[];for(let e=1;e<=16;e++)this.channels[e]=new i(this,e);this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null,await this.close(),this._midiInput=null}_onStateChange(e){let t={timestamp:d.time,target:this};"open"===e.port.connection?(t.type="opened",this.emit("opened",t)):"closed"===e.port.connection&&"connected"===e.port.state?(t.type="closed",this.emit("closed",t)):"closed"===e.port.connection&&"disconnected"===e.port.state?(t.type="disconnected",t.target={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):"pending"===e.port.connection&&"disconnected"===e.port.state||console.warn("This statechange event was not caught: ",e.port.connection,e.port.state)}_onMidiMessage(e){let t=null;e.data[0]!==d.MIDI_SYSTEM_MESSAGES.sysex&&(t=e.data.slice(1));let n={target:this,data:Array.from(e.data),rawData:e.data,statusByte:e.data[0],dataBytes:t,timestamp:e.timeStamp,type:"midimessage"};if(this.emit("midimessage",n),e.data[0]<240){let t=1+(15&e.data[0]);this.channels[t]._parseEvent(e)}else e.data[0]<=255&&this._parseEvent(e)}_parseEvent(e){let t=e.data[0];var n={target:this,data:Array.from(e.data),rawData:e.data,timestamp:e.timeStamp};t===d.MIDI_SYSTEM_MESSAGES.sysex?n.type="sysex":t===d.MIDI_SYSTEM_MESSAGES.timecode?n.type="timecode":t===d.MIDI_SYSTEM_MESSAGES.songposition?n.type="songposition":t===d.MIDI_SYSTEM_MESSAGES.songselect?(n.type="songselect",n.song=e.data[1]+1):t===d.MIDI_SYSTEM_MESSAGES.tunerequest?n.type="tunerequest":t===d.MIDI_SYSTEM_MESSAGES.clock?n.type="clock":t===d.MIDI_SYSTEM_MESSAGES.start?n.type="start":t===d.MIDI_SYSTEM_MESSAGES.continue?n.type="continue":t===d.MIDI_SYSTEM_MESSAGES.stop?n.type="stop":t===d.MIDI_SYSTEM_MESSAGES.activesensing?n.type="activesensing":t===d.MIDI_SYSTEM_MESSAGES.reset?n.type="reset":n.type="unknownmidimessage",this.emit(n.type,n)}async open(){try{return await this._midiInput.open(),Promise.resolve(this)}catch(e){return Promise.reject(e)}}async close(){return this._midiInput?this._midiInput.close():Promise.resolve()}getChannelModeByNumber(){d.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'InputChannel' class.")}addListener(e,t,n){if(d.validation){if("function"==typeof n){let e=null!=t?[].concat(t):void 0;t=n,n={channels:e}}if(void 0!==d.MIDI_CHANNEL_VOICE_MESSAGES[e]&&void 0===n.channels)throw new Error("For channel-specific events, 'options.channels' must be defined.")}let r=[];return void 0===d.MIDI_CHANNEL_VOICE_MESSAGES[e]?r.push(super.addListener(e,t,n)):d.sanitizeChannels(n.channels).forEach(a=>{r.push(this.channels[a].addListener(e,t,n))}),r}addOneTimeListener(e,t,n={}){return n.remaining=1,this.addListener(e,t,n)}on(e,t,n,r){return this.addListener(e,t,n,r)}hasListener(e,t,n={}){if(d.validation){if("function"==typeof n){let e=[].concat(t);t=n,n={channels:e}}if(void 0!==d.MIDI_CHANNEL_VOICE_MESSAGES[e]&&void 0===n.channels)throw new Error("For channel-specific events, 'options.channels' must be defined.")}return void 0!==d.MIDI_CHANNEL_VOICE_MESSAGES[e]?d.sanitizeChannels(n.channels).every(n=>this.channels[n].hasListener(e,t)):super.hasListener(e,t)}removeListener(e,t,n={}){if(d.validation&&"function"==typeof n){let e=[].concat(t);t=n,n={channels:e}}if(void 0===n.channels&&(n.channels=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),null==e)return d.sanitizeChannels(n.channels).forEach(e=>this.channels[e].removeListener()),super.removeListener();void 0!==d.MIDI_CHANNEL_VOICE_MESSAGES[e]?d.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].removeListener(e,t,n)}):super.removeListener(e,t,n)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return d.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}class c extends a{constructor(e,t){super(),this.output=e,this.number=t}destroy(){this.output=null,this.number=null,this.removeListener()}send(e,t=[],n={}){return this.output.send(e,t,n),this}setKeyAftertouch(e,t,n={}){if(d.validation){if(n.useRawValue&&(n.rawValue=n.useRawValue),isNaN(parseFloat(t)))throw new RangeError("Invalid key aftertouch value.");if(n.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}return n.rawValue||(t=Math.round(127*t)),d.getValidNoteArray(e,n).forEach(e=>{this.send((d.MIDI_CHANNEL_VOICE_MESSAGES.keyaftertouch<<4)+(this.number-1),[e.number,t],d.convertToTimestamp(n.time))}),this}sendControlChange(e,t,n={}){if("string"==typeof e&&(e=d.MIDI_CONTROL_CHANGE_MESSAGES[e]),d.validation){if(void 0===e)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 119.");if(!Number.isInteger(e)||!(e>=0&&e<=119))throw new TypeError("Control change number must be an integer between 0 and 119.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new TypeError("Control change value must be an integer between 0 and 127")}return this.send((d.MIDI_CHANNEL_VOICE_MESSAGES.controlchange<<4)+(this.number-1),[e,t],d.convertToTimestamp(n.time)),this}_selectNonRegisteredParameter(e,t={}){return this.sendControlChange(99,e[0],t),this.sendControlChange(98,e[1],t),this}_deselectRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_deselectNonRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_selectRegisteredParameter(e,t={}){return this.sendControlChange(101,e[0],t),this.sendControlChange(100,e[1],t),this}_setCurrentParameter(e,t={}){return e=[].concat(e),this.sendControlChange(6,e[0],t),e.length<2||this.sendControlChange(38,e[1],t),this}decrementRegisteredParameter(e,t={}){if(Array.isArray(e)||(e=d.MIDI_REGISTERED_PARAMETER[e]),d.validation){if(void 0===e)throw new TypeError("The specified registered parameter is invalid.");let t=!1;if(Object.getOwnPropertyNames(d.MIDI_REGISTERED_PARAMETER).forEach(n=>{d.MIDI_REGISTERED_PARAMETER[n][0]===e[0]&&d.MIDI_REGISTERED_PARAMETER[n][1]===e[1]&&(t=!0)}),!t)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(97,0,t),this._deselectRegisteredParameter(t),this}incrementRegisteredParameter(e,t={}){if(Array.isArray(e)||(e=d.MIDI_REGISTERED_PARAMETER[e]),d.validation){if(void 0===e)throw new TypeError("The specified registered parameter is invalid.");let t=!1;if(Object.getOwnPropertyNames(d.MIDI_REGISTERED_PARAMETER).forEach(n=>{d.MIDI_REGISTERED_PARAMETER[n][0]===e[0]&&d.MIDI_REGISTERED_PARAMETER[n][1]===e[1]&&(t=!0)}),!t)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(96,0,t),this._deselectRegisteredParameter(t),this}playNote(e,t={}){if(this.sendNoteOn(e,t),t.duration>0&&isFinite(String(t.duration).trim()||NaN)){let n={time:(d.convertToTimestamp(t.time)||d.time)+t.duration,release:t.release,rawRelease:t.rawRelease};this.sendNoteOff(e,n)}return this}sendNoteOff(e,t={}){if(d.validation){if(null!=t.rawRelease&&!(t.rawRelease>=0&&t.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(null!=t.release&&!(t.release>=0&&t.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");t.rawVelocity&&(t.rawRelease=t.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),t.velocity&&(t.release=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let n=64;null!=t.rawRelease?n=t.rawRelease:isNaN(t.release)||(n=Math.round(127*t.release));let r={rawRelease:parseInt(n)};return d.getValidNoteArray(e,r).forEach(e=>{this.send((d.MIDI_CHANNEL_VOICE_MESSAGES.noteoff<<4)+(this.number-1),[e.number,e.rawRelease],d.convertToTimestamp(t.time))}),this}stopNote(e,t={}){return this.sendNoteOff(e,t)}sendNoteOn(e,t={}){if(d.validation){if(null!=t.rawAttack&&!(t.rawAttack>=0&&t.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(null!=t.attack&&!(t.attack>=0&&t.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");t.rawVelocity&&(t.rawAttack=t.velocity,t.rawRelease=t.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),t.velocity&&(t.attack=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let n=64;null!=t.rawAttack?n=t.rawAttack:isNaN(t.attack)||(n=Math.round(127*t.attack));let r={rawAttack:n};return d.getValidNoteArray(e,r).forEach(e=>{this.send((d.MIDI_CHANNEL_VOICE_MESSAGES.noteon<<4)+(this.number-1),[e.number,e.rawAttack],d.convertToTimestamp(t.time))}),this}sendChannelMode(e,t,n={}){if("string"==typeof e&&(e=d.MIDI_CHANNEL_MODE_MESSAGES[e]),d.validation){if(void 0===e)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(e)||!(e>=120&&e<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(t))||t<0||t>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send((d.MIDI_CHANNEL_VOICE_MESSAGES.channelmode<<4)+(this.number-1),[e,t],d.convertToTimestamp(n.time)),this}setOmniMode(e,t={}){return void 0===e||e?this.sendChannelMode("omnimodeon",0,t):this.sendChannelMode("omnimodeoff",0,t),this}setChannelAftertouch(e,t={}){if(d.validation){if(isNaN(parseFloat(e)))throw new RangeError("Invalid channel aftertouch value.");if(t.rawValue){if(!(e>=0&&e<=127&&Number.isInteger(e)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(e>=0&&e<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return this.send((d.MIDI_CHANNEL_VOICE_MESSAGES.channelaftertouch<<4)+(this.number-1),[Math.round(127*e)],d.convertToTimestamp(t.time)),this}setMasterTuning(e,t={}){if(e=parseFloat(e)||0,d.validation&&!(e>-65&&e<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let n=Math.floor(e)+64,r=e-Math.floor(e);r=Math.round((r+1)/2*16383);let a=r>>7&127,o=127&r;return this.setRegisteredParameter("channelcoarsetuning",n,t),this.setRegisteredParameter("channelfinetuning",[a,o],t),this}setModulationRange(e,t,n={}){if(d.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!(null==t||Number.isInteger(t)&&t>=0&&t<=127))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return t>=0&&t<=127||(t=0),this.setRegisteredParameter("modulationrange",[e,t],n),this}setNonRegisteredParameter(e,t,n={}){if(t=[].concat(t),d.validation){if(!Array.isArray(e)||!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");t.forEach(e=>{if(!(e>=0&&e<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(e,n),this._setCurrentParameter(t,n),this._deselectNonRegisteredParameter(n),this}setPitchBend(e,t={}){if(d.validation)if(t.rawValue&&Array.isArray(e)){if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(t.rawValue&&!Array.isArray(e)){if(!(e>=0&&e<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(e)||null===e)throw new RangeError("Invalid pitch bend value.");if(!(e>=-1&&e<=1))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}let n=0,r=0;if(t.rawValue&&Array.isArray(e))n=e[0],r=e[1];else if(t.rawValue&&!Array.isArray(e))n=e;else{let t=Math.round((e+1)/2*16383);n=t>>7&127,r=127&t}return this.send((d.MIDI_CHANNEL_VOICE_MESSAGES.pitchbend<<4)+(this.number-1),[r,n],d.convertToTimestamp(t.time)),this}setPitchBendRange(e,t,n={}){if(d.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.setRegisteredParameter("pitchbendrange",[e,t],n),this}setProgram(e,t={}){if(e=parseInt(e)||1,d.validation&&!(e>=1&&e<=128))throw new RangeError("The program number must be between 1 and 128.");return this.send((d.MIDI_CHANNEL_VOICE_MESSAGES.programchange<<4)+(this.number-1),[e-1],d.convertToTimestamp(t.time)),this}setRegisteredParameter(e,t,n={}){if(Array.isArray(e)||(e=d.MIDI_REGISTERED_PARAMETER[e]),d.validation){if(!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(t).forEach(e=>{if(!(e>=0&&e<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(e,n),this._setCurrentParameter(t,n),this._deselectRegisteredParameter(n),this}setTuningBank(e,t={}){if(d.validation&&(!Number.isInteger(e)||!(e>=1&&e<=128)))throw new RangeError("The tuning bank number must be between 1 and 128.");return this.setRegisteredParameter("tuningbank",e-1,t),this}setTuningProgram(e,t={}){if(d.validation&&(!Number.isInteger(e)||!(e>=1&&e<=128)))throw new RangeError("The tuning program number must be between 1 and 128.");return this.setRegisteredParameter("tuningprogram",e-1,t),this}setLocalControl(e,t={}){return e?this.sendChannelMode("localcontrol",127,t):this.sendChannelMode("localcontrol",0,t)}turnNotesOff(e={}){return this.sendChannelMode("allnotesoff",0,e)}turnSoundOff(e={}){return this.sendChannelMode("allsoundoff",0,e)}resetAllControllers(e={}){return this.sendChannelMode("resetallcontrollers",0,e)}setPolyphonicMode(e,t={}){return"mono"===e?this.sendChannelMode("monomodeon",0,t):this.sendChannelMode("polymodeon",0,t)}}class l extends a{constructor(e){if(super(),d.validation&&(!e||"output"!==e.type))throw new TypeError("The supplied MIDIOutput is invalid.");this._midiOutput=e,this.channels=[];for(let e=1;e<=16;e++)this.channels[e]=new c(this,e);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._midiOutput.onstatechange=null,await this.close(),this._midiOutput=null}_onStateChange(e){let t={timestamp:d.time};"open"===e.port.connection?(t.type="opened",t.target=this,this.emit("opened",t)):"closed"===e.port.connection&&"connected"===e.port.state?(t.type="closed",t.target=this,this.emit("closed",t)):"closed"===e.port.connection&&"disconnected"===e.port.state?(t.type="disconnected",t.target={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):"pending"===e.port.connection&&"disconnected"===e.port.state||console.warn("This statechange event was not caught:",e.port.connection,e.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(e){return Promise.reject(e)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(e,t={},n={}){if(d.validation){if(!Array.isArray(e)&&parseInt(e)>=128&&parseInt(e)<=255&&(e=[e],Array.isArray(t)&&(e=e.concat(t)),t="number"==typeof n?{time:n}:n),!(parseInt(e[0])>=128&&parseInt(e[0])<=255))throw new TypeError("The first byte (status) must be an integer between 128 and 255.");e.slice(1).forEach(e=>{if(e=parseInt(e),!(parseInt(e)>=0&&parseInt(e)<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")})}return this._midiOutput.send(e,d.convertToTimestamp(t.time)),this}sendSysex(e,t,n={}){return t=(e=[].concat(e)).concat(t,d.MIDI_SYSTEM_MESSAGES.sysexend),this.send(d.MIDI_SYSTEM_MESSAGES.sysex,t,{time:n.time}),this}clear(){return this._midiOutput.clear?this._midiOutput.clear():d.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(e,t={}){if(d.validation&&(e=parseInt(e),isNaN(e)||!(e>=0&&e<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send(d.MIDI_SYSTEM_MESSAGES.timecode,[e],{time:t.time}),this}setSongPosition(e,t={}){var n=(e=Math.floor(e)||0)>>7&127,r=127&e;return this.send(d.MIDI_SYSTEM_MESSAGES.songposition,[n,r],{time:t.time}),this}sendSongPosition(e,t={}){return d.validation&&console.warn("The sendSongPosition() method has been deprecated. Use setSongPosition() instead."),this.setSongPosition(e,t)}setSong(e,t={}){if(d.validation&&(e=parseInt(e),isNaN(e)||!(e>=1&&e<=128)))throw new RangeError("The program value must be between 1 and 128");return this.send(d.MIDI_SYSTEM_MESSAGES.songselect,[e],{time:t.time}),this}sendSongSelect(e,t={}){return d.validation&&console.warn("The sendSongSelect() method has been deprecated. Use setSong() instead."),this.setSong(e,t)}sendTuneRequest(e={}){return this.send(d.MIDI_SYSTEM_MESSAGES.tunerequest,void 0,{time:e.time}),this}sendClock(e={}){return this.send(d.MIDI_SYSTEM_MESSAGES.clock,void 0,{time:e.time}),this}sendStart(e={}){return this.send(d.MIDI_SYSTEM_MESSAGES.start,void 0,{time:e.time}),this}sendContinue(e={}){return this.send(d.MIDI_SYSTEM_MESSAGES.continue,void 0,{time:e.time}),this}sendStop(e={}){return this.send(d.MIDI_SYSTEM_MESSAGES.stop,void 0,{time:e.time}),this}sendActiveSensing(e={}){return this.send(d.MIDI_SYSTEM_MESSAGES.activesensing,[],{time:e.time}),this}sendReset(e={}){return this.send(d.MIDI_SYSTEM_MESSAGES.reset,void 0,{time:e.time}),this}sendTuningRequest(e={}){return d.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(e)}setKeyAftertouch(e,t,n={},r={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;t=n,(n=r).channels=e}return null==n.channels&&(n.channels="all"),d.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].setKeyAftertouch(e,t,n)}),this}sendKeyAftertouch(e,t,n,r={}){return d.validation&&console.warn("The sendKeyAftertouch() method has been deprecated. Use setKeyAftertouch() instead."),r.channels=t,this.setKeyAftertouch(e,n,r)}sendControlChange(e,t,n={},r={}){if(d.validation&&(Array.isArray(n)||Number.isInteger(n)||"all"===n)){let e=n;(n=r).channels=e}return null==n.channels&&(n.channels="all"),d.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendControlChange(e,t,n)}),this}setPitchBendRange(e,t,n={},r={}){if(d.validation&&(Array.isArray(n)||Number.isInteger(n)||"all"===n)){let e=n;(n=r).channels=e}return null==n.channels&&(n.channels="all"),d.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].setPitchBendRange(e,t,n)}),this}setRegisteredParameter(e,t,n={},r={}){if(d.validation&&(Array.isArray(n)||Number.isInteger(n)||"all"===n)){let e=n;(n=r).channels=e}return null==n.channels&&(n.channels="all"),d.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].setRegisteredParameter(e,t,n)}),this}setChannelAftertouch(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].setChannelAftertouch(e,t)}),this}sendChannelAftertouch(e,t,n={}){return d.validation&&console.warn("The sendChannelAftertouch() method has been deprecated. Use setChannelAftertouch()."),n.channels=t,this.setChannelAftertouch(e,n)}setPitchBend(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].setPitchBend(e,t)}),this}sendPitchBend(e,t,n={}){return d.validation&&console.warn("The sendPitchBend() method has been deprecated. Use setPitchBend() instead."),n.channels=t,this.setPitchBend(e,n)}setProgram(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].setProgram(e,t)}),this}sendProgramChange(e,t,n={}){return d.validation&&console.warn("The sendProgramChange() method has been deprecated. Use setProgram() instead."),n.channels=t,this.setProgram(e,n)}setModulationRange(e,t,n={},r={}){if(d.validation&&(Array.isArray(n)||Number.isInteger(n)||"all"===n)){let e=n;(n=r).channels=e}return null==n.channels&&(n.channels="all"),d.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].setModulationRange(e,t,n)}),this}setMasterTuning(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].setMasterTuning(e,t)}),this}setTuningProgram(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].setTuningProgram(e,t)}),this}setTuningBank(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].setTuningBank(e,t)}),this}sendChannelMode(e,t,n={},r={}){if(d.validation&&(Array.isArray(n)||Number.isInteger(n)||"all"===n)){let e=n;(n=r).channels=e}return null==n.channels&&(n.channels="all"),d.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendChannelMode(e,t,n)}),this}turnSoundOff(e={},t={}){if(d.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){let n=e;(e=t).channels=n}return null==e.channels&&(e.channels="all"),d.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].turnSoundOff(e)}),this}turnNotesOff(e={},t={}){if(d.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){let n=e;(e=t).channels=n}return null==e.channels&&(e.channels="all"),d.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].turnNotesOff(e)}),this}resetAllControllers(e={},t={}){if(d.validation&&(Array.isArray(e)||Number.isInteger(e)||"all"===e)){let n=e;(e=t).channels=n}return null==e.channels&&(e.channels="all"),d.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].resetAllControllers(e)}),this}setPolyphonicMode(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].setPolyphonicMode(e,t)}),this}setLocalControl(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].setLocalControl(e,t)}),this}setOmniMode(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].setOmniMode(e,t)}),this}setNonRegisteredParameter(e,t,n={},r={}){if(d.validation&&(Array.isArray(n)||Number.isInteger(n)||"all"===n)){let e=n;(n=r).channels=e}return null==n.channels&&(n.channels="all"),d.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].setNonRegisteredParameter(e,t,n)}),this}incrementRegisteredParameter(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].incrementRegisteredParameter(e,t)}),this}decrementRegisteredParameter(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].decrementRegisteredParameter(e,t)}),this}sendNoteOff(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendNoteOff(e,t)}),this}stopNote(e,t){return this.sendNoteOff(e,t)}playNote(e,t={},n={}){if(d.validation&&(t.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),t.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].playNote(e,t)}),this}sendNoteOn(e,t={},n={}){if(d.validation&&(Array.isArray(t)||Number.isInteger(t)||"all"===t)){let e=t;(t=n).channels=e}return null==t.channels&&(t.channels="all"),d.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendNoteOn(e,t)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}}class u{constructor(e,t={}){Number.isInteger(e)?this.number=e:this.name=e,this.duration=null==t.duration?1/0:t.duration,this.attack=null==t.attack?.5:t.attack,this.release=null==t.release?.5:t.release,null!=t.rawAttack&&(this.rawAttack=t.rawAttack),null!=t.rawRelease&&(this.rawRelease=t.rawRelease)}get name(){return d.NOTES[this._number%12]+d.getOctave(this.number)}set name(e){if(d.validation&&!1===d.guessNoteNumber(e))throw new Error("Invalid note name.");this._number=d.guessNoteNumber(e)}get number(){return this._number}set number(e){if(d.validation&&!1===d.guessNoteNumber(e))throw new Error("Invalid note number.");this._number=d.guessNoteNumber(e)}get duration(){return this._duration}set duration(e){if(d.validation&&(e=parseFloat(e),isNaN(e)||null===e||e<0))throw new RangeError("Invalid duration.");this._duration=e}get attack(){return this._rawAttack/127}set attack(e){if(d.validation&&(e=parseFloat(e),isNaN(e)||null===e||!(e>=0&&e<=1)))throw new RangeError("Invalid attack value.");this._rawAttack=Math.round(127*e)}get rawAttack(){return this._rawAttack}set rawAttack(e){if(d.validation&&(e=parseFloat(e),isNaN(e)||null===e||!(e>=0&&e<=127)))throw new RangeError("Invalid rawAttack value.");this._rawAttack=e}get release(){return this._rawRelease/127}set release(e){if(d.validation&&(e=parseFloat(e),isNaN(e)||null===e||!(e>=0&&e<=1)))throw new RangeError("Invalid release value.");this._rawRelease=Math.round(127*e)}get rawRelease(){return this._rawRelease}set rawRelease(e){if(d.validation&&(e=parseFloat(e),isNaN(e)||null===e||!(e>=0&&e<=127)))throw new RangeError("Invalid rawRelease value.");this._rawRelease=e}get octave(){return Math.floor(Math.floor(this._number)/12-1)}}n.Note=u;const d=new class extends a{constructor(){super(),this.interface=null,this.validation=!0,this._inputs=[],this._outputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(e={},t=!1){if(this.enabled)return Promise.resolve();this.validation=!1!==e.validation,this.validation&&("function"==typeof e&&(e={callback:e,sysex:t}),t&&(e.sysex=!0));try{this.interface=await navigator.requestMIDIAccess({sysex:e.sysex,software:e.software})}catch(t){return"function"==typeof e.callback&&e.callback(t),Promise.reject(t)}let n={timestamp:this.time,target:this,type:"enabled"};this.emit("enabled",n),"function"==typeof e.callback&&e.callback(),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{let e=await this._updateInputsAndOutputs();return Promise.resolve({inputs:e[0],outputs:e[1]})}catch(e){return Promise.reject(e)}}async disable(){return this._destroyInputsAndOutputs().then(()=>{"function"==typeof navigator.close&&navigator.close(),this.interface&&(this.interface.onstatechange=void 0),this.interface=null;let e={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",e),this.removeListener()})}getInputById(e){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return!1}for(let t=0;t<this.inputs.length;t++)if(this.inputs[t].id===e.toString())return this.inputs[t];return!1}getInputByName(e){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return!1;e=e.toString()}for(let t=0;t<this.inputs.length;t++)if(~this.inputs[t].name.indexOf(e))return this.inputs[t];return!1}getOutputByName(e){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return!1;e=e.toString()}for(let t=0;t<this.outputs.length;t++)if(~this.outputs[t].name.indexOf(e))return this.outputs[t];return!1}getOutputById(e){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return!1}for(let t=0;t<this.outputs.length;t++)if(this.outputs[t].id===e.toString())return this.outputs[t];return!1}getNoteNumberByName(e){this.validation&&"string"!=typeof e&&(e="");let t=e.match(/([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)/i);if(!t)return!1;let n={C:0,D:2,E:4,F:5,G:7,A:9,B:11}[t[1].toUpperCase()],r=12*(parseInt(t[3])+1-Math.floor(this.octaveOffset))+n;return t[2].toLowerCase().indexOf("b")>-1?r-=t[2].length:t[2].toLowerCase().indexOf("#")>-1&&(r+=t[2].length),!(r<0||r>127)&&r}noteNameToNumber(e){return console.warn("The noteNameToNumber() method has been deprecated. Use getNoteNumberByName() instead."),this.getNoteNumberByName(e)}getOctave(e){return this.validation&&(e=parseInt(e)),!isNaN(e)&&e>=0&&e<=127&&Math.floor(e/12-1)+this.octaveOffset}sanitizeChannels(e){let t;if(this.validation)if("all"===e)t=["all"];else if("none"===e)return[];return t=Array.isArray(e)?e:[e],t.indexOf("all")>-1&&(t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),t.map((function(e){return parseInt(e)})).filter((function(e){return e>=1&&e<=16}))}toMIDIChannels(e){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use sanitizeChannels() instead."),this.sanitizeChannels(e)}guessNoteNumber(e){let t=!1;return Number.isInteger(e)&&e>=0&&e<=127||parseInt(e)>=0&&parseInt(e)<=127?t=parseInt(e):("string"==typeof e||e instanceof String)&&(t=this.getNoteNumberByName(e)),!1!==t&&t}getValidNoteArray(e,t={}){let n=[];return Array.isArray(e)||(e=[e]),e.forEach(e=>{n.push(this.getNoteObject(e,t))}),n}getNoteObject(e,t){if(e instanceof u)return e;{let n=this.guessNoteNumber(e);if(!1!==n)return new u(n,t);throw new TypeError(`The input could not be parsed as a note (${e})`)}}convertToTimestamp(e){let t=!1,n=parseFloat(e);return!isNaN(n)&&("string"==typeof e&&"+"===e.substring(0,1)?n>=0&&(t=this.time+n):n>=0&&(t=n),t)}async _destroyInputsAndOutputs(){let e=[];return this.inputs.forEach(t=>e.push(t.destroy())),this.outputs.forEach(t=>e.push(t.destroy())),Promise.all(e).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(e){this._updateInputsAndOutputs();let t={timestamp:e.timeStamp,type:e.port.state};this.interface&&"connected"===e.port.state?"output"===e.port.type?(t.port=this.getOutputById(e.port.id),t.target=t.port):"input"===e.port.type&&(t.port=this.getInputById(e.port.id),t.target=t.port):(t.port={connection:"closed",id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},t.target=t.port),this.emit(e.port.state,t)}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){let e=[];for(let e=0;e<this._inputs.length;e++){let t=!0,n=this.interface.inputs.values();for(let r=n.next();r&&!r.done;r=n.next())if(this._inputs[e]._midiInput===r.value){t=!1;break}t&&this._inputs.splice(e,1)}return this.interface&&this.interface.inputs.forEach(t=>{let n=!0;for(let e=0;e<this._inputs.length;e++)this._inputs[e]._midiInput===t&&(n=!1);if(n){let n=new s(t);this._inputs.push(n),e.push(n.open())}}),Promise.all(e)}async _updateOutputs(){let e=[];for(let e=0;e<this._outputs.length;e++){let t=!0,n=this.interface.outputs.values();for(let r=n.next();r&&!r.done;r=n.next())if(this._outputs[e]._midiOutput===r.value){t=!1;break}t&&(this._outputs[e].close(),this._outputs.splice(e,1))}return this.interface&&this.interface.outputs.forEach(t=>{let n=!0;for(let e=0;e<this._outputs.length;e++)this._outputs[e]._midiOutput===t&&(n=!1);if(n){let n=new l(t);this._outputs.push(n),e.push(n.open())}}),Promise.all(e)}get enabled(){return null!==this.interface}get inputs(){return this._inputs}get isNode(){return"[object process]"===Object.prototype.toString.call(void 0!==r?r:0)}get isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be a valid number.");this._octaveOffset=e}get outputs(){return this._outputs}get supported(){return"undefined"!=typeof navigator&&navigator.requestMIDIAccess}get sysexEnabled(){return!(!this.interface||!this.interface.sysexEnabled)}get time(){return performance.now()}get MIDI_CHANNEL_VOICE_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,channelmode:11,nrpn:11,programchange:12,channelaftertouch:13,pitchbend:14}}get MIDI_CHANNEL_MESSAGES(){return console.warn("MIDI_CHANNEL_MESSAGES has been deprecated. Use MIDI_CHANNEL_VOICE_MESSAGES instead."),this.MIDI_CHANNEL_VOICE_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}get MIDI_CONTROL_CHANGE_MESSAGES(){return{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101}}get MIDI_INTERFACE_EVENTS(){return["connected","disconnected"]}get MIDI_NRPN_MESSAGES(){return{entrymsb:6,entrylsb:38,increment:96,decrement:97,paramlsb:98,parammsb:99,nullactiveparameter:127}}get MIDI_REGISTERED_PARAMETER(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}get MIDI_SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}get NOTES(){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}};n.WebMidi=d,d.constructor=null},{process:"4de4a03e94e27ceb4ecf8a26d457f9e0"}],"4de4a03e94e27ceb4ecf8a26d457f9e0":[function(e,t,n){var r,a,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{a="function"==typeof clearTimeout?clearTimeout:s}catch(e){a=s}}();var l,u=[],d=!1,h=-1;function f(){d&&l&&(d=!1,l.length?u=l.concat(u):h=-1,u.length&&p())}function p(){if(!d){var e=c(f);d=!0;for(var t=u.length;t;){for(l=u,u=[];++h<t;)l&&l[h].run();h=-1,t=u.length}l=null,d=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===s||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||d||c(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],"0899cc6a6b0eda25734a56aad670415f":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.tapTempo=n.stopTimer=n.startTimer=n.setTimeBetween=n.setBPM=n.now=n.setBars=n.getBars=n.getBPM=n.getBarProgress=n.getBar=n.timePerBar=n.MAX_BARS_ALLOWED=n.EVENT_TICK=n.EVENT_STOPPING=n.EVENT_STARTING=n.EVENT_READY=n.CMD_UPDATE=n.CMD_STOP=n.CMD_START=void 0;n.CMD_START="start";n.CMD_STOP="stop";n.CMD_UPDATE="update";n.EVENT_READY="ready";n.EVENT_STARTING="starting";n.EVENT_STOPPING="stopping";n.EVENT_TICK="tick";n.MAX_BARS_ALLOWED=32;const r=window.AudioContext||window.webkitAudioContext,a=new Worker(e("./timing.settimeout.worker.js"));let o=-1,i=1,s=null,c=!1,l=0,u=16,d=0;const h=()=>2403/u;n.timePerBar=h;n.getBar=()=>l;n.getBarProgress=()=>l/u;n.getBPM=()=>6e4/h();n.getBars=()=>u;n.setBars=e=>(u=e<1?1:e>32?32:e,u);const f=()=>s.currentTime;n.now=f;n.setBPM=e=>(i=6e4/e,a.postMessage({command:"update",interval:i,time:f()}),i);n.setTimeBetween=e=>(i=e,a.postMessage({command:"update",interval:i,time:f()}),i);n.startTimer=(e,t=200,n={})=>(d=0,null===s&&(s=new r,"suspended"===s.state&&s.resume()),i=t,a.onmessage=n=>{const r=f(),a=n.data;switch(a.event){case"starting":a.time;o=r,c=!0;break;case"tick":const i=a.intervals,s=i*t*.001,h=r-o,f=a.time,p=f%t*.001,m=f-h,g=Math.floor(f/t);l=++d%u,e&&e({bar:l,bars:u,barsElapsed:d,timePassed:f,elapsed:h,expected:s,drift:m,level:g,intervals:i,lag:p});break;default:console.log("message: ",n)}},a.onerror=e=>{console.error("error...",{error:e}),a.postMessage({error:e,time:s.currentTime})},a.postMessage({command:"start",time:s.currentTime,interval:t,accurateTiming:!1}),{currentTime:f(),timingWorker:a});n.stopTimer=()=>{const e=f();return a.onmessage=e=>{switch(e.event){case"stopping":c=!1,s=null}},a.postMessage({command:"stop",time:e}),{currentTime:f(),timingWorker:a}};let p=[];n.tapTempo=(e=!0,t=1e4)=>{const n=Date.now();e&&p.length>0&&n-p[p.length-1]>t&&(p=[]),p.push(n);const r=p.length,a=r-1,o=p[a]-p[0];if(r>=2){return o/a}return-1}},{"./timing.settimeout.worker.js":"6688115806623b3855973d763d7df2f9"}],"6688115806623b3855973d763d7df2f9":[function(e,t,n){t.exports=e("./get-worker-url")(e("./relative-path")("6b4f3191f1147a9a","67e0df2ea507acf8"))},{"./get-worker-url":"46d68abd7799303df617a73becfe0fa7","./relative-path":"3d690079c6611245df705566cbbc1942"}],"46d68abd7799303df617a73becfe0fa7":[function(e,t,n){"use strict";var r=e("./bundle-url");t.exports=function(e){var t=r.getBundleURL()+e;return r.getOrigin(t)===self.location.origin?t:URL.createObjectURL(new Blob(["importScripts("+JSON.stringify(t)+");"]))}},{"./bundle-url":"a079551cb6dc35425204fc0bb93fe7bb"}],a079551cb6dc35425204fc0bb93fe7bb:[function(e,t,n){"use strict";var r=null;function a(e){return(""+e).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}n.getBundleURL=function(){return r||(r=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return a(e[0])}return"/"}()),r},n.getBaseURL=a,n.getOrigin=function(e){let t=(""+e).match(/(https?|file|ftp):\/\/[^/]+/);if(!t)throw new Error("Origin not found");return t[0]}},{}],"3d690079c6611245df705566cbbc1942":[function(e,t,n){"use strict";var r=e("./bundle-manifest").resolve;function a(e){if(""===e)return".";var t="/"===e[e.length-1]?e.slice(0,e.length-1):e,n=t.lastIndexOf("/");return-1===n?".":t.slice(0,n)}function o(e,t){if(e===t)return"";var n=e.split("/");"."===n[0]&&n.shift();var r,a,o=t.split("/");for("."===o[0]&&o.shift(),r=0;(r<o.length||r<n.length)&&null==a;r++)n[r]!==o[r]&&(a=r);var i=[];for(r=0;r<n.length-a;r++)i.push("..");return o.length>a&&i.push.apply(i,o.slice(a)),i.join("/")}t.exports=function(e,t){return o(a(r(e)),r(t))},t.exports._dirname=a,t.exports._relative=o},{"./bundle-manifest":"7bd0744a1d6e904180ae29467f4e3090"}],b0fa31d0ac4fa682c4ae7d502ab9ee9b:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.focusApp=n.setupInterface=n.showPlayerSelector=n.updateTempo=n.setupInstrumentForm=n.setupCameraForm=n.setControls=n.toggleVideoVisiblity=n.isVideoVisible=n.video=n.toggleVisibility=n.controls=n.buttonVideo=n.buttonQuantise=void 0;var r=e("../audio/instruments"),a=e("./full-screen"),o=e("../location-handler"),i=e("../models/info"),s=(e("./button"),e("./toggle")),c=e("./select");const l=document;let u,d,h,f,p;n.buttonQuantise=h,n.buttonVideo=f,n.controls=p;const m=l.querySelector("main");n.toggleVisibility=e=>{const t="hidden"!==e.style.visibility;return e.style.visibility=t?"hidden":"visible",!t};const g=l.querySelector("video");n.video=g;const b=()=>"hidden"===g.style.visibility;n.isVideoVisible=b;n.toggleVideoVisiblity=e=>{const t=b();console.error("toggling video vis",{value:e,currentlyVisible:t}),g.style.visibility=t?"visible":"hidden"};n.setControls=e=>{l.getElementById("person-a-controls").appendChild(e)};n.setupCameraForm=(e,t)=>{const n=l.getElementById("camera").querySelector("#camera select"),r=e.map((e,t)=>`<option value="${e.deviceId}">${e.label}</option>`);n.innerHTML=`<optgroup label="Detected Cameras">${r.join("")}</optgroup>`,(0,c.connectSelect)(n,t)};n.setupInstrumentForm=e=>{const t=r.INSTRUMENT_FOLDERS.map((e,t)=>`<label for="${e}">${r.INSTRUMENT_NAMES[t]}<input id="${e}" name="instrument-selector" type="radio" value="${e}"></input></label>`);return t.unshift("<legend>Select an instrument</legend>"),""+t.join("")};n.updateTempo=e=>{const t=l.getElementById("input-tempo");t&&t.setAttribute("value",e),console.log("Setting tempo",e)};n.showPlayerSelector=e=>new Promise((t,n)=>{const r=l.getElementById("onboard"),a=l.getElementById("player-selector"),o=a.querySelector("#button-solo"),i=a.querySelector("#button-duet"),s=a.querySelector("#button-trio"),c=(l.getElementById("button-start"),a.querySelector("#toggle-advanced-mode"));let u=e.advancedMode||!1,d=e.duet?2:1;c.setAttribute("checked",!u),l.documentElement.classList.toggle("player-selection",!0);const h=e=>{d=e,l.documentElement.classList.remove("solo","duet"),l.documentElement.classList.add(1===d?"solo":"duet")};o.addEventListener("click",e=>h(1)),i.addEventListener("click",e=>h(2)),s.addEventListener("click",e=>h(3)),c.addEventListener("change",e=>{u=!u,m.classList.toggle("beginner",!u)}),r.addEventListener("submit",e=>{var n;return e.preventDefault(),(n=d)<2?(o.classList.toggle("hide",!0),i.classList.toggle("hide",!1),m.classList.add("solo")):(i.classList.toggle("hide",!0),o.classList.toggle("hide",!1),m.classList.add("duet")),a.classList.add("completed"),l.documentElement.classList.toggle("player-selection",!0),setTimeout(()=>{l.documentElement.classList.toggle("advanced",u),l.documentElement.classList.toggle("player-selection",!1),a.classList.remove("completed")},45),t({players:n,advancedMode:u}),!1},!0),m.classList.toggle("beginner",!u),h(d),a.focus()});n.setupInterface=e=>{l.querySelector("h1");const t=l.getElementById("share"),r=(l.getElementById("button-solo"),l.getElementById("button-duet"),l.getElementById("title"),l.querySelector("share-menu"));if(r.url=(0,o.getShareLink)(e),t.addEventListener("mousedown",t=>{r.setAttribute("url",(0,o.getShareLink)(e)),console.error("SHARING",{shareElement:r,url:r.url})},!1),n.controls=p=l.getElementById("controls"),u=l.getElementById("button-instrument"),n.buttonVideo=f=l.getElementById("button-video"),d=l.getElementById("button-record"),n.buttonQuantise=h=l.getElementById("button-quantise"),(0,a.canFullscreen)()){const t=(0,s.setToggle)("button-fullscreen",n=>{e.fullscreen=(0,a.toggleFullScreen)(),t.classList.toggle("fs",e.fullscreen)},!1)}else l.getElementById("button-fullscreen").classList.toggle("hide",!0);const c=l.getElementById("version"),m=c.innerHTML;c.innerHTML=`${m} <span id="release">${i.formattedDate}</span>`,p.addEventListener("submit",e=>{e.preventDefault()},!0)};n.focusApp=()=>{}},{"../audio/instruments":"adb022073b84168965080f9f27da58ab","./full-screen":"36f206dbf9b27e7acbf3cfd0776d6188","../location-handler":"99fcf05ce09eb6c13fde8b1abcb1879b","../models/info":"3f5f67e0be087ccbd5ecffd5a31a4d49","./button":"1320e5768254984e98e2398c62d5c5f7","./toggle":"a6b2e211a95018e31ccdcdf3ef303130","./select":"a81fae2e506d45649dac2138e254fd37"}],"36f206dbf9b27e7acbf3cfd0776d6188":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toggleFullScreen=n.goFullscreen=n.exitFullscreen=n.canFullscreen=void 0;const r=()=>document.fullscreenEnabled||document.mozFullScreenEnabled||document.documentElement.webkitRequestFullScreen;n.canFullscreen=r;const a=()=>{document.exitFullscreen()};n.exitFullscreen=a;const o=e=>{r()&&document.documentElement.requestFullscreen()};n.goFullscreen=o;n.toggleFullScreen=()=>document.fullscreenElement?(document.exitFullscreen&&a(),!1):(o(),!0)},{}],"99fcf05ce09eb6c13fde8b1abcb1879b":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getShareLink=n.addToHistory=n.toQuery=n.refresh=n.getRefererHostname=n.getReferer=n.loadSoloMode=n.loadDuetMode=n.forceSecure=n.getLocationSettings=n.parseType=void 0;const r=e=>{if("string"==typeof e){const t=e.toLowerCase();return"true"===t||"1"===t||"false"!==t&&"0"!==t&&e}return Array.isArray(e)?e.toString():data};n.parseType=e=>"string"==typeof e?isNaN(parseFloat(e))?"true"===e.toLowerCase()||"false"!==e&&(e.indexOf(",")>=0?convertIntegerArrayToBooleans(e.split(",")):e):parseFloat(e):Array.isArray(e)?e.toString():e;n.getLocationSettings=e=>{{const t=Object.assign({},e),n=new URLSearchParams(window.location.search);for(const[e,a]of n)t[e]=r(a);return t}};n.forceSecure=(e=!1)=>{e||"localhost"===location.hostname||"https:"===location.protocol||(location.protocol="https:")};n.loadDuetMode=()=>{new URLSearchParams(window.location.search).duet=!0};n.loadSoloMode=()=>{new URLSearchParams(window.location.search).duet=!1};const a=()=>document.referrer||document.location||"interface.place";n.getReferer=a;n.getRefererHostname=()=>new URL(a()).hostname;n.refresh=e=>{window.location.reload()};const o=e=>new URLSearchParams(e).toString();n.toQuery=o;n.addToHistory=(e,t="")=>{const n=new URL(window.location);for(let t in e){const r=e[t];n.searchParams.set(t,r)}window.history.pushState(e,t,n)};n.getShareLink=e=>window.location+o(e)},{}],"3f5f67e0be087ccbd5ecffd5a31a4d49":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.formattedDate=void 0;var r=e("../version");const a=new Date(r.DATE),o=`${a.getDate()}/${a.getMonth()+1}/${a.getFullYear()} ${a.toLocaleTimeString("en-GB",{hour12:!0,hour:"numeric",minute:"numeric"})}`;n.formattedDate=o},{"../version":"25488683cc04bb43faf629e105172bc8"}],"25488683cc04bb43faf629e105172bc8":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DATE=n.VERSION=void 0;n.VERSION="0.7.0";n.DATE=1624906315389},{}],"1320e5768254984e98e2398c62d5c5f7":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.setupMIDIButton=n.showUpdateButton=n.createInstallButton=n.showReloadButton=n.setButton=void 0;var r=e("./text"),a=e("../version"),o=e("../models/info");n.setButton=(e,t)=>{const n=document.getElementById(e);return!!n&&(n.addEventListener("click",e=>{t&&t({element:n})}),n)};n.showReloadButton=()=>{};n.createInstallButton=e=>{const t=`Click to install ${e.short_name} V-${a.VERSION.replaceAll(".","-")}<br>Date:${o.formattedDate}`,n=document.createElement("button");return n.id="button-install",n.classList.add("install-app"),n.setAttribute("aria-label",t),n.style.setProperty("--logo",`url(${e.icons[0].src})`),n.innerHTML="Install",(0,r.addTooltip)(n),n};n.showUpdateButton=(e,t)=>{const n=doc.createElement("button");n.id="button-update",n.setAttribute("aria-label","Update to new version"),n.classList.add("update-available"),n.innerHTML="Update",n.addEventListener("click",()=>t()),e.appendChild(n)};n.setupMIDIButton=(e,t)=>{let n=!1;return e.addEventListener("mousedown",async e=>(e.preventDefault(),t&&t(),n=!0,!1),{once:!0}),{setText:t=>e.innerHTML=t,setLabel:t=>e.setAttribute("aria-label",t)}}},{"./text":"822f913172339b3ead8fd4d6e71a954e","../version":"25488683cc04bb43faf629e105172bc8","../models/info":"3f5f67e0be087ccbd5ecffd5a31a4d49"}],"822f913172339b3ead8fd4d6e71a954e":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.addToolTips=n.addTooltip=n.setToast=n.setFeedback=n.bindTextElement=void 0;var r=e("../utils");const a=(e,t=700,n=0,a=!1)=>{let o=null,i=-1,s=-1,c=null;const l=(0,r.debounce)(t=>{e.innerHTML=t},t);return e?(r,u=t)=>{a&&(r=r.split(/!|\./i).join("<br>")),c=r,""!==e.innerHTML&&o==r||(clearTimeout(s),o=r,0===u?(clearTimeout(i),e.innerHTML=r):i=l(r),n>0&&(s=(t=>{const r=n*t;return s=setTimeout(()=>{e.innerHTML=""},r),r})(r.length)))}:null};n.bindTextElement=a;const o=a(document.getElementById("feedback"),20);n.setFeedback=o;const i=a(document.getElementById("toast"),20,900,!0);n.setToast=i;const s=e=>e.addEventListener("mouseover",e=>{const t=e.target.getAttribute("aria-label")||e.target.innerHTML;i(t)});n.addTooltip=s;n.addToolTips=(e,t="button, select, input")=>{e.querySelectorAll(t).forEach(e=>s(e))}},{"../utils":"569dc304b7e08c7a087e8d733528b9ee"}],a6b2e211a95018e31ccdcdf3ef303130:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.setToggle=void 0;var r=e("./button");n.setToggle=(e,t,n)=>{const a=(0,r.setButton)(e,()=>{n=!n,"LABEL"===a.parentNode.nodeName&&a.parentNode.classList.toggle("checked",n),t(n)});return n&&(a.setAttribute("checked",n),a.parentNode.classList.toggle("checked",n)),a}},{"./button":"1320e5768254984e98e2398c62d5c5f7"}],a81fae2e506d45649dac2138e254fd37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.connectReverbControls=n.connectTempoControls=n.connectReverbSelector=n.connectPaletteSelector=n.connectSelect=void 0;var r=e("./ui"),a=e("../audio/effects/reverb");const o=async(e,t)=>{const n="string"==typeof e?document.getElementById(e):e;if(!n)throw Error("No element found with that spec");n.addEventListener("change",e=>{const r=n.options[n.selectedIndex||n.options.selectedIndex];return t&&t(r),!0})};n.connectSelect=o;n.connectPaletteSelector=e=>o("select-palette",e);n.connectReverbSelector=e=>o("select-impulse",e);n.connectTempoControls=e=>{o("select-tempo",t=>{const n=parseInt(t.innerHTML);(0,r.updateTempo)(n),e&&e(n)})};n.connectReverbControls=e=>{const t="select-impulse",n=a.DIRS,r=document.getElementById(t);if(r){const e=(e,t)=>e.map(e=>{const t=e=e.trim(),n=e.substring(e.lastIndexOf("/")+1);return`<option value="${t}">${n.substring(0,n.lastIndexOf("."))}</option>`}).join("\n"),t=n.map(async t=>{const n=await(0,a.loadImpulseJSON)(t);return`<optgroup>${t}</optgroup>${e(n,t)}`});Promise.all(t).then(e=>{r.innerHTML=e.join("")})}else console.error("Injecting impulse FAILED to ",{options:r,impulseList:impulseList});o(t,t=>e&&e(t))}},{"./ui":"b0fa31d0ac4fa682c4ae7d502ab9ee9b","../audio/effects/reverb":"f7dee7e6f6f6d14fee6166e1d4ca217f"}],"1e277403826e5d724af5bb5c8f06d220":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.showError=void 0;n.showError=(e,t,n=!1)=>{console.error("Could not load",e),console.warn("Consider:",t)}},{}],a616ce4857bc1da6e5a499fc7a954ad3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getLoadProgress=n.setLoadProgress=void 0;const r=document;let a=0;const o=["Please wait","Loading.","Loading..","Loading...","Almost done!"],i=r.getElementById("progress-bar"),s=r.querySelector("progress");n.setLoadProgress=(e,t)=>{a=e,s.setAttribute("value",parseInt(e)),t&&t.length||(t=o[Math.ceil(e*(o.length-1))]),i.innerHTML!==t&&(i.innerHTML=t)};n.getLoadProgress=()=>a},{}],f65640eac8726b36f8f61e36879841ff:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.appendPhotographElement=n.createPhotographElement=void 0;var r=e("../timing/timing.js"),a=e("../visual/canvas"),o=e("../visual/2d");const i=()=>{const e=Math.ceil(1e7*(0,r.now)()),t="photograph-"+e,n=(0,a.getCanvasDimensions)(),i=new Image;i.src=(0,o.takePhotograph)(),i.alt="Photograph taken "+Date.now().toString(),i.width=n.width,i.height=n.height;const s=document.createElement("a");return s.href=i.src,s.innerHTML="Click to download this photograph",s.id=t,s.download=`snapshot-${e}.png`,s.appendChild(i),s};n.createPhotographElement=i;n.appendPhotographElement=()=>{const e=i();document.getElementById("photographs").appendChild(e),requestAnimationFrame(()=>document.getElementById(e.id).scrollIntoView())}},{"../timing/timing.js":"0899cc6a6b0eda25734a56aad670415f","../visual/canvas":"041a34f0683a41bf466ce78a0fb7cc0c","../visual/2d":"f803e61e201bc53ab013db5ee5dd0610"}],"041a34f0683a41bf466ce78a0fb7cc0c":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drawElement=n.copyCanvasToClipboard=n.overdraw=n.clear=n.getCanvasDimensions=n.updateCanvasSize=n.canvasContext=n.canvas=void 0;const r=document.querySelector("canvas");n.canvas=r;const a=r.getContext("2d");n.canvasContext=a;let o=r.width,i=r.height;n.updateCanvasSize=(e,t)=>{o=null!=e?e:r.width,i=null!=t?t:r.height};n.getCanvasDimensions=()=>({width:o,height:i});n.clear=()=>{a.clearRect(0,0,o,i)};n.overdraw=(e=0,t=-1)=>{a.save(),a.drawImage(r,e,t),a.restore()};n.copyCanvasToClipboard=async()=>r.toBlob(async e=>{await navigator.clipboard.write([new ClipboardItem({[e.type]:e})])});n.drawElement=e=>{a.save(),a.translate(o,0),a.scale(-1,1),a.drawImage(e,0,0),a.restore()}},{}],f803e61e201bc53ab013db5ee5dd0610:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drawFace=n.drawFaceMesh=n.drawPoints=n.setNodeCount=n.drawBoundingBox=n.drawInstrument=n.drawParagraph=n.drawText=n.drawNode=n.drawTriangle=n.drawPart=n.drawShapeByIndexes=n.takePhotograph=void 0;var r=e("../maths/maths"),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,t&&t.set(e,n);return n}(e("../palette")),o=e("./canvas"),i=e("../maths/easing"),s=e("./face");function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}n.takePhotograph=(e="image/png")=>o.canvas.toDataURL(e);n.drawShapeByIndexes=(e,t,n=2,r="red",a=!0,i=!0)=>{o.canvasContext.fillStyle=r,o.canvasContext.strokeStyle=r,o.canvasContext.moveTo(e[t[0]][0],e[t[0]][1]),o.canvasContext.beginPath();for(let n=1,r=t.length;n<r;n++)o.canvasContext.lineTo(e[t[n]][0],e[t[n]][1]);o.canvasContext.closePath(),i&&o.canvasContext.fill(),a&&o.canvasContext.stroke()};n.drawPart=(e,t=2,n="red",i=!0,s=!0,c=!1)=>{o.canvasContext.fillStyle=n,o.canvasContext.strokeStyle=n,o.canvasContext.moveTo(e[0][0],e[0][1]),o.canvasContext.beginPath();for(let n=0,a=e.length;n<a;n++){const a=e[n][0],s=e[n][1];o.canvasContext.arc(a,s,t,0,r.TAU),i&&o.canvasContext.lineTo(a,s)}if(s&&o.canvasContext.fill(),i&&o.canvasContext.stroke(),c)for(let t=0,n=e.length;t<n;t+=2){const n=e[t][0],r=e[t][1];o.canvasContext.stroke(),o.canvasContext.font="18px Oxanium",o.canvasContext.textAlign="center",o.canvasContext.fillStyle=a.default.dark,o.canvasContext.fillText("#"+t,n,r)}};const l=(e,t,n,r,a,i,s,c=1)=>{o.canvasContext.beginPath(),o.canvasContext.lineWidth=c,o.canvasContext.strokeStyle=s,o.canvasContext.moveTo(e,t),o.canvasContext.lineTo(n,r),o.canvasContext.lineTo(a,i),o.canvasContext.closePath(),o.canvasContext.stroke()};n.drawTriangle=l;n.drawNode=(e,t,n=5,i="blue")=>{o.canvasContext.fillStyle=i,o.canvasContext.beginPath(),o.canvasContext.arc(t[0],t[1],n,0,r.TAU),o.canvasContext.fill(),o.canvasContext.beginPath(),o.canvasContext.arc(e[0],e[1],n,0,r.TAU),o.canvasContext.fill(),o.canvasContext.beginPath(),o.canvasContext.moveTo(e[0],e[1]),o.canvasContext.strokeStyle=a.default.orange,o.canvasContext.fillStyle=a.default.orange,o.canvasContext.lineTo(t[0],t[1])};const u=(e,t,n="",r="10px",i="center")=>{o.canvasContext.font=`900 ${r} Oxanium`,o.canvasContext.textAlign=i,o.canvasContext.fillStyle=a.default.white,o.canvasContext.strokeStyle=a.default.dark,o.canvasContext.strokeText(""+n,e,t),o.canvasContext.fillText(""+n,e,t)};n.drawText=u;n.drawParagraph=(e,t,n=[],r="8px",a=20)=>{let o=t;for(const t of n)u(e,o,t,r,"left"),o+=a};n.drawInstrument=(e,t,n="")=>{const r=`${t.toUpperCase()} - ${n}`;u(e.topLeft[0],e.topLeft[1],r,"24px")};n.drawBoundingBox=(e,t="red")=>{const{bottomRight:n,topLeft:r}=e;o.canvasContext.beginPath(),o.canvasContext.fillStyle=t,o.canvasContext.strokeRect(r[0],r[1],n[0],n[1]),o.canvasContext.fill()};let d=0;n.setNodeCount=e=>d+=e;let h=0;const f=i.easeInQuad;n.drawPoints=(e,t={h:0,s:100,l:100},n=3,i=!1,s=!0)=>{const{scaledMesh:c}=e,l=c.length;for(let e=0;e<l;e++){const u=c[e][0],p=c[e][1],m=1-(c[e][2]+45)/45,g=(0,r.clamp)(n*f(m),1,n),b=(0,r.clamp)(m,.5,1);if(o.canvasContext.beginPath(),s&&e===d%l)o.canvasContext.stroke(),o.canvasContext.font="22px Oxanium",o.canvasContext.textAlign="center",o.canvasContext.fillStyle=a.default.dark,o.canvasContext.fillText("#"+e,u+g+1,p),o.canvasContext.fillStyle="hsla(0,90%,70%,1)",o.canvasContext.arc(u,p,3*g,0,r.TAU);else{const n=t.h,a=i?(h+++n+360*e/l)%360:n;o.canvasContext.fillStyle=`hsla(${a},${t.s}%,${t.l}%,${b})`,o.canvasContext.arc(u,p,g,0,r.TAU)}o.canvasContext.fill()}};n.drawFaceMesh=(e,t={h:0,s:100,l:100},n=.5,r=!1,a=.2)=>{const{scaledMesh:o}=e,i=t.h;for(let e=0,a=s.TRIANGLE_MATRIX.length-2;e<a;e+=3){const c=o[s.TRIANGLE_MATRIX[e]],u=o[s.TRIANGLE_MATRIX[e+1]],d=o[s.TRIANGLE_MATRIX[e+2]],h=t.a||1,f=`hsla(${r?(i+360*e/a)%360:i},${t.s}%,${t.l}%,${h})`;l(c[0],c[1],u[0],u[1],d[0],d[1],f,n)}};n.drawFace=(e,t=a.DEFAULT_COLOURS,n=!1,r=!1,o=!1)=>{const{annotations:i}=e;r&&n?drawMouth(e,t.mouth,o):drawMouth(e,t.mouthClosed,o)}},{"../maths/maths":"ce2f8ad85ead883d6119bddf22ec8710","../palette":"8c184ea81a7f9f2a10a21f3b44355276","./canvas":"041a34f0683a41bf466ce78a0fb7cc0c","../maths/easing":"ee0f6ded4c052474c40a1d9ff30a0651","./face":"a7dbe3203914934f0210b2ba27aafe8e"}],"8c184ea81a7f9f2a10a21f3b44355276":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.PASTEL_COLOURS=n.DAMI_KIM_COLOURS=n.DEFAULT_COLOURS=void 0;const r={hue:90,saturation:80,luminosity:50,hueRange:360,dots:60,mouth:"rgba(255,0,0,0.5)",mouthClosed:"rgba(255,0,0,0.2)",lipsUpperInner:"pink",lipsLowerInner:"pink",midwayBetweenEyes:"blue",leftEyeLower0:"red",rightEyeLower0:"red",leftEyeIris:"yellow",rightEyeIris:"yellow"};n.DEFAULT_COLOURS=r;const a={...r};n.DAMI_KIM_COLOURS=a;const o={...r};n.PASTEL_COLOURS=o;var i={white:"hsl(22, 28%, 87%)",dark:"hsl(30, 6%, 14%)",grey:"hsl(11, 6%, 50%)",cream:"hsl(27, 30%, 45%)",brown:"hsl(23, 22%, 30%)",blue:"hsl(196, 18%, 33%)",green:"hsl(56, 18%, 33%)",yellow:"hsl(56, 18%, 33%)",orange:"hsl(28, 69%, 38%)",red:"hsl(9, 58%, 35%)"};n.default=i},{}],ee0f6ded4c052474c40a1d9ff30a0651:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.easeOutSine=function(e){return Math.sin(e*(Math.PI/2))},n.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)},n.easeInQuad=function(e){return e*e},n.easeOutQuad=function(e){return e*(2-e)},n.easeInOutQuad=function(e){return e<.5?2*e*e:(4-2*e)*e-1},n.easeInCubic=function(e){return e*e*e},n.easeOutCubic=function(e){const t=e-1;return t*t*t+1},n.easeInOutCubic=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},n.easeInQuart=function(e){return e*e*e*e},n.easeOutQuart=function(e){const t=e-1;return 1-t*t*t*t},n.easeInOutQuart=function(e){const t=e-1;return e<.5?8*e*e*e*e:1-8*t*t*t*t},n.easeInQuint=function(e){return e*e*e*e*e},n.easeOutQuint=function(e){const t=e-1;return 1+t*t*t*t*t},n.easeInOutQuint=function(e){const t=e-1;return e<.5?16*e*e*e*e*e:1+16*t*t*t*t*t},n.easeInExpo=function(e){if(0===e)return 0;return Math.pow(2,10*(e-1))},n.easeOutExpo=function(e){if(1===e)return 1;return 1-Math.pow(2,-10*e)},n.easeInOutExpo=function(e){if(0===e||1===e)return e;const t=2*e,n=t-1;if(t<1)return.5*Math.pow(2,10*n);return.5*(2-Math.pow(2,-10*n))},n.easeInCirc=function(e){const t=e/1;return-1*(Math.sqrt(1-t*e)-1)},n.easeOutCirc=function(e){const t=e-1;return Math.sqrt(1-t*t)},n.easeInOutCirc=function(e){const t=2*e,n=t-2;if(t<1)return-.5*(Math.sqrt(1-t*t)-1);return.5*(Math.sqrt(1-n*n)+1)},n.easeInBack=function(e,t=1.70158){return e*e*((t+1)*e-t)},n.easeOutBack=function(e,t=1.70158){const n=e/1-1;return n*n*((t+1)*n+t)+1},n.easeInOutBack=function(e,t=1.70158){const n=2*e,r=n-2,a=1.525*t;if(n<1)return.5*n*n*((a+1)*n-a);return.5*(r*r*((a+1)*r+a)+2)},n.easeInElastic=function(e,t=.7){if(0===e||1===e)return e;const n=e/1-1,r=1-t,a=r/(2*Math.PI)*Math.asin(1);return-Math.pow(2,10*n)*Math.sin((n-a)*(2*Math.PI)/r)},n.easeOutElastic=function(e,t=.7){const n=1-t,r=2*e;if(0===e||1===e)return e;const a=n/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*r)*Math.sin((r-a)*(2*Math.PI)/n)+1},n.easeInOutElastic=function(e,t=.65){const n=1-t;if(0===e||1===e)return e;const r=2*e,a=r-1,o=n/(2*Math.PI)*Math.asin(1);if(r<1)return Math.pow(2,10*a)*Math.sin((a-o)*(2*Math.PI)/n)*-.5;return Math.pow(2,-10*a)*Math.sin((a-o)*(2*Math.PI)/n)*.5+1},n.easeOutBounce=r,n.easeInBounce=a,n.easeInOutBounce=function(e){if(e<.5)return.5*a(2*e);return.5*r(2*e-1)+.5},n.easeInSine=n.linear=void 0;n.linear=e=>e;function r(e){const t=e/1;if(t<1/2.75)return 7.5625*t*t;if(t<2/2.75){const e=t-1.5/2.75;return 7.5625*e*e+.75}if(t<2.5/2.75){const e=t-2.25/2.75;return 7.5625*e*e+.9375}{const e=t-2.625/2.75;return 7.5625*e*e+.984375}}function a(e){return 1-r(1-e)}n.easeInSine=e=>-1*Math.cos(e*(Math.PI/2))+1},{}],a7dbe3203914934f0210b2ba27aafe8e:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TRIANGLE_MATRIX=void 0;n.TRIANGLE_MATRIX=[127,34,139,11,0,37,232,231,120,72,37,39,128,121,47,232,121,128,104,69,67,175,171,148,157,154,155,118,50,101,73,39,40,9,151,108,48,115,131,194,204,211,74,40,185,80,42,183,40,92,186,230,229,118,202,212,214,83,18,17,76,61,146,160,29,30,56,157,173,106,204,194,135,214,192,203,165,98,21,71,68,51,45,4,144,24,23,77,146,91,205,50,187,201,200,18,91,106,182,90,91,181,85,84,17,206,203,36,148,171,140,92,40,39,193,189,244,159,158,28,247,246,161,236,3,196,54,68,104,193,168,8,117,228,31,189,193,55,98,97,99,126,47,100,166,79,218,155,154,26,209,49,131,135,136,150,47,126,217,223,52,53,45,51,134,211,170,140,67,69,108,43,106,91,230,119,120,226,130,247,63,53,52,238,20,242,46,70,156,78,62,96,46,53,63,143,34,227,173,155,133,123,117,111,44,125,19,236,134,51,216,206,205,154,153,22,39,37,167,200,201,208,36,142,100,57,212,202,20,60,99,28,158,157,35,226,113,160,159,27,204,202,210,113,225,46,43,202,204,62,76,77,137,123,116,41,38,72,203,129,142,64,98,240,49,102,64,41,73,74,212,216,207,42,74,184,169,170,211,170,149,176,105,66,69,122,6,168,123,147,187,96,77,90,65,55,107,89,90,180,101,100,120,63,105,104,93,137,227,15,86,85,129,102,49,14,87,86,55,8,9,100,47,121,145,23,22,88,89,179,6,122,196,88,95,96,138,172,136,215,58,172,115,48,219,42,80,81,195,3,51,43,146,61,171,175,199,81,82,38,53,46,225,144,163,110,246,33,7,52,65,66,229,228,117,34,127,234,107,108,69,109,108,151,48,64,235,62,78,191,129,209,126,111,35,143,163,161,246,117,123,50,222,65,52,19,125,141,221,55,65,3,195,197,25,7,33,220,237,44,70,71,139,122,193,245,247,130,33,71,21,162,153,158,159,170,169,150,188,174,196,216,186,92,144,160,161,2,97,167,141,125,241,164,167,37,72,38,12,145,159,160,38,82,13,63,68,71,226,35,111,158,153,154,101,50,205,206,92,165,209,198,217,165,167,97,220,115,218,133,112,243,239,238,241,214,135,169,190,173,133,171,208,32,125,44,237,86,87,178,85,86,179,84,85,180,83,84,181,201,83,182,137,93,132,76,62,183,61,76,184,57,61,185,212,57,186,214,207,187,34,143,156,79,239,237,123,137,177,44,1,4,201,194,32,64,102,129,213,215,138,59,166,219,242,99,97,2,94,141,75,59,235,24,110,228,25,130,226,23,24,229,22,23,230,26,22,231,112,26,232,189,190,243,221,56,190,28,56,221,27,28,222,29,27,223,30,29,224,247,30,225,238,79,20,166,59,75,60,75,240,147,177,215,20,79,166,187,147,213,112,233,244,233,128,245,128,114,188,114,217,174,131,115,220,217,198,236,198,131,134,177,132,58,143,35,124,110,163,7,228,110,25,356,389,368,11,302,267,452,350,349,302,303,269,357,343,277,452,453,357,333,332,297,175,152,377,384,398,382,347,348,330,303,304,270,9,336,337,278,279,360,418,262,431,304,408,409,310,415,407,270,409,410,450,348,347,422,430,434,313,314,17,306,307,375,387,388,260,286,414,398,335,406,418,364,367,416,423,358,327,251,284,298,281,5,4,373,374,253,307,320,321,425,427,411,421,313,18,321,405,406,320,404,405,315,16,17,426,425,266,377,400,369,322,391,269,417,465,464,386,257,258,466,260,388,456,399,419,284,332,333,417,285,8,346,340,261,413,441,285,327,460,328,355,371,329,392,439,438,382,341,256,429,420,360,364,394,379,277,343,437,443,444,283,275,440,363,431,262,369,297,338,337,273,375,321,450,451,349,446,342,467,293,334,282,458,461,462,276,353,383,308,324,325,276,300,293,372,345,447,382,398,362,352,345,340,274,1,19,456,248,281,436,427,425,381,256,252,269,391,393,200,199,428,266,330,329,287,273,422,250,462,328,258,286,384,265,353,342,387,259,257,424,431,430,342,353,276,273,335,424,292,325,307,366,447,345,271,303,302,423,266,371,294,455,460,279,278,294,271,272,304,432,434,427,272,407,408,394,430,431,395,369,400,334,333,299,351,417,168,352,280,411,325,319,320,295,296,336,319,403,404,330,348,349,293,298,333,323,454,447,15,16,315,358,429,279,14,15,316,285,336,9,329,349,350,374,380,252,318,402,403,6,197,419,318,319,325,367,364,365,435,367,397,344,438,439,272,271,311,195,5,281,273,287,291,396,428,199,311,271,268,283,444,445,373,254,339,263,466,249,282,334,296,449,347,346,264,447,454,336,296,299,338,10,151,278,439,455,292,407,415,358,371,355,340,345,372,390,249,466,346,347,280,442,443,282,19,94,370,441,442,295,248,419,197,263,255,359,440,275,274,300,383,368,351,412,465,263,467,466,301,368,389,380,374,386,395,378,379,412,351,419,436,426,322,373,390,388,2,164,393,370,462,461,164,0,267,302,11,12,374,373,387,268,12,13,293,300,301,446,261,340,385,384,381,330,266,425,426,423,391,429,355,437,391,327,326,440,457,438,341,382,362,459,457,461,434,430,394,414,463,362,396,369,262,354,461,457,316,403,402,315,404,403,314,405,404,313,406,405,421,418,406,366,401,361,306,408,407,291,409,408,287,410,409,432,436,410,434,416,411,264,368,383,309,438,457,352,376,401,274,275,4,421,428,262,294,327,358,433,416,367,289,455,439,462,370,326,2,326,370,305,460,455,254,449,448,255,261,446,253,450,449,252,451,450,256,452,451,341,453,452,413,464,463,441,413,414,258,442,441,257,443,442,259,444,443,260,445,444,467,342,445,459,458,250,289,392,290,290,328,460,376,433,435,250,290,392,411,416,433,341,463,464,453,464,465,357,465,412,343,412,399,360,363,440,437,399,456,420,456,363,401,435,288,372,383,353,339,255,249,448,261,255,133,243,190,133,155,112,33,246,247,33,130,25,398,384,286,362,398,414,362,463,341,263,359,467,263,249,255,466,467,260,75,60,166,238,239,79,162,127,139,72,11,37,121,232,120,73,72,39,114,128,47,233,232,128,103,104,67,152,175,148,173,157,155,119,118,101,74,73,40,107,9,108,49,48,131,32,194,211,184,74,185,191,80,183,185,40,186,119,230,118,210,202,214,84,83,17,77,76,146,161,160,30,190,56,173,182,106,194,138,135,192,129,203,98,54,21,68,5,51,4,145,144,23,90,77,91,207,205,187,83,201,18,181,91,182,180,90,181,16,85,17,205,206,36,176,148,140,165,92,39,245,193,244,27,159,28,30,247,161,174,236,196,103,54,104,55,193,8,111,117,31,221,189,55,240,98,99,142,126,100,219,166,218,112,155,26,198,209,131,169,135,150,114,47,217,224,223,53,220,45,134,32,211,140,109,67,108,146,43,91,231,230,120,113,226,247,105,63,52,241,238,242,124,46,156,95,78,96,70,46,63,116,143,227,116,123,111,1,44,19,3,236,51,207,216,205,26,154,22,165,39,167,199,200,208,101,36,100,43,57,202,242,20,99,56,28,157,124,35,113,29,160,27,211,204,210,124,113,46,106,43,204,96,62,77,227,137,116,73,41,72,36,203,142,235,64,240,48,49,64,42,41,74,214,212,207,183,42,184,210,169,211,140,170,176,104,105,69,193,122,168,50,123,187,89,96,90,66,65,107,179,89,180,119,101,120,68,63,104,234,93,227,16,15,85,209,129,49,15,14,86,107,55,9,120,100,121,153,145,22,178,88,179,197,6,196,89,88,96,135,138,136,138,215,172,218,115,219,41,42,81,5,195,51,57,43,61,208,171,199,41,81,38,224,53,225,24,144,110,105,52,66,118,229,117,227,34,234,66,107,69,10,109,151,219,48,235,183,62,191,142,129,126,116,111,143,7,163,246,118,117,50,223,222,52,94,19,141,222,221,65,196,3,197,45,220,44,156,70,139,188,122,245,139,71,162,145,153,159,149,170,150,122,188,196,206,216,92,163,144,161,164,2,167,242,141,241,0,164,37,11,72,12,144,145,160,12,38,13,70,63,71,31,226,111,157,158,154,36,101,205,203,206,165,126,209,217,98,165,97,237,220,218,237,239,241,210,214,169,140,171,32,241,125,237,179,86,178,180,85,179,181,84,180,182,83,181,194,201,182,177,137,132,184,76,183,185,61,184,186,57,185,216,212,186,192,214,187,139,34,156,218,79,237,147,123,177,45,44,4,208,201,32,98,64,129,192,213,138,235,59,219,141,242,97,97,2,141,240,75,235,229,24,228,31,25,226,230,23,229,231,22,230,232,26,231,233,112,232,244,189,243,189,221,190,222,28,221,223,27,222,224,29,223,225,30,224,113,247,225,99,60,240,213,147,215,60,20,166,192,187,213,243,112,244,244,233,245,245,128,188,188,114,174,134,131,220,174,217,236,236,198,134,215,177,58,156,143,124,25,110,7,31,228,25,264,356,368,0,11,267,451,452,349,267,302,269,350,357,277,350,452,357,299,333,297,396,175,377,381,384,382,280,347,330,269,303,270,151,9,337,344,278,360,424,418,431,270,304,409,272,310,407,322,270,410,449,450,347,432,422,434,18,313,17,291,306,375,259,387,260,424,335,418,434,364,416,391,423,327,301,251,298,275,281,4,254,373,253,375,307,321,280,425,411,200,421,18,335,321,406,321,320,405,314,315,17,423,426,266,396,377,369,270,322,269,413,417,464,385,386,258,248,456,419,298,284,333,168,417,8,448,346,261,417,413,285,326,327,328,277,355,329,309,392,438,381,382,256,279,429,360,365,364,379,355,277,437,282,443,283,281,275,363,395,431,369,299,297,337,335,273,321,348,450,349,359,446,467,283,293,282,250,458,462,300,276,383,292,308,325,283,276,293,264,372,447,346,352,340,354,274,19,363,456,281,426,436,425,380,381,252,267,269,393,421,200,428,371,266,329,432,287,422,290,250,328,385,258,384,446,265,342,386,387,257,422,424,430,445,342,276,422,273,424,306,292,307,352,366,345,268,271,302,358,423,371,327,294,460,331,279,294,303,271,304,436,432,427,304,272,408,395,394,431,378,395,400,296,334,299,6,351,168,376,352,411,307,325,320,285,295,336,320,319,404,329,330,349,334,293,333,366,323,447,316,15,315,331,358,279,317,14,316,8,285,9,277,329,350,253,374,252,319,318,403,351,6,419,324,318,325,397,367,365,288,435,397,278,344,439,310,272,311,248,195,281,375,273,291,175,396,199,312,311,268,276,283,445,390,373,339,295,282,296,448,449,346,356,264,454,337,336,299,337,338,151,294,278,455,308,292,415,429,358,355,265,340,372,388,390,466,352,346,280,295,442,282,354,19,370,285,441,295,195,248,197,457,440,274,301,300,368,417,351,465,251,301,389,385,380,386,394,395,379,399,412,419,410,436,322,387,373,388,326,2,393,354,370,461,393,164,267,268,302,12,386,374,387,312,268,13,298,293,301,265,446,340,380,385,381,280,330,425,322,426,391,420,429,437,393,391,326,344,440,438,458,459,461,364,434,394,428,396,262,274,354,457,317,316,402,316,315,403,315,314,404,314,313,405,313,421,406,323,366,361,292,306,407,306,291,408,291,287,409,287,432,410,427,434,411,372,264,383,459,309,457,366,352,401,1,274,4,418,421,262,331,294,358,435,433,367,392,289,439,328,462,326,94,2,370,289,305,455,339,254,448,359,255,446,254,253,449,253,252,450,252,256,451,256,341,452,414,413,463,286,441,414,286,258,441,258,257,442,257,259,443,259,260,444,260,467,445,309,459,250,305,289,290,305,290,460,401,376,435,309,250,392,376,411,433,453,341,464,357,453,465,343,357,412,437,343,399,344,360,440,420,437,456,360,420,363,361,401,288,265,372,353,390,339,249,339,448,255]},{}],dba4aa4fd874962cbb2ad03795b3a24b:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drawBars=n.drawWaves=void 0;var r=e("./canvas");!function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n)}(e("../palette"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}let o=0;const{width:i,height:s}=(0,r.getCanvasDimensions)();n.drawWaves=(e,t)=>{r.canvasContext.lineWidth=2,r.canvasContext.strokeStyle=`hsla(${o}, 100, 150, 0.5)`,r.canvasContext.beginPath(),o=o++%360;const n=1*i/t;let a=0;for(let o=0;o<t;o++){const t=e[o]/128*s/2;0===o?r.canvasContext.moveTo(a,t):r.canvasContext.lineTo(a,t),a+=n}r.canvasContext.lineTo(i,s/2),r.canvasContext.stroke()};n.drawBars=(e,t)=>{const n=i/t*2;let a,o=0;for(let i=0;i<t;i++)a=e[i],r.canvasContext.fillStyle="hsla("+a/s*360+",50%,50%,0.3)",r.canvasContext.fillRect(o,0,n,a),o+=n+1}},{"./canvas":"041a34f0683a41bf466ce78a0fb7cc0c","../palette":"8c184ea81a7f9f2a10a21f3b44355276"}],f88cc042be3abc856bd0c7e33042a321:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drawQuantise=void 0;var r=e("../maths/maths"),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,t&&t.set(e,n);return n}(e("../palette")),o=e("./canvas");function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}const{width:s,height:c}=(0,o.getCanvasDimensions)();n.drawQuantise=(e,t=-1,n=1,i=30,s=4)=>{const l=c/(n+1);for(let n=0,c=t+1;n<c;++n){let c=0,u=n*l+l;o.canvasContext.fillStyle=n===t?a.default.cream:a.default.orange,o.canvasContext.strokeStyle=n===t?a.default.orange:a.default.brown,o.canvasContext.strokeWidth=i,o.canvasContext.lineWidth=e&&n===t?8:4,o.canvasContext.beginPath(),o.canvasContext.arc(c,u,s,0,r.TAU),o.canvasContext.fill(),o.canvasContext.stroke(),o.canvasContext.closePath()}o.canvasContext.lineWidth=1}},{"../maths/maths":"ce2f8ad85ead883d6119bddf22ec8710","../palette":"8c184ea81a7f9f2a10a21f3b44355276","./canvas":"041a34f0683a41bf466ce78a0fb7cc0c"}],ce693141997b2d2648718d5ab03d6662:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.detectCameras=n.findBestCamera=n.loadCamera=n.setupCamera=n.filterVideoCameras=void 0;const r=e=>e.filter(e=>"videoinput"===e.kind);n.filterVideoCameras=r;const a=async(e,t)=>new Promise(async(n,r)=>{var a;let o;(e=null!==(a=e)&&void 0!==a?a:document.createElement("video")).onloadedmetadata=t=>{try{e.play(),e.width=e.videoWidth,e.height=e.videoHeight,n(o)}catch(e){r(o)}},e.onerror=e=>{console.error("VIDEO:Error",e),r(o)};const i={};t?i.deviceId={exact:t}:i.facingMode="user";const s={video:i,audio:!1};try{o=await navigator.mediaDevices.getUserMedia(s),e.srcObject=o}catch(e){r(e)}});n.setupCamera=a;let o=!1;const i=async(e,t,n="Default")=>{let r;o=!0;try{if(!(t&&t.length>0))throw console.log(t,"Camera unfound",{video:e,deviceId:t}),Error("Camera Device not specified "+t);r=await a(e,t)}catch(e){throw e}return o=!1,r};n.loadCamera=i;n.findBestCamera=async(e,t)=>{let n,o,c=!1;const l=e.has("camera")?e.getItem("camera").deviceId:void 0,u=r(await s());if(u.length<1)throw Error("No Cameras found on this device");if(!l)try{return n=await a(t),{camera:n,log:o,videoCameraDevices:u,saved:c}}catch(e){console.log("default camera not found")}try{n=await i(t,l,"Saved"),o="Camera Found",c=!0}catch(r){e.removeItem("camera"),o="Could not open saved camera, but found others...",n=await a(t)}return{camera:n,log:o,videoCameraDevices:u,saved:c}};const s=async()=>navigator.mediaDevices.enumerateDevices();n.detectCameras=s},{}],"94673a9f225080d4eed255b4e849347b":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.playNextPart=n.combinePatternWithInstrument=n.kitSequence=n.hatSequence=n.snareSequence=n.kickSequence=n.pattern=n.factory=n.createPattern=void 0;n.createPattern=(e,t=16)=>{new Array};n.factory=(e=16)=>new Array(4*e).fill(0);const r=(e,t=0)=>{let n=t;const r=e.length-1;return{reset:()=>(n=0,e[n]),previous:()=>{const t=n-1;return n=t<0?r:t,e[n]},next:()=>{const t=n+1;return n=t>r?0:t,e[n]},position:t=>e[t],length:e.length,current:()=>e[n],set:t=>e=t}};n.pattern=r;const a=[[255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0]],o=[[0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0]],i=new Array(16).map(e=>255*e/16),s=[[255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0]],c=r(a[0]);n.kickSequence=c;const l=r(o[0]);n.snareSequence=l;const u=r(s[0]);n.hatSequence=u;n.kitSequence=()=>({kick:r(a[0]),hat:r(s[0]),snare:r(o[0]),roll:r(i)});n.combinePatternWithInstrument=(e,t)=>{};n.playNextPart=(e,t,...n)=>{const r=e.next();return r>0&&(t(r,...n),!0)}},{}],e40e2877bdeb8c72986e028992ca18be:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getNextInstruction=n.getInstruction=n.getHelp=void 0;var r=e("../locales/en_GB");n.getHelp=(e,t="en-GB")=>r.QUICK_START[e%(r.QUICK_START.length-1)];n.getInstruction=(e,t="en-GB")=>r.INSTRUCTIONS[e%(r.INSTRUCTIONS.length-1)];n.getNextInstruction=(e="en-GB")=>r.INSTRUCTIONS[1%(r.INSTRUCTIONS.length-1)]},{"../locales/en_GB":"583d19eba131f4d38d1d317c3f53234a"}],"583d19eba131f4d38d1d317c3f53234a":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.INSTRUCTIONS=n.QUICK_START=void 0;const r=["Hello!","I'm looking for your pretty face","Look at me and open your mouth","Move your face close to the screen","Try and put it in the centre","I still cannot see you","Make sure you allowed the camera!"];n.QUICK_START=r;const a=["Welcome to the <strong>interFACE</strong>","Smile at the screen to begin...","Tilt your head forwards and backwards to change octave","Roll your head left and right to change pitch","Then open you mouth to make it louder!","Change instruments by closing both eyes for 1 bar","or by tapping your face on screen","to select an instrument from a list","hold your finger on your face for one bar to see all instruments","Facing left plays the black keys","Facing right plays the white keys","Use your eyes to shape the sound","Connect a MIDI instrument and click the MIDI button","In order to play the MIDI instrument with your head","You can change tempo using the arrow keys","Or just type a 3 digit number to set a BPM","Or tap the Q key in rhythm a few times","","","","","","","","","Hotkeys<br>(* means beta feature)","Type any three numbers to set the tempo","eg. 090 for 90BPM","eg. 120 for 120BPM","Arrow Up - add more bars","Arrow Down - remove a bar","Arrow Left - previous instrument","Arrow Right - next instrument","A - 808","B - Backing Percussion","C - Clear","D - Closed Hat","E - Clack","G - ","H - ","J - ","K - ","M - Metronome toggle on or off","Q - Quiet mode (mute / unmute)","R - Record*","S - Snare","T - Hide Instrument Text","V - Toggle video on screen","W - Cowbell","","","","","","","","","","","","","","","","","OMG I can't believe you are still here!","Secret Keys are as follows","CAPS Lock - developer debug","TAB - show more info on screen"];n.INSTRUCTIONS=a},{}],dad49c631de14c19376524e29b658dc1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.trackError=n.trackExit=n.track=n.setupReporting=void 0;var r=o(e("analytics")),a=o(e("@analytics/google-analytics"));function o(e){return e&&e.__esModule?e:{default:e}}let i;n.setupReporting=(e="Interface",t="G-1XT0GV0L6J")=>(i=(0,r.default)({app:e,plugins:[(0,a.default)({trackingId:t})]}),i.page(),i);n.track=(e,t)=>{i&&i.track(e,t)};n.trackExit=()=>{};n.trackError=(e,t=42,n="Fails")=>{i&&i.track("Error",{category:n,label:e,value:t})}},{analytics:"6ede170d3b2f6ce2d1c0867860501ac8","@analytics/google-analytics":"99a9dbfd305f7b247a121eef61122bfc"}],"6ede170d3b2f6ce2d1c0867860501ac8":[function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(n,"__esModule",{value:!0});var a=e("@analytics/core"),o=r(a),i=r(e("@analytics/storage-utils"));var s=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e};function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(n,!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e};function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={storage:i};return o(l(l({},t),e))}n.EVENTS=a.EVENTS,n.CONSTANTS=a.CONSTANTS,n.default=u,n.init=u,n.Analytics=u},{"@analytics/core":"5e853abf05614232b0e1f56d8867d168","@analytics/storage-utils":"1f5dec9c67bee8663c570503eda07baf"}],"5e853abf05614232b0e1f56d8867d168":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("analytics-utils");var a=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}};var o=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)};var i=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var s=function(e){return a(e)||o(e)||i()};function c(e,t){return e(t={exports:{}},t.exports),t.exports}var l=c((function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(r){return"function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?e.exports=n=function(e){return t(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)},n(r)}e.exports=n}));var u=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e};function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var h=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},f="function",p="undefined",m="@@redux/"+Math.random().toString(36),g=function(){return("undefined"==typeof Symbol?"undefined":l(Symbol))===f&&Symbol.observable||"@@observable"}(),b=" != "+f;function v(e,t,n){if(l(t)===f&&l(n)===p&&(n=t,t=void 0),l(n)!==p){if(l(n)!==f)throw new Error("enhancer"+b);return n(v)(e,t)}if(l(e)!==f)throw new Error("reducer"+b);var a=e,o=t,i=[],s=i,c=!1;function d(){s===i&&(s=i.slice())}function h(){return o}function m(e){if(l(e)!==f)throw new Error("Listener"+b);var t=!0;return d(),s.push(e),function(){if(t){t=!1,d();var n=s.indexOf(e);s.splice(n,1)}}}function y(e){if(!r.isObject(e))throw new Error("Act != obj");if(l(e.type)===p)throw new Error("ActType "+p);if(c)throw new Error("Dispatch in reducer");try{c=!0,o=a(o,e)}finally{c=!1}for(var t=i=s,n=0;n<t.length;n++){(0,t[n])()}return e}return y({type:"@@redux/INIT"}),u({dispatch:y,subscribe:m,getState:h,replaceReducer:function(e){if(l(e)!==f)throw new Error("next reducer"+b);a=e,y({type:"@@redux/INIT"})}},g,(function(){var e=m;return u({subscribe:function(t){if("object"!==l(t))throw new TypeError("Observer != obj");function n(){t.next&&t.next(h())}return n(),{unsubscribe:e(n)}}},g,(function(){return this}))}))}function y(e,t){var n=t&&t.type;return"action "+(n&&n.toString()||"?")+"reducer "+e+" returns "+p}function w(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var a=t[r];l(e[a])===f&&(n[a]=e[a])}var o,i=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t],r=n(void 0,{type:"@@redux/INIT"});if(l(r)===p||l(n(void 0,{type:m}))===p)throw new Error("reducer "+t+" "+p)}))}(n)}catch(e){o=e}return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(o)throw o;for(var r=!1,a={},s=0;s<i.length;s++){var c=i[s],u=n[c],d=e[c],h=u(d,t);if(l(h)===p){var f=y(c,t);throw new Error(f)}a[c]=h,r=r||h!==d}return r?a:e}}function E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function I(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(n,r,a){var o,i=e(n,r,a),c=i.dispatch,l={getState:i.getState,dispatch:function(e){return c(e)}};return o=t.map((function(e){return e(l)})),c=E.apply(void 0,s(o))(i.dispatch),h(h({},i),{},{dispatch:c})}}}var S=["bootstrap","params","campaign","initializeStart","initialize","initializeEnd","ready","resetStart","reset","resetEnd","pageStart","page","pageEnd","pageAborted","trackStart","track","trackEnd","trackAborted","identifyStart","identify","identifyEnd","identifyAborted","userIdChanged","registerPlugins","enablePlugin","disablePlugin","online","offline","setItemStart","setItem","setItemEnd","setItemAborted","removeItemStart","removeItem","removeItemEnd","removeItemAborted"],_=["name","EVENTS","config","loaded"],T=S.reduce((function(e,t){return e[t]=t,e}),{registerPluginType:function(e){return"registerPlugin:".concat(e)},pluginReadyType:function(e){return"ready:".concat(e)}});function M(e){return S.includes(e)}var C="__anon_id",A="__user_id",O="__user_traits",N=Object.freeze({ANON_ID:C,USER_ID:A,USER_TRAITS:O}),k=/^utm_/,x=/^an_prop_/,P=/^an_trait_/;function R(e){var t=e.storage,n=t.setItem,r=t.getItem;return function(t){return function(a){return function(o){if(o.type===T.bootstrap){var i=o.params,s=o.user;r(C)||n(C,s.anonymousId);var c=Object.keys(o.params);if(c.length){var l=i.an_uid,u=i.an_event,d=c.reduce((function(e,t){if(t.match(k)||t.match(/^(d|g)clid/)){var n=t.replace(k,""),r="campaign"===n?"name":n;e.campaign[r]=i[t]}return t.match(x)&&(e.props[t.replace(x,"")]=i[t]),t.match(P)&&(e.traits[t.replace(P,"")]=i[t]),e}),{campaign:{},props:{},traits:{}});t.dispatch(h(h({type:T.params,raw:i},d),l?{userId:l}:{})),l&&setTimeout((function(){return e.identify(l,d.traits)}),0),u&&setTimeout((function(){return e.track(u,d.props)}),0),Object.keys(d.campaign).length&&t.dispatch({type:T.campaign,campaign:d.campaign})}}return a(o)}}}}var L="userId",D="anonymousId";function B(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.type===T.setItemEnd){if(n.key===C)return h(h({},t),{anonymousId:n.value});if(n.key===A)return h(h({},t),{userId:n.value})}switch(n.type){case T.identify:return Object.assign({},t,{userId:n.userId,traits:h(h({},t.traits),n.traits)});case T.reset:return[L,D,"traits"].forEach((function(e){r.globalContext[F(e)]=null})),[A,C,O].forEach((function(t){e.removeItem(t)})),Object.assign({},t,{userId:null,anonymousId:null,traits:{}});default:return t}}}function j(e,t){return{userId:t.getItem(A)||e.an_uid,anonymousId:t.getItem(C)||e.an_aid||r.uuid(),traits:t.getItem(O)||{}}}var F=function(e){return"__TEMP__"+e};function V(e){return function(t,n,a){var o=n.getState("user")[t];if(o)return o;if(a&&r.isObject(a)&&a[t])return a[t];var i=j({},e)[t];return i||(r.globalContext[F(t)]?r.globalContext[F(t)]:null)}}function U(e){var t=e.storage,n=t.setItem,a=t.removeItem,o=t.getItem;return function(e){return function(t){return function(i){var s=i.userId,c=i.traits,l=i.options,u=i.callback;if(i.type===T.reset&&([A,O,C].forEach((function(e){return a(e)})),[L,D,"traits"].forEach((function(e){r.globalContext[F(e)]=void 0})),r.isFunction(u)&&u()),i.type===T.identify){o(C)||n(C,r.uuid());var d=o(A),f=o(O)||{};d&&d!==s&&e.dispatch({type:T.userIdChanged,old:{userId:d,traits:f},new:{userId:s,traits:c},options:l}),s&&n(A,s),c&&n(O,h(h({},f),c))}return t(i)}}}}var $=c((function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof d?t:d,o=Object.create(a.prototype),i=new S(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return T()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var s=w(i,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,i),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function d(){}function h(){}function f(){}var p={};p[a]=function(){return this};var m=Object.getPrototypeOf,g=m&&m(m(_([])));g&&g!==t&&n.call(g,a)&&(p=g);var b=f.prototype=d.prototype=Object.create(p);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){var r;this._invoke=function(a,o){function i(){return new t((function(r,i){!function r(a,o,i,s){var c=l(e[a],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,s)}))}s(c.arg)}(a,o,r,i)}))}return r=r?r.then(i,i):i()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=l(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function _(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=b.constructor=f,f.constructor=h,h.displayName=s(f,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,i,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},v(y.prototype),y.prototype[o]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new y(c(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},v(b),s(b,i,"Generator"),b[a]=function(){return this},b.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=_,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;I(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:_(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));function G(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}var q=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){G(o,r,a,i,s,"next",e)}function s(e){G(o,r,a,i,s,"throw",e)}i(void 0)}))}},H={};function W(e,t){H[e]&&r.isFunction(H[e])&&(H[e](t),delete H[e])}function z(e,t,n){return new Promise((function(r,a){return t()?r(e):n<1?a(h(h({},e),{},{queue:!0})):(o=10,new Promise((function(e){return setTimeout(e,o)}))).then((function(o){return z(e,t,n-10).then(r,a)}));var o}))}function Y(e,t,n){var a=t(),o=e.getState(),i=o.plugins,s=o.context,c=o.queue,l=o.user;if(!s.offline&&c&&c.actions&&c.actions.length){var u=c.actions.reduce((function(e,t,n){return i[t.plugin].loaded?(e.process.push(t),e.processIndex.push(n)):(e.requeue.push(t),e.requeueIndex.push(n)),e}),{processIndex:[],process:[],requeue:[],requeueIndex:[]});if(u.processIndex&&u.processIndex.length){u.processIndex.forEach((function(t){var o=c.actions[t],s=o.plugin,u=o.payload.type,d=a[s][u];if(d&&r.isFunction(d)){var f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[L,D].reduce((function(e,n){return Q(e,t,n)}),e)}(o.payload,l);d({payload:f,config:i[s].config,instance:n});var p="".concat(u,":").concat(s);e.dispatch(h(h({},f),{},{type:p,_:{called:p,from:"queueDrain"}}))}}));var d=c.actions.filter((function(e,t){return!~u.processIndex.indexOf(t)}));c.actions=d}}}function K(e,t,n){return setInterval((function(){return Y(e,t,n)}),3e3)}function Q(e,t,n){return e.hasOwnProperty(n)&&!e[n]&&t[n]?Object.assign({},e,u({},"".concat(n),t[n])):e}var X=function(e){if(Array.isArray(e))return e};var J=function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n};var Z=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")};var ee=function(e,t){return X(e)||J(e,t)||Z()};function te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.keys(e).filter((function(e){var a=n.plugins||{};return r.isBoolean(a[e])?a[e]:!1!==a.all&&(!t[e]||!1!==t[e].enabled)})).map((function(t){return e[t]}))}var ne=/Start$/,re=/^bootstrap/,ae=/^ready/;function oe(e,t,n,r,a){return ie.apply(this,arguments)}function ie(){return(ie=q($.mark((function e(t,n,a,o,i){var s,c,l,u,d,f,p,m,g,b,v,y;return $.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r.isFunction(n)?n():n,c=t.type,l=c.replace(ne,""),!t._||!t._.called){e.next=5;break}return e.abrupt("return",t);case 5:return u=a.getState(),d=te(s,u.plugins,t.options),c===T.initializeStart&&t.fromEnable&&(d=Object.keys(u.plugins).filter((function(e){var n=u.plugins[e];return t.plugins.includes(e)&&!n.initialized})).map((function(e){return s[e]}))),f=d.map((function(e){return e.name})),p=pe(c,d,s),e.next=12,ce({action:t,data:{exact:p.before,namespaced:p.beforeNS},state:u,allPlugins:s,allMatches:p,instance:a,store:o,EVENTS:i});case 12:if(!ge(m=e.sent,f.length)){e.next=15;break}return e.abrupt("return",m);case 15:if(c!==l){e.next=19;break}g=m,e.next=22;break;case 19:return e.next=21,ce({action:h(h({},m),{},{type:l}),data:{exact:p.during,namespaced:p.duringNS},state:u,allPlugins:s,allMatches:p,instance:a,store:o,EVENTS:i});case 21:g=e.sent;case 22:if(!c.match(ne)){e.next=29;break}return b="".concat(l,"End"),e.next=26,ce({action:h(h({},g),{},{type:b}),data:{exact:p.after,namespaced:p.afterNS},state:u,allPlugins:s,allMatches:p,instance:a,store:o,EVENTS:i});case 26:v=e.sent,(y=se(v))&&y({payload:v});case 29:return e.abrupt("return",m);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){return!!e.meta&&Object.keys(e.meta).reduce((function(t,n){var a=e.meta[n];return r.isFunction(a)?a:t}),!1)}function ce(e){return le.apply(this,arguments)}function le(){return(le=q($.mark((function e(t){var n,a,o,i,s,c,l,u,d,f,p,m,g,b,v,y,w,E;return $.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,a=t.action,o=t.instance,i=t.state,s=t.allPlugins,c=t.allMatches,l=t.store,u=t.EVENTS,d=i.plugins,f=i.context,p=a.type,m=p.match(ne),g=n.exact.map((function(e){return e.pluginName})),m&&(g=c.during.map((function(e){return e.pluginName}))),b=ye(o,g),v=n.exact.reduce((function(e,t){var n=t.pluginName,r=t.methodName,a=!1;return r.match(/^initialize/)||r.match(/^reset/)||(a=!d[n].loaded),f.offline&&r.match(/^(page|track|identify)/)&&(a=!0),e["".concat(n)]=a,e}),{}),e.next=10,n.exact.reduce(function(){var e=q($.mark((function e(t,i,c){var l,u,f;return $.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=i.pluginName,e.next=3,t;case 3:if(u=e.sent,!n.namespaced||!n.namespaced[l]){e.next=11;break}return e.next=7,n.namespaced[l].reduce(function(){var e=q($.mark((function e(t,n,a){var i,c,u,f;return $.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(e,t,n){return function(r,a){var o=n||t;return h(h({},e),{},{abort:{reason:r,plugins:a||[t],caller:p,from:o}})}},e.next=3,t;case 3:if(i=e.sent,n.method&&r.isFunction(n.method)){e.next=6;break}return e.abrupt("return",i);case 6:return we(n.methodName,n.pluginName),e.next=9,n.method({payload:i,instance:o,abort:c(i,l,n.pluginName),config:de(n.pluginName,d,s),plugins:d});case 9:return u=e.sent,f=r.isObject(u)?u:{},e.abrupt("return",Promise.resolve(h(h({},i),f)));case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Promise.resolve(a));case 7:f=e.sent,u[l]=f,e.next=12;break;case 11:u[l]=a;case 12:return e.abrupt("return",Promise.resolve(u));case 13:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Promise.resolve({}));case 10:return y=e.sent,e.next=13,n.exact.reduce(function(){var e=q($.mark((function e(t,a,i){var c,u,f,g,w,E,I,S,_,T,M,C;return $.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.exact.length===i+1,u=a.pluginName,f=s[u],e.next=5,t;case 5:if(g=e.sent,w=y[u]?y[u]:{},m&&(w=g),!me(w,u)){e.next=11;break}return ue({data:w,method:p,instance:o,pluginName:u,store:l}),e.abrupt("return",Promise.resolve(g));case 11:if(!me(g,u)){e.next=14;break}return c&&ue({data:g,method:p,instance:o,store:l}),e.abrupt("return",Promise.resolve(g));case 14:if(!v.hasOwnProperty(u)||!0!==v[u]){e.next=17;break}return l.dispatch({type:"queue",plugin:u,payload:w,_:{called:"queue",from:"queueMechanism"}}),e.abrupt("return",Promise.resolve(g));case 17:return E=b(y[u],s[u]),e.next=20,f[p]({abort:E.abort,payload:w,instance:o,config:de(u,d,s),plugins:d});case 20:return I=e.sent,S=r.isObject(I)?I:{},_=h(h({},g),S),me(T=y[u],u)?ue({data:T,method:p,instance:o,pluginName:u,store:l}):(M="".concat(p,":").concat(u),(M.match(/:/g)||[]).length<2&&!p.match(re)&&!p.match(ae)&&(C=m?_:w,o.dispatch(h(h({},C),{},{type:M,_:{called:M,from:"submethod"}})))),e.abrupt("return",Promise.resolve(_));case 26:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Promise.resolve(a));case 13:if(w=e.sent,p.match(ne)||p.match(/^registerPlugin/)||p.match(ae)||p.match(re)||p.match(/^params/)||p.match(/^userIdChanged/)){e.next=21;break}if(u.plugins.includes(p),!w._||w._.originalAction!==p){e.next=18;break}return e.abrupt("return",w);case 18:E=h(h({},w),{_:{originalAction:w.type,called:w.type,from:"engineEnd"}}),ge(w,n.exact.length)&&!p.match(/End$/)&&(E=h(h({},E),{type:w.type+"Aborted"})),l.dispatch(E);case 21:return e.abrupt("return",w);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){var t=e.data,n=e.method,r=(e.instance,e.pluginName),a=n+"Aborted"+(r?":"+r:"");e.store.dispatch(h(h({},t),{},{type:a,_:{called:a,from:"abort"}}))}function de(e,t,n){var r=t[e]||n[e];return r&&r.config?r.config:{}}function he(e,t){return t.reduce((function(t,n){return n[e]?t.concat({methodName:e,pluginName:n.name,method:n[e]}):t}),[])}function fe(e,t){var n=function(e){return e.replace(ne,"")}(e),r=t?":".concat(t):"";return["".concat(e).concat(r),"".concat(n).concat(r),"".concat(n,"End").concat(r)]}function pe(e,t,n){var r=fe(e).map((function(e){return he(e,t)}));return t.reduce((function(n,r){var a=r.name,o=fe(e,a).map((function(e){return he(e,t)})),i=ee(o,3),s=i[0],c=i[1],l=i[2];return s.length&&(n.beforeNS[a]=s),c.length&&(n.duringNS[a]=c),l.length&&(n.afterNS[a]=l),n}),{before:r[0],beforeNS:{},during:r[1],duringNS:{},after:r[2],afterNS:{}})}function me(e,t){var n=e.abort;return!!n&&(!0===n||(ve(n,t)||n&&ve(n.plugins,t)))}function ge(e,t){var n=e.abort;if(!n)return!1;if(!0===n||r.isString(n))return!0;var a=n.plugins;return be(n)&&n.length===t||be(a)&&a.length===t}function be(e){return Array.isArray(e)}function ve(e,t){return!(!e||!be(e))&&e.includes(t)}function ye(e,t){return function(n,r,a){var o=r.config,i=r.name,s="".concat(i,".").concat(n.type);a&&(s=a.event);var c=n.type.match(ne)?function(e,t,n,r,a){return function(o,i){var s=r?r.name:e,c=i&&be(i)?i:n;if(r&&(!(c=i&&be(i)?i:[e]).includes(e)||1!==c.length))throw new Error("Method ".concat(t," can only abort ").concat(e," plugin. ").concat(JSON.stringify(c)," input valid"));return h(h({},a),{},{abort:{reason:o,plugins:c,caller:t,_:s}})}}(i,s,t,a,n):function(e,t){return function(){throw new Error(e.type+" action not cancellable. Remove abort in "+t)}}(n,s);return{payload:Ie(n),instance:e,config:o||{},abort:c}}}function we(e,t){var n=Ee(e);if(n&&n.name===t){var r=Ee(n.method),a=r?"or "+r.method:"";throw new Error([t+" plugin is calling method "+e,"Plugins cant call self","Use ".concat(n.method," ").concat(a," in ").concat(t," plugin insteadof ").concat(e)].join("\n"))}}function Ee(e){var t=e.match(/(.*):(.*)/);return!!t&&{method:t[1],name:t[2]}}function Ie(e){return Object.keys(e).reduce((function(t,n){return"type"===n||(r.isObject(e[n])?t[n]=Object.assign({},e[n]):t[n]=e[n]),t}),{})}function Se(e,t,n){var r={};return function(a){return function(o){return function(){var i=q($.mark((function i(s){var c,l,u,d,f,p,m,g,b,v,y,w;return $.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(c=s.type,l=s.abort,u=s.plugins,d=s,!l){i.next=4;break}return i.abrupt("return",o(s));case 4:if(c===T.enablePlugin&&a.dispatch({type:T.initializeStart,plugins:u,disabled:[],fromEnable:!0,ts:s.ts}),c===T.disablePlugin&&setTimeout((function(){W(s.ts)}),0),c===T.initializeEnd&&(f=t(),p=Object.keys(f),m=p.filter((function(e){return u.includes(e)})).map((function(e){return f[e]})),g=[],b=[],v=s.disabled,y=m.map((function(e){var t=e.loaded,n=e.name;return z(e,t,1e4).then((function(t){return r[n]||(a.dispatch({type:T.pluginReadyType(n),name:n,events:Object.keys(e).filter((function(e){return!_.includes(e)}))}),r[n]=!0),g=g.concat(n),e})).catch((function(e){if(e instanceof Error)throw new Error(e);return b=b.concat(e.name),e}))})),Promise.all(y).then((function(e){var t={plugins:g,failed:b,disabled:v};setTimeout((function(){p.length===y.length+v.length&&a.dispatch(h(h({},{type:T.ready}),t)),W(s.ts,t)}),0)}))),c===T.bootstrap){i.next=13;break}return/^ready:([^:]*)$/.test(c)&&setTimeout((function(){return Y(a,t,e)}),0),i.next=11,oe(s,t,e,a,n);case 11:return w=i.sent,i.abrupt("return",o(w));case 13:return i.abrupt("return",o(d));case 14:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}()}}}function _e(){return(new Date).getTime()}function Te(e){return function(t){return function(t){return function(n){var r=n.type,a=n.key,o=n.value,i=n.options;if(r===T.setItem||r===T.removeItem){if(n.abort)return t(n);r===T.setItem?e.setItem(a,o,i):e.removeItem(a,i)}return t(n)}}}}var Me,Ce,Ae,Oe,Ne=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ke=function e(){var t=this;Ne(this,e),u(this,"before",[]),u(this,"after",[]),u(this,"addMiddleware",(function(e,n){t[n]=t[n].concat(e)})),u(this,"removeMiddleware",(function(e,n){var r=t[n].findIndex((function(t){return t===e}));-1!==r&&(t[n]=[].concat(s(t[n].slice(0,r)),s(t[n].slice(r+1))))})),u(this,"dynamicMiddlewares",(function(e){return function(n){return function(r){return function(a){var o={getState:n.getState,dispatch:function(e){return n.dispatch(e)}},i=t[e].map((function(e){return e(o)}));return E.apply(void 0,s(i))(r)(a)}}}}))};function xe(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r={};if("initialize:aborted"===n.type)return t;if(/^registerPlugin:([^:]*)$/.test(n.type)){var a=Pe(n.type,"registerPlugin"),o=e()[a];if(!o||!a)return t;var i=n.enabled;return r[a]={enabled:i,initialized:!!i&&Boolean(!o.initialize),loaded:!!i&&Boolean(o.loaded()),config:o.config||{}},h(h({},t),r)}if(/^initialize:([^:]*)$/.test(n.type)){var s=Pe(n.type,T.initialize),c=e()[s];return c&&s?(r[s]=h(h({},t[s]),{initialized:!0,loaded:Boolean(c.loaded())}),h(h({},t),r)):t}if(/^ready:([^:]*)$/.test(n.type))return r[n.name]=h(h({},t[n.name]),{loaded:!0}),h(h({},t),r);switch(n.type){case T.disablePlugin:return h(h({},t),Re(n.plugins,!1,t));case T.enablePlugin:return h(h({},t),Re(n.plugins,!0,t));default:return t}}}function Pe(e,t){return e.substring(t.length+1,e.length)}function Re(e,t,n){return e.reduce((function(e,r){return e[r]=h(h({},n[r]),{enabled:t}),e}),n)}Me=function(){if(!r.inBrowser)return!1;var e=navigator.appVersion;return~e.indexOf("Win")?"Windows":~e.indexOf("Mac")?"MacOS":~e.indexOf("X11")?"UNIX":~e.indexOf("Linux")?"Linux":"Unknown OS"}(),Ce=r.inBrowser?document.referrer:null,Ae=r.getBrowserLocale(),Oe=r.getTimeZone();var Le={initialized:!1,sessionId:r.uuid(),app:null,version:null,debug:!1,offline:!!r.inBrowser&&!navigator.onLine,os:{name:Me},userAgent:r.inBrowser?navigator.userAgent:"node",library:{name:"analytics",version:"0.9.2"},timezone:Oe,locale:Ae,campaign:{},referrer:Ce};function De(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le,t=arguments.length>1?arguments[1]:void 0,n=e.initialized,r=t.type,a=t.campaign;switch(r){case T.campaign:return h(h({},e),{campaign:a});case T.offline:return h(h({},e),{offline:!0});case T.online:return h(h({},e),{offline:!1});default:return n?e:h(h(h({},Le),e),{initialized:!0})}}var Be=["plugins","reducers","storage"];function je(e){return Object.keys(e).reduce((function(t,n){return Be.includes(n)||(t[n]=e[n]),t}),{})}function Fe(e){var t=e;try{t=JSON.parse(JSON.stringify(e))}catch(e){}return t}var Ve=/#.*$/;function Ue(e){var t=/(http[s]?:\/\/)?([^\/\s]+\/)(.*)/g.exec(e);return"/"+(t&&t[3]?t[3].split("?")[0].replace(Ve,""):"")}function $e(e){var t=function(){if(r.inBrowser)for(var e,t=document.getElementsByTagName("link"),n=0;e=t[n];n++)if("canonical"===e.getAttribute("rel"))return e.getAttribute("href")}();return t?t.match(/\?/)?t:t+e:window.location.href.replace(Ve,"")}var Ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!r.inBrowser)return e;var t=document,n=t.title,a=t.referrer,o=window,i=o.location,s=o.innerWidth,c=o.innerHeight,l=i.hash,u=i.search,d=$e(u),f={title:n,url:d,path:Ue(d),hash:l,search:u,width:s,height:c};return a&&""!==a&&(f.referrer=a),h(h({},f),e)},qe={last:{},history:[]};function He(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,t=arguments.length>1?arguments[1]:void 0,n=t.properties,r=t.options,a=t.meta;switch(t.type){case T.page:var o=Fe(h({properties:n,meta:a},Object.keys(r).length&&{options:r}));return h(h({},e),{last:o,history:e.history.concat(o)});default:return e}}var We={last:{},history:[]};function ze(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,a=t.options,o=t.event,i=t.properties;switch(n){case T.track:var s=Fe(h(h({event:o,properties:i},Object.keys(a).length&&{options:a}),{},{meta:r}));return h(h({},e),{last:s,history:e.history.concat(s)});default:return e}}var Ye={actions:[]};function Ke(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ye,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case"queue":var a;return a=r&&r.type&&r.type===T.identify?[t].concat(e.actions):e.actions.concat(t),h(h({},e),{},{actions:a});case"dequeue":return[];default:return e}}function Qe(e,t,n){if(!r.inBrowser)return!1;var a=window[(n?"add":"remove")+"EventListener"];e.split(" ").forEach((function(e){a(e,t)}))}function Xe(e){var t=Qe.bind(null,"online offline",(function(t){return Promise.resolve(!navigator.onLine).then(e)}));return t(!0),function(e){return t(!1)}}function Je(){return Array.prototype.slice.call(arguments).reduce((function(e,t){return e||(r.isFunction(t)?t:e)}),!1)}function Ze(){return r.globalContext.__analytics__=[],function(e){return function(t,n,a){var o=e(t,n,a),i=o.dispatch;return Object.assign(o,{dispatch:function(e){var t=e.action||e;return r.globalContext.__analytics__.push(t),i(e)}})}}}function et(e){return function(){return E(E.apply(null,arguments),Ze())}}function tt(e){return e?r.isString(e)?[e]:e:[]}var nt=function(e,t,n){return{type:T.setItemStart,timestamp:_e(),key:e,value:t,options:n}},rt=function(e,t){return{type:T.removeItemStart,timestamp:_e(),key:e,options:t}};function at(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.reducers||{},n=(e.plugins||[]).reduce((function(e,t){if(r.isFunction(t))return e.middlewares=e.middlewares.concat(t),e;if(t.NAMESPACE&&(t.name=t.NAMESPACE),!t.name)throw new Error("https://lytics.dev/errors/1");var n=t.EVENTS?Object.keys(t.EVENTS).map((function(e){return t.EVENTS[e]})):[],a=!(!1===t.enabled),o=!(t.config&&!1===t.config.enabled);e.pluginEnabled[t.name]=a&&o,delete t.enabled,t.methods&&(e.methods[t.name]=Object.keys(t.methods).reduce((function(e,n){return e[n]=ne(t.methods[n]),e}),{}),delete t.methods);var i=Object.keys(t).concat(n),s=new Set(e.events.concat(i));if(e.events=Array.from(s),e.pluginsArray=e.pluginsArray.concat(t),e.plugins[t.name])throw new Error(t.name+" already loaded");return e.plugins[t.name]=t,e.plugins[t.name].loaded||(e.plugins[t.name].loaded=function(){return!0}),e}),{plugins:{},pluginEnabled:{},methods:{},pluginsArray:[],middlewares:[],events:[]}),a=e.storage?e.storage:{getItem:function(e){return r.globalContext[e]},setItem:function(e,t){return r.globalContext[e]=t},removeItem:function(e){return r.globalContext[e]=void 0}},o=V(a),i=n.plugins,c=n.events.filter((function(e){return!_.includes(e)})),u=new Set(c.concat(S).filter((function(e){return!_.includes(e)}))),d=Array.from(u).sort(),f=c.sort(),p=function(){return i},m=new ke,g=m.addMiddleware,b=m.removeMiddleware,y=m.dynamicMiddlewares,A=function(){throw new Error("Abort disabled in listener")},O=function(e,t){return function(n){t&&t(n),e(n)}},N=r.paramsParse(),k=j(N,a),x=h({enable:function(e,t){var n=r.uuid();return new Promise((function(r){H[n]=O(r,t),J.dispatch({type:T.enablePlugin,plugins:tt(e),ts:n,_:{originalAction:T.enablePlugin}})}))},disable:function(e,t){var n=r.uuid();return new Promise((function(r){H[n]=O(r,t),J.dispatch({type:T.disablePlugin,plugins:tt(e),ts:n,_:{originalAction:T.disablePlugin}})}))}},n.methods),P={identify:function(e,t,n,a){var i=r.isString(e)?e:null,s=r.isObject(e)?e:t,c=n||{},l=P.user();r.globalContext[F(L)]=i;var u=i||s.userId||o(L,P,s);return new Promise((function(e,r){J.dispatch(h(h({type:T.identifyStart,userId:u,traits:s||{},options:c,anonymousId:l.anonymousId},l.id&&l.id!==i&&{previousId:l.id}),{},{meta:{timestamp:_e(),callback:O(e,Je(t,n,a))}}))}))},track:function(e,t,n,a){var i=r.isObject(e)?e.event:e;if(!i||!r.isString(i))throw new Error("Event missing");var s=r.isObject(e)?e:t||{},c=r.isObject(n)?n:{};return new Promise((function(e,r){J.dispatch({type:T.trackStart,event:i,properties:s,options:c,userId:o(L,P,t),anonymousId:o(D,P,t),meta:{timestamp:_e(),callback:O(e,Je(t,n,a))}})}))},page:function(e,t,n){var a=r.isObject(e)?e:{},i=r.isObject(t)?t:{};return new Promise((function(r,s){J.dispatch({type:T.pageStart,properties:Ge(a),options:i,userId:o(L,P,a),anonymousId:o(D,P,a),meta:{timestamp:_e(),callback:O(r,Je(e,t,n))}})}))},user:function(e){if(e===L||"id"===e)return o(L,P);var t=P.getState("user");return e?r.dotProp(t,e):t},reset:function(e){return new Promise((function(t,n){J.dispatch({type:T.resetStart,timestamp:_e(),callback:O(t,e)})}))},ready:function(e){return P.on(T.ready,e)},on:function(e,t){if(!e||!r.isFunction(t))return!1;if(e===T.bootstrap)throw new Error(".on disabled for "+e);var n=/Start$|Start:/;if("*"===e){var a=function(e){return function(e){return function(r){return r.type.match(n)&&t({payload:r,instance:P,plugins:i}),e(r)}}},o=function(e){return function(e){return function(r){return r.type.match(n)||t({payload:r,instance:P,plugins:i}),e(r)}}};return g(a,ot),g(o,it),function(){b(a,ot),b(o,it)}}var s=e.match(n)?ot:it,c=function(n){return function(n){return function(r){return r.type===e&&t({payload:r,instance:P,plugins:i,abort:A}),n(r)}}};return g(c,s),function(){return b(c,s)}},once:function(e,t){if(!e||!r.isFunction(t))return!1;if(e===T.bootstrap)throw new Error(".once disabled for "+e);var n=P.on(e,(function(e){var r=e.payload;t({payload:r,instance:P,plugins:i,abort:A}),n()}));return n},getState:function(e){var t=J.getState();return e?r.dotProp(t,e):Object.assign({},t)},dispatch:function(e){var t=r.isString(e)?{type:e}:e;if(M(t.type))throw new Error("reserved action "+t.type);var n=t.meta||{},a=e._||{},o=h(h({},t),{},{meta:h({timestamp:_e()},n),_:h({originalAction:t.type},a)});J.dispatch(o)},enablePlugin:x.enable,disablePlugin:x.disable,plugins:x,storage:{getItem:a.getItem,setItem:function(e,t,n){J.dispatch(nt(e,t,n))},removeItem:function(e,t){J.dispatch(rt(e,t))}},setAnonymousId:function(e,t){P.storage.setItem(C,e,t)},events:{all:d,core:S,plugins:f}},$=n.middlewares.concat([y(ot),Se(P,p,{all:d,plugins:f}),Te(a),R(P),U(P),y(it)]),G={context:De,user:B(a),page:He,track:ze,plugins:xe(p),queue:Ke},q=E,W=E;if(r.inBrowser&&e.debug){var z=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;z&&(q=z({trace:!0,traceLimit:25})),W=function(){return 0===arguments.length?Ze():r.isObject(l(arguments[0]))?et():et().apply(null,arguments)}}var Y=je(e),Q=n.pluginsArray.reduce((function(e,t){var r=t.name,a=t.config,o=t.loaded,i=n.pluginEnabled[r];return e[r]={enabled:i,initialized:!!i&&Boolean(!t.initialize),loaded:Boolean(o()),config:a||{}},e}),{}),X={context:Y,user:k,plugins:Q},J=v(w(h(h({},G),t)),X,W(q(I.apply(void 0,s($))))),Z=Object.keys(i);J.dispatch({type:T.bootstrap,plugins:Z,config:Y,params:N,user:k});var ee=Z.filter((function(e){return n.pluginEnabled[e]})),te=Z.filter((function(e){return!n.pluginEnabled[e]}));function ne(e){return function(){var t=Array.prototype.slice.call(arguments),n=Array.apply(null,Array(e.length)).map((function(){})).map((function(e,n){if(t[n]||!1===t[n]||null===t[n])return t[n]})).concat(P);return e.apply({instance:P},n)}}return J.dispatch({type:T.registerPlugins,plugins:Z,enabled:n.pluginEnabled}),n.pluginsArray.map((function(e,t){var a=e.bootstrap,o=e.config,i=e.name;a&&r.isFunction(a)&&a({instance:P,config:o,payload:e}),J.dispatch({type:T.registerPluginType(i),name:i,enabled:n.pluginEnabled[i],plugin:e}),n.pluginsArray.length===t+1&&J.dispatch({type:T.initializeStart,plugins:ee,disabled:te})})),Xe((function(e){J.dispatch({type:e?T.offline:T.online})})),K(J,p,P),P}var ot="before",it="after";n.default=at,n.init=at,n.Analytics=at,n.EVENTS=T,n.CONSTANTS=N},{"analytics-utils":"d5519d74f55f17443c57b69f6260897f"}],d5519d74f55f17443c57b69f6260897f:[function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(n,"__esModule",{value:!0});var a=r(e("dlv")),o=e("@analytics/storage-utils"),i=r(o);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}var l="undefined"!=typeof document;function u(e){if(!l)return!1;var t=e||document.referrer;if(t){var n=window.document.location.port,r=t.split("/")[2];return n&&(r=r.replace(":".concat(n),"")),r!==window.location.hostname}return!1}function d(e,t){var n=(e.split("?")||[,])[1];if(!n||-1===n.indexOf(t))return e;var r=new RegExp("(\\&|\\?)".concat(t,'([_A-Za-z0-9"+=.\\/\\-@%]+)'),"g"),a="?".concat(n).replace(r,"").replace(/^&/,"?");return e.replace("?".concat(n),a)}function h(e){return function(e){var t,n={},r=/([^&=]+)=?([^&]*)/g;for(;t=r.exec(e);){var a=c(t[1]),o=c(t[2]);"[]"===a.substring(a.length-2)?(a=a.substring(0,a.length-2),(n[a]||(n[a]=[])).push(o)):n[a]=""===o||o}for(var i in n){var s=i.split("[");s.length>1&&(f(n,s.map((function(e){return e.replace(/[?[\]\\ ]/g,"")})),n[i]),delete n[i])}return n}(function(e){if(e){var t=e.match(/\?(.*)/);return t&&t[1]?t[1].split("#")[0]:""}return l&&window.location.search.substring(1)}(e))}function f(e,t,n){for(var r=t.length-1,a=0;a<r;++a){var o=t[a];o in e||(e[o]={}),e=e[o]}e[t[r]]=n}function p(e){if(!l)return null;var t=document.createElement("a");return t.setAttribute("href",e),t.hostname}function m(e){return(p(e)||"").split(".").slice(-2).join(".")}function g(e){var t=e.split(".");return t.length>1?t.slice(0,-1).join("."):e}var b={trimTld:g,getDomainBase:m,getDomainHost:p};var v="q",y={"daum.net":v,"eniro.se":"search_word","naver.com":"query","yahoo.com":"p","msn.com":v,"aol.com":v,"ask.com":v,"baidu.com":"wd","yandex.com":"text","rambler.ru":"words",google:v,"bing.com":{p:v,n:"live"}};n.dotProp=a,n.storage=i,n.getCookie=o.getCookie,n.setCookie=o.setCookie,n.globalContext=o.globalContext,n.removeCookie=o.removeCookie,n.isFunction=function(e){return"function"==typeof e},n.isString=function(e){return"string"==typeof e},n.isArray=function(e){return Array.isArray(e)},n.isObject=function(e){if("object"!==s(e)||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},n.isUndefined=function(e){return void 0===e},n.isBoolean=function(e){return"boolean"==typeof e},n.decodeUri=c,n.getBrowserLocale=function(){if(l){var e=navigator,t=e.language,n=e.languages,r=e.userLanguage;return r||(n&&n.length?n[0]:t)}},n.getTimeZone=function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}},n.inBrowser=l,n.isExternalReferrer=u,n.isScriptLoaded=function(e){if(!l)return!0;var t=document.getElementsByTagName("script");return!!Object.keys(t).filter((function(n){var r=t[n].src;return"string"==typeof e?-1!==r.indexOf(e):e instanceof RegExp&&r.match(e)})).length},n.noOp=function(){},n.paramsClean=d,n.paramsGet=function(e,t){return c((RegExp("".concat(e,"=(.+?)(&|$)")).exec(t)||[,""])[1])},n.paramsParse=h,n.paramsRemove=function(e,t){return l?new Promise((function(n,r){if(window.history&&window.history.replaceState){var a=window.location.href,o=d(a,e);a!==o&&history.replaceState({},"",o)}return t&&t(),n()})):Promise.resolve()},n.parseReferrer=function(e,t){if(!l)return!1;var n={source:"(direct)",medium:"(none)",campaign:"(not set)"};e&&u(e)&&(n.referrer=e);var r=function(e){if(!e||!l)return!1;var t=m(e),n=document.createElement("a");n.href=e,n.hostname.indexOf("google")>-1&&(t="google");if(y[t]){var r=y[t],a="string"==typeof r?r:r.p,o=new RegExp(a+"=.*?([^&#]*|$)","gi"),i=n.search.match(o);return{source:r.n||g(t),medium:"organic",term:(i?i[0].split("=")[1]:"")||"(not provided)"}}var s=u(e)?"referral":"internal";return{source:n.hostname,medium:s}}(e);r&&Object.keys(r).length&&(n=Object.assign({},n,r));var a=h(t),o=Object.keys(a);if(!o.length)return n;var i=o.reduce((function(e,t){return t.match(/^utm_/)&&(e["".concat(t.replace(/^utm_/,""))]=a[t]),t.match(/^(d|g)clid/)&&(e.source="google",e.medium=a.gclid?"cpc":"cpm",e[t]=a[t]),e}),{});return Object.assign({},n,i)},n.url=b,n.uuid=function(){for(var e="",t=0,n=4294967295*Math.random()|0;t++<36;){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"[t-1],a=15&n;e+="-"==r||"4"==r?r:("x"==r?a:3&a|8).toString(16),n=t%8==0?4294967295*Math.random()|0:n>>4}return e},n.throttle=function(e,t){var n,r,a,o=null,i=0,s=function(){i=new Date,o=null,a=e.apply(n,r)};return function(){var c=new Date;i||(i=c);var l=t-(c-i);return n=this,r=arguments,l<=0?(clearTimeout(o),o=null,i=c,a=e.apply(n,r)):o||(o=setTimeout(s,l)),a}}},{dlv:"83a8bb07f637160c26ce43710946daa3","@analytics/storage-utils":"1f5dec9c67bee8663c570503eda07baf"}],"83a8bb07f637160c26ce43710946daa3":[function(e,t,n){var r;r=this,"object"==typeof n&&void 0!==t?t.exports=function(e,t,n,r,a){for(t=t.split?t.split("."):t,r=0;r<t.length;r++)e=e?e[t[r]]:a;return e===a?n:e}:r.dlv=function(e,t,n,r,a){for(t=t.split?t.split("."):t,r=0;r<t.length;r++)e=e?e[t[r]]:a;return e===a?n:e}},{}],"1f5dec9c67bee8663c570503eda07baf":[function(e,t,n){"use strict";var r=arguments[3];Object.defineProperty(n,"__esModule",{value:!0});var a=e("@analytics/cookie-utils");function o(){try{if("undefined"==typeof localStorage||"undefined"==typeof JSON)return!1;localStorage.setItem("_t_","1"),localStorage.removeItem("_t_")}catch(e){return!1}return!0}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){var t;try{void 0===(t=JSON.parse(e))&&(t=e),"true"===t&&(t=!0),"false"===t&&(t=!1),parseFloat(t)===t&&"object"!==i(t)&&(t=parseFloat(t))}catch(n){t=e}return t}var c="object"===("undefined"==typeof self?"undefined":i(self))&&self.self===self&&self||"object"===(void 0===r?"undefined":i(r))&&r.global===r&&r||void 0,l="localStorage",u="cookie",d="global",h=o(),f=a.hasCookieSupport();function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return null;var n=v(t);if("all"===n)return m(e);if(y(n)){var r=localStorage.getItem(e);if(r||n===l)return s(r)}if(w(n)){var o=a.getCookie(e);if(o||n===u)return s(o)}return c[e]||null}function m(e){return{cookie:s(a.getCookie(e)),localStorage:s(localStorage.getItem(e)),global:c[e]||null}}function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!t)return!1;var r=v(n),o=JSON.stringify(t);if(y(r)){var i=s(localStorage.getItem(e));return localStorage.setItem(e,o),{value:t,oldValue:i,location:l}}if(w(r)){var h=s(a.getCookie(e));return a.setCookie(e,o),{value:t,oldValue:h,location:u}}var f=c[e];return c[e]=t,{value:t,oldValue:f,location:d}}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return!1;var n=v(t);return y(n)?(localStorage.removeItem(e),l):w(n)?(a.removeCookie(e),u):(c[e]=void 0,d)}function v(e){return"string"==typeof e?e:e.storage}function y(e){return h&&(!e||e===l)}function w(e){return f&&(!e||e===u)}var E={getItem:p,setItem:g,removeItem:b};n.getCookie=a.getCookie,n.setCookie=a.setCookie,n.removeCookie=a.removeCookie,n.hasCookieSupport=a.hasCookieSupport,n.getItem=p,n.setItem=g,n.removeItem=b,n.globalContext=c,n.hasLocalStorageSupport=o,n.default=E},{"@analytics/cookie-utils":"8c2a8a98fdb2a5da9738f81db8ec3099"}],"8c2a8a98fdb2a5da9738f81db8ec3099":[function(e,t,n){"use strict";function r(e,t,n,r,a,o){if("undefined"!=typeof window)return arguments.length>1?document.cookie=e+"="+encodeURIComponent(t)+(n?"; expires="+new Date(+new Date+1e3*n).toUTCString()+(r?"; path="+r:"")+(a?"; domain="+a:"")+(o?"; secure":""):""):decodeURIComponent((("; "+document.cookie).split("; "+e+"=")[1]||"").split(";")[0])}Object.defineProperty(n,"__esModule",{value:!0});var a=r,o=r;n.hasCookieSupport=function(){try{r("_c_","1");var e=-1!==document.cookie.indexOf("_c_");return r("_c_","",-1),e}catch(e){return!1}},n.setCookie=o,n.getCookie=a,n.removeCookie=function(e){return r(e,"",-1)}},{}],"99a9dbfd305f7b247a121eef61122bfc":[function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){r(e,t,n[t])}))}return e}Object.defineProperty(n,"__esModule",{value:!0});var o={trackingId:null,debug:!1,anonymizeIp:!1,customDimensions:{},resetCustomDimensionsOnPage:[],setCustomDimensionsToPage:!0},i={};function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!1,n=l(e),r=n.instanceName,s=n.instancePrefix;return{name:"google-analytics",config:a({},o,e),initialize:function(e){var t=e.config,n=e.instance;if(!t.trackingId)throw new Error("No GA trackingId defined");var o,l,u,d,f,p,m,g=t.customDimensions,b=t.customScriptSrc||"https://www.google-analytics.com/analytics.js";if(c(b)&&(o=window,l=document,u="script",d=b,f="ga",o.GoogleAnalyticsObject=f,o.ga=o.ga||function(){(o.ga.q=o.ga.q||[]).push(arguments)},o.ga.l=1*new Date,p=l.createElement(u),m=l.getElementsByTagName(u)[0],p.async=1,p.src=d,m.parentNode.insertBefore(p,m)),!i[r]){var v=a({cookieDomain:t.domain||"auto",siteSpeedSampleRate:t.siteSpeedSampleRate||1,sampleRate:t.sampleRate||100,allowLinker:!0},t.cookieConfig);if(r&&(v.name=r),ga("create",t.trackingId,v),t.debug&&(ga("".concat(s,"set"),"sendHitTask",null),window.ga_debug={trace:!0}),t.anonymizeIp&&ga("".concat(s,"set"),"anonymizeIp",!0),t.tasks){["customTask","previewTask","checkProtocolTask","validationTask","checkStorageTask","historyImportTask","samplerTask","buildHitTask","sendHitTask","timingTask","displayFeaturesTask"].forEach((function(e){if(t.tasks.hasOwnProperty(e)){var n=t.tasks[e];"function"==typeof n?ga(t.tasks[e]):null===n&&ga("".concat(s,"set"),e,n)}}))}var y=(n.user()||{}).traits||{};if(Object.keys(y).length&&g&&Object.keys(g).length){var w=h(y,t);ga("".concat(s,"set"),w)}i[r]=!0}},page:function(e){var n=e.payload,r=e.config,o=e.instance,i=n.properties,l=r.resetCustomDimensionsOnPage,u=r.customDimensions,h=o.getState("context.campaign");if(!c()){if(l&&l.length){var f=l.reduce((function(e,t){return u[t]&&(e[u[t]]=null),e}),{});Object.keys(f).length&&ga("".concat(s,"set"),f)}var m=i.path||document.location.pathname,g={page:m,title:i.title,location:i.url},b={page:m,title:i.title};i.referrer!==document.referrer&&(b.referrer=i.referrer);var v=a({},g,d(h),p(i,r,s));ga("".concat(s,"set"),b),t&&delete v.location,ga("".concat(s,"send"),"pageview",v),t=!0}},track:function(e){var t=e.payload,n=e.config,r=e.instance,a=t.properties,o=t.event,i=a.label,s=a.value;u({hitType:"event",event:o,label:i,category:a.category||"All",value:s,nonInteraction:a.nonInteraction,campaign:r.getState("context.campaign")},n,t)},identify:function(e){var t=e.payload,n=e.config;m(t.userId,t.traits,n)},loaded:function(){return!!window.gaplugins}}}function c(e){return e?!function(e){var t=document.querySelectorAll("script[src]");return!!Object.keys(t).filter((function(n){return(t[n].src||"")===e})).length}(e):"undefined"==typeof ga}function l(e){var t=e.instanceName;return{instancePrefix:t?"".concat(t,"."):"",instanceName:t}}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(!c()){var r=l(t),o=r.instancePrefix,i={hitType:e.hitType||"event",eventAction:e.event,eventLabel:e.label,eventCategory:e.category||"All",nonInteraction:void 0!==e.nonInteraction&&!!e.nonInteraction};e.value&&(i.eventValue=g(e.value));var s=d(e),u=p(n.properties,t,o),h=a({},i,s,u);return ga("".concat(o,"send"),"event",h),h}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={},n=e.name,r=e.source,a=e.medium,o=e.content,i=e.keyword;return n&&(t.campaignName=n),r&&(t.campaignSource=r),a&&(t.campaignMedium=a),o&&(t.campaignContent=o),i&&(t.campaignKeyword=i),t}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.customDimensions;return Object.keys(n).reduce((function(t,r){var a=n[r],o=f(e,r)||e[r];return"boolean"==typeof o&&(o=o.toString()),o||0===o?(t[a]=o,t):t}),{})}function f(e,t,n,r,a){for(t=t.split?t.split("."):t,r=0;r<t.length;r++)e=e?e[t[r]]:a;return e===a?n:e}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=h(e,t);return Object.keys(r).length?t.setCustomDimensionsToPage?(ga("".concat(n,"set"),r),{}):r:{}}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!c()){var r=l(n),a=r.instancePrefix;if(e&&ga("".concat(a,"set"),"userId",e),Object.keys(t).length){var o=h(t,n);ga("".concat(a,"set"),o)}}}function g(e){return!e||e<0?0:Math.round(e)}var b=s,v=s,y=u,w=m;n.default=b,n.init=v,n.identify=w,n.track=y,n.page=void 0,n.initialize=void 0},{}],dd6a1e56851684b1b1584ee092f2589f:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.DEFAULT_OPTIONS=n.EYE_COLOURS=void 0;var r=e("./maths/maths"),a=e("./maths/easing"),o=e("./timing/timing.js"),i=e("./palette"),s=e("./audio/audio"),c=e("./audio/notes"),l=e("./audio/instruments"),u=e("./dom/ui"),d=e("./parameter-recorder"),h=e("./visual/2d"),f=e("./visual/2d.eyes"),p=e("./visual/2d.mouth");n.EYE_COLOURS=["blue","green","brown","orange"];const m={...i.DEFAULT_COLOURS,useDelay:!1,delayTime:.14,delayLength:10,stereoPan:!0,sendMIDI:!0,swapControls:!1,photoSensitive:!1,drawMesh:!1,drawNodes:!0,meshOnSing:!1,drawMask:!0,drawMouth:!0,drawEyes:!0,scleraRadius:3,irisRadius:1,pupilRadius:.3,eyeRatio:.8,mouseHoldDuration:.3,eyeShutHolddDuration:3500,feedback:.1,rollSensitivity:1.2,pitchSensitivity:1,mouthCutOff:.2,mouthSilence:.05,volumeRate:.7,instrumentPack:l.INSTRUMENT_PACK_MUSYNGKITE,precision:3,ease:a.easeInSine};n.DEFAULT_OPTIONS=m;n.default=class{constructor(e,t,n,a={}){if(this.options=Object.assign({},m,a),this.name=e,this.counter=0,this.instrumentPointer=0,this.instrumentLoading=!1,this.data=null,this.active=!1,this.audioContext=t,this.tracks=0,this.octave=4,this.midi=null,this.midiActive=!1,this.midiChannel="all",this.isLooping=!1,this.isPlayingBack=!1,this.setPalette(this.options),this.precision=Math.pow(10,parseInt(this.options.precision)),this.parameterRecorder=new d.ParamaterRecorder(t),this.yaw=0,this.pitch=0,this.roll=0,this.singing=!1,this.isMouthOpen=!1,this.isLeftEyeOpen=!0,this.isRightEyeOpen=!0,this.isRecordingParameters=!1,this.mouseDownAt=-1,this.leftEyeClosedAt=-1,this.rightEyeClosedAt=-1,this.lastNoteName="A0",this.lastNoteSound="-",this.debug=this.options.debug,this.mouthScale=(0,r.rescale)(this.options.mouthCutOff),this.gainNode=t.createGain(),this.gainNode.gain.value=0,this.options.stereoPan?(this.stereoNode=t.createStereoPanner(),this.stereoNode.connect(this.gainNode),this.outputNode=this.stereoNode):this.outputNode=this.gainNode,this.options.useDelay){const e=t.createDelay(this.options.delayLength),r=t.createGain();e.delayTime.value=this.options.delayTime,r.gain.value=this.options.feedback,this.gainNode.connect(e),e.connect(n)}else this.gainNode.connect(n);this.button=document.getElementById(e),this.button.addEventListener("mousedown",e=>{this.mouseDownAt=t.currentTime;const n=()=>{this.mouseDownFor<this.options.mouseHoldDuration?requestAnimationFrame(n):this.isMouseDown&&(this.mouseDownAt=-1,this.showForm())};n(),e.preventDefault()}),this.button.addEventListener("mouseup",e=>{this.mouseDownFor;this.instrumentLoading||this.loadInstrument((0,s.randomInstrument)()),this.mouseDownAt=-1,e.preventDefault()}),this.button.addEventListener("mouseover",e=>{this.isMouseOver=!0}),this.button.addEventListener("mouseout",e=>{this.isMouseOver=!1})}get areEyesOpen(){return this.isLeftEyeOpen&&this.isRightEyeOpen}get mouseDownFor(){return this.audioContext.currentTime-this.mouseDownAt}get isMouseDown(){return this.mouseDownAt>-1}get isMouseHeld(){return this.options.mouseHoldDuration<this.mouseDownFor}get controlsID(){return this.name+"-controls"}get controls(){return document.getElementById(this.controlsID)}get instrumentName(){return this.instrument?this.instrument.name:"loading"}get instrumentTitle(){return this.instrument?this.instrument.title:"loading"}get instrumentIndex(){return l.INSTRUMENT_FOLDERS.indexOf(this.instrumentName)}get hasMIDI(){return null!==this.midi&&this.midiChannel&&this.midiChannel.length>0}get MIDIDeviceName(){return this.midi?this.midi.name:"unknown"}get history(){return this.parameterRecorder.recording}setPalette(e){var t;this.saturation=e.saturation,this.luminosity=e.luminosity,this.hueRange=e.hueRange,this.hue=null!==(t=e.hue)&&void 0!==t?t:Math.random()*this.hueRange}update(e){this.counter++,this.data=e,this.isRecordingParameters&&this.parameterRecorder.save(e),this.isLeftEyeOpen!==!e.leftEyeClosed&&(e.leftEyeClosed?this.onLeftEyeClose(e.time):this.onLeftEyeOpen(e.time-this.leftEyeClosedAt),this.isLeftEyeOpen=!e.leftEyeClosed),this.isRightEyeOpen!==!e.rightEyeClosed&&(e.rightEyeClosed?this.onRightEyeClose(e.time):this.onRightEyeOpen(e.time-this.rightEyeClosedAt),this.isRightEyeOpen=!e.rightEyeClosed)}draw(e,t=!0,n=!1,a=!1){if(!(n||e||this.prediction||this.isPlayingBack))return;e&&!n||(e=this.prediction),this.isPlayingBack;let o=this.hue;this.instrumentLoading&&(o+=120);const i=this.options,s=this.isRightEyeOpen?-1:e.time-this.rightEyeClosedAt,l=this.isLeftEyeOpen?-1:e.time-this.leftEyeClosedAt,u=`${i.saturation}%, ${i.luminosity+(a?10:0)}%`;i.mouth=`hsla(${(o+30)%360},${u},0.8)`,i.mouthClosed=`hsla(${(o+30)%360},${u},0.9)`,i.lipsUpperInner=`hsla(${(o+50)%360},${u},1)`,i.lipsLowerInner=`hsla(${(o+50)%360},${u},1)`,i.midwayBetweenEyes=`hsla(${(o+270)%360},${u},1)`,i.leftEyeLower0=`hsla(${(o+300)%360},${u},0.8)`,i.rightEyeLower0=`hsla(${(o+300)%360},${u},0.8)`,i.leftEyeIris=`hsla(${(this.isLeftEyeOpen?o+90:o-90)%360},${i.saturation}%,${i.luminosity}%, 1)`,i.rightEyeIris=`hsla(${(this.isRightEyeOpen?o+90:o-90)%360},${i.saturation}%, ${i.luminosity}%, 1)`;const d={h:o,s:i.saturation,l:i.luminosity,a:1};if(i.drawMask&&(i.drawNodes||i.drawMesh||!i.meshOnSing?i.drawNodes?(0,h.drawPoints)(e,d,3,this.instrumentLoading,this.debug):i.drawMesh&&(0,h.drawFaceMesh)(e,d,.5,this.instrumentLoading,this.isMouthOpen,this.debug):this.singing?(0,h.drawFaceMesh)(e,d,.5,this.instrumentLoading,this.isMouthOpen,this.debug):(0,h.drawPoints)(e,d,3,this.instrumentLoading,this.debug)),i.drawMouth){const t={h:o,s:i.saturation,l:i.luminosity,a:1},n={h:o,s:i.saturation,l:20,a:1};this.isMouthOpen&&this.singing?(0,p.drawMouth)(e,t,this.debug):(0,p.drawMouth)(e,n,this.debug)}const{bottomRight:m,topLeft:g}=e.boundingBox,b=Math.abs(m[0]-g[0]),v=Math.abs(m[1]-g[1]);this.counter%22==0&&this.button.setAttribute("style",`--${this.name}-x:${m[0]};--${this.name}-y:${g[1]};--${this.name}-w:${b};--${this.name}-h:${v};`);const{annotations:y}=e,{silhouette:w}=y;if((this.instrumentLoading||this.isRightEyeOpen||this.isLeftEyeOpen?-1:Math.max(l,s))>i.eyeShutHolddDuration)this.leftEyeClosedAt=e.time,this.rightEyeClosedAt=e.time,this.loadNextInstrument(e=>console.log("instrumnetName",e));else if(i.drawEyes){const t={iris:i.leftEyeIris,irisRadius:i.irisRadius,pupil:"rgba(0,0,0,0.8)",pupilRadius:i.pupilRadius,sclera:"white",scleraRadius:i.scleraRadius,ratio:i.eyeRatio},n=(0,r.clamp)(e.eyeDirection,-1,1);(0,f.drawEye)(y,!0,this.isLeftEyeOpen,n,t),t.iris=i.rightEyeIris,(0,f.drawEye)(y,!1,this.isRightEyeOpen,n,t)}if(t)if(this.isMouseOver||this.instrumentLoading)if(this.isMouseDown&&!this.instrumentLoading){const t=1-this.mouseDownFor/this.options.mouseHoldDuration,n=100-Math.ceil(100*t);this.isMouseHeld?((0,h.drawInstrument)(e.boundingBox,this.instrumentTitle,"Select"),(0,h.drawPart)(w,4,`hsla(${o},50%,${n}%,0.3)`,!0,!1,!1),(0,h.drawParagraph)(e.boundingBox.topLeft[0],e.boundingBox.topLeft[1]+40,["Press me"],"14px")):((0,h.drawInstrument)(e.boundingBox,this.instrumentTitle,""+(100-n)),(0,h.drawPart)(w,4,`hsla(${o},50%,${n}%,${t})`,!0),(0,h.drawParagraph)(e.boundingBox.topLeft[0],e.boundingBox.topLeft[1]+40,["Hold me to see all instruments"],"14px"))}else(0,h.drawInstrument)(e.boundingBox,this.instrumentTitle,"Hold to choose instrument"),(0,h.drawPart)(w,4,"hsla("+o+",50%,50%,0.3)",!0);else if(this.instrumentLoading)(0,h.drawInstrument)(e.boundingBox,this.instrumentTitle,"loading...");else{const t=(this.debug," "+(0,c.getNoteText)(this.lastNoteName)),n=this.singing?"| ♫ "+this.lastNoteSound:this.isMouthOpen?"<":"-";if((0,h.drawInstrument)(e.boundingBox,this.instrumentTitle,`${t} ${n}`),this.debug){const t=["Gain:"+this.gainNode.gain.value.toFixed(2),"Happiness:"+e.happiness.toFixed(3),`Smirks left:${e.leftSmirk.toFixed(3)} / right:${e.rightSmirk.toFixed(3)}`,"mouthRange:"+e.mouthRange.toFixed(3),"mouthRatio:"+e.mouthRatio.toFixed(3),"mouthWidth:"+e.mouthWidth.toFixed(3),"mouthOpen:"+e.mouthOpen.toFixed(3),`pitch:${e.pitch.toFixed(3)} roll:${e.roll.toFixed(3)} yaw:${e.yaw.toFixed(3)}`,`eyes direction:${e.eyeDirection.toFixed(3)} left:${e.leftEye.toFixed(3)} right:${e.rightEye.toFixed(3)}`,`eyes open :${this.areEyesOpen} left:${!e.leftEyeClosed} right:${!e.rightEyeClosed}`,`eye closed left:${e.leftEyeClosed} right:${e.rightEyeClosed}`,`dims:${e.mouthWidth.toFixed(2)}x${e.mouthRange.toFixed(2)}`,(e.lookingRight,"left")];(0,h.drawParagraph)(e.boundingBox.topLeft[0],e.boundingBox.topLeft[1]+40,t,"14px")}}}sing(){if(!this.data||this.tracks>18)return{yaw:0,pitch:0,roll:0,lipPercentage:0,eyeDirection:0};const e=this.data,t=this.options,n=e.mouthOpen,a=e.yaw,i=(0,r.clamp)(.5*(e.pitch+1)*this.options.pitchSensitivity,0,1),l=(0,r.clamp)((e.roll+.5)*this.options.rollSensitivity,0,1),u=this.options.swapControls?l:i,d=this.options.swapControls?i:l,h=(0,r.clamp)(e.eyeDirection,-1,1),f=(0,r.clamp)(n,0,1),p=(t.ease(f),Math.round(7*u));this.octave=(0,r.clamp)(p,1,7);const m=e.lookingRight,g=(0,c.getNoteName)(d,this.octave,m),b=(0,c.getNoteSound)(d,m);let v;if(this.lastNoteName=g,this.lastNoteSound=b,this.hue=d*this.hueRange,this.saturation=100*n,this.options.stereoPan&&(this.stereoNode.pan.value=h),this.instrument&&f>=t.mouthCutOff){const e=this.instrument[g];e||console.log("note not found!",{noteName:g,roll:d,octave:this.octave,isMinor:m}),this.tracks++;(0,s.playTrack)(e,0,this.outputNode).then(()=>{this.active=!1,this.tracks--});if(v=this.mouthScale(f),v=t.ease(v),v=Math.round(v*this.precision)/this.precision,this.options.sendMIDI&&this.hasMIDI){const e={channels:this.midiChannel,attack:v};this.midi.playNote(g,e),this.midiActive?this.midi.setKeyAftertouch(g,.5*(h+1)):this.midiActive=!0}this.singing=!0,this.isMouthOpen=!0,this.active=!0}else f>t.mouthSilence&&f<t.mouthCutOff?(v=0,this.singing=!1,this.isMouthOpen=!0):(v=0,this.singing=!1,this.isMouthOpen=!1);return this.options.sendMIDI&&this.hasMIDI&&(this.midi.sendClock(),this.midi.setSongPosition(16383*(0,o.getBarProgress)()),this.singing||(this.midi.stopNote(g,{release:.2}),this.midi.turnSoundOff(),this.midi.turnNotesOff(),this.midiActive=!1)),this.gainNode.gain.value=v,this.yaw=a,this.pitch=u,this.roll=d,{yaw:a,pitch:u,roll:d,lipPercentage:n,eyeDirection:h}}async loadRandomInstrument(e){return await this.loadInstrument((0,s.randomInstrument)(),e)}async loadPreviousInstrument(e){const t=this.instrumentPointer,n=t-1<0?0:t-1;return await this.loadInstrument(l.INSTRUMENT_FOLDERS[n],e)}async loadNextInstrument(e){const t=this.instrumentPointer,n=t+1>=l.INSTRUMENT_FOLDERS.length?0:t+1;return await this.loadInstrument(l.INSTRUMENT_FOLDERS[n],e)}async reloadInstrument(e){return await this.loadInstrument(l.INSTRUMENT_FOLDERS[this.instrumentPointer],e)}async loadInstrument(e,t){return this.instrumentLoading=!0,this.instrument=await(0,s.loadInstrumentPack)(e,this.options.instrumentPack),this.instrumentPointer=l.INSTRUMENT_FOLDERS.indexOf(e),this.instrumentLoading=!1,t&&t(e),this.button.dispatchEvent(new CustomEvent("instrumentchange",{detail:{instrument:this.instrument,instrumentName:e}})),e}setMIDI(e,t="all"){this.midiChannel=t,this.midi=e}onInstrumentInput(e){const t=e.target.id;this.hideForm(),this.loadInstrument(t),e.preventDefault()}onLeftEyeOpen(e){this.leftEyeClosedAt=-1}onLeftEyeClose(e){this.leftEyeClosedAt=e}onRightEyeOpen(e){this.rightEyeClosedAt=-1}onRightEyeClose(e){this.rightEyeClosedAt=e}showForm(){this.controls.innerHTML=(0,u.setupInstrumentForm)(()=>{});this.controls.querySelectorAll("input").forEach(e=>e.addEventListener("change",e=>this.onInstrumentInput(e)),!1);const e=document.getElementById(this.instrumentName);e?e.focus():this.controls.focus(),this.controls.classList.toggle("showing",!0)}hideForm(){this.controls.innerHTML="",setTimeout(()=>this.controls.classList.toggle("showing",!1),303)}}},{"./maths/maths":"ce2f8ad85ead883d6119bddf22ec8710","./maths/easing":"ee0f6ded4c052474c40a1d9ff30a0651","./timing/timing.js":"0899cc6a6b0eda25734a56aad670415f","./palette":"8c184ea81a7f9f2a10a21f3b44355276","./audio/audio":"0114cf8fd744b8dc84d80f331ac3468a","./audio/notes":"f8a5579e8771521f023538f4c12b5f30","./audio/instruments":"adb022073b84168965080f9f27da58ab","./dom/ui":"b0fa31d0ac4fa682c4ae7d502ab9ee9b","./parameter-recorder":"c876f69f329c215308fa73ed02c575af","./visual/2d":"f803e61e201bc53ab013db5ee5dd0610","./visual/2d.eyes":"9f44f353b499a2eef3c2c0a4adba1372","./visual/2d.mouth":"20207cb5b7d2bb16bd870dc165b674e1"}],c876f69f329c215308fa73ed02c575af:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParamaterRecorder=void 0;n.ParamaterRecorder=class{constructor(e,t={}){this.isRecording=!1,this.context=e,this.parameters,this.startTime}get recording(){return this.parameters}reset(){this.parameters={}}save(e){let t=this.context.currentTime;this.isRecording||(this.startTime=t,this.isRecording=!0),this.parameters[this.startTime-t]=parameters}getValuesAtTime(e){return this.parameters[e]}}},{}],"9f44f353b499a2eef3c2c0a4adba1372":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drawEye=void 0;var r=e("./canvas"),a=e("../maths/maths");!function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}n.default=e,t&&t.set(e,n)}(e("../palette"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}const i={iris:"rgba(100,255,100,0.8)",irisRadius:1,pupil:"rgba(0,0,0,0.8)",pupilRadius:.3,sclera:"white",scleraRadius:4};n.drawEye=(e,t=!0,n=!0,o=0,s=i)=>{const c=t?e.leftEyeIris:e.rightEyeIris,l=c[0],u=c[1],d=c[2],h=c[3],f=c[4],p=Math.abs(h[0]-u[0]),m=f[1]-d[1],g=s.ratio||.8,b=.5*Math.max(p,m);if(r.canvasContext.strokeWidth=0,n){const e=b*s.scleraRadius,t=b*s.irisRadius,n=b*s.pupilRadius,i=(e-t)*-o;r.canvasContext.beginPath(),r.canvasContext.arc(l[0]+i,l[1],e,0,a.TAU),r.canvasContext.fillStyle=s.sclera,r.canvasContext.fill(),r.canvasContext.closePath(),r.canvasContext.beginPath(),r.canvasContext.fillStyle=s.iris,r.canvasContext.arc(l[0],l[1],t,0,a.TAU*g),r.canvasContext.lineTo(l[0],l[1]),r.canvasContext.fill(),r.canvasContext.closePath(),r.canvasContext.beginPath(),r.canvasContext.fillStyle=s.pupil,r.canvasContext.arc(l[0],l[1],n,0,a.TAU*g),r.canvasContext.fill()}else{const n=t?e.leftEyeLower0:e.rightEyeLower0;r.canvasContext.beginPath(),r.canvasContext.lineStyle=s.iris,r.canvasContext.fillStyle=s.pupil,r.canvasContext.moveTo(n[0][0],n[0][1]),r.canvasContext.lineTo(n[4][0],n[4][1]),r.canvasContext.lineTo(n[6][0],n[6][1]),r.canvasContext.closePath(),r.canvasContext.stroke(),r.canvasContext.fill()}}},{"./canvas":"041a34f0683a41bf466ce78a0fb7cc0c","../maths/maths":"ce2f8ad85ead883d6119bddf22ec8710","../palette":"8c184ea81a7f9f2a10a21f3b44355276"}],"20207cb5b7d2bb16bd870dc165b674e1":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.drawMouth=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}n.default=e,t&&t.set(e,n);return n}(e("../palette")),a=e("./canvas"),o=e("./2d");function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}n.drawMouth=(e,t={h:90,s:50,l:50,a:.6},n=!0)=>{const{annotations:i,mouthRange:s,mouthWidth:c,mouthOpen:l}=e,{lipsUpperInner:u,lipsLowerInner:d}=i,h=[u,d],f=`hsla(${t.h},${t.s}%,${t.l}%, ${t.a})`,p=`hsla(${t.h},${t.s}%,10%, ${t.a})`,m=u[5],g=d[5],b=a.canvasContext.createLinearGradient(0,0,c,s);b.addColorStop(0,f),b.addColorStop(.5,p),b.addColorStop(1,f),a.canvasContext.lineWidth=2,a.canvasContext.strokeStyle=p,a.canvasContext.beginPath(),a.canvasContext.moveTo(u[0][0],u[0][1]),a.canvasContext.fillStyle=b;for(let e=0,t=h.length;e<t;e++){const t=h[e];for(let e=0,n=t.length;e<n;e++){const n=t[e][0],r=t[e][1];a.canvasContext.lineTo(n,r)}}return a.canvasContext.closePath(),a.canvasContext.fill(),a.canvasContext.stroke(),n&&((0,o.drawNode)(g,m,5),a.canvasContext.fillStyle=r.default.blue,a.canvasContext.font="12px Oxanium",a.canvasContext.textAlign="center",a.canvasContext.fillText(Math.floor(s)+"px",g[0],g[1]-20)),a.canvasContext.stroke(),a.canvasContext.lineWidth=1,{lipUpperMiddle:m,lipLowerMiddle:g}}},{"../palette":"8c184ea81a7f9f2a10a21f3b44355276","./canvas":"041a34f0683a41bf466ce78a0fb7cc0c","./2d":"f803e61e201bc53ab013db5ee5dd0610"}],cde67f52b564f0e95dce1a0eaa0cb214:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getBrowserLocales=n.trimLocaleCode=void 0;const r=e=>e.split(/-|_/)[0];n.trimLocaleCode=r;n.getBrowserLocales=(e={})=>{const t=Object.assign({},{languageCodeOnly:!1,fallback:"en-GB"},e),n=void 0===navigator.languages?[navigator.language]:navigator.languages;return n?n.map(e=>{const n=e.trim();return t.languageCodeOnly?r(n):n}):t.fallback?[t.fallback]:void 0}},{}],"300693fbda54b9e9f6d7dbc70c6d85e0":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getDomainDefaults=n.getFactoryDefaults=n.NAMES=n.DANCE_OPTIONS=n.BODY_OPTIONS=n.KIDS_OPTIONS=n.DEFAULT_OPTIONS=void 0;var r=e("./audio/instruments");const a={advancedMode:!1,showSettings:!1,metronome:!1,backingTrack:!1,clear:!0,transparent:!0,synch:!0,debug:!1,muted:!1,duet:!1,masks:!0,stereo:!1,eyes:!0,quantise:!0,text:!0,spectrogram:!0,speak:!0,midiChannel:"all",bpm:120,model:"face",instrumentPack:r.INSTRUMENT_PACK_FATBOY,instrumentPacks:[r.INSTRUMENT_PACK_FATBOY,r.INSTRUMENT_PACK_FM,r.INSTRUMENT_PACK_MUSYNGKITE].join(","),photoSensitive:window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches||!1};n.DEFAULT_OPTIONS=a;const o={...a,advancedMode:!1,text:!1,masks:!1};n.KIDS_OPTIONS=o;const i={...a,backingTrack:!0};n.BODY_OPTIONS=i;const s={...a,instrumentPack:r.INSTRUMENT_PACK_MUSYNGKITE,instrumentPacks:[r.INSTRUMENT_PACK_MUSYNGKITE].join(",")};n.DANCE_OPTIONS=s;const c=["a","b","c","d"].map(e=>"person-"+e);n.NAMES=c;const l=(e=a)=>Object.assign({},e);n.getFactoryDefaults=l;n.getDomainDefaults=e=>{switch(e.toLowerCase()){case"lol":return l(o);case"band":return l();case"dance":return l(s);default:return l()}}},{"./audio/instruments":"adb022073b84168965080f9f27da58ab"}],"89a3b6041c1b1b1528848d21ce257e48":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.installOrUpdate=n.isSupportingBrowser=void 0;var r,a=e("../version");(r=e("url:../manifest.webmanifest"))&&r.__esModule;const o=window.hasOwnProperty("BeforeInstallPromptEvent");n.isSupportingBrowser=o;let i;let s,c=(()=>{const e="standalone"in navigator&&!0===window.navigator.standalone,t=window.matchMedia("(display-mode: standalone)").matches;return e||t||!1})(),l=null===navigator.serviceWorker.controller,u=!1,d=!1,h=!1,f=!1;const p=a.VERSION;let m;n.installOrUpdate=async(t=!1)=>{let n=[],r={};if(!o)throw Error("Browser does not support PWA installation");c?n.push(`PWA ${a.VERSION} Installed, checking for updates`,{deferredPrompt:s,isFirstRun:l,isInWebAppiOS:isInWebAppiOS,isInWebAppChrome:isInWebAppChrome}):l?n.push(`PWA ${a.VERSION} AVAILABLE WWW / PWA`,{deferredPrompt:s,isFirstRun:l,first:navigator.serviceWorker.controller}):n.push("WWW "+a.VERSION,{deferredPrompt:s,isFirstRun:l,first:navigator.serviceWorker.controller});const b=await navigator.serviceWorker.getRegistration();if(b){const e=b.active,t=new URL(e.scriptURL);m=t.search.split("=")[1],h=m!==a.VERSION;const r=e.state;n.push("SW Reg v",`${m} -> ${p}`,{updatesAvailable:h,previousVersion:m,registration:b,activatedState:r,activeWorker:e,previousServiceWorkerURL:t}),b.addEventListener("updatefound",async()=>{const r=b.installing;if(n.push("Update found",{registration:b,installWorker:r,activeWorker:e,previousServiceWorkerURL:t}),d=!0,n.push({changes:changes,waiting:r.waiting,controller:navigator.serviceWorker.controller}),r.waiting&&navigator.serviceWorker.controller&&n.push("sanity check",{installWorker:r,nav:navigator.serviceWorker.controller}),r.addEventListener("statechange",()=>{"installed"===r.state?(d=!1,f=!0,n.push("update installed expected truth",navigator.serviceWorker.controller,{registration:b,installWorker:r})):n.push("update",r.state,{registration:b,installWorker:r})}),navigator.storage){await navigator.storage.estimate()}},{once:!0})}else n.push("PWA NO service worker registered");let v=await navigator.serviceWorker.register("../service-worker.js#v="+a.VERSION);if(v||(console.log("Service worker with #"),v=await navigator.serviceWorker.register("../service-worker.js?v="+a.VERSION)),v||(console.log("Service worker with ?"),v=await navigator.serviceWorker.register(e("../service-worker.js"))),l?n.push("PWA FRESH service worker registering",{serviceWorker:v}):n.push("PWA registering service worker",{serviceWorker:v}),c||s||(s=await g(),u=!0,n.push("Waiting prompts",s)),r={log:n,previousVersion:m,currentVersion:p,isInstallable:u,isFirstRun:l,isRunningAsApp:c,install:e=>{return t=e,n=s,new Promise(async(e,r)=>{if(!n)return r();window.addEventListener("appinstalled",t=>{e({success:!0,log:"Your PWA has been installed"})},{once:!0}),n.prompt(),t.disabled=!0,"accepted"===(await n.userChoice).outcome?(new URLSearchParams(window.location.search).installing=!0,i=!0,t.hidden=!0):(i=!1,e({success:!1,log:"User chose to not install"})),t.disabled=!1});var t,n},prompt:s,updatesAvailable:h,updating:d,updated:f,update:()=>{b.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload()}},h){const t=await(async()=>{const{injectChangeLog:t,fetchChangesAsText:n}=await e("./changes.js");return await n("changelog")})();r.changes=t}return r};const g=()=>new Promise((e,t)=>o?s?e(s):void window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e(t)},{once:!0}):t("Unsupported Browser"));c||g().then(e=>s=e)},{"../version":"25488683cc04bb43faf629e105172bc8","url:../manifest.webmanifest":"2c09a30d65374f7a71bc494df3af90c9","./changes.js":"2005377d0c1156ae8dacd44c9c298ac1","../service-worker.js":"3feead4fa45e5cd84e72c0d2076c5990"}],"2c09a30d65374f7a71bc494df3af90c9":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+e("./relative-path")("6b4f3191f1147a9a","5e7afda96a044623")},{"./bundle-url":"a079551cb6dc35425204fc0bb93fe7bb","./relative-path":"3d690079c6611245df705566cbbc1942"}],"2005377d0c1156ae8dacd44c9c298ac1":[function(e,t,n){t.exports=Promise.all([e("./loaders/browser/html-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("6b4f3191f1147a9a","b25317a87243e7f7")),e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("6b4f3191f1147a9a","ab1218e7a40a8f20"))]).then(()=>parcelRequire("a1ffdb75c07b54ad8fa7dc273d377751"))},{"./loaders/browser/html-loader":"6048cc98828ec198c56b750895f94bce","./bundle-url":"a079551cb6dc35425204fc0bb93fe7bb","./relative-path":"3d690079c6611245df705566cbbc1942","./loaders/browser/js-loader":"a9c840d63b072ad73ba68ab5bad5cba1"}],"6048cc98828ec198c56b750895f94bce":[function(e,t,n){const r=e("../../cacheLoader");t.exports=r((function(e){return fetch(e).then((function(e){return e.text()}))}))},{"../../cacheLoader":"9bafdf9169957e2c85ca25fe116ad091"}],"9bafdf9169957e2c85ca25fe116ad091":[function(e,t,n){"use strict";let r={};t.exports=function(e){return function(t){return r[t]?r[t]:r[t]=e(t).catch((function(e){throw delete r[t],e}))}}},{}],a9c840d63b072ad73ba68ab5bad5cba1:[function(e,t,n){const r=e("../../cacheLoader");t.exports=r((function(e){return new Promise((function(t,n){var r=document.createElement("script");r.async=!0,r.type="text/javascript",r.charset="utf-8",r.src=e,r.onerror=function(e){r.onerror=r.onload=null,n(e)},r.onload=function(){r.onerror=r.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(r)}))}))},{"../../cacheLoader":"9bafdf9169957e2c85ca25fe116ad091"}],"3feead4fa45e5cd84e72c0d2076c5990":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+e("./relative-path")("6b4f3191f1147a9a","afee35552e3127ac")},{"./bundle-url":"a079551cb6dc35425204fc0bb93fe7bb","./relative-path":"3d690079c6611245df705566cbbc1942"}],cfecc9fa9a81e04d3c647b955966e409:[function(e,t,n){t.exports=Promise.all([e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("6b4f3191f1147a9a","398cc1a82b51c7b0")),e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("6b4f3191f1147a9a","68f15ba4c459cde7"))]).then(()=>parcelRequire("410ef9c154a1514e5d94d04516f72291"))},{"./loaders/browser/js-loader":"a9c840d63b072ad73ba68ab5bad5cba1","./bundle-url":"a079551cb6dc35425204fc0bb93fe7bb","./relative-path":"3d690079c6611245df705566cbbc1942"}],b5b67b38abb1ba44992301555178057b:[function(e,t,n){t.exports=Promise.all([e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("6b4f3191f1147a9a","398cc1a82b51c7b0")),e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("6b4f3191f1147a9a","e863fa9238ad121c"))]).then(()=>parcelRequire("c6c35714687ef2135034611ec7e8fdec"))},{"./loaders/browser/js-loader":"a9c840d63b072ad73ba68ab5bad5cba1","./bundle-url":"a079551cb6dc35425204fc0bb93fe7bb","./relative-path":"3d690079c6611245df705566cbbc1942"}],"283f33f850e985deba879d3ef80dccb5":[function(e,t,n){t.exports=e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("6b4f3191f1147a9a","5fc42901187e8545")).then(()=>parcelRequire("99c69f85e2e0ab520ebcabc424fac7a2"))},{"./loaders/browser/js-loader":"a9c840d63b072ad73ba68ab5bad5cba1","./bundle-url":"a079551cb6dc35425204fc0bb93fe7bb","./relative-path":"3d690079c6611245df705566cbbc1942"}]},{},["2c01906a74607c172273de4db49de9f6","098cc988061dd902c257e1316c740bdd"]);