import{$f8e3232e83f0b4b967dc34b60ada38c$init as e,$c02f97239ce81f7a7e662de49329e4a6$init as t}from"./source.ee3055dd.js";var a,n=!1;function o(){return n||(n=!0,a={},a=e().getBundleURL()+"service-worker.js"),a}export const updater=async()=>new Promise((e,t)=>{let a,n=0;const r=()=>{a.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload()};"serviceWorker"in navigator?window.addEventListener("load",async()=>{a=await navigator.serviceWorker.register(o());if(a.installing&&navigator.storage){const e=await navigator.storage.estimate();e&&(n=((e,t=2)=>{if(0===e)return"0 Bytes";const a=t<0?0:t,n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(a))+" "+["Bytes","KB","MB","GB"][n]})(e.usage))}a.onupdatefound=async()=>{const n=a.installing;n.onstatechange=async()=>{if("installed"===n.state)if(navigator.serviceWorker){const t=await navigator.serviceWorker.getRegistration();t&&t.waiting&&e(r)}else t("No Service Worker");else t("Not Installed")}}}):t("Service Workers not allowed")});export const update=async()=>{try{const e=await updater();t().setToast("An Update is available! Press update to install it");const a=document.createElement("button");return a.classList.add("update-available"),a.innerHTML="Update to new version",a.addEventListener("click",()=>e(),{once:!0}),document.documentElement.appendChild(a),!0}catch(e){return!1}};
//# sourceMappingURL=update.d1e14477.js.map
