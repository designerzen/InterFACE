{"mappings":"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AE,GAAE;QACtB,iCAAiC;QACjC,eAAe,CAAC,EAAE,GAAG,CAAA,GAAA,qCAAuB,CAAC,CAAC,EAAE;QAChD,OAAO;IACR;AACD;AAQO,MAAM,yBAAyB,OAAQ,WAAS,aAAa,EAAE,SAAO,KAAK;IACjF,MAAM,MAAM,CAAC,eAAe,EAAE,SAAS,CAAC;IACxC,IAAG;QACF,MAAM,UAAU,MAAM,MAAO;QAC7B,MAAM,QAAQ,MAAM,QAAQ;QAC5B,OAAO,WAAY,OAAO;IAC3B,EAAC,OAAM,OAAM;QACZ,OAAO,EAAE;IACV;AACD;AAGO,MAAM,6BAA6B,CAAA;IACzC,IAAI,QAAQ,kBAAkB,QAAQ;IACtC,IAAI,UAAU,IACb,QAAQ,gBAAgB,QAAQ;IAEjC,OAAO,iBAAiB,CAAC,MAAM;AAChC;;;ACpPA,qGAAqG;AACrG,gFAAgF;AAChF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;;8DACa;0EAmIA;wEAmBA;2DAoBA;sEAGA;uDAEA;sDAcA;AA7LN,MAAM,2BAA2B;IACvC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;I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","sources":["node_modules/@parcel/runtime-browser-hmr/lib/runtime-9df8d634aedec71d.js","source/app.js","source/index.js","source/location-handler.js","node_modules/@parcel/transformer-js/src/esmodule-helpers.js","source/dom/load-progress.js","source/version.js","source/i18n.js","source/settings.js","source/audio/instruments.js","source/audio/midi/general-midi.js","source/palette.js","source/maths/easing.js","source/pwa/pwa.js","source/pwa/servicewaiting.polyfill.js","source/pwa/platform.js","node_modules/@parcel/runtime-js/lib/runtime-ab64d1fec518eed9.js","node_modules/@parcel/runtime-js/lib/helpers/browser/js-loader.js","node_modules/@parcel/runtime-js/lib/helpers/cacheLoader.js","node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","node_modules/@parcel/runtime-js/lib/runtime-7044ffc90b8a8348.js","source/store.js","source/utils.js","source/dom/errors.js","source/dom/button.js","source/dom/tooltips.js","source/models/info.js","source/hardware/mouse.js","source/capabilities.js","node_modules/process/browser.js","source/attractor.js","node_modules/@parcel/runtime-js/lib/runtime-d6902bd07261cbde.js"],"sourcesContent":["var HMR_HOST = null;var HMR_PORT = null;var HMR_SECURE = false;var HMR_ENV_HASH = \"d6ea1d42532a7575\";module.bundle.HMR_BUNDLE_ID = \"cce5b2ea81e41450\";\"use strict\";\n\n/* global HMR_HOST, HMR_PORT, HMR_ENV_HASH, HMR_SECURE, chrome, browser, __parcel__import__, __parcel__importScripts__, ServiceWorkerGlobalScope */\n/*::\nimport type {\n  HMRAsset,\n  HMRMessage,\n} from '@parcel/reporter-dev-server/src/HMRServer.js';\ninterface ParcelRequire {\n  (string): mixed;\n  cache: {|[string]: ParcelModule|};\n  hotData: {|[string]: mixed|};\n  Module: any;\n  parent: ?ParcelRequire;\n  isParcelRequire: true;\n  modules: {|[string]: [Function, {|[string]: string|}]|};\n  HMR_BUNDLE_ID: string;\n  root: ParcelRequire;\n}\ninterface ParcelModule {\n  hot: {|\n    data: mixed,\n    accept(cb: (Function) => void): void,\n    dispose(cb: (mixed) => void): void,\n    // accept(deps: Array<string> | string, cb: (Function) => void): void,\n    // decline(): void,\n    _acceptCallbacks: Array<(Function) => void>,\n    _disposeCallbacks: Array<(mixed) => void>,\n  |};\n}\ninterface ExtensionContext {\n  runtime: {|\n    reload(): void,\n    getURL(url: string): string;\n    getManifest(): {manifest_version: number, ...};\n  |};\n}\ndeclare var module: {bundle: ParcelRequire, ...};\ndeclare var HMR_HOST: string;\ndeclare var HMR_PORT: string;\ndeclare var HMR_ENV_HASH: string;\ndeclare var HMR_SECURE: boolean;\ndeclare var chrome: ExtensionContext;\ndeclare var browser: ExtensionContext;\ndeclare var __parcel__import__: (string) => Promise<void>;\ndeclare var __parcel__importScripts__: (string) => Promise<void>;\ndeclare var globalThis: typeof self;\ndeclare var ServiceWorkerGlobalScope: Object;\n*/\nvar OVERLAY_ID = '__parcel__error__overlay__';\nvar OldModule = module.bundle.Module;\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData[moduleName],\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n  module.bundle.hotData[moduleName] = undefined;\n}\nmodule.bundle.Module = Module;\nmodule.bundle.hotData = {};\nvar checkedAssets /*: {|[string]: boolean|} */, assetsToDispose /*: Array<[ParcelRequire, string]> */, assetsToAccept /*: Array<[ParcelRequire, string]> */;\n\nfunction getHostname() {\n  return HMR_HOST || (location.protocol.indexOf('http') === 0 ? location.hostname : 'localhost');\n}\nfunction getPort() {\n  return HMR_PORT || location.port;\n}\n\n// eslint-disable-next-line no-redeclare\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = getHostname();\n  var port = getPort();\n  var protocol = HMR_SECURE || location.protocol == 'https:' && !/localhost|127.0.0.1|0.0.0.0/.test(hostname) ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + (port ? ':' + port : '') + '/');\n\n  // Web extension context\n  var extCtx = typeof chrome === 'undefined' ? typeof browser === 'undefined' ? null : browser : chrome;\n\n  // Safari doesn't support sourceURL in error stacks.\n  // eval may also be disabled via CSP, so do a quick check.\n  var supportsSourceURL = false;\n  try {\n    (0, eval)('throw new Error(\"test\"); //# sourceURL=test.js');\n  } catch (err) {\n    supportsSourceURL = err.stack.includes('test.js');\n  }\n\n  // $FlowFixMe\n  ws.onmessage = async function (event /*: {data: string, ...} */) {\n    checkedAssets = {} /*: {|[string]: boolean|} */;\n    assetsToAccept = [];\n    assetsToDispose = [];\n    var data /*: HMRMessage */ = JSON.parse(event.data);\n    if (data.type === 'update') {\n      // Remove error overlay if there is one\n      if (typeof document !== 'undefined') {\n        removeErrorOverlay();\n      }\n      let assets = data.assets.filter(asset => asset.envHash === HMR_ENV_HASH);\n\n      // Handle HMR Update\n      let handled = assets.every(asset => {\n        return asset.type === 'css' || asset.type === 'js' && hmrAcceptCheck(module.bundle.root, asset.id, asset.depsByBundle);\n      });\n      if (handled) {\n        console.clear();\n\n        // Dispatch custom event so other runtimes (e.g React Refresh) are aware.\n        if (typeof window !== 'undefined' && typeof CustomEvent !== 'undefined') {\n          window.dispatchEvent(new CustomEvent('parcelhmraccept'));\n        }\n        await hmrApplyUpdates(assets);\n\n        // Dispose all old assets.\n        let processedAssets = {} /*: {|[string]: boolean|} */;\n        for (let i = 0; i < assetsToDispose.length; i++) {\n          let id = assetsToDispose[i][1];\n          if (!processedAssets[id]) {\n            hmrDispose(assetsToDispose[i][0], id);\n            processedAssets[id] = true;\n          }\n        }\n\n        // Run accept callbacks. This will also re-execute other disposed assets in topological order.\n        processedAssets = {};\n        for (let i = 0; i < assetsToAccept.length; i++) {\n          let id = assetsToAccept[i][1];\n          if (!processedAssets[id]) {\n            hmrAccept(assetsToAccept[i][0], id);\n            processedAssets[id] = true;\n          }\n        }\n      } else fullReload();\n    }\n    if (data.type === 'error') {\n      // Log parcel errors to console\n      for (let ansiDiagnostic of data.diagnostics.ansi) {\n        let stack = ansiDiagnostic.codeframe ? ansiDiagnostic.codeframe : ansiDiagnostic.stack;\n        console.error('🚨 [parcel]: ' + ansiDiagnostic.message + '\\n' + stack + '\\n\\n' + ansiDiagnostic.hints.join('\\n'));\n      }\n      if (typeof document !== 'undefined') {\n        // Render the fancy html overlay\n        removeErrorOverlay();\n        var overlay = createErrorOverlay(data.diagnostics.html);\n        // $FlowFixMe\n        document.body.appendChild(overlay);\n      }\n    }\n  };\n  ws.onerror = function (e) {\n    console.error(e.message);\n  };\n  ws.onclose = function () {\n    console.warn('[parcel] 🚨 Connection to the HMR server was lost');\n  };\n}\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n    console.log('[parcel] ✨ Error resolved');\n  }\n}\nfunction createErrorOverlay(diagnostics) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n  let errorHTML = '<div style=\"background: black; opacity: 0.85; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; font-family: Menlo, Consolas, monospace; z-index: 9999;\">';\n  for (let diagnostic of diagnostics) {\n    let stack = diagnostic.frames.length ? diagnostic.frames.reduce((p, frame) => {\n      return `${p}\n<a href=\"/__parcel_launch_editor?file=${encodeURIComponent(frame.location)}\" style=\"text-decoration: underline; color: #888\" onclick=\"fetch(this.href); return false\">${frame.location}</a>\n${frame.code}`;\n    }, '') : diagnostic.stack;\n    errorHTML += `\n      <div>\n        <div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">\n          🚨 ${diagnostic.message}\n        </div>\n        <pre>${stack}</pre>\n        <div>\n          ${diagnostic.hints.map(hint => '<div>💡 ' + hint + '</div>').join('')}\n        </div>\n        ${diagnostic.documentation ? `<div>📝 <a style=\"color: violet\" href=\"${diagnostic.documentation}\" target=\"_blank\">Learn more</a></div>` : ''}\n      </div>\n    `;\n  }\n  errorHTML += '</div>';\n  overlay.innerHTML = errorHTML;\n  return overlay;\n}\nfunction fullReload() {\n  if ('reload' in location) {\n    location.reload();\n  } else if (extCtx && extCtx.runtime && extCtx.runtime.reload) {\n    extCtx.runtime.reload();\n  }\n}\nfunction getParents(bundle, id) /*: Array<[ParcelRequire, string]> */{\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n  var parents = [];\n  var k, d, dep;\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || Array.isArray(dep) && dep[dep.length - 1] === id) {\n        parents.push([bundle, k]);\n      }\n    }\n  }\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n  return parents;\n}\nfunction updateLink(link) {\n  var href = link.getAttribute('href');\n  if (!href) {\n    return;\n  }\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    if (link.parentNode !== null) {\n      // $FlowFixMe\n      link.parentNode.removeChild(link);\n    }\n  };\n  newLink.setAttribute('href',\n  // $FlowFixMe\n  href.split('?')[0] + '?' + Date.now());\n  // $FlowFixMe\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      // $FlowFixMe[incompatible-type]\n      var href /*: string */ = links[i].getAttribute('href');\n      var hostname = getHostname();\n      var servedFromHMRServer = hostname === 'localhost' ? new RegExp('^(https?:\\\\/\\\\/(0.0.0.0|127.0.0.1)|localhost):' + getPort()).test(href) : href.indexOf(hostname + ':' + getPort());\n      var absolute = /^https?:\\/\\//i.test(href) && href.indexOf(location.origin) !== 0 && !servedFromHMRServer;\n      if (!absolute) {\n        updateLink(links[i]);\n      }\n    }\n    cssTimeout = null;\n  }, 50);\n}\nfunction hmrDownload(asset) {\n  if (asset.type === 'js') {\n    if (typeof document !== 'undefined') {\n      let script = document.createElement('script');\n      script.src = asset.url + '?t=' + Date.now();\n      if (asset.outputFormat === 'esmodule') {\n        script.type = 'module';\n      }\n      return new Promise((resolve, reject) => {\n        var _document$head;\n        script.onload = () => resolve(script);\n        script.onerror = reject;\n        (_document$head = document.head) === null || _document$head === void 0 ? void 0 : _document$head.appendChild(script);\n      });\n    } else if (typeof importScripts === 'function') {\n      // Worker scripts\n      if (asset.outputFormat === 'esmodule') {\n        return __parcel__import__(asset.url + '?t=' + Date.now());\n      } else {\n        return new Promise((resolve, reject) => {\n          try {\n            __parcel__importScripts__(asset.url + '?t=' + Date.now());\n            resolve();\n          } catch (err) {\n            reject(err);\n          }\n        });\n      }\n    }\n  }\n}\nasync function hmrApplyUpdates(assets) {\n  global.parcelHotUpdate = Object.create(null);\n  let scriptsToRemove;\n  try {\n    // If sourceURL comments aren't supported in eval, we need to load\n    // the update from the dev server over HTTP so that stack traces\n    // are correct in errors/logs. This is much slower than eval, so\n    // we only do it if needed (currently just Safari).\n    // https://bugs.webkit.org/show_bug.cgi?id=137297\n    // This path is also taken if a CSP disallows eval.\n    if (!supportsSourceURL) {\n      let promises = assets.map(asset => {\n        var _hmrDownload;\n        return (_hmrDownload = hmrDownload(asset)) === null || _hmrDownload === void 0 ? void 0 : _hmrDownload.catch(err => {\n          // Web extension bugfix for Chromium\n          // https://bugs.chromium.org/p/chromium/issues/detail?id=1255412#c12\n          if (extCtx && extCtx.runtime && extCtx.runtime.getManifest().manifest_version == 3) {\n            if (typeof ServiceWorkerGlobalScope != 'undefined' && global instanceof ServiceWorkerGlobalScope) {\n              extCtx.runtime.reload();\n              return;\n            }\n            asset.url = extCtx.runtime.getURL('/__parcel_hmr_proxy__?url=' + encodeURIComponent(asset.url + '?t=' + Date.now()));\n            return hmrDownload(asset);\n          }\n          throw err;\n        });\n      });\n      scriptsToRemove = await Promise.all(promises);\n    }\n    assets.forEach(function (asset) {\n      hmrApply(module.bundle.root, asset);\n    });\n  } finally {\n    delete global.parcelHotUpdate;\n    if (scriptsToRemove) {\n      scriptsToRemove.forEach(script => {\n        if (script) {\n          var _document$head2;\n          (_document$head2 = document.head) === null || _document$head2 === void 0 ? void 0 : _document$head2.removeChild(script);\n        }\n      });\n    }\n  }\n}\nfunction hmrApply(bundle /*: ParcelRequire */, asset /*:  HMRAsset */) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n  if (asset.type === 'css') {\n    reloadCSS();\n  } else if (asset.type === 'js') {\n    let deps = asset.depsByBundle[bundle.HMR_BUNDLE_ID];\n    if (deps) {\n      if (modules[asset.id]) {\n        // Remove dependencies that are removed and will become orphaned.\n        // This is necessary so that if the asset is added back again, the cache is gone, and we prevent a full page reload.\n        let oldDeps = modules[asset.id][1];\n        for (let dep in oldDeps) {\n          if (!deps[dep] || deps[dep] !== oldDeps[dep]) {\n            let id = oldDeps[dep];\n            let parents = getParents(module.bundle.root, id);\n            if (parents.length === 1) {\n              hmrDelete(module.bundle.root, id);\n            }\n          }\n        }\n      }\n      if (supportsSourceURL) {\n        // Global eval. We would use `new Function` here but browser\n        // support for source maps is better with eval.\n        (0, eval)(asset.output);\n      }\n\n      // $FlowFixMe\n      let fn = global.parcelHotUpdate[asset.id];\n      modules[asset.id] = [fn, deps];\n    } else if (bundle.parent) {\n      hmrApply(bundle.parent, asset);\n    }\n  }\n}\nfunction hmrDelete(bundle, id) {\n  let modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n  if (modules[id]) {\n    // Collect dependencies that will become orphaned when this module is deleted.\n    let deps = modules[id][1];\n    let orphans = [];\n    for (let dep in deps) {\n      let parents = getParents(module.bundle.root, deps[dep]);\n      if (parents.length === 1) {\n        orphans.push(deps[dep]);\n      }\n    }\n\n    // Delete the module. This must be done before deleting dependencies in case of circular dependencies.\n    delete modules[id];\n    delete bundle.cache[id];\n\n    // Now delete the orphans.\n    orphans.forEach(id => {\n      hmrDelete(module.bundle.root, id);\n    });\n  } else if (bundle.parent) {\n    hmrDelete(bundle.parent, id);\n  }\n}\nfunction hmrAcceptCheck(bundle /*: ParcelRequire */, id /*: string */, depsByBundle /*: ?{ [string]: { [string]: string } }*/) {\n  if (hmrAcceptCheckOne(bundle, id, depsByBundle)) {\n    return true;\n  }\n\n  // Traverse parents breadth first. All possible ancestries must accept the HMR update, or we'll reload.\n  let parents = getParents(module.bundle.root, id);\n  let accepted = false;\n  while (parents.length > 0) {\n    let v = parents.shift();\n    let a = hmrAcceptCheckOne(v[0], v[1], null);\n    if (a) {\n      // If this parent accepts, stop traversing upward, but still consider siblings.\n      accepted = true;\n    } else {\n      // Otherwise, queue the parents in the next level upward.\n      let p = getParents(module.bundle.root, v[1]);\n      if (p.length === 0) {\n        // If there are no parents, then we've reached an entry without accepting. Reload.\n        accepted = false;\n        break;\n      }\n      parents.push(...p);\n    }\n  }\n  return accepted;\n}\nfunction hmrAcceptCheckOne(bundle /*: ParcelRequire */, id /*: string */, depsByBundle /*: ?{ [string]: { [string]: string } }*/) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n  if (depsByBundle && !depsByBundle[bundle.HMR_BUNDLE_ID]) {\n    // If we reached the root bundle without finding where the asset should go,\n    // there's nothing to do. Mark as \"accepted\" so we don't reload the page.\n    if (!bundle.parent) {\n      return true;\n    }\n    return hmrAcceptCheck(bundle.parent, id, depsByBundle);\n  }\n  if (checkedAssets[id]) {\n    return true;\n  }\n  checkedAssets[id] = true;\n  var cached = bundle.cache[id];\n  assetsToDispose.push([bundle, id]);\n  if (!cached || cached.hot && cached.hot._acceptCallbacks.length) {\n    assetsToAccept.push([bundle, id]);\n    return true;\n  }\n}\nfunction hmrDispose(bundle /*: ParcelRequire */, id /*: string */) {\n  var cached = bundle.cache[id];\n  bundle.hotData[id] = {};\n  if (cached && cached.hot) {\n    cached.hot.data = bundle.hotData[id];\n  }\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData[id]);\n    });\n  }\n  delete bundle.cache[id];\n}\nfunction hmrAccept(bundle /*: ParcelRequire */, id /*: string */) {\n  // Execute the module.\n  bundle(id);\n\n  // Run the accept callbacks in the new version of the module.\n  var cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      var assetsToAlsoAccept = cb(function () {\n        return getParents(module.bundle.root, id);\n      });\n      if (assetsToAlsoAccept && assetsToAccept.length) {\n        assetsToAlsoAccept.forEach(function (a) {\n          hmrDispose(a[0], a[1]);\n        });\n\n        // $FlowFixMe[method-unbinding]\n        assetsToAccept.push.apply(assetsToAccept, assetsToAlsoAccept);\n      }\n    });\n  }\n}","// This is just a Capacitor entry point for when compiling th web app into an actual app\r\n\r\n// https://www.npmjs.com/package/capacitor-dark-mode\r\n\r\n// import { Capacitor } from '@capacitor/core'\r\n\r\n// camera???\r\nimport * as I from './index'\r\n\r\n","/**\r\n * This is the default root loader for the app\r\n * It is responsible for loading in as much data upfront as possible\r\n * before showing a UI from those external libs\r\n * http://localhost:909/?advancedMode=false&showSettings=false&showPiano=false&metronome=false&backingTrack=false&clear=false&synch=true&disco=false&overlays=true&masks=true&eyes=true&quantise=true&text=true&spectrogram=true&speak=true&debug=true&muted=false&duet=false&stereo=true&stereoPan=true&midiChannel=all&bpm=200&autoHide=false&loadMIDIPerformance=false&useGamePad=true&model=face&instrumentPack=FatBoy&instrumentPacks=FatBoy%2CFluidR3_GM%2CMusyngKite&photoSensitive=false&automationMode=false\r\n */\r\nimport { getReferer, getRefererHostname, forceSecure, getEditionFromURL } from './location-handler'\r\nimport { setLoadProgress } from './dom/load-progress'\r\nimport { VERSION } from './version'\r\nimport { getBrowserLocales } from './i18n'\r\nimport { getDomainDefaults } from './settings'\r\n\r\nimport { showChangelog, installOrUpdate, uninstall } from './pwa/pwa'\r\nimport { createStore} from './store'\r\nimport { showError} from './dom/errors'\r\nimport { setToast } from './dom/tooltips'\r\nimport { MOUSE_HELD, MOUSE_TAP, addMouseTapAndHoldEvents} from './hardware/mouse'\r\n\r\nimport Capabilities from './capabilities'\r\nimport Attractor from './attractor'\r\n\r\n// TESTING\r\n// import createAppInterface from './interface.js'\r\n\r\n// for custom path editions rather than on unique domains\r\n// instead you can have over-rides both in the globalThis._synth space\r\n// or else via a named route here\r\nconst DOMAIN = getEditionFromURL()[0]\r\nconst HOST = getRefererHostname()\r\nconst LTD = HOST.split('.').pop()\r\n\r\nconst IS_DEVELOPMENT_MODE = process.env.NODE_ENV === \"development\"\r\nconst body = document.documentElement\r\nconst debugMode = IS_DEVELOPMENT_MODE || new URLSearchParams(window.location.search).has(\"debug\") \r\n\r\n// 5 minutes\r\nconst LOAD_TIMEOUT = 5 * 60 * 1000\r\n\r\n// if on http flip to https and exit\r\nforceSecure(IS_DEVELOPMENT_MODE)\r\n\r\n// start loading / updating...\"loading\",\r\n// NB. see _base.pug for double of this - this is just in case\r\nbody.classList.toggle( \"loading\", true )\r\nbody.classList.add( debugMode ? \"debug\" : LTD )\r\n\r\n// This teaches us which kind of an app this is...\r\nconst capabilities = new Capabilities()\r\n// TODO: \r\n// ESCAPE - no cameras found on system?\r\n// ESCAPE - no GPU?\r\n// remove loading stuff and quit\r\n\r\n\r\nif (debugMode)\r\n{\r\n\tconsole.log(\"TEST : Initialising\", {capabilities, DOMAIN, HOST, LTD } )\r\n}\r\n\r\n\r\n// FIXME: show updates button\r\nconst showUpgradeDialog = () => {\t\r\n\tconst updateButton = document.getElementById(\"button-update\")\r\n\tconst changes = showChangelog( document.getElementById(\"changelog\") )\r\n\tdocument.getElementById(\"pwa\").setAttribute(\"open\", true)\r\n\tupdateButton.setAttribute(\"hidden\", false)\r\n}\r\n\r\n// set window.title\r\nconst setTitle = title => {\r\n\tif (document.title !== title)\r\n\t{\r\n\t\tdocument.title = title\r\n\t}\r\n}\r\n\r\nconst start = () => {\r\n\r\n\tsetLoadProgress(0.5, \" \")\r\n\r\n\t// if we have a specific referer, we can change the options accordingly\r\n\t// allow different domains to show different styles / options / configs\r\n\t// current domains that point this way include :\r\n\t// interface.place\r\n\t// interface.lol\t<- defaults to simple 'kid' mode\r\n\t// interface.band\t<- defaults to duet mode\r\n\t// const referer = getReferer()\r\n\r\n\t// we can also inject specific options through an object set\r\n\t// in a global space \r\n\tconst globalOptions = Object.assign( {}, globalThis._synth )\r\n\tconst dominOptions = getDomainDefaults( HOST ) \r\n\tconst defaultOptions = { ...dominOptions }\r\n\t\r\n\t// only overwrite objects with the same keys!\r\n\tconst validOptionKeys = Object.keys(defaultOptions)\r\n\tObject.keys(globalOptions).forEach( key => validOptionKeys.indexOf(key) > -1 ? defaultOptions[key] = globalOptions[key] : null )\r\n\r\n\t// console.log( \"Global options\" ,  { globalOptions, dominOptions, defaultOptions, validOptionKeys } )\r\n\t\r\n\tconst language = getBrowserLocales()[0]\r\n\tconst store = createStore()\r\n\r\n\tlet startLoadTime = Date.now()\r\n\tlet failed = false\r\n\r\n\t\r\n\t// Lazy load the main interface code\r\n\timport('./interface.js').then( async ({createInterface}) => {\r\n\r\n\t\tconst title = document.title\r\n\t\ttry{\r\n\t\t\tconst application = await createInterface( defaultOptions, store, capabilities, language, (loadProgress, message, hideLoader=false) => {\r\n\t\t\t\t\r\n\t\t\t\tif (failed)\r\n\t\t\t\t{\r\n\t\t\t\t\t// already failed so why show more loading?\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (loadProgress !== 0.5)\r\n\t\t\t\t{\r\n\t\t\t\t\t// reset the timer during the half time show\r\n\t\t\t\t\tstartLoadTime = Date.now()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst elapsed = Date.now() - startLoadTime\r\n\t\t\t\t//console.log( \"Loading\", {elapsed, loadProgress, message} ) \r\n\r\n\t\t\t\t// if (elapsed > LOAD_TIMEOUT)\r\n\t\t\t\t// {\r\n\t\t\t\t// \tfailed = true\r\n\t\t\t\t// \tsetLoadProgress( \r\n\t\t\t\t// \t\t0, \r\n\t\t\t\t// \t\t\"Oh no!\",\r\n\t\t\t\t// \t\ttrue\r\n\t\t\t\t// \t)\r\n\t\t\t\t// \tshowError( \"Couldn't load everything\", \"Occasssionally I fall apart and require a refresh! Sorry!\" )\r\n\t\t\t\t// }\r\n\t\t\t\t// else \r\n\t\t\t\t\r\n\t\t\t\tif (hideLoader)\r\n\t\t\t\t{\r\n\t\t\t\t\tsetLoadProgress( \r\n\t\t\t\t\t\tloadProgress, \r\n\t\t\t\t\t\t\"\",\r\n\t\t\t\t\t\ttrue\r\n\t\t\t\t\t)\r\n\t\t\t\t\tsetTitle( title )\r\n\r\n\t\t\t\t} else if (loadProgress < 1) {\r\n\r\n\t\t\t\t\t// const rectifiedProgress = halfLoaded ? loadProgress * 0.5 : 0.5 + loadProgress * 0.5\r\n\t\t\t\t\t// console.log( \"Interface: loaded\", {rectifiedProgress} )\r\n\t\t\t\t\tsetLoadProgress( \r\n\t\t\t\t\t\tloadProgress, \r\n\t\t\t\t\t\tmessage \r\n\t\t\t\t\t)\r\n\t\t\t\t\tsetTitle( `${title} - ${Math.ceil(loadProgress * 100)} %` )\r\n\r\n\t\t\t\t}else{\r\n\r\n\t\t\t\t\tsetLoadProgress(1, \"Ready!\", true)\r\n\t\t\t\t\tsetTitle( title )\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t// This allows for remote control as well as allowing the\r\n\t\t\t// app to change parameters on it's own\r\n\t\t\tconst automator = application.setAutomator( new Attractor(application) )\r\n\t\t\t\r\n\t\t\t// console.log(\"Attract mode!\", {automator, application})\r\n\t\t\r\n\t\t\t// let installation = null\r\n\t\t\t// // at any point we can now trigger the installation\r\n\t\t\t// if (installation)\r\n\t\t\t// {\r\n\t\t\t// \ttry{\r\n\t\t\t// \t\tconst destination = document.getElementById(\"shared-controls\")\r\n\t\t\t// \t\tconst needsInstall = await installation( destination )\t\t\r\n\t\t\t\t\t\r\n\t\t\t// \t\tcanBeInstalled = needsInstall\r\n\t\t\t\t\t\r\n\t\t\t// \t}catch(error){\r\n\t\r\n\t\t\t// \t\tbody.classList.add(\"installation-unavailable\")\r\n\t\t\t// \t\tconsole.error(\"Install/Update issue\", error)\r\n\t\t\t// \t}\r\n\t\t\t\t\r\n\t\t\t// }else{\r\n\t\t\t// \t// console.log(\"Loaded Webpage\")\r\n\t\t\t// }\r\n\t\r\n\t\t\t// const Attractor = await import('./attractor.js')\r\n\t\t\t// For automatic stuff...\r\n\t\t\t// const attractMode = new Attractor( application )\r\n\t\r\n\t\t\t// Show hackers message to debuggers\r\n\t\t\tif (debugMode)\r\n\t\t\t{\r\n\t\t\t\tconsole.log(`InterFACE Version ${VERSION} from ${getReferer()} in ${language} used ${application.count} times, last time was ${Math.ceil(application.timeElapsedSinceLastPlay/1000)} seconds ago`, {application, defaultOptions, referer:getReferer() } )\t\r\n\t\t\t\t// console.log(`Loaded App ${VERSION} ${needsInstall ? \"Installable\" : needsUpdate ? \"Update Available\" : \"\"}` )\t\r\n\t\t\t}\r\n\r\n\t\t}catch(error){\r\n\r\n\t\t\t// body.classList.add(\"failed\")\r\n\t\t\t//uninstall()\r\n\t\t\tshowError( error, \"Oh no! Try a hard refresh (CTRL-SHIFT-R)\", true )\r\n\t\t\tconsole.error(\"Ultimate failure - remove loading - add error class?\")\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// import {installer} from './install'\r\n// import {update}  from './update.js'\r\n// const test = async ()=>{\r\n// \tconst {installer} = await import('./install.js')\r\n// \tconst {update} = await import('./update.js')\r\n// \tconst destination = document.getElementById(\"shared-controls\")\r\n// \tconst install = await installer(true)\r\n// \tconst needsInstall = await install( destination )\t\t\r\n// \tconst needsUpdate = await update()\r\n// }\r\n// test()\r\n\r\nconst versionElement = document.getElementById(\"version\")\r\nconst runningVersion = versionElement.innerText\r\n\r\nconst checkPWAUpdates = () =>{\r\n\r\n\t// PWA Install / Update / Load from cache\r\n\t// needs to be run early on ideally and in a seperate thread\r\n\t// loads in the relevant data to determine if the app needs to be \r\n\t// updated if installed or installed if uninstalled\r\n\t\r\n\treturn installOrUpdate(debugMode, runningVersion).then( state => {\r\n\r\n\t\t// this is the amount of time to run before we \"check\" for things\r\n\t\t// const TIME_BEFORE_REFRESH = 24 * 60 * 60 * 1000\r\n\t\tif (debugMode)\r\n\t\t{\r\n\t\t\tconsole.log(\"TEST : Fetched install status\", {state, debugMode, runningVersion} )\r\n\t\t\tconsole.info( \"PWA\", state.log, {state} )\r\n\t\t}\r\n\r\n\t\t// add custom classes to elements so that we can \r\n\t\t// show a bit more useful feedback about the status of the web app\r\n\t\t// and whether it is installed / has updates available etc...\r\n\t\t// TODO: Add an update button!?\r\n\t\t\r\n\t\t// previousVersion, currentVersion,\r\n\t\t// isInstallable, isFirstRun, isRunningAsApp, install:(), updatesAvailable, updating, updated, update:()\r\n\r\n\t\t// add some useful classes to <body> element for styling\r\n\t\tbody.classList.toggle( \"updates-available\", state.hasUpdates )\r\n\t\tbody.classList.toggle( \"first-run\", state.isFirstRun )\r\n\t\tbody.classList.toggle( \"installable\", state.isInstallable )\r\n\t\tbody.classList.toggle( \"installed\", state.isRunningAsApp )\r\n\t\t\r\n\t\tif (state.isInstallable)\r\n\t\t{\r\n\t\t\t// hook into button and show...\r\n\t\t\tconst installButtons = document.querySelectorAll(\".button-install\")\r\n\t\t\tinstallButtons.forEach( installButton => {\r\n\t\t\t\tinstallButton.addEventListener(\"click\", async (event) => {\r\n\t\t\t\t\tconst installed = await state.install(installButton)\r\n\t\t\t\t\tconsole.log( \"installed\", installed.success, {installed} )\r\n\t\t\t\t\tsetToast( installed.success ? \"Installed to HomeScreen\" : \"You can always install again in the future\" )\r\n\t\t\t\t} )\r\n\t\t\t\t\r\n\t\t\t\t// find associated label if it exists...\r\n\t\t\t\tconst installButtonLabel = document.querySelectorAll(`label[for=\"${installButton.id}\"]`)\r\n\t\t\t\tinstallButtonLabel.hidden = false\r\n\t\t\t\tinstallButton.hidden = false\r\n\t\t\t})\r\n\t\t\r\n\t\t}else if(state.updatesAvailable){\r\n\r\n\t\t\tshowUpgradeDialog()\r\n\t\t}\r\n\r\n\t\t//setToast( canBeInstalled ? \"You can install this as an app...<br>Click install when prompted!\" : \"\" )\r\n\t\t\r\n\t}).catch ( error =>{ \r\n\r\n\t\tbody.classList.add( \"failed\" )\r\n\r\n\t\tconsole.error(\"Interface:PWA\",error) \r\n\t})\r\n}\r\n\r\n/**\r\n * DEPENDING ON HOW THIS APP IS RUNNING...\r\n * If it is a node based electron app, we want to hide the PWA stuff\r\n * otherwise it is super confusing, so we do a simple sniff and divert\r\n * \r\n * Check for app / web pwa updates\r\n */\r\nconst checkPlatformUpdates = async () => {\r\n\tif (capabilities.electron)\r\n\t{\r\n\t\t// TODO: ELECTRON update...\r\n\r\n\t}else if (capabilities.pwa){\r\n\t\t// we are running this as a PWA!\r\n\t\tawait checkPWAUpdates()\r\n\r\n\t}else if (capabilities.pwaPossible){\r\n\t\t// potential for it to be a webapp\r\n\t\tawait checkPWAUpdates()\r\n\r\n\t}else{\r\n\r\n\t\t// probably just a website that doesn't have \r\n\t\t// service workers enabled probably for security\r\n\t}\r\n\treturn start()\r\n}\r\n\r\n\r\n\r\n// add a special class to the app to frame it\r\nbody.classList.toggle( \"interface\", true)\r\n\r\n// we hang out here\r\ncheckPlatformUpdates().finally( ()=> {\r\n\tif (debugMode){\r\n\t\tconsole.log(\"Starting PhotoSynth v.\"+runningVersion )\r\n\t}\r\n})\r\n\r\n// Click and hold on the version for more info\r\nconst versionButton = document.getElementById( \"version\" )\r\naddMouseTapAndHoldEvents( versionButton )\r\nversionButton.addEventListener( MOUSE_TAP, event => {\r\n\t// allow pass through to github\r\n} )\r\n\r\nversionButton.addEventListener( MOUSE_HELD, event => {\r\n\t// Show dialog for upgrade?\r\n\tshowUpgradeDialog()\r\n\tevent.preventDefault()\r\n} )","/**\r\n * Convert a URL query value into a JS data type by inferring the type\r\n * @param {Any} JavaScript data type (eg. String, Number, Boolean, Array, Object)\r\n */\r\nconst guessType = value => {\r\n\r\n\tif (typeof value === \"string\")\r\n\t{\r\n\t\tconst lower = value.toLowerCase()\r\n\t\t// check for bool and such\r\n\t\tif (lower === \"true\" || lower === \"1\") {\r\n\t\t\treturn true\r\n\t\t} else if (lower === \"false\"|| lower === \"0\") {\r\n\t\t\treturn false\r\n\t\t}\r\n\r\n\t\treturn value\r\n\r\n\t}else if (Array.isArray(value)){\r\n\t\t// Array convert the array to a string?\r\n\t\t// convert booleans from 1 / 0 ?\r\n\t\treturn value.toString()\r\n\r\n    } else {\r\n\r\n\t\treturn data\r\n\t}\r\n}\r\n\r\n/**\r\n *  Convert a string into a JS data type by inferring the type\r\n * @param {Any} JavaScript data type (eg. String, Number, Boolean, Array, Object)\r\n */\r\nexport const parseType = value => {\r\n\r\n\t// check to see if the string is also an array...\r\n\tif (typeof value === \"string\")\r\n\t{\r\n\t\tif (!isNaN(parseFloat(value))) {\r\n\t\t\treturn parseFloat(value)\r\n\t\t} else if (value.toLowerCase() === \"true\") {\r\n\t\t\treturn true\r\n\t\t} else if (value === \"false\") {\r\n\t\t\treturn false\r\n\t\t}else if (value.indexOf(',') >= 0){\r\n\t\t\t// this is a comma seperated list array...\r\n\t\t\treturn convertIntegerArrayToBooleans( value.split(\",\") )\r\n\t\t} else {\r\n\t\t\treturn value\r\n\t\t}\r\n\r\n\t}else if (Array.isArray(value)){\r\n\t\t// Array convert the array to a string?\r\n\t\t// convert booleans from 1 / 0 ?\r\n\t\treturn value.toString()\r\n    } else {\r\n\t\t// God only knows\r\n        return value\r\n    }\r\n}\r\n\r\n/**\r\n *  Fetch the current URL query as an object\r\n * @returns {URLSearchParams} URL States\r\n */\r\n const fetchStateFromURL = () => {\r\n\treturn new URLSearchParams(window.location.search)\r\n}\r\n\r\n/**\r\n * This takes a snapshot of the url and takes and queries\r\n * then it will take apart and create an object\r\n * and return a merged subset\r\n * @returns {Object} URL State Object \r\n */\r\nexport const getLocationSettings = (defaultOptions) => {{\r\n\tconst urlParams = fetchStateFromURL()\r\n\tconst locationOptions = Object.assign( {}, defaultOptions )\r\n\tfor (const [key, value] of urlParams) \r\n\t{\r\n\t\t// NB. ensure we data type these\r\n\t\tlocationOptions[key] = guessType(value)\t\r\n\t\t// console.log(`${key}:${value}`)\r\n\t}\r\n\t//console.log(`query:${locationOptions}`)\r\n\treturn locationOptions\r\n}}\r\n\r\n/**\r\n * This takes a state and creates a URL query string\r\n * @returns {String} Query String with current state\r\n */\r\nexport const createQueryString = options => {\r\n\treturn new URLSearchParams(options).toString()\r\n}\r\n\r\n/**\r\n * This takes a snapshot of the url and queries\r\n * then it will take apart and create an object\r\n * and return a merged subset\r\n * @returns {String} URL with current state\r\n */\r\n export const getShareLink = (options) => {\r\n\treturn window.location + createQueryString(options)\r\n}\r\n\r\n/**\r\n * This attempts to determine where the user came from\r\n * and to create class names that can create custom versions\r\n * so long as they maintin their urls (ie. not use shortlinks)\r\n * @returns {String} Refering URL\r\n */\r\nexport const getReferer = () => {\r\n\tconst ref = document.referrer\r\n\t// check against our list\r\n\treturn ref || document.location || 'interface.place'\r\n}\r\n\r\n/**\r\n * This attempts to determine which domain the user came from\r\n * @returns {String} Refering hostname\r\n */\r\nexport const getRefererHostname = () => {\r\n\tconst referrer = new URL( getReferer() )\r\n\t// now strip out everything but the location\r\n\t// check against our list\r\n\treturn referrer.hostname\r\n}\r\n\r\n/**\r\n * \r\n * @returns {Array<String>} location path\r\n */\r\nexport const getEditionFromURL = () => {\r\n\tconst domain = new URL( document.location )\r\n\treturn domain.pathname.replace(\"/\",\"\").split(\"/\")\r\n}\r\n\r\n/**\r\n * Reload the current page with the current state or\r\n * optionally a new state to be merged\r\n * @param {Object} options New state to set on reload\r\n */\r\nexport const refresh = options => {\r\n\tif (options){\r\n\t\taddToHistory(options)\r\n\t}\r\n\twindow.location.reload()\r\n}\r\n\r\n/**\r\n * Reloads current page in secure mode (as cameras need a certificate)\r\n */\r\n export const forceSecure = (debug=false) => {\r\n\tif (!debug && location.hostname !== \"localhost\" && location.protocol !== 'https:')\r\n\t{\r\n\t\tlocation.protocol = 'https:'\r\n\t}\r\n\treturn false\r\n}\r\n\r\n/**\r\n * Changes options in the URL so that state survives refreshes\r\n * @param {Object} options New state to set on location\r\n * @param {String} title Optional history title\r\n */\r\nexport const addToHistory = (options, title=\"\") => {\r\n\tconst url = new URL(window.location)\r\n\tfor (let i in options){\r\n\t\tconst option = options[i]\r\n\t\turl.searchParams.set(i, option)\r\n\t\t//console.log(\"History\", {out, options, title, url} )\r\n\t}\r\n\t//\r\n\tconst out = window.history.pushState(options, title, url)\r\n\t//console.log(\"History\", {out, options, title, url} )\r\n}","exports.interopDefault = function (a) {\n  return a && a.__esModule ? a : {default: a};\n};\n\nexports.defineInteropFlag = function (a) {\n  Object.defineProperty(a, '__esModule', {value: true});\n};\n\nexports.exportAll = function (source, dest) {\n  Object.keys(source).forEach(function (key) {\n    if (key === 'default' || key === '__esModule' || dest.hasOwnProperty(key)) {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function () {\n        return source[key];\n      },\n    });\n  });\n\n  return dest;\n};\n\nexports.export = function (dest, destName, get) {\n  Object.defineProperty(dest, destName, {\n    enumerable: true,\n    get: get,\n  });\n};\n","\r\nconst doc = document\r\n\r\nlet loadDestination = 0\r\nlet loadMeter = -1\r\nlet loadMessageIndex = 0\r\nlet loadStartedAt = -1\r\n\r\nconst LOAD_MESSAGES = [\r\n\t\"Please wait, this can take<br>up to 6 minutes to load!\", \r\n\t\"Lots of data is required so this can take a long time\", \r\n\t\"Still Loading! Still may take a few minutes yet!\", \r\n\t\"Almost done! Just hang on in there!\"\r\n]\r\n\r\nconst BE_PATIENT_MESSAGES = [\r\n\t\"Loading.\",\r\n\t\"Loading..\",\r\n\t\"Loading...\"\r\n]\r\n\r\n// give each message one second to display\r\nconst TOTAL_LOAD_DURATION = LOAD_MESSAGES.length * 1000\r\n\r\nconst progressMessage = doc.querySelector('label[for=\"progress-bar\"]')\r\nconst progressBar = doc.querySelector('progress')\r\n\r\nlet requestFrame \r\nlet currentMessage = ''\r\nlet messageChangedAt = Date.now()\r\n\r\nconst getLoaderMessage = (timeAsProgress) => {\r\n\treturn LOAD_MESSAGES[ Math.floor(timeAsProgress * (LOAD_MESSAGES.length-1)) ] || BE_PATIENT_MESSAGES[0]\r\n}\r\n\r\nexport const setLoadProgress = (progress, message, complete=false) => {\r\n\r\n\tconst percentage = progress * 100\r\n\tconst rounded = parseInt(percentage)\r\n\tconst hasProgressed = loadMeter !== rounded\r\n\tconst RATE = 1\r\n\tconst now = Date.now()\r\n\r\n\tlet text = ''\r\n\r\n\t// we should store the time\r\n\tif (loadMeter < 0){\r\n\t\tloadStartedAt = now\r\n\t}\r\n\r\n\tconst timeElapsed = now - loadStartedAt\r\n\tconst timeAsProgress = timeElapsed / TOTAL_LOAD_DURATION\r\n\r\n\tif (hasProgressed)\r\n\t{\r\n\t\t// animate this...\r\n\t\tloadMeter = loadMeter < rounded ? \r\n\t\t\t\t\t\tloadMeter + RATE:\r\n\t\t\t\t\t\tloadMeter > rounded ? \r\n\t\t\t\t\t\t\tloadMeter - RATE:\r\n\t\t\t\t\t\t\tloadMeter\r\n\t}else{\r\n\t\t// complete so dont repeat\r\n\t\t//loadMeter = rounded\r\n\t}\r\n\t\r\n\tcancelAnimationFrame( requestFrame )\r\n\t\r\n\tconst timeSinceTextChanged = now - messageChangedAt\r\n\tconst progressAsPercent = loadMeter * 0.01\r\n\r\n\tprogressBar.parentNode.style.setProperty(\"--progress\", progressAsPercent )\r\n\tprogressBar.setAttribute(\"value\", progressAsPercent )\r\n\r\n\tif (complete && !hasProgressed)\r\n\t{\r\n\t\tprogressBar.parentNode.setAttribute(\"data-loaded\", true )\r\n\t}else{\r\n\t\tprogressBar.parentNode.setAttribute(\"data-loaded\", false )\r\n\t}\r\n\r\n\t// check to see if the message has changed\r\n\tif (rounded === 0 ) {\r\n\r\n\t\ttext = LOAD_MESSAGES[ 0 ]\t\r\n\r\n\t} else if (message && message.length && currentMessage !== message && timeSinceTextChanged < 900 ) {\r\n\t\t\r\n\t\t// use message but break lines?\r\n\t\t// append percentage\r\n\t\ttext = message\r\n\t\tmessageChangedAt = now\r\n\t\t// console.log(timeSinceTextChanged, \"Setting load message\", {currentMessage, message} )\r\n\r\n\t}else if (rounded === 100){\r\n\r\n\t\ttext = LOAD_MESSAGES[ LOAD_MESSAGES.length - 1 ]\t\r\n\r\n\t}else{\r\n\r\n\t\t// get prescripted from list...\r\n\t\ttext = getLoaderMessage(timeAsProgress)\r\n\t\tmessageChangedAt = now\r\n\t}\r\n\r\n\tif (!text){\r\n\r\n\t}\r\n\r\n\t// console.log(\"loading\", {timeSinceTextChanged, timeAsProgress, loadMeter, percentage, rounded, progress, message, text} )\r\n\t\r\n\ttext += \"<span class='load-percent'>\" + rounded + \"%</span>\"\r\n\t\r\n\t// text += BE_PATIENT_MESSAGES[loadMessageIndex++%(BE_PATIENT_MESSAGES.length-1)]\t\r\n\t\r\n\tif (progressMessage.innerHTML !== text)\r\n\t{\r\n\t// \t// only change label text not the input field too?\r\n\t// \tprogressMessage.innerHTML = text\r\n\r\n\t// }else if (hasProgressed){\r\n\r\n\t\t// add an extra message if it hasn't actually progressed?\r\n\t\tprogressMessage.innerHTML = text\r\n\t\tcurrentMessage = text\r\n\t}\r\n\r\n\r\n\r\n\tif (hasProgressed)\r\n\t{\r\n\t\trequestFrame = requestAnimationFrame( ()=>{\r\n\t\t\tsetLoadProgress(progress, message, complete)\r\n\t\t})\r\n\t}\r\n}\r\n\r\nexport const getLoadProgress = () => loadMeter\r\n","export const VERSION=\"0.17.0\";\rexport const DATE=1690388694005;","export const trimLocaleCode = locale => locale.split(/-|_/)[0]\r\n\r\nexport const getBrowserLocales = (options = {}) => {\r\n\t\r\n\tconst defaultOptions = {\r\n\t  languageCodeOnly: false,\r\n\t  fallback:'en-GB'\r\n\t}\r\n\r\n\tconst settings = Object.assign( {}, defaultOptions, options )\r\n\tconst browserLocales = navigator.languages === undefined ? [navigator.language] : navigator.languages\r\n  \r\n\t// we could assume english here but hey\r\n\tif (!browserLocales) \r\n\t{\r\n\t  return settings.fallback ? [settings.fallback] : undefined\r\n\t}\r\n  \r\n\treturn browserLocales.map(locale => {\r\n\t  const trimmedLocale = locale.trim()\r\n\t  return settings.languageCodeOnly ? trimLocaleCode(trimmedLocale) : trimmedLocale\r\n\t})\r\n  }\r\n\r\n  // TODO: Load pot files","import { INSTRUMENT_PACK_FATBOY, INSTRUMENT_PACK_FM, INSTRUMENT_PACK_MUSYNGKITE } from './audio/instruments'\r\nimport { DEFAULT_COLOURS } from './palette'\r\nimport { easeInSine, easeOutSine , easeInCubic, easeOutCubic, linear, easeOutQuad} from \"./maths/easing\"\r\n\r\nconst isDevelopmentMode = process.env.NODE_ENV === \"development\"\r\n\r\n// https://www.midi.org/specifications-old/item/manufacturer-id-numbers\r\nexport const MIDI_ID = \"00H 21H 71H\"\r\n\r\n\r\nexport const DEFAULT_TASKS_VISION_OPTIONS = {\r\n\t\r\n\t// runningMode: \"IMAGE\" | \"VIDEO\"\r\n\trunningMode:\"VIDEO\",\r\n\t\r\n\t// numFaces \tThe maximum number of faces that can be detected by the the FaceLandmarker. Smoothing is only applied when num_faces is set to 1. \tInteger > 0 \t1\r\n\tnumFaces: 2,\r\n\t\r\n\t// minFaceDetectionConfidence \tThe minimum confidence score for the face detection to be considered successful. \tFloat [0.0,1.0] \t0.5\r\n\t// minFacePresenceConfidence \tThe minimum confidence score of face presence score in the face landmark detection. \tFloat [0.0,1.0] \t0.5\r\n\t// minTrackingConfidence \tThe minimum confidence score for the face tracking to be considered successful. \tFloat [0.0,1.0] \t0.5\r\n\t\r\n\t// Whether Face Landmarker outputs face blendshapes. Face blendshapes are used for rendering the 3D face model. \tBoolean \tFalse\r\n\toutputFaceBlendshapes :true,\r\n\t\r\n\t// Whether FaceLandmarker outputs the facial transformation matrix.\r\n\t// FaceLandmarker uses the matrix to transform the face landmarks from \r\n\t// a canonical face model to the detected face, so users can apply \r\n\t// effects on the detected landmarks.\r\n\toutputFacialTransformationMatrixes: true\r\n}\r\n\r\nexport const DEFAULT_TENSORFLOW_OPTIONS = {\r\n\t\r\n\t// or 'tfjs' (mediapipe is far smoother and gives us handy annotations)\r\n\truntime: 'mediapipe', \r\n\t// runtime: 'tfjs', \r\n\r\n\t// location of actual ML model\r\n\t// solutionPath: 'https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh',\r\n\t// solutionPath: 'https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh',\r\n\tsolutionPath: './@mediapipe/',\r\n\r\n\t// maxFaces - The maximum number of faces detected in the input. Should be set to the minimum number for performance. Defaults to 10.\r\n\tmaxFaces:1,\r\n\t\r\n\t// Whether to load the MediaPipe iris detection model (an additional 2.6 MB of weights). The MediaPipe iris detection model provides (1) an additional 10 keypoints outlining the irises and (2) improved eye region keypoints enabling blink detection. Defaults to true.\r\n\t// shouldLoadIrisModel:true,\r\n\t\r\n\t// Minimum detection Confidence - Threshold for discarding a prediction. \r\n\t// [0 - 1] for a face to be considered detected\r\n    // detectionConfidence: 0.9,\r\n    \r\n    // Minimum confidence [0 - 1] for the landmark tracker to be considered detected\r\n    // Higher values are more robust at the expense of higher latency\r\n    // minTrackingConfidence: 0.5\r\n\r\n\t// maxContinuousChecks - How many frames to go without running the bounding box detector. Only relevant if maxFaces > 1. Defaults to 5.\r\n\t// iouThreshold - A float representing the threshold for deciding whether boxes overlap too much in non-maximum suppression. Must be between [0, 1]. Defaults to 0.3. A score of 0 means no overlapping faces will be detected, whereas a score closer to 1 means the model will attempt to detect completely overlapping faces.\r\n\t// scoreThreshold - A threshold for deciding when to remove boxes based on score in non-maximum suppression. Defaults to 0.75. Increase this score in order to reduce false positives (detects fewer faces).\r\n\t// modelUrl - Optional param for specifying a custom facemesh model url or a tf.io.IOHandler object.\r\n\t// irisModelUrl - Optional param for specifying a custom iris model url or a tf.io.IOHandler object.\r\n\r\n\t// send out normalised bits of face too\r\n\t// NB. this we handle ourselves\r\n\trefineLandmarks: true,\r\n\r\n\ttriangulateMesh: false,\r\n\r\n\tboundingBox: true,\r\n\r\n\tbackEnds:[\r\n\t\t// 'cpu',\r\n\t\t'wasm',\r\n\t\t'webgl'\r\n\t]\r\n\t,\r\n\t...DEFAULT_TASKS_VISION_OPTIONS\r\n}\r\n\r\nexport const DEFAULT_OPTIONS = {\r\n\t// this allows us to show some extra options if set to true...\r\n\tadvancedMode:true,\r\n\t// initially show the settings panel\r\n\tshowSettings:false,\r\n\t// overlaid screen keyboard\r\n\tshowPiano:false,\r\n\t// play a constant beat\r\n\tmetronome:false,\r\n\t// play music at same time\r\n\tbackingTrack:false,\r\n\r\n\t// clear the canvas on every frame\r\n\t// also doubles as a video hider\r\n\tclear:false,\r\n\t// draw video onto canvas every frame (transparent doesn't have to be true then)\r\n\t// clear will always take precedence\r\n\tsynch:true,\r\n\t// start in MTV disco mode\r\n\tdisco:false,\r\n\r\n\r\n\t// AR mode (without this - just video stream or blank)\r\n\toverlays:true,\r\n\r\n\t// show face overlays\r\n\tmasks:true,\r\n\t// show eye tracking\r\n\teyes:true,\r\n\t// synchronise the beats with metronome\r\n\tquantise:true,\r\n\t// show the person's texts above them\r\n\ttext:true,\r\n\t// audio visualiser is actually helpful to play\r\n\tspectrogram:true,\r\n\t// read out important instructions\r\n\tspeak:true,\r\n\t\r\n\t// show debug texts\r\n\tdebug:isDevelopmentMode,\r\n\t// cancel audio playback (not midi)\r\n\tmuted:false,\r\n\t// dual person mode (required reload)\r\n\tduet:false,\r\n\t\r\n\t// FIXME: monophonic?\r\n\tstereo:true,\r\n\r\n\t// stereo panning with eyes\r\n\tstereoPan:true,\r\n\r\n\t// midi channel (0/\"all\" means send to all)\r\n\tmidiChannel:\"all\",\r\n\t// saved BPM that can be shared?\r\n\tbpm:200,\r\n\t\r\n\t// hide menu if mouse outside of screen...\r\n\tautoHide:!isDevelopmentMode,\r\n\r\n\t// load a midi track automatically on app start\r\n\tloadMIDIPerformance:false,\r\n\r\n\t// allow game pads such as the xbox controller to do cool\r\n\t// stuff as a modifier for the audio\r\n\tuseGamePad:true,\r\n\t\r\n\t// choice of different models to use\r\n\tmodel:\"face\",\r\n\t// sample set\r\n\tinstrumentPack:INSTRUMENT_PACK_FATBOY,\r\n\tinstrumentPacks:[INSTRUMENT_PACK_FATBOY, INSTRUMENT_PACK_FM, INSTRUMENT_PACK_MUSYNGKITE].join(\",\"),\r\n\t// global mode that get's passed into person too\r\n\tphotoSensitive: window.matchMedia && window.matchMedia(\"(prefers-reduced-motion: reduce)\").matches || false\r\n}\r\n\r\n// For kid friendly versions with big eyes, no scary overlays and \r\n// simpler buttons and fewer controls and settings\r\nexport const KIDS_OPTIONS = {\r\n\t...DEFAULT_OPTIONS ,\r\n\tadvancedMode:false,\r\n\ttext:false,\r\n\tmasks:false,\r\n}\r\n\r\n// simpler buttons and fewer controls and settings\r\nexport const BODY_OPTIONS = {\r\n\t...DEFAULT_OPTIONS ,\r\n\t// model:'hand'\r\n\tbackingTrack:true\r\n}\r\n\r\n// simpler buttons and fewer controls and settings\r\nexport const DANCE_OPTIONS = {\r\n\t...DEFAULT_OPTIONS ,\r\n\t// model:'hand'\r\n\tinstrumentPack:INSTRUMENT_PACK_MUSYNGKITE,\r\n\tinstrumentPacks:[INSTRUMENT_PACK_MUSYNGKITE].join(\",\")\r\n}\r\n\r\n\r\n// NB. These must align with the button names\r\n// \t\tin the DOM when the app is launched\r\nexport const NAMES = ['a','b','c','d'].map( m => `person-${m}` )\r\n\r\nexport const getFactoryDefaults = ( options=DEFAULT_OPTIONS ) => Object.assign( {}, options )\r\n\r\nexport const getDomainDefaults = (name) => {\r\n\r\n\t// use the LTD \r\n\tswitch(name.split('.').pop().toLowerCase())\r\n\t{\r\n\t\t// localhost 127.0.0.(1)\r\n\t\t// case 'localhost': \r\n\t\t// case '1': return getFactoryDefaults(KIDS_OPTIONS)\r\n\t\t\r\n\t\tcase 'lol': return getFactoryDefaults(KIDS_OPTIONS)\r\n\t\tcase 'band': return getFactoryDefaults()\r\n\t\tcase 'dance': return getFactoryDefaults(DANCE_OPTIONS)\r\n\r\n\t\t// defaults to interface.place\r\n\t\tdefault: return getFactoryDefaults()\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\nexport const EYE_COLOURS = ['blue','green','brown','orange']\r\n\r\n\r\nexport const DEFAULT_VOICE_OPTIONS = {\r\n\tyaw:0, pitch:0, roll:0,\r\n\thue:90,\r\n\tlipPercentage:0,\r\n\teyeDirection:0,\r\n\toctave:4,\r\n\tnote:-1,\r\n\tnoteName:'',\r\n\tvolume:0,\r\n\tsinging:false,\r\n\tmouthOpen:false,\r\n\tactive:false\r\n}\r\n\r\nexport const DEFAULT_PERSON_OPTIONS = {\r\n\t...DEFAULT_COLOURS,\r\n\r\n\t// Passed to the delay node\r\n\t// NB. There is a global delay too remember\r\n\tuseDelay:false,\r\n\tdelayTime: 0.14,\r\n\tdelayLength: 10,\r\n\r\n\t// left / right ear stereo panning\r\n\tstereoPan:true,\r\n\r\n\tsendMIDI:true,\r\n\r\n\t// if you want the axis to be switched\r\n\tswapControls:false,\r\n\r\n\t// if the user has epilepsy, set to true\r\n\tphotoSensitive:false,\r\n\r\n\t// force draw face mesh\r\n\tdrawMesh:false,\r\n\t// force draw face blob nodes\r\n\tdrawNodes:true,\r\n\t// alternate between mesh and blobs depending on mouth\r\n\t// NB. The two above will override this behaviour\r\n\tmeshOnSing:false,\r\n\r\n\t// all the above can be disabled!\r\n\tdrawMask:true,\r\n\r\n\t// draw these parts over the mesh...\r\n\tdrawMouth:true,\r\n\t// kid mode turns eyes googly!\r\n\tdrawEyes:true,\r\n\t// extra controls\r\n\tdrawEyebrows:true,\r\n\r\n\t// ratios of size of eye\r\n\t// white bit\r\n\tscleraRadius:1,\r\n\t// blue bit\r\n\tirisRadius:0.8,\r\n\t// black bit\r\n\tpupilRadius:0.3,\r\n\t// frank sidebottom angle\r\n\teyeRatio:0.8,\r\n\r\n\t// mouse hold for clicking in seconds 0.5 and more feels weird\r\n\tmouseHoldDuration:0.4,\r\n\r\n\t// for how many pixels do you have to drag before it becomes a swipe?\r\n\tmouseGestureDistance:40,\r\n\r\n\t// if both eyes are closed for X ms do something...\r\n\teyeShutHolddDuration:3500, // ms\r\n\r\n\t// how much feedback to apply to the feedback node\r\n\tfeedback:0.1,\r\n\r\n\t// to adjust the angle that the head has to roll...\r\n\t// larger means less movement required\r\n\trollSensitivity:1.2,\r\n\r\n\t// to adjust the amount of pitching (head rocking)\r\n\t// depending on how complicated the piece is the octaves\r\n\t// can also be shifted between a certain range...\r\n\tpitchSensitivity:1,\r\n\r\n\t// size of the mouth to signal activity\r\n\tmouthCutOff:0.2,\r\n\r\n\t// size of the mouth to signal silence\r\n\tmouthSilence:0.05,\r\n\r\n\t// volume smooth rate = smaller means faster fades?\r\n\tvolumeRate:0.7,\r\n\r\n\t// Samples to use for the audio engine INSTRUMENT_PACKS[0]\r\n\t//instrumentPack:INSTRUMENT_PACK_MUSYNGKITE,\r\n\tinstrumentPack:INSTRUMENT_PACK_MUSYNGKITE,\r\n\r\n\t// this is the amount of decimal places used to smooth the mouth\r\n\t// the higher the number the less smooth the output is\r\n\t// 1 or 2 should be more than enough\r\n\tprecision:3,\r\n\r\n\t// set this to one of the interpolation methods above\r\n\t// IN means that it starts off slowly (prefered)\r\n\tease:easeInSine // easeInSine // linear\r\n}","import { GENERAL_MIDI_INSTRUMENTS, FAMILY_DICTIONARY } from \"./midi/general-midi\"\r\n// '𝄞',\r\nexport const MUSICAL_NOTES = ['♫','𝅗𝅥','𝅘𝅥','𝅘𝅥𝅮','𝅘𝅥𝅯','𝅘𝅥𝅰','𝅘𝅥𝅱','𝅘𝅥𝅲']\r\n\r\nexport const INSTRUMENT_PACK_FM = \"FluidR3_GM\"\r\nexport const INSTRUMENT_PACK_FATBOY = \"FatBoy\"\r\nexport const INSTRUMENT_PACK_MUSYNGKITE = \"MusyngKite\"\r\nexport const INSTRUMENT_PACKS = [INSTRUMENT_PACK_FM, INSTRUMENT_PACK_FATBOY]\r\n\r\n// NB. These are actually General MIDI instrument names\r\n// but we can't use them as certain folders are misnamed\r\nexport const DEFAULT_FOLDERS = [\r\n\t\"acoustic_grand_piano\",\r\n\t\"bright_acoustic_piano\",\r\n\t\"electric_grand_piano\",\r\n\t\"honkytonk_piano\",\r\n\t\"electric_piano_1\",\r\n\t\"electric_piano_2\",\r\n\t\"harpsichord\",\r\n\t\"clavinet\",\r\n\t\"celesta\",\r\n\t\"glockenspiel\",\r\n\t\"music_box\",\r\n\t\"vibraphone\",\r\n\t\"marimba\",\r\n\t\"xylophone\",\r\n\t\"tubular_bells\",\r\n\t\"dulcimer\",\r\n\t\"drawbar_organ\",\r\n\t\"percussive_organ\",\r\n\t\"rock_organ\",\r\n\t\"church_organ\",\r\n\t\"reed_organ\",\r\n\t\"accordion\",\r\n\t\"harmonica\",\r\n\t\"tango_accordion\",\r\n\t\"acoustic_guitar_nylon\",\r\n\t\"acoustic_guitar_steel\",\r\n\t\"electric_guitar_jazz\",\r\n\t\"electric_guitar_clean\",\r\n\t\"electric_guitar_muted\",\r\n\t\"overdriven_guitar\",\r\n\t\"distortion_guitar\",\r\n\t\"guitar_harmonics\",\r\n\t\"acoustic_bass\",\r\n\t\"electric_bass_finger\",\r\n\t\"electric_bass_pick\",\r\n\t\"fretless_bass\",\r\n\t\"slap_bass_1\",\r\n\t\"slap_bass_2\",\r\n\t\"synth_bass_1\",\r\n\t\"synth_bass_2\",\r\n\t\"violin\",\r\n\t\"viola\",\r\n\t\"cello\",\r\n\t\"contrabass\",\r\n\t\"tremolo_strings\",\r\n\t\"pizzicato_strings\",\r\n\t\"orchestral_harp\",\r\n\t\"timpani\",\r\n\t\"string_ensemble_1\",\r\n\t\"string_ensemble_2\",\r\n\t\"synth_strings_1\",\r\n\t\"synth_strings_2\",\r\n\t\"choir_aahs\",\r\n\t\"voice_oohs\",\r\n\t\"synth_choir\",\r\n\t\"orchestra_hit\",\r\n\t\"trumpet\",\r\n\t\"trombone\",\r\n\t\"tuba\",\r\n\t\"muted_trumpet\",\r\n\t\"french_horn\",\r\n\t\"brass_section\",\r\n\t\"synth_brass_1\",\r\n\t\"synth_brass_2\",\r\n\t\"soprano_sax\",\r\n\t\"alto_sax\",\r\n\t\"tenor_sax\",\r\n\t\"baritone_sax\",\r\n\t\"oboe\",\r\n\t\"english_horn\",\r\n\t\"bassoon\",\r\n\t\"clarinet\",\r\n\t\"piccolo\",\r\n\t\"flute\",\r\n\t\"recorder\",\r\n\t\"pan_flute\",\r\n\t\"blown_bottle\",\r\n\t\"shakuhachi\",\r\n\t\"whistle\",\r\n\t\"ocarina\",\r\n\t\"lead_1_square\",\r\n\t\"lead_2_sawtooth\",\r\n\t\"lead_3_calliope\",\r\n\t\"lead_4_chiff\",\r\n\t\"lead_5_charang\",\r\n\t\"lead_6_voice\",\r\n\t\"lead_7_fifths\",\r\n\t\"lead_8_bass__lead\",\r\n\t\"pad_1_new_age\",\r\n\t\"pad_2_warm\",\r\n\t\"pad_3_polysynth\",\r\n\t\"pad_4_choir\",\r\n\t\"pad_5_bowed\",\r\n\t\"pad_6_metallic\",\r\n\t\"pad_7_halo\",\r\n\t\"pad_8_sweep\",\r\n\t\"fx_1_rain\",\r\n\t\"fx_2_soundtrack\",\r\n\t\"fx_3_crystal\",\r\n\t\"fx_4_atmosphere\",\r\n\t\"fx_5_brightness\",\r\n\t\"fx_6_goblins\",\r\n\t\"fx_7_echoes\",\r\n\t\"fx_8_scifi\",\r\n\t\"sitar\",\r\n\t\"banjo\",\r\n\t\"shamisen\",\r\n\t\"koto\",\r\n\t\"kalimba\",\r\n\t\"bagpipe\",\r\n\t\"fiddle\",\r\n\t\"shanai\",\r\n\t\"tinkle_bell\",\r\n\t\"agogo\",\r\n\t\"steel_drums\",\r\n\t\"woodblock\",\r\n\t\"taiko_drum\",\r\n\t\"melodic_tom\",\r\n\t\"synth_drum\",\r\n\t\"reverse_cymbal\",\r\n\t\"guitar_fret_noise\",\r\n\t\"breath_noise\",\r\n\t\"seashore\",\r\n\t\"bird_tweet\",\r\n\t\"telephone_ring\",\r\n\t\"helicopter\",\r\n\t\"applause\",\r\n\t\"gunshot\"\r\n]\r\n\r\n// actual instrument folder names\r\nexport let instrumentFolders = DEFAULT_FOLDERS.map( instrumentFolder => instrumentFolder+`-mp3`)\r\n// nice names for the above\r\nexport let instrumentNames = instrumentFolders.map( (instrument, index) => GENERAL_MIDI_INSTRUMENTS[index] )\r\n\r\n// combine those 2 together\r\nconst TITLE_DICTIONARY = {}\r\ninstrumentFolders.forEach( (name,index) => TITLE_DICTIONARY[name] = instrumentNames[index] )\r\n\r\n\r\n\r\n\r\n/**\r\n * Fetch a random instrument name\r\n * @returns {String} Instrument Name\r\n */\r\n export const getRandomInstrument = () => instrumentFolders[ Math.floor( Math.random() * instrumentFolders.length ) ]\r\n\r\n\r\n/**\r\n * Find the family for this instrument\r\n * @param {String} instrumentName - name of the instrument\r\n * @returns \r\n */\r\nexport const getInstrumentFamily = instrumentName => FAMILY_DICTIONARY[instrumentName]\r\n\r\n/**\r\n * \r\n * @param {*} instrumentName \r\n * @returns \r\n */\r\nexport const getInstrumentTitle = instrumentName => TITLE_DICTIONARY[instrumentName]\r\n\r\n\r\n/**\r\n * Create an Object of all instruments and folders -\r\n * useful for debugging and understanding connections\r\n * but also used in the side bar for each user\r\n * @returns \r\n */\r\nexport const createInstruments = () => DEFAULT_FOLDERS.map( (folder, index) => {\r\n\t\tconst name = GENERAL_MIDI_INSTRUMENTS[index]\r\n\t\tconst family = FAMILY_DICTIONARY[name]\r\n\t\tconst location = instrumentFolders[index]\r\n\t\treturn {\r\n\t\t\tfolder,\r\n\t\t\tname,\r\n\t\t\tfamily,\r\n\t\t\tlocation\r\n\t\t}\r\n\t}\r\n)\r\n\r\n// TODO: Which of these are loops?\r\n// export const LOOPS = []\r\n// export const SINGLE_SHOTS = []\r\n\r\nexport const instrumentCache = {}\r\nexport const fetchInstrument = (name) =>{\r\n\t\r\n\t// FIXME: Create if it doesn't exist?\r\n\treturn instrumentCache[name]\r\n}\r\n\r\nexport const storeInstrument = (name,data) => {\r\n\tinstrumentCache[name] = data\r\n}\r\n\r\nconst createPack = (packs, format=\"mp3\") => {\r\n\treturn packs.map( (instrument, i) => {\r\n\t\tconst formatted = `${instrument}-${format}`\r\n\t\tinstrumentFolders[i] =formatted\r\n\t\t// FIXME: May not always align...\r\n\t\tinstrumentNames[i] = GENERAL_MIDI_INSTRUMENTS[i]\r\n\t\treturn formatted\r\n\t})\r\n}\r\n\r\n/**\r\n * Load an Data pack from specified JSON file\r\n * @param {String} packName \r\n * @returns \r\n */\r\n// This is a way to load in a collection of files from json\r\nexport const loadInstrumentDataPack = async ( packName='musyng.json', format=\"mp3\" ) => {\r\n\tconst url = `./assets/audio/${packName}`\r\n\ttry{\r\n\t\tconst request = await fetch( url )\r\n\t\tconst packs = await request.json()\r\n\t\treturn createPack( packs, format )\r\n\t}catch(error){\r\n\t\treturn []\r\n\t}\t\r\n}\r\n\r\n// FIXME: Remove this!\r\nexport const getFolderNameForInstrument = name => {\r\n\tlet index = instrumentFolders.indexOf(name)\r\n\tif (index === -1){\r\n\t\tindex = instrumentNames.indexOf(name)\r\n\t}\r\n\treturn instrumentFolders[index]\r\n}","// [General MIDI Instrument Patch Map](https://www.midi.org/specifications/item/gm-level-1-sound-set)\r\n// [General MIDI Instrument Patch Map](http://cs.uccs.edu/~cs525/midi/midi.html)\r\n/*\r\nGeneral MIDI Level 1 Instrument Families\r\n\r\nThe General MIDI Level 1 instrument sounds are grouped by families.\r\nIn each family are 8 specific instruments.\r\n\r\nPC# \tFamily Name\r\n1-8 \tPiano\r\n9-16 \tChromatic Percussion\r\n17-24 \tOrgan\r\n25-32 \tGuitar\r\n33-40 \tBass\r\n41-48 \tStrings\r\n49-56 \tEnsemble\r\n57-64 \tBrass\r\n65-72 \tReed\r\n73-80 \tPipe\r\n81-88 \tSynth Lead\r\n89-96 \tSynth Pad\r\n97-104 \tSynth Effects\r\n105-112 Ethnic\r\n113-120 Percussive\r\n121-128 Sound Effects\r\n\r\nOn MIDI Channel 10, each MIDI Note number (\"Key#\") corresponds to a different drum sound, as shown below.\r\nGM-compatible instruments must have the sounds on the keys shown here.\r\n\r\nWhile many current instruments also have additional sounds above or below the range show here,\r\nand may even have additional \"kits\" with variations of these sounds, only these sounds are supported\r\nby General MIDI Level 1 devices.\r\n\r\n*/\r\nexport const GENERAL_MIDI_INSTRUMENTS = [\r\n\t\"acoustic grand piano\",\r\n\t\"bright acoustic piano\",\r\n\t\"electric grand piano\",\r\n\t\"honky-tonk piano\",\r\n\t\"electric piano 1\",\r\n\t\"electric piano 2\",\r\n\t\"harpsichord\",\r\n\t\"clavi\",\r\n\t\"celesta\",\r\n\t\"glockenspiel\",\r\n\t\"music box\",\r\n\t\"vibraphone\",\r\n\t\"marimba\",\r\n\t\"xylophone\",\r\n\t\"tubular bells\",\r\n\t\"dulcimer\",\r\n\t\"drawbar organ\",\r\n\t\"percussive organ\",\r\n\t\"rock organ\",\r\n\t\"church organ\",\r\n\t\"reed organ\",\r\n\t\"accordion\",\r\n\t\"harmonica\",\r\n\t\"tango accordion\",\r\n\t\"acoustic guitar (nylon)\",\r\n\t\"acoustic guitar (steel)\",\r\n\t\"electric guitar (jazz)\",\r\n\t\"electric guitar (clean)\",\r\n\t\"electric guitar (muted)\",\r\n\t\"overdriven guitar\",\r\n\t\"distortion guitar\",\r\n\t\"guitar harmonics\",\r\n\t\"acoustic bass\",\r\n\t\"electric bass (finger)\",\r\n\t\"electric bass (pick)\",\r\n\t\"fretless bass\",\r\n\t\"slap bass 1\",\r\n\t\"slap bass 2\",\r\n\t\"synth bass 1\",\r\n\t\"synth bass 2\",\r\n\t\"violin\",\r\n\t\"viola\",\r\n\t\"cello\",\r\n\t\"contrabass\",\r\n\t\"tremolo strings\",\r\n\t\"pizzicato strings\",\r\n\t\"orchestral harp\",\r\n\t\"timpani\",\r\n\t\"string ensemble 1\",\r\n\t\"string ensemble 2\",\r\n\t\"synthstrings 1\",\r\n\t\"synthstrings 2\",\r\n\t\"choir aahs\",\r\n\t\"voice oohs\",\r\n\t\"synth voice\",\r\n\t\"orchestra hit\",\r\n\t\"trumpet\",\r\n\t\"trombone\",\r\n\t\"tuba\",\r\n\t\"muted trumpet\",\r\n\t\"french horn\",\r\n\t\"brass section\",\r\n\t\"synthbrass 1\",\r\n\t\"synthbrass 2\",\r\n\t\"soprano sax\",\r\n\t\"alto sax\",\r\n\t\"tenor sax\",\r\n\t\"baritone sax\",\r\n\t\"oboe\",\r\n\t\"english horn\",\r\n\t\"bassoon\",\r\n\t\"clarinet\",\r\n\t\"piccolo\",\r\n\t\"flute\",\r\n\t\"recorder\",\r\n\t\"pan flute\",\r\n\t\"blown bottle\",\r\n\t\"shakuhachi\",\r\n\t\"whistle\",\r\n\t\"ocarina\",\r\n\t\"lead 1 (square)\",\r\n\t\"lead 2 (sawtooth)\",\r\n\t\"lead 3 (calliope)\",\r\n\t\"lead 4 (chiff)\",\r\n\t\"lead 5 (charang)\",\r\n\t\"lead 6 (voice)\",\r\n\t\"lead 7 (fifths)\",\r\n\t\"lead 8 (bass + lead)\",\r\n\t\"pad 1 (new age)\",\r\n\t\"pad 2 (warm)\",\r\n\t\"pad 3 (polysynth)\",\r\n\t\"pad 4 (choir)\",\r\n\t\"pad 5 (bowed)\",\r\n\t\"pad 6 (metallic)\",\r\n\t\"pad 7 (halo)\",\r\n\t\"pad 8 (sweep)\",\r\n\t\"fx 1 (rain)\",\r\n\t\"fx 2 (soundtrack)\",\r\n\t\"fx 3 (crystal)\",\r\n\t\"fx 4 (atmosphere)\",\r\n\t\"fx 5 (brightness)\",\r\n\t\"fx 6 (goblins)\",\r\n\t\"fx 7 (echoes)\",\r\n\t\"fx 8 (sci-fi)\",\r\n\t\"sitar\",\r\n\t\"banjo\",\r\n\t\"shamisen\",\r\n\t\"koto\",\r\n\t\"kalimba\",\r\n\t\"bag pipe\",\r\n\t\"fiddle\",\r\n\t\"shanai\",\r\n\t\"tinkle bell\",\r\n\t\"agogo\",\r\n\t\"steel drums\",\r\n\t\"woodblock\",\r\n\t\"taiko drum\",\r\n\t\"melodic tom\",\r\n\t\"synth drum\",\r\n\t\"reverse cymbal\",\r\n\t\"guitar fret noise\",\r\n\t\"breath noise\",\r\n\t\"seashore\",\r\n\t\"bird tweet\",\r\n\t\"telephone ring\",\r\n\t\"helicopter\",\r\n\t\"applause\",\r\n\t\"gunshot\",\r\n]\r\n\r\nexport const GENERAL_MIDI_INSTRUMENT_FAMILY_NAMES = [\r\n\t\"piano\",\r\n\t\"chromatic percussion\",\r\n\t\"organ\",\r\n\t\"guitar\",\r\n\t\"bass\",\r\n\t\"strings\",\r\n\t\"ensemble\",\r\n\t\"brass\",\r\n\t\"reed\",\r\n\t\"pipe\",\r\n\t\"synth lead\",\r\n\t\"synth pad\",\r\n\t\"synth effects\",\r\n\t\"ethnic\",\r\n\t\"percussive\",\r\n\t\"sound effects\",\r\n]\r\n\r\nexport const GENERAL_MIDI_INSTRUMENT_FAMILY_IDS = {\r\n\t0: \"piano\",\r\n\t7: \"chromatic percussion\",\r\n\t12: \"organ\",\r\n\t25: \"guitar\",\r\n\t33: \"bass\",\r\n\t41: \"strings\",\r\n\t49: \"ensemble\",\r\n\t57: \"brass\",\r\n\t65: \"reed\",\r\n\t69: \"pipe\",\r\n\t81: \"synth lead\",\r\n\t89: \"synth pad\",\r\n\t97: \"synth effects\",\r\n\t// some rasict shit right here akin to \"world\" music\r\n\t105: \"ethnic\",\r\n\t113: \"percussive\",\r\n\t123: \"sound effects\"\r\n}\r\n\r\nexport const GENERAL_MIDI_FAMILIES = new Map()\r\n\r\n// This creates a Map of instument arrays\r\nexport const GENERAL_MIDI_INSTRUMENT_FAMILIES = {}\r\n\r\nexport const FAMILY_DICTIONARY = {}\r\nlet latch = GENERAL_MIDI_INSTRUMENT_FAMILY_IDS[0]\r\nGENERAL_MIDI_INSTRUMENTS.forEach( (instrument, index) => {\r\n\t\r\n\tif (GENERAL_MIDI_INSTRUMENT_FAMILY_IDS[index])\r\n\t{\r\n\t\tlatch = GENERAL_MIDI_INSTRUMENT_FAMILY_IDS[index]\r\n\t}\r\n\t// GENERAL_MIDI_INSTRUMENT_FAMILY_IDS[index]\r\n\tGENERAL_MIDI_FAMILIES.set( latch, [...(GENERAL_MIDI_FAMILIES.get(latch) || []), instrument] )\r\n\tFAMILY_DICTIONARY[instrument] = latch\r\n})\r\n\r\n\r\nexport const DrumKitByPatchID = {\r\n\t 0: \"standard kit\",\r\n\t 8: \"room kit\",\r\n\t16: \"power kit\",\r\n\t24: \"electronic kit\",\r\n\t25: \"tr-808 kit\",\r\n\t32: \"jazz kit\",\r\n\t40: \"brush kit\",\r\n\t48: \"orchestra kit\",\r\n\t56: \"sound fx kit\",\r\n}\r\n\r\n/*\r\n\r\nChannel 10 Drum sounds (overwrites the noteNumber)\r\n\r\nDrum Sound - 35\r\nAcoustic Bass Drum - 36\r\nBass Drum 1 - 37\r\nSide Stick 38 \r\nAcoustic Snare - 39\r\nHand Clap 40\r\nElectric Snare 41\r\nLow Floor Tom 42\r\nClosed Hi Hat 43\r\nHigh Floor Tom 44\r\nPedal Hi-Hat 45\r\nLow Tom 46\r\nOpen Hi-Hat 47\r\nLow-Mid Tom 48\r\nHi-Mid Tom 49\r\nCrash Cymbal 1 50\r\nHigh Tom 51\r\nRide Cymbal 1 52\r\nChinese Cymbal 53\r\nRide Bell 54\r\nTambourine 55\r\nSplash Cymbal 56\r\nCowbell 57\r\nCrash Cymbal 2 58\r\nVibraslap 59\r\nRide Cymbal 2 60\r\nHi Bongo 61\r\nLow Bongo 62\r\nMute Hi Conga 63\r\nOpen Hi Conga 64\r\nLow Conga 65\r\nHigh Timbale 66\r\nLow Timbale 67\r\nHigh Agogo 68\r\nLow Agogo 69\r\nCabasa 70\r\nMaracas 71\r\nShort Whistle \r\n72\r\nLong Whistle \r\n73\r\nShort Guiro \r\n74\r\nLong Guiro \r\n75\r\nClaves\r\n76\r\nHi Wood Block\r\n77\r\nLow Wood Block\r\n78\r\nMute Cuica\r\n79\r\nOpen Cuica\r\n80\r\nMute Triangle\r\n81\r\nOpen Triangle\r\n*/","const PALETTE = {\r\n\twhite:\"hsl(22, 28%, 87%)\",\r\n\tdark:\"hsl(30, 6%, 14%)\",\r\n\tgrey:\"hsl(11, 6%, 50%)\",\r\n\tcream:\"hsl(27, 30%, 45%)\",\r\n\tbrown:\"hsl(23, 22%, 30%)\",\r\n\tblue:\"hsl(196, 18%, 33%)\",\r\n\tgreen:\"hsl(56, 18%, 33%)\",\r\n\tyellow:\"hsl(56, 18%, 33%)\",\r\n\torange:\"hsl(28, 69%, 38%)\",\r\n\tred:\"hsl(9, 58%, 35%)\"\r\n}\r\n\r\nexport const DEFAULT_COLOURS = {\r\n\t// 0->hueRange\r\n\thue:90,\r\n\t// percentages\r\n\tsaturation:80,\r\n\t// used to create white mode / black mode and greyscale modes\r\n\tluminosity:50,\r\n\t// 0->360\r\n\thueRange:360,\r\n\t// dots hue? still used?\r\n\tdots:60,\r\n\tmouth:'rgba(255,0,0,0.5)',\r\n\tmouthClosed:'rgba(255,0,0,0.2)',\r\n\tlipsUpperInner:'pink',\r\n\tlipsLowerInner:'pink',\r\n\tmidwayBetweenEyes:'blue',\r\n\tleftEyeLower0:'red',\r\n\trightEyeLower0:'red',\r\n\tleftEyeIris:'yellow',\r\n\trightEyeIris:'yellow',\r\n}\r\n\r\n// Dami kim special mode\r\nexport const DAMI_KIM_COLOURS = { ...DEFAULT_COLOURS }\r\n\r\n// Simpler colour scheme\r\nexport const PASTEL_COLOURS = { ... DEFAULT_COLOURS }\r\n\r\nexport default PALETTE","// Based on https://gist.github.com/gre/1650294\r\n\r\n// No easing, no acceleration\r\nexport const linear = t => t\r\n\r\n// Slight acceleration from zero to full speed\r\nexport const easeInSine = t  => -1 * Math.cos( t * ( Math.PI / 2 ) ) + 1\r\n\r\n// Slight deceleration at the end\r\nexport function easeOutSine( t ) {\r\n    return Math.sin( t * ( Math.PI / 2 ) )\r\n}\r\n\r\n// Slight acceleration at beginning and slight deceleration at end\r\nexport function easeInOutSine( t ) {\r\n    return -0.5 * ( Math.cos( Math.PI * t ) - 1 )\r\n}\r\n\r\n// Accelerating from zero velocity\r\nexport function easeInQuad( t ) {\r\n    return t * t\r\n}\r\n\r\n// Decelerating to zero velocity\r\nexport function easeOutQuad( t ) {\r\n    return t * ( 2 - t )\r\n}\r\n\r\n// Acceleration until halfway, then deceleration\r\nexport function easeInOutQuad( t ) {\r\n    return t < 0.5 ? 2 * t * t : - 1 + ( 4 - 2 * t ) * t\r\n}\r\n\r\n// Accelerating from zero velocity\r\nexport function easeInCubic( t ) {\r\n    return t * t * t\r\n}\r\n\r\n// Decelerating to zero velocity\r\nexport function easeOutCubic( t ) {\r\n    const t1 = t - 1\r\n    return t1 * t1 * t1 + 1\r\n}\r\n\r\n// Acceleration until halfway, then deceleration\r\nexport function easeInOutCubic( t ) {\r\n    return t < 0.5 ? 4 * t * t * t : ( t - 1 ) * ( 2 * t - 2 ) * ( 2 * t - 2 ) + 1\r\n}\r\n\r\n// Accelerating from zero velocity\r\nexport function easeInQuart( t ) {\r\n    return t * t * t * t\r\n}\r\n\r\n// Decelerating to zero velocity\r\nexport function easeOutQuart( t ) {\r\n    const t1 = t - 1\r\n    return 1 - t1 * t1 * t1 * t1\r\n}\r\n\r\n// Acceleration until halfway, then deceleration\r\nexport function easeInOutQuart( t ) {\r\n    const t1 = t - 1\r\n    return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * t1 * t1 * t1 * t1\r\n}\r\n\r\n// Accelerating from zero velocity\r\nexport function easeInQuint( t ) {\r\n    return t * t * t * t * t\r\n}\r\n\r\n// Decelerating to zero velocity\r\nexport function easeOutQuint( t ) {\r\n    const t1 = t - 1\r\n    return 1 + t1 * t1 * t1 * t1 * t1\r\n}\r\n\r\n// Acceleration until halfway, then deceleration\r\nexport function easeInOutQuint( t ) {\r\n    const t1 = t - 1\r\n    return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * t1 * t1 * t1 * t1 * t1\r\n}\r\n\r\n// Accelerate exponentially until finish\r\nexport function easeInExpo( t ) {\r\n\r\n    if( t === 0 ) {\r\n        return 0\r\n    }\r\n\r\n    return Math.pow( 2, 10 * ( t - 1 ) )\r\n\r\n}\r\n\r\n// Initial exponential acceleration slowing to stop\r\nexport function easeOutExpo( t ) {\r\n\r\n    if( t === 1 ) {\r\n        return 1\r\n    }\r\n\r\n    return ( -Math.pow( 2, -10 * t ) + 1 )\r\n\r\n}\r\n\r\n// Exponential acceleration and deceleration\r\nexport function easeInOutExpo( t ) {\r\n    \r\n    if( t === 0 || t === 1 ) {\r\n        return t\r\n    }\r\n\r\n    const scaledTime = t * 2\r\n    const scaledTime1 = scaledTime - 1\r\n\r\n    if( scaledTime < 1 ) {\r\n        return 0.5 * Math.pow( 2, 10 * ( scaledTime1 ) )\r\n    }\r\n\r\n    return 0.5 * ( -Math.pow( 2, -10 * scaledTime1 ) + 2 )\r\n\r\n}\r\n\r\n// Increasing velocity until stop\r\nexport function easeInCirc( t ) {\r\n\r\n    const scaledTime = t / 1\r\n    return -1 * ( Math.sqrt( 1 - scaledTime * t ) - 1 )\r\n\r\n}\r\n\r\n// Start fast, decreasing velocity until stop\r\nexport function easeOutCirc( t ) {\r\n\r\n    const t1 = t - 1\r\n    return Math.sqrt( 1 - t1 * t1 )\r\n\r\n}\r\n\r\n// Fast increase in velocity, fast decrease in velocity\r\nexport function easeInOutCirc( t ) {\r\n\r\n    const scaledTime = t * 2\r\n    const scaledTime1 = scaledTime - 2\r\n\r\n    if( scaledTime < 1 ) {\r\n        return -0.5 * ( Math.sqrt( 1 - scaledTime * scaledTime ) - 1 )\r\n    }\r\n\r\n    return 0.5 * ( Math.sqrt( 1 - scaledTime1 * scaledTime1 ) + 1 )\r\n\r\n}\r\n\r\n// Slow movement backwards then fast snap to finish\r\nexport function easeInBack( t, magnitude = 1.70158 ) {\r\n\r\n    return t * t * ( ( magnitude + 1 ) * t - magnitude )\r\n\r\n}\r\n\r\n// Fast snap to backwards point then slow resolve to finish\r\nexport function easeOutBack( t, magnitude = 1.70158 ) {\r\n\r\n    const scaledTime = ( t / 1 ) - 1\r\n    \r\n    return (\r\n        scaledTime * scaledTime * ( ( magnitude + 1 ) * scaledTime + magnitude )\r\n    ) + 1\r\n\r\n}\r\n\r\n// Slow movement backwards, fast snap to past finish, slow resolve to finish\r\nexport function easeInOutBack( t, magnitude = 1.70158 ) {\r\n\r\n    const scaledTime = t * 2\r\n    const scaledTime2 = scaledTime - 2\r\n\r\n    const s = magnitude * 1.525\r\n\r\n    if( scaledTime < 1) {\r\n\r\n        return 0.5 * scaledTime * scaledTime * (\r\n            ( ( s + 1 ) * scaledTime ) - s\r\n        )\r\n\r\n    }\r\n\r\n    return 0.5 * (\r\n        scaledTime2 * scaledTime2 * ( ( s + 1 ) * scaledTime2 + s ) + 2\r\n    )\r\n\r\n}\r\n// Bounces slowly then quickly to finish\r\nexport function easeInElastic( t, magnitude = 0.7 ) {\r\n\r\n    if( t === 0 || t === 1 ) {\r\n        return t\r\n    }\r\n\r\n    const scaledTime = t / 1\r\n    const scaledTime1 = scaledTime - 1\r\n\r\n    const p = 1 - magnitude\r\n    const s = p / ( 2 * Math.PI ) * Math.asin( 1 )\r\n\r\n    return -(\r\n        Math.pow( 2, 10 * scaledTime1 ) *\r\n        Math.sin( ( scaledTime1 - s ) * ( 2 * Math.PI ) / p )\r\n    )\r\n\r\n}\r\n\r\n// Fast acceleration, bounces to zero\r\nexport function easeOutElastic( t, magnitude = 0.7 ) {\r\n\r\n    const p = 1 - magnitude\r\n    const scaledTime = t * 2\r\n\r\n    if( t === 0 || t === 1 ) {\r\n        return t\r\n    }\r\n\r\n    const s = p / ( 2 * Math.PI ) * Math.asin( 1 )\r\n    return (\r\n        Math.pow( 2, -10 * scaledTime ) *\r\n        Math.sin( ( scaledTime - s ) * ( 2 * Math.PI ) / p )\r\n    ) + 1\r\n\r\n}\r\n\r\n// Slow start and end, two bounces sandwich a fast motion\r\nexport function easeInOutElastic( t, magnitude = 0.65 ) {\r\n\r\n    const p = 1 - magnitude\r\n\r\n    if( t === 0 || t === 1 ) {\r\n        return t\r\n    }\r\n\r\n    const scaledTime = t * 2\r\n    const scaledTime1 = scaledTime - 1\r\n    \r\n    const s = p / ( 2 * Math.PI ) * Math.asin( 1 )\r\n\r\n    if( scaledTime < 1 ) {\r\n        return -0.5 * (\r\n            Math.pow( 2, 10 * scaledTime1 ) *\r\n            Math.sin( ( scaledTime1 - s ) * ( 2 * Math.PI ) / p )\r\n        )\r\n    }\r\n\r\n    return (\r\n        Math.pow( 2, -10 * scaledTime1 ) *\r\n        Math.sin( ( scaledTime1 - s ) * ( 2 * Math.PI ) / p ) * 0.5\r\n    ) + 1\r\n\r\n}\r\n\r\n// Bounce to completion\r\nexport function easeOutBounce( t ) {\r\n\r\n    const scaledTime = t / 1\r\n\r\n    if( scaledTime < ( 1 / 2.75 ) ) {\r\n\r\n        return 7.5625 * scaledTime * scaledTime\r\n\r\n    } else if( scaledTime < ( 2 / 2.75 ) ) {\r\n\r\n        const scaledTime2 = scaledTime - ( 1.5 / 2.75 )\r\n        return ( 7.5625 * scaledTime2 * scaledTime2 ) + 0.75\r\n\r\n    } else if( scaledTime < ( 2.5 / 2.75 ) ) {\r\n\r\n        const scaledTime2 = scaledTime - ( 2.25 / 2.75 )\r\n        return ( 7.5625 * scaledTime2 * scaledTime2 ) + 0.9375\r\n\r\n    } else {\r\n\r\n        const scaledTime2 = scaledTime - ( 2.625 / 2.75 )\r\n        return ( 7.5625 * scaledTime2 * scaledTime2 ) + 0.984375\r\n\r\n    }\r\n\r\n}\r\n\r\n// Bounce increasing in velocity until completion\r\nexport function easeInBounce( t ) {\r\n    return 1 - easeOutBounce( 1 - t )\r\n}\r\n\r\n// Bounce in and bounce out\r\nexport function easeInOutBounce( t ) {\r\n\r\n    if( t < 0.5 ) {\r\n\r\n        return easeInBounce( t * 2 ) * 0.5\r\n        \r\n    }\r\n\r\n    return ( easeOutBounce( ( t * 2 ) - 1 ) * 0.5 ) + 0.5\r\n\r\n}","// checkForUpdates()\r\n// await checkForUpdates() => { currentVersion:0.0.1, newVersion:0.0.2, updateAvailable:true } \r\n\r\n// Fix some issues with early browsers\r\nimport './servicewaiting.polyfill'\r\nimport { VERSION } from '../version'\r\nimport { isInWebAppiOS, isIOS, isTWAAndroid, isMicrosoftStore, isFirefox } from './platform'\r\n\r\n// import serviceWorkerPath from \"url:../service-worker.js\"\r\n\r\n// console.error({serviceWorkerPath, manifestPath})\r\n\r\n// ? made CloudFlare barf up the ServiceWorker so meh!\r\nconst URL_SEPERATOR = \"#\"\r\n\r\nconst NAME = \"pwastillcausingmeheadaches\"\r\n\r\nlet deferredPrompt\r\n\r\n// flags\r\nconst PWA_TYPES = [ \"standalone\", \"fullscreen\",  \"minimal-ui\" ]\r\n// as there are other modes that are active as pwa such as fullscreen\r\nconst displayMode = PWA_TYPES.filter( displayMode => window.matchMedia( `(display-mode:${displayMode})` ).matches )\r\nconst isInWebAppChrome = PWA_TYPES.includes( displayMode )\r\n\r\n// const isInWebAppChrome = [\"fullscreen\", \"standalone\", \"minimal-ui\"].some( displayMode => window.matchMedia( `(display-mode:${displayMode})` ).matches )\r\n// const isInWebAppChrome = window.matchMedia('(display-mode: standalone)').matches\r\n\r\n// if this is the first ever run or if this is the cache has been cleared...\r\nconst isFirstRun = navigator.serviceWorker.controller === null\r\n// Is the user online or offline?\r\nconst isOnline = navigator.onLine \r\n\r\n// 1. Check WebBrowser to see if PWA mode is available (not all browsers have it!)\r\n// \t\tcheck for beforeinstallprompt support\r\n// \t\t- if available then continue\r\nexport const isSupportingBrowser = window.hasOwnProperty(\"BeforeInstallPromptEvent\")\r\n\r\n// 2. Check if the app was JUST installed (previously before refresh)\r\n// was installed on the last refresh\r\n// - if so then quit\r\nconst wasJustInstalled = new URLSearchParams(window.location.search).installing || false\r\n\r\n// 3. Check to see if the app has already been installed!\r\n//\t\t- if it has continue to UPDATE step\r\n//\t\t- if it has not, continue to INSTALL step\r\n// is this runnning as an App on the device? PWA / TWA / MSStore \r\nconst isRunningAsApp = isInWebAppiOS || isInWebAppChrome || isTWAAndroid || isMicrosoftStore || false\r\n\r\n// 4. If Installed check for updates\r\n\r\n\r\n// It is useful to know the kind of computer or device this\r\n// is being installed onto - for example, firefox can show a\r\n// message saying that certain features aren't available!\r\nconst platform = {\r\n\tios:isIOS,\r\n\tandroid:isTWAAndroid,\r\n\tmicrosoft:isMicrosoftStore,\r\n\tfirefox:isFirefox(),\r\n\tpwa:isRunningAsApp,\r\n\toffline:!isOnline,\r\n\tdisplayMode\r\n}\r\n\r\n// The process goes like this...\r\n\r\n// FIXME: show change log if just installed and silently exit!\r\nconst setJustBeenInstalled = (cookieSecret=NAME) =>{\r\n\t// checks a few things... query string for \"installing=true\"\r\n\tconst urlParams = new URLSearchParams(window.location.search)\r\n\turlParams.installing = true\r\n\r\n\tlocalStorage.setItem(cookieSecret,{\r\n\t\tinstalling:true,\r\n\t\tversion:VERSION\r\n\t})\r\n}\r\n\r\n\r\n\r\n// INSTALL PATH\r\n// - set localstorage flag for version and for date installed as well as if it has JUST been installed (gets cleared after first refresh)\r\n\r\n\r\n// UPDATE PATH\r\n\r\nlet installed\r\n// TODO: Lazy load from install\r\nconst showInstallPrompt = (installButton, prompt) => new Promise( async (resolve,reject)=>{\r\n\r\n\tif (!prompt)\r\n\t{\r\n\t\treturn reject()\r\n\t}\r\n\r\n\twindow.addEventListener(\"appinstalled\", evt => {\r\n\t\t\r\n\t\t//console.log(\"appinstalled fired\", evt)\r\n\t\tresolve({\r\n\t\t\tsuccess:true,\r\n\t\t\tlog:\"Your PWA has been installed\"\r\n\t\t})\r\n\r\n\t}, {once:true})\r\n\r\n\t// show the actual prompt\r\n\tprompt.prompt()\r\n\t\r\n\t// disable the install button to prevent repress\r\n\tinstallButton.disabled = true\r\n\t\r\n\t// wait for the user to click a button...\r\n\tconst choiceResult = await prompt.userChoice\r\n\t\r\n\t// user clicked...\r\n\tif (choiceResult.outcome === \"accepted\") \r\n\t{\r\n\t\tconst urlParams = new URLSearchParams(window.location.search)\r\n\t\turlParams.installing = true\r\n\t\t// set?\r\n\r\n\t\tinstalled = true\r\n\t\tinstallButton.hidden = true\r\n\t\t//prompt = null\r\n\r\n\t\t// this should trigger the above event!\r\n\t\t\r\n\t} else {\r\n\r\n\t\tinstallButton.disabled = false\r\n\t\tinstalled = false\r\n\t\tresolve({\r\n\t\t\tsuccess:false,\r\n\t\t\tlog:\"User chose to not install\"\r\n\t\t})\r\n\t\t//reject(\"User chose to not install\")\r\n\t}\r\n})\r\n\r\n// Force uninstall (if pushed out a dodgy version for example)\r\nexport const uninstall = () => {\r\n\tnavigator.serviceWorker.getRegistrations()\r\n\t\t.then( registrations => { \r\n\t\t\tfor(let registration of registrations) \r\n\t\t\t{ \r\n\t\t\t\tregistration.unregister()\r\n\t\t\t\t.then(()=>self.clients.matchAll())\r\n\t\t\t\t.then(clients => { \r\n\t\t\t\t\tclients.forEach(client => { \r\n\t\t\t\t\t\tif (client.url && \"navigate\" in client){ \r\n\t\t\t\t\t\t\tclient.navigate(client.url)\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n}\r\n\r\nexport const showChangelog = async ( domElement ) =>{\r\n\tconst {injectChangeLog, fetchChangesAsText} = await import('./changes.js')\r\n\tconst changes = await fetchChangesAsText('changelog')\r\n\tinjectChangeLog( domElement )\r\n\treturn changes\r\n}\r\n\r\nlet isInstallable = false\r\nlet updating = false\r\nlet updatesAvailable = false\r\nlet updated = false\r\nlet newVersionAvailable = false\r\n\r\n// versioning\r\nconst currentVersion = VERSION\r\nlet previousVersion\r\n\r\n// progressive web app variant\r\n// this simply loads and installs the service worker\r\nexport const installOrUpdate = async(debug=false, currentlyRunningVersion='' ) => {\r\n\r\n\tlet log = []\r\n\tlet output = {}\r\n\r\n\t// 1. Check browser allows PWAs\r\n\tif (!isSupportingBrowser)\r\n\t{\r\n\t\tthrow Error(\"Browser does not support PWA installation\")\r\n\t}\r\n\r\n\t// 2. check to see if it is already installed and running as a PWA\r\n\tif (isRunningAsApp)\r\n\t{\r\n\t\tlog.push(`PWA ${VERSION} Installed, checking for updates`, {deferredPrompt, isFirstRun, isInWebAppiOS, isInWebAppChrome } )\r\n\r\n\t}else{\r\n\r\n\t\t// check to see if the service worker is running...\r\n\t\tif (isFirstRun)\r\n\t\t{\r\n\t\t\t// totally clean setup\r\n\t\t\tlog.push(`PWA ${VERSION} AVAILABLE WWW / PWA`, {deferredPrompt, isFirstRun, first:navigator.serviceWorker.controller } )\r\n\t\t}else if (wasJustInstalled){\r\n\t\t\t// recently installed\r\n\t\t\tlog.push(`PWA ${VERSION} was JUST installed` )\r\n\t\t}else{\r\n\t\t\t// check to see if the service worker is running...\r\n\t\t\tlog.push(`WWW ${VERSION}`, {deferredPrompt, isFirstRun, first:navigator.serviceWorker.controller } )\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tconst registration = await navigator.serviceWorker.getRegistration()\r\n\r\n\t// ===================================================\r\n\t// INSTALLATION OF SERVICE WORKER MEANS IT WAS JUST INSTALLED \r\n\t// check if installing...\r\n\tif (registration?.installing)\r\n\t{\r\n\t\t// if the feature exists, we can work out how heavy the app is\r\n\t\tif (navigator.storage)\r\n\t\t{\r\n\t\t\tconst storageData = await navigator.storage.estimate()\r\n\t\t\tconsole.log(\"Checking for installed storage space\", storageData )\r\n\t\t}\r\n\t}\r\n\r\n\t// FIXME: Check if we are installing the app!\r\n\r\n\r\n\t// INSTALL UPDATES ===================================================\r\n\t// Updates - the app does not need to be installed to have updates!\r\n\t// updates simply means that the service-worker has changed since last time\r\n\t// and that there are new assets that need to be cached and downloaded.\r\n\t// 1. Check to see if it is installed as a service worker\r\n\tif (registration)\r\n\t{\r\n\t\t// if there is an active SW it means that this isn't the first\r\n\t\t// time that the app has run and that there maybe updates to this\r\n\t\t// service worker that will be noticed when the new service worker\r\n\t\t// is registered below...\r\n\t\tconst activeWorker = registration.active\r\n\t\tconst previousServiceWorkerURL = new URL(activeWorker.scriptURL)\r\n\t\t\r\n\t\tpreviousVersion = previousServiceWorkerURL.search.split(\"=\")[1] || currentlyRunningVersion\r\n\t\tnewVersionAvailable = previousVersion !== VERSION\r\n\t\t\r\n\t\t// \"installing\" - the install event has fired, but not yet complete\r\n\t\t// \"installed\"  - install complete\r\n\t\t// \"activating\" - the activate event has fired, but not yet complete\r\n\t\t// \"activated\"  - fully active\r\n\t\t// \"redundant\"  - discarded. Either failed install, or it's been\r\n\t\t//                replaced by a newer version\r\n\t\tconst activatedState = activeWorker.state\r\n\r\n\t\tlog.push(\"PREVIOUS SW URL\", `${previousServiceWorkerURL}` )\r\n\t\tlog.push(\"EXPECTED VERSION\", `${VERSION}` )\r\n\t\tlog.push(\"SW Reg v\", `${previousVersion} -> ${currentVersion}`, {updatesAvailable, previousVersion, registration, activatedState, activeWorker, previousServiceWorkerURL } )\r\n\t\tlog.push(`SW State ${activatedState}` )\r\n\t\t\t\r\n\t\t// As in our service worker we have the self.skipWaiting() command set up\r\n\t\t// the update should automatically install in the background \r\n\t\t// FOR USE AFTER RELOAD - for the time being the previous Service-Worker is used\r\n\t\tregistration.addEventListener('updatefound', async () => {\r\n\r\n\t\t\tconst installingWorker = registration.installing\r\n\t\t\t\r\n\t\t\t// check this version installed and the updated version????\r\n\t\t\tlog.push(\"Update found\", {registration, installWorker: installingWorker, activeWorker, previousServiceWorkerURL } )\r\n\t\t\tupdating = true\r\n\r\n\t\t\t// show \"install update\" buton?\r\n\t\t\t//log.push( {changes,waiting: installWorker.waiting, controller: navigator.serviceWorker.controller  } )\r\n\t\t\t\r\n\t\t\t// if there is already a service-worker registered and running as the controller...\r\n\t\t\t// as well as a worker \"waiting\" to be installed... resolve immediately?\r\n\t\t\tif (installingWorker?.waiting && navigator.serviceWorker.controller) \r\n\t\t\t{\r\n\t\t\t\t// FIXME: \r\n\t\t\t\t//newWorker = reg.waiting\r\n\t\t\t\tlog.push( \"sanity check\", {installWorker: installingWorker, nav:navigator.serviceWorker.controller} )\r\n\t\t\t}\r\n\r\n\t\t\tif (installingWorker)\r\n\t\t\t{\r\n\t\t\t\tinstallingWorker.addEventListener('statechange', () => {\r\n\r\n\t\t\t\t\tswitch (installingWorker.state) {\r\n\t\t\t\t\t\tcase 'installed':\r\n\t\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\r\n\t\t\t\t\t\t\t\t// New Service-Worker has replaced the old one!\r\n\t\t\t\t\t\t\t\t// new update available!\r\n\t\t\t\t\t\t\t\tupdatesAvailable = true\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t// no update available\r\n\t\t\t\t\t\t\t\tupdatesAvailable = false\r\n\t\t\t\t\t\t\t\tlog.push(\"update\", installingWorker.state, {registration, installWorker: installingWorker} )\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlog.push(\"update installed expected truth\", navigator.serviceWorker.controller, {registration, installWorker: installingWorker} )\r\n\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (installingWorker.state === 'installed') \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// FIXME: unregister old one???\r\n\t\r\n\t\t\t\t\t\t// TODO: Auto reload???\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t// if (navigator.storage) \r\n\t\t\t// {\r\n\t\t\t// \tconst storageData = await navigator.storage.estimate()\r\n\t\t\t// }\r\n\r\n\t\t}, {once:true})\r\n\r\n\t}else{\r\n\t\t// no service worker installed yet?\r\n\t\tlog.push(\"PWA NO service worker registered\" )\r\n\t}\r\n\r\n\t//log.push(\"PWA registering service worker...\" )\r\n\r\n\t// as there is no previously one registered, we \r\n\r\n\t// This \"installs\" the app into the local app cache but does\r\n\t// not create the icon on the homescreen or desktop\r\n\t// NB. By appending the Version as an GET var we can specify which version this matches\r\n\tconst hashedSWURL = `../service-worker.js#v=${VERSION}`\r\n\tlet serviceWorker = await navigator.serviceWorker.register(hashedSWURL)\r\n\tlog.push(\"Service worker with #\",hashedSWURL, serviceWorker)\r\n\r\n\tif (!serviceWorker)\r\n\t{\r\n\t\tconst querySWURL = `../service-worker.js?v=${VERSION}`\r\n\t\tserviceWorker = await navigator.serviceWorker.register(querySWURL)\t\t\r\n\t\tlog.push(\"Service worker with ?\",querySWURL, serviceWorker)\r\n\t}\r\n\r\n\t// annoying really but we leave this in just for parcel to force copy it\r\n\tif (!serviceWorker)\r\n\t{\r\n\t\tserviceWorker = await navigator.serviceWorker.register( new URL('../service-worker.js', import.meta.url) , {type: 'module'} )\t\r\n\t\t// serviceWorker = await navigator.serviceWorker.register(\"../service-worker.js\")\t\r\n\t\tlog.push(\"Service worker falling back to default :*(\", serviceWorker)\r\n\t\t\t\r\n\t}\r\n\t\r\n\t// at this point, if the service worker is a different version,\r\n\t// the update method above begins\r\n\r\n\tif (isFirstRun)\r\n\t{\r\n\t\tlog.push(\"PWA FRESH service worker registering\", {serviceWorker} )\r\n\r\n\t}else{\r\n\t\tlog.push(\"PWA registering service worker\", {serviceWorker} )\r\n\t}\r\n\r\n\t// INSTALLABLE!\r\n\t// app is running as a PWA so we don't have to show the install button ever! \r\n\t// if not installed we can also show an install button\r\n\tif (!isRunningAsApp)\r\n\t{\r\n\t\t// get install stuff prepared...\r\n\t\t// check if prompt is available else wait...\r\n\t\tif (!deferredPrompt)\r\n\t\t{\r\n\t\t\t// if this is not installable it will hang forever here\r\n\t\t\tdeferredPrompt = await interceptPrompt()\r\n\t\t\tisInstallable = true\r\n\t\t\tlog.push(\"Waiting prompts\", deferredPrompt )\r\n\t\t}\r\n\r\n\t\t// this could be simplified?\r\n\t\t// const shouldShowInstall = () => relatedApps.length < 1 && (deferredPrompt ?? isIOS) && (deferredPrompt && (\"standalone\" in navigator && navigator.standalone === false) || (installed === false))\r\n\t}\r\n\r\n\toutput = {\r\n\r\n\t\tlog,\r\n\r\n\t\tonline: isOnline,\r\n\t\toffline:!isOnline,\r\n\r\n\t\tpreviousVersion, currentVersion,\r\n\t\t\r\n\t\tisInstallable, isFirstRun, isRunningAsApp, \r\n\t\r\n\t\t// \r\n\t\thasUpdates: updatesAvailable && !isFirstRun,\r\n\r\n\t\t// FIXME\r\n\t\tisInstalled:isRunningAsApp,\r\n\r\n\t\t// Show the installer if not installed?\r\n\t\t// NB. THIS MUST BE TIES INTO A USER INTERACTION\r\n\t\tinstall:(button)=> showInstallPrompt( button, deferredPrompt ),\r\n\r\n\t\tprompt:deferredPrompt,\r\n\r\n\t\tupdatesAvailable, updating, updated, \r\n\t\tnewVersionAvailable,\r\n\r\n\r\n\t\t// requestAddToHomescreen \r\n\t\t// The actual update / reload script for if user wants new version now!\r\n\t\tupdate:()=>{\r\n\t\t\tregistration.waiting.postMessage({ type: 'SKIP_WAITING' })\r\n\t\t\twindow.location.reload()\r\n\t\t},\r\n\t\t...platform\r\n\t}\r\n\r\n\t// // Updates are available so change the setup\r\n\t// if (updatesAvailable)\r\n\t// {\r\n\t// \tconst changes = await showChangelog()\r\n\t// \toutput.changes = changes\r\n\t// }\r\n\t\r\n\t// first thing first, load in our PWA utilities and manifestand changelog and stuff...\r\n\t\r\n\t//try{\r\n\t\t\t\r\n\t\t// const {isAppInstalled, installer} = await import('./install.js')\r\n\t\t// const isInstalled = isAppInstalled()\r\n\t\t// installation = await installer(true)\r\n\r\n\t\t// console.log(\"PWA test 1\", {isInstalled,installation,log,debug})\r\n\t\t\r\n\t\t// console.log(\"PWA test 2\", {installation})\r\n\t\r\n\t\t// Update checks\r\n\t\t// const {updateApp, addUpdateListener} = await import('./update.js')\r\n\r\n\t\t// console.log(\"PWA test loaded update apps\", {updateApp, addUpdateListener})\r\n\t\t\r\n\t\t// // now check for any updates!\r\n\t\t// addUpdateListener()\r\n\r\n\r\n\t\t// may as well disrupt the load if an update is available!\r\n\t\t// as we reload the thing anyways!\r\n\t\t// const {updater, updateAvailable} = await updateApp()\r\n\t\t// const updates = await updateApp()\r\n\r\n\t\t// console.log(\"PWA test 4\", {updates})\r\n\t\r\n\t\t// console.log(\"PWA test 5\", {updateApp})\r\n\r\n\t\t// if (updateAvailable)\r\n\t\t// {\r\n\t\t// \t// allow user to update!\r\n\t\t// \t// showUpdateButton(document.getElementById(\"shared-controls\"), updater) \r\n\t\t// \t// setToast(\"An Update is available! Press update to install it\" )\r\n\t\t\t\r\n\t\t// }else{\r\n\r\n\t\t// \t// FIXME: show changelog???\r\n\t\t// \tconst {injectChangeLog, fetchChangesAsText} = await import('./changes.js')\r\n\t\t// \t// fetchChangesAsText('changelog')\r\n\t\t// \tlog += fetchChangesAsText()\r\n\t\t// }\r\n\r\n\t\t// console.log(\"installer\", { updateAvailable,updater, updateAvailable, installer, installation})\r\n\t\r\n\t// }catch(error){\r\n\r\n\t// \tconsole.error(\"PWA\", error)\r\n\t// }\r\n\r\n\tif (debug)\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\treturn output\r\n}\r\n\r\n\r\n// Prevent the install app popup appearing\r\nconst interceptPrompt = () => new Promise( (resolve,reject) => {\r\n\t\r\n\tif (!isSupportingBrowser)\r\n\t{\r\n\t\treturn reject(\"Unsupported Browser\")\r\n\t}\r\n\r\n\tif (deferredPrompt)\r\n\t{\r\n\t\treturn resolve( deferredPrompt )\r\n\t}\r\n\r\n\t// Intercept install prompt catch install prompt and prevent it showing immediately\r\n\t// you can run deferredPrompt.prompt() to start it again\r\n\twindow.addEventListener(\"beforeinstallprompt\", event => {\r\n\t\t\t\r\n\t\tevent.preventDefault() \r\n\t\tresolve( event )\r\n\r\n\t}, {once:true})\t\t\r\n})\r\n\r\n// No need to watch if already installed\r\nif (!isRunningAsApp)\r\n{\r\n\tinterceptPrompt().then( prompt => deferredPrompt = prompt )\r\n}\r\n\r\n","// Brilliant prolyfil by dfabulich\r\n// https://github.com/w3c/ServiceWorker/issues/1222#issuecomment-351566460\r\nif (!('waiting' in navigator.serviceWorker)) {\r\n\tnavigator.serviceWorker.waiting = new Promise(function(resolve) {\r\n\t\tnavigator.serviceWorker.ready.then(function(reg) {\r\n\t\t\tfunction awaitStateChange() {\r\n\t\t\t\treg.installing.addEventListener('statechange', function() {\r\n\t\t\t\t\tif (this.state === 'installed') resolve(reg)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tif (reg.waiting) resolve(reg)\r\n\t\t\tif (reg.installing) awaitStateChange()\r\n\t\t\treg.addEventListener('updatefound', awaitStateChange)\r\n\t\t})\r\n\t})\r\n}\r\n","\r\n// Determine as much functionality as possible\r\nexport const isInWebAppiOS = \"standalone\" in navigator ? window.navigator.standalone === true : matchMedia(\"(display-mode: standalone)\").matches\r\n\r\n\r\n// handle iOS specifically\r\n// this includes the regular iPad and the iPad pro but not macOS\r\nexport const isIOS =\r\n\tnavigator.userAgent.includes(\"iPhone\") || navigator.userAgent.includes(\"iPad\") ||\r\n\t(navigator.userAgent.includes(\"Macintosh\") && navigator.maxTouchPoints && navigator.maxTouchPoints > 2)\r\n\r\n\r\n// is this an APK TWA android app?\r\nexport const isTWAAndroid = document.referrer.includes('android-app://')\r\n\r\n// check to see if it is in the microsoft store pwas format\r\nexport const isMicrosoftStore = Array.isArray( navigator.userAgent.match(/MSAppHost/i) )\r\n\r\n\r\nexport const isFirefox = () => {\r\n\t\r\n}","module.exports = (require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-url').getBundleURL('hAF7M') + \"changes.a7179ccd.js\" + \"?\" + Date.now()).catch(err => {delete module.bundle.cache[module.id]; throw err;})).then(() => module.bundle.root('3MFIV'));","\"use strict\";\n\nvar cacheLoader = require('../cacheLoader');\nmodule.exports = cacheLoader(function (bundle) {\n  return new Promise(function (resolve, reject) {\n    // Don't insert the same script twice (e.g. if it was already in the HTML)\n    var existingScripts = document.getElementsByTagName('script');\n    if ([].concat(existingScripts).some(function isCurrentBundle(script) {\n      return script.src === bundle;\n    })) {\n      resolve();\n      return;\n    }\n    var preloadLink = document.createElement('link');\n    preloadLink.href = bundle;\n    preloadLink.rel = 'preload';\n    preloadLink.as = 'script';\n    document.head.appendChild(preloadLink);\n    var script = document.createElement('script');\n    script.async = true;\n    script.type = 'text/javascript';\n    script.src = bundle;\n    script.onerror = function (e) {\n      var error = new TypeError(\"Failed to fetch dynamically imported module: \".concat(bundle, \". Error: \").concat(e.message));\n      script.onerror = script.onload = null;\n      script.remove();\n      reject(error);\n    };\n    script.onload = function () {\n      script.onerror = script.onload = null;\n      resolve();\n    };\n    document.getElementsByTagName('head')[0].appendChild(script);\n  });\n});","\"use strict\";\n\nvar cachedBundles = {};\nvar cachedPreloads = {};\nvar cachedPrefetches = {};\nfunction getCache(type) {\n  switch (type) {\n    case 'preload':\n      return cachedPreloads;\n    case 'prefetch':\n      return cachedPrefetches;\n    default:\n      return cachedBundles;\n  }\n}\nmodule.exports = function (loader, type) {\n  return function (bundle) {\n    var cache = getCache(type);\n    if (cache[bundle]) {\n      return cache[bundle];\n    }\n    return cache[bundle] = loader.apply(null, arguments).catch(function (e) {\n      delete cache[bundle];\n      throw e;\n    });\n  };\n};","\"use strict\";\n\nvar bundleURL = {};\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n  return value;\n}\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n  return '/';\n}\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\n// TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^/]+/);\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n  return matches[0];\n}\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","module.exports = require('./helpers/bundle-url').getBundleURL('hAF7M') + \"service-worker.js\" + \"?\" + Date.now();","import {debounce} from './utils'\r\n\r\n/**\r\n * little local storage wrapper for storing cached objects\r\n * @param {String} name Unique name for the store cache\r\n * @returns {Array<Function>} Store controls\r\n */\r\nexport const createStore = (name=\"InterFACE\") => {\r\n\tconst storage = localStorage.getItem(name)\r\n\tconst data = Object.assign({}, JSON.parse(storage) )\r\n\tconst save = debounce( updates => {\r\n\t\tconst encoded = JSON.stringify(updates)\r\n\t\tlocalStorage.setItem(name, encoded )\r\n\t}, 20 )\r\n\r\n\treturn {\r\n\t\tsave,\r\n\t\thas:key =>{\r\n\t\t\treturn data[key] ? true : false\r\n\t\t},\r\n\t\tremoveItem:key =>{\r\n\t\t\tdelete data[key] \r\n\t\t\tsave(data)\r\n\t\t},\r\n\t\tgetItem:key =>{\r\n\t\t\treturn data[key] \r\n\t\t},\r\n\t\tsetItem:(key,value)=>{\r\n\t\t\tdata[key] = Object.assign( {}, data[key], value )\r\n\t\t\t// save to local\r\n\t\t\tsave(data)\r\n\t\t\t\r\n\t\t\treturn data\r\n\t\t},\r\n\t}\r\n}\r\n\r\n","export const convertOptionToObject = items => items.reduce( (accumulator, current) => {\r\n\tconst c = current.split(\":\")\r\n\taccumulator[c[0]] = parseFloat(c[1])\r\n\treturn accumulator\r\n}, {})\r\n\r\nexport const debounce = (callback, wait) => {\r\n\tlet timerId\r\n\t\r\n\treturn (...args) => {\r\n\t\t//console.error(args, \"debounce\", arguments)\r\n\t  clearTimeout(timerId)\r\n\t  timerId = setTimeout(() => callback(...args), wait)\r\n\t  return timerId\r\n\t}\r\n}\r\n\r\n\r\n// memoize this method\r\nexport const memoize = ( method ) => {\r\n\r\n\t// store outputs and inputs\r\n\tconst cache = new Map()\r\n\r\n\t// takes same args as the method\r\n\treturn (...args) => {\r\n\r\n\t\t// check to see if we have a cached entry\r\n\t\tif (cache.has(args))\r\n\t\t{\r\n\t\t\treturn cache.get(args)\r\n\t\t}\r\n\r\n\t\tconst result = method.apply( this, args )\r\n\t\tcache.set( args, result )\r\n\t\treturn result\r\n\t}\r\n}\r\n\r\n\r\nexport const injectJavascript = async(url) => new Promise((resolve, reject) => {\r\n\tconst script = document.createElement(\"script\")\r\n\tscript.onload = () => { resolve(url) }\r\n\tscript.onerror = error => { reject(error) }\r\n\tscript.src = url\r\n\tdocument.head.appendChild(script)\r\n\t// console.error(\"injecting JS\", url , script)\r\n})\r\n\r\n\r\n// DECODE UTILITIES\r\n\r\n\r\n/*\r\nBase64 / binary data / UTF-8 strings utilities\r\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Base64_encoding_and_decoding\r\nhttps://github.com/audiojs/audio-loader/blob/master/lib/base64.js\r\n*/\r\nexport const b64ToUint6 = nChr => {\r\n\treturn nChr > 64 && nChr < 91 ? nChr - 65\r\n\t  : nChr > 96 && nChr < 123 ? nChr - 71\r\n\t  : nChr > 47 && nChr < 58 ? nChr + 4\r\n\t  : nChr === 43 ? 62\r\n\t  : nChr === 47 ? 63\r\n\t  : 0\r\n}\r\n\r\n/**\r\n * Base64 string to array encoding \r\n * @param {Uint6} nUint6 \r\n * @returns \r\n */\r\nexport const uint6ToB64 = nUint6 => {\r\n\treturn nUint6 < 26 ? nUint6 + 65\r\n\t  : nUint6 < 52 ? nUint6 + 71\r\n\t  : nUint6 < 62 ? nUint6 - 4\r\n\t  : nUint6 === 62 ? 43\r\n\t  : nUint6 === 63 ? 47\r\n\t  : 65\r\n}\r\n\r\n/**\r\n * Decode Base64 to Uint8Array\r\n * @param {sBase64} sBase64 \r\n * @param {nBlocksSize} nBlocksSize \r\n * @returns Uint8Array\r\n */\r\nexport const decodeBase64 = (sBase64, nBlocksSize) => {\r\n\tconst sB64Enc = sBase64.replace(/[^A-Za-z0-9\\+\\/]/g, '')\r\n\tconst nInLen = sB64Enc.length\r\n\tconst nOutLen = nBlocksSize\r\n\t  ? Math.ceil((nInLen * 3 + 1 >> 2) / nBlocksSize) * nBlocksSize\r\n\t  : nInLen * 3 + 1 >> 2\r\n\r\n\tconst taBytes = new Uint8Array(nOutLen)\r\n  \r\n\tfor (let nMod3, nMod4, nUint24 = 0, nOutIdx = 0, nInIdx = 0; nInIdx < nInLen; nInIdx++) \r\n\t{\r\n\t  nMod4 = nInIdx & 3\r\n\t  nUint24 |= b64ToUint6(sB64Enc.charCodeAt(nInIdx)) << 18 - 6 * nMod4\r\n\t  if (nMod4 === 3 || nInLen - nInIdx === 1) \r\n\t  {\r\n\t\tfor (nMod3 = 0; nMod3 < 3 && nOutIdx < nOutLen; nMod3++, nOutIdx++) \r\n\t\t{\r\n\t\t  taBytes[nOutIdx] = nUint24 >>> (16 >>> nMod3 & 24) & 255\r\n\t\t}\r\n\t\tnUint24 = 0\r\n\t  }\r\n\t}\r\n\treturn taBytes\r\n}\r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const base64DecToArr = (sBase64, nBlocksSize) => {\r\n\r\n  var\r\n    sB64Enc = sBase64.replace(/[^A-Za-z0-9\\+\\/]/g, \"\"), nInLen = sB64Enc.length,\r\n    nOutLen = nBlocksSize ? Math.ceil((nInLen * 3 + 1 >> 2) / nBlocksSize) * nBlocksSize : nInLen * 3 + 1 >> 2, taBytes = new Uint8Array(nOutLen);\r\n\r\n  for (var nMod3, nMod4, nUint24 = 0, nOutIdx = 0, nInIdx = 0; nInIdx < nInLen; nInIdx++) {\r\n    nMod4 = nInIdx & 3;\r\n    nUint24 |= b64ToUint6(sB64Enc.charCodeAt(nInIdx)) << 6 * (3 - nMod4);\r\n    if (nMod4 === 3 || nInLen - nInIdx === 1) {\r\n      for (nMod3 = 0; nMod3 < 3 && nOutIdx < nOutLen; nMod3++, nOutIdx++) {\r\n        taBytes[nOutIdx] = nUint24 >>> (16 >>> nMod3 & 24) & 255;\r\n      }\r\n      nUint24 = 0;\r\n\r\n    }\r\n  }\r\n\r\n  return taBytes;\r\n}\r\n\r\n\r\nexport const base64EncArr = (aBytes) => {\r\n\r\n  let nMod3 = 2, sB64Enc = \"\"\r\n  for (var nLen = aBytes.length, nUint24 = 0, nIdx = 0; nIdx < nLen; nIdx++) \r\n  {\r\n    nMod3 = nIdx % 3\r\n    if (nIdx > 0 && (nIdx * 4 / 3) % 76 === 0) \r\n\t{ \r\n\t\tsB64Enc += \"\\r\\n\" \r\n\t}\r\n    nUint24 |= aBytes[nIdx] << (16 >>> nMod3 & 24)\r\n    if (nMod3 === 2 || aBytes.length - nIdx === 1) \r\n\t{\r\n      sB64Enc += String.fromCodePoint(uint6ToB64(nUint24 >>> 18 & 63), uint6ToB64(nUint24 >>> 12 & 63), uint6ToB64(nUint24 >>> 6 & 63), uint6ToB64(nUint24 & 63))\r\n      nUint24 = 0\r\n    }\r\n  }\r\n\r\n  return sB64Enc.substr(0, sB64Enc.length - 2 + nMod3) + (nMod3 === 2 ? '' : nMod3 === 1 ? '=' : '==');\r\n}\r\n\r\n/**\r\n * UTF-8 array to JS string and vice versa \r\n */\r\nexport const UTF8ArrToStr = (aBytes) => {\r\n  let sView = \"\"\r\n  for (var nPart, nLen = aBytes.length, nIdx = 0; nIdx < nLen; nIdx++) \r\n  {\r\n    nPart = aBytes[nIdx]\r\n    sView += String.fromCodePoint(\r\n      nPart > 251 && nPart < 254 && nIdx + 5 < nLen ? /* six bytes */\r\n        /* (nPart - 252 << 30) may be not so safe in ECMAScript! So...: */\r\n        (nPart - 252) * 1073741824 + (aBytes[++nIdx] - 128 << 24) + (aBytes[++nIdx] - 128 << 18) + (aBytes[++nIdx] - 128 << 12) + (aBytes[++nIdx] - 128 << 6) + aBytes[++nIdx] - 128\r\n      : nPart > 247 && nPart < 252 && nIdx + 4 < nLen ? /* five bytes */\r\n        (nPart - 248 << 24) + (aBytes[++nIdx] - 128 << 18) + (aBytes[++nIdx] - 128 << 12) + (aBytes[++nIdx] - 128 << 6) + aBytes[++nIdx] - 128\r\n      : nPart > 239 && nPart < 248 && nIdx + 3 < nLen ? /* four bytes */\r\n        (nPart - 240 << 18) + (aBytes[++nIdx] - 128 << 12) + (aBytes[++nIdx] - 128 << 6) + aBytes[++nIdx] - 128\r\n      : nPart > 223 && nPart < 240 && nIdx + 2 < nLen ? /* three bytes */\r\n        (nPart - 224 << 12) + (aBytes[++nIdx] - 128 << 6) + aBytes[++nIdx] - 128\r\n      : nPart > 191 && nPart < 224 && nIdx + 1 < nLen ? /* two bytes */\r\n        (nPart - 192 << 6) + aBytes[++nIdx] - 128\r\n      : /* nPart < 127 ? */ /* one byte */\r\n        nPart\r\n    )\r\n  }\r\n  return sView\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} sDOMStr \r\n * @returns \r\n */\r\nexport const strToUTF8Arr = (sDOMStr) => {\r\n\r\n  var aBytes, nChr, nStrLen = sDOMStr.length, nArrLen = 0\r\n\r\n  /* mapping... */\r\n\r\n  for (var nMapIdx = 0; nMapIdx < nStrLen; nMapIdx++) \r\n  {\r\n    nChr = sDOMStr.codePointAt(nMapIdx)\r\n\r\n    if (nChr > 65536) {\r\n      nMapIdx++\r\n    }\r\n\r\n    nArrLen += nChr < 0x80 ? 1 : nChr < 0x800 ? 2 : nChr < 0x10000 ? 3 : nChr < 0x200000 ? 4 : nChr < 0x4000000 ? 5 : 6\r\n  }\r\n\r\n  aBytes = new Uint8Array(nArrLen)\r\n\r\n  /* transcription... */\r\n  for (var nIdx = 0, nChrIdx = 0; nIdx < nArrLen; nChrIdx++) \r\n  {\r\n    nChr = sDOMStr.codePointAt(nChrIdx)\r\n    if (nChr < 128) {\r\n      /* one byte */\r\n      aBytes[nIdx++] = nChr\r\n    } else if (nChr < 0x800) {\r\n      /* two bytes */\r\n      aBytes[nIdx++] = 192 + (nChr >>> 6)\r\n      aBytes[nIdx++] = 128 + (nChr & 63)\r\n    } else if (nChr < 0x10000) {\r\n      /* three bytes */\r\n      aBytes[nIdx++] = 224 + (nChr >>> 12)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 6 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr & 63)\r\n    } else if (nChr < 0x200000) {\r\n      /* four bytes */\r\n      aBytes[nIdx++] = 240 + (nChr >>> 18)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 12 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 6 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr & 63);\r\n      nChrIdx++\r\n    } else if (nChr < 0x4000000) {\r\n      /* five bytes */\r\n      aBytes[nIdx++] = 248 + (nChr >>> 24)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 18 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 12 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 6 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr & 63)\r\n      nChrIdx++\r\n    } else /* if (nChr <= 0x7fffffff) */ {\r\n      /* six bytes */\r\n      aBytes[nIdx++] = 252 + (nChr >>> 30)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 24 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 18 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 12 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr >>> 6 & 63)\r\n      aBytes[nIdx++] = 128 + (nChr & 63)\r\n      nChrIdx++\r\n    }\r\n  }\r\n  return aBytes\r\n}\r\n\r\n\r\nexport const toBytes = (number, byteCount) => {\r\n\tconst bytes = new Array(byteCount)\r\n\tfor (let i = byteCount - 1; i >= 0; i--) \r\n\t{\r\n\t\tbytes[i] = number & 255\r\n\t\tnumber >>= 8\r\n\t}\r\n\treturn bytes\r\n}\r\n\r\nexport const toVarLenBytes = (number) => {\r\n\tconst bytes = []\r\n\tlet last = true\r\n\tdo {\r\n\t\tconst partial_value = number & 127\r\n\t\tnumber >>= 7\r\n\t\tif (last) {\r\n\t\t\t// first bit is off for last byte\r\n\t\t\tbytes.unshift(partial_value)\r\n\t\t\tlast = false\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// set first bit on for all other bytes\r\n\t\t\tbytes.unshift(partial_value | 128)\r\n\t\t}\r\n\t} while (number > 0)\r\n\treturn bytes\r\n}\r\n\r\n\r\n/* Array of bytes to Base64 string decoding */\r\n\r\n// export const b64ToUint6 = (nChr) => {\r\n// \treturn nChr > 64 && nChr < 91 ?\r\n// \t\tnChr - 65\r\n// \t  : nChr > 96 && nChr < 123 ?\r\n// \t\tnChr - 71\r\n// \t  : nChr > 47 && nChr < 58 ?\r\n// \t\tnChr + 4\r\n// \t  : nChr === 43 ?\r\n// \t\t62\r\n// \t  : nChr === 47 ?\r\n// \t\t63\r\n// \t  :\r\n// \t\t0;\r\n//   }  \r\n\r\n/**\r\n * \r\nconst a2b = (a) => {\r\n\tlet b, c, d, e = {}, f = 0, g = 0, h = \"\", i = String.fromCharCode, j = a.length\r\n\tfor (b = 0; 64 > b; b++){\r\n\t\te[\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".charAt(b)] = b\r\n\t}\r\n\tfor (c = 0; j > c; c++){\r\n\t\tfor (b = e[a.charAt(c)], f = (f << 6) + b, g += 6; g >= 8; ) {\r\n\t\t\t((d = 255 & f >>> (g -= 8)) || j - 2 > c) && (h += i(d))\r\n\t\t}\r\n\t}\r\n\treturn h\r\n}\r\n */","\r\nimport { showReloadButton } from '../dom/button'\r\n\r\nexport const showError = (error, solution, fatal=false) => {\r\n \r\n\tconst body = document.documentElement\r\n\r\n\tbody.classList.add(\"failure\")\r\n\tbody.classList.remove(\"loading\")\r\n\r\n\t// TODO: show the error messages on screen in a dialog\r\n\tconst dialog = document.getElementById(\"errors\")\r\n\tdialog.open = true\r\n\t\r\n\tif (fatal)\r\n\t{\r\n\t\t// if fatal then we can't continue so show reload button?\t\r\n\t\t// add a reload button to the feedback node\r\n\t\t// const form = dialog.querySelector(\"form\")\r\n\t\t// form.appendChild( showReloadButton(true) )\r\n\r\n\t\t// remove existing button\r\n\t\t\r\n\t\t// play audio files located...\r\n\t\t// lemmings sound effect sounds best\r\n\t\tconst audioElement = dialog.querySelector(\"audio\")\r\n\t\taudioElement.setAttribute(\"autoplay\", true)\r\n\t\taudioElement.setAttribute(\"start\", true)\r\n\t}\r\n\r\n\tdocument.getElementById(\"error-details\").innerText = error\r\n\t\t\r\n\tconsole.error(\"Could not load\", {fatal}, error )\r\n\tconsole.warn( \"Consider:\", solution )\r\n}","import { addTooltip } from './tooltips'\r\nimport { VERSION } from '../version'\r\nimport {formattedDate} from '../models/info'\r\nimport {addMouseTapAndHoldEvents, MOUSE_HELD, MOUSE_HOLDING, MOUSE_TAP} from '../hardware/mouse'\r\n\r\nexport const setButton = (buttonNameOrElement, callback, eventType=\"mousedown\", preventDefault=false ) => {\r\n\tconst element = typeof buttonNameOrElement === \"string\" ? document.getElementById(buttonNameOrElement) : buttonNameOrElement\r\n\t// check to see that the button hasn't got the display:none!\r\n\tif (element)\r\n\t{\r\n\t\t// element.addEventListener(\"click\", (event) => {\r\n\t\t// click was too unresponsive so lets use touch / mousedown\r\n\t\telement.addEventListener(eventType, (event) => {\r\n\t\t\tif (preventDefault){\r\n\t\t\t\tevent.preventDefault()\r\n\t\t\t}\r\n\t\t\tcallback && callback({element, event})\r\n\t\t})\r\n\t\treturn element\r\n\t}\r\n\t\r\n\treturn null\r\n}\r\n\r\nexport const setPressureButton = (buttonNameOrElement, tapCallback, holdCallback, holdingCallback ) => {\r\n\tconst element = typeof buttonNameOrElement === \"string\" ? document.getElementById(buttonNameOrElement) : buttonNameOrElement\r\n\tif (element)\r\n\t{\r\n\t\taddMouseTapAndHoldEvents( element )\r\n\t\telement.addEventListener( MOUSE_TAP, event => {\r\n\t\t\ttapCallback && tapCallback(event)\r\n\t\t} )\r\n\r\n\t\telement.addEventListener( MOUSE_HOLDING, event => {\r\n\t\t\tholdingCallback && holdingCallback(event)\r\n\t\t} )\r\n\r\n\t\telement.addEventListener( MOUSE_HELD, event => {\r\n\t\t\tholdCallback && holdCallback(event)\r\n\t\t} )\r\n\t\treturn element\r\n\t}\r\n\treturn null\r\n}\r\n\r\n\r\n\r\n/**\r\n * Create a clickable button with label and tooltip\r\n * @param {String} label \r\n * @param {String} tip \r\n * @param {String} classes \r\n */\r\nexport const createButton = (label, tip, classes='' ) => {\r\n\tconst button = document.createElement('button')\r\n\tbutton.classList.add(classes)\r\n\tbutton.setAttribute(\"type\", \"button\" )\r\n\tbutton.setAttribute(\"aria-label\", tip )\r\n\tbutton.innerHTML = label\r\n\taddTooltip(button)\r\n\treturn button\r\n}\r\n\r\n/**\r\n * For when an update has taken or a failure has occurred\r\n * this simply adds a CTA with a reload button\r\n */\r\nexport const showReloadButton = (reset) => {\r\n\tconst button = createButton(\"Try again! Reload and reset\", \"Reload this application!\", \"reload-app\" )\r\n\tbutton.addEventListener( \"click\", event => {\r\n\t\t// remove any potential options that could cause issue?\r\n\t\tif (reset){\r\n\t\t\thistory.replaceState( null, null, \"?\" )\r\n\t\t}\r\n\t\twindow.location.reload() \r\n\t})\r\n\tbutton.id = \"button-reload\"\r\n\treturn button\r\n}\r\n\r\nexport const createInstallButton = (manifestData) => {\r\n\t// show install button or update button???\r\n\tconst tip = `Click to install ${manifestData.short_name} V-${VERSION.replaceAll(\".\",\"-\")}<br>Date:${formattedDate}`\r\n\tconst button = createButton(\"Install\", tip, \"install-app\" )\r\n\tbutton.id = \"button-install\"\r\n\tbutton.style.setProperty(\"--logo\",`url(${ manifestData.icons[0].src })`)\r\n\treturn button\r\n}\r\n\r\n////////////////////////////////////////////////////////////////////\r\n// TODO: This is rubbish, what was I thinking?\r\n////////////////////////////////////////////////////////////////////\r\nexport const showUpdateButton = (domElement, action) => {\r\n\tconst button = createButton(\"Update\", `Update to new version`, \"update-available\" )\r\n\tbutton.id = \"button-update\"\r\n\tbutton.addEventListener('click', ()=>action() )\r\n\t// reveal update button?\r\n\t//domElement.appendChild(button)\r\n}\r\n\r\n////////////////////////////////////////////////////////////////////\r\n// a simple midi buttnon with states\r\n// just set the state with the return\r\n////////////////////////////////////////////////////////////////////\r\nexport const setupMIDIButton = (buttonMIDI, callback) => {\r\n\t\r\n\tlet midiEnabled = false\r\n\r\n\tconst onStartRequested = async (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tcallback && callback()\r\n\t\tmidiEnabled = true\r\n\t\t//buttonMIDI.removeEventListener('mousedown', onStartRequested)\r\n\t\treturn false\r\n\t}\r\n\r\n\tbuttonMIDI.addEventListener('mousedown', onStartRequested, { once: true })\r\n\t\r\n\treturn {\r\n\t\tsetText:text=>buttonMIDI.innerHTML = text,\r\n\t\tsetLabel:text=>buttonMIDI.setAttribute(\"aria-label\",text)\r\n\t}\r\n}","/**\r\n * Very simple tooltip moving, presenting and updating\r\n */\r\n\r\n/**\r\n * Create a tooltip and bind it to the element\r\n * @param {HTMLElement} element DOM element to bind to\r\n * @param {Number} revealRate typing rate in characters per second\r\n * @param {Number} clearRate clear word after x ms\r\n * @returns {Function} method with 2 arguments to set the tip message\r\n */\r\n const createTip =  (element, revealRate=6, clearRate=550) => {\r\n\t\r\n\tlet previousMessage = ''\r\n\tlet interval = null\r\n\tlet frame = null\r\n\r\n\tlet isAnimating = false\r\n\tlet hasCompleted = false\r\n\r\n\treturn element ? (message, letterRate=revealRate ) => {\r\n\t\r\n\t\t// prevent hiding \r\n\t\tclearInterval( interval )\r\n\t\t\r\n\t\t// check to see if it has changed...\r\n\t\tif (message === previousMessage)\r\n\t\t{\r\n\t\t\t// or do we just show it all???\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\t// write the message letter by letter\r\n\t\tfunction write ( index=0, speed=1, returnVisit=false){\r\n\r\n\t\t\t// if (!returnVisit){\r\n\t\t\t// \tconsole.log( index, \"isAnimating\", {interval}, letterRate, \"tip\", {message, previousMessage} )\r\n\t\t\t// }\r\n\t\t\tcancelAnimationFrame( frame )\r\n\r\n\t\t\tconst revealingMessage = message.slice(0, index)\r\n\t\t\t\t\r\n\t\t\tconst isWriting = index < message.length \r\n\r\n\t\t\t//console.log( \"draw\",isWriting, message, index, message.length )\r\n\r\n\t\t\tif (isWriting)\r\n\t\t\t{\r\n\t\t\t\t//console.log( index,  message.length, \"wrting\", {interval}, {message, previousMessage} )\r\n\t\t\t\t// ok, so we have a new message and immediately we overwrite the previous message\r\n\t\t\t\telement.innerHTML = revealingMessage\r\n\t\t\t\t//write( index + speed, speed, true )\r\n\t\t\t\tisAnimating = true\r\n\t\t\t\tframe = requestAnimationFrame(()=>write( index + speed, speed, true ))\r\n\t\t\t\r\n\t\t\t}else{\t\t\t\r\n\r\n\t\t\t\t// ended!\r\n\t\t\t\tisAnimating = false\r\n\t\t\t\telement.innerHTML = message\r\n\t\t\t\t// console.log( index,  message.length, \"wrte end\", {interval}, {message, previousMessage} )\r\n\r\n\t\t\t\t// clear the previous interval after x chars read\r\n\t\t\t\tconst after = clearRate * message.length\r\n\t\t\t\t// and then hide this after x seconds...\r\n\t\t\t\tinterval = setTimeout(()=>{\t\t\t\r\n\t\t\t\t\telement.innerHTML = ''\r\n\t\t\t\t\thasCompleted = true\r\n\t\t\t\t}, after)\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\r\n\t\t// if the letterRate is 0, then we just show the message\r\n\t\tif (letterRate < 1 )\r\n\t\t{\t\r\n\t\t\twrite( message.length, 10 )\r\n\t\t}else{\r\n\r\n\t\t\tif (isAnimating){\r\n\t\t\t\t// just animate the new characters\r\n\t\t\t\twrite( previousMessage.length, letterRate)\r\n\t\t\t   \t//write( 0, letterRate)\r\n\t\t   }else{\r\n\r\n\t\t\t\t// ended!?\r\n\t\t\t   write( 0, letterRate)\r\n\t\t   }\r\n\t\t}\r\n\r\n\t\tpreviousMessage = message\r\n\r\n\t} : null\r\n}\r\n\r\n\r\n/**\r\n * Create a method that controls the toast element remotely\r\n * @param {HTMLElement} controls DOM element to search within\r\n * @param {String} query query selector for finding the elements to bind to\r\n */\r\nconst toastElement = document.getElementById(\"toast\")\r\n// export const setToast = bindTextElement( toastElement, 20, 900, true )\r\nexport const setToast = createTip( toastElement )\r\n\r\nconst tooltips = new Map()\r\n\r\n/**\r\n * set the style of the tooltip to the x/y coords\r\n * of the provided element\r\n * @param {HTMLElement} target \r\n */\r\nconst setToolTipPosition = (target) => {\r\n\ttoastElement.setAttribute(\r\n\t\t\"style\", \r\n\t\t`--left: ${target.offsetLeft}; \r\n\t\t --top: ${target.offsetTop};`\r\n\t)\r\n}\r\n\r\n/**\r\n * adds a single tooltip to an element where hovering will reveal new info\r\n * @param {HTMLElement} controls DOM element to search within\r\n */\r\nexport const addTooltip = element => { \r\n\tconst callback = event => {\r\n\t\tconst toolTip = event.target.getAttribute(\"aria-label\") || event.target.innerText\r\n\t\tconst position = \r\n\t\t\tevent.target.nodeName === \"BUTTON\" ? \r\n\t\t \t\tevent.target : event.target.parentElement \r\n\t\tsetToolTipPosition(position)\r\n\t\tsetToast(toolTip)\r\n\t\t// console.error( {toolTip, position} )\r\n\t}\r\n\telement.addEventListener(\"mouseover\", callback)\r\n\t// check for dom removal \r\n\ttooltips.set( element, callback )\r\n}\r\n\r\n/**\r\n * Undoes the above\r\n * @param {HTMLElement} element \r\n */\r\nexport const removeTooltip = element => { \r\n\tconst callback = tooltips.get( element )\r\n\tif (callback)\r\n\t{\r\n\t\telement.removeEventListener(\"mouseover\", callback)\r\n\t\ttooltips.delete(element)\r\n\t}\r\n}\r\n\r\n/**\r\n * adds tooltips to all elements that match the query\r\n * @param {HTMLElement} controls DOM element to search within\r\n * @param {String} query query selector for finding the elements to bind to\r\n */\r\nexport const addToolTips = (controls, query=\"button, select, input\") => {\r\n\t\r\n\t// do a query here to catch all buttons?\r\n\tconst buttons = controls.querySelectorAll(query)\r\n\t\r\n\t// const fragment = doc.createDocumentFragment() \r\n\t// fragment.appendChild(doc.createElement('fieldset'))\r\n\t// const fragment = doc.createElement('fieldset')\r\n\t// fragment.innerHTML = setupInstrumentForm()\r\n\t// add to dom\r\n\t// controls.appendChild( fragment )\r\n\r\n\t// intercept any hover events...\r\n\tbuttons.forEach( button => addTooltip(button) )\r\n}","import {VERSION, DATE} from '../version'\r\n\r\nconst releaseDate = new Date(DATE)\r\nconst dateOptions = {\r\n\thour12 : true,\r\n\thour:  \"numeric\",\r\n\tminute:  \"numeric\",\r\n }\r\nexport const formattedDate = `${releaseDate.getDate()}/${releaseDate.getMonth()+1}/${releaseDate.getFullYear()} ${ releaseDate.toLocaleTimeString(\"en-GB\",dateOptions) }`\r\n","// watch for global mouse moves...\r\n// watch for mouse holding\r\nconst now = () => performance.now() || Date.now()\r\n\r\nexport const MOUSE_HELD = \"mouse_held\"\r\nexport const MOUSE_HOLDING = \"mouse_holding\"\r\nexport const MOUSE_TAP = \"mouse_tap\"\r\n\r\n/**\r\n * hook in to see how the user treats an element...\r\n * how long did they click for or if after x seconds \r\n * has the user held itt down still?\r\n * @param {HTMLElement} button - button to watch for changes\r\n * @param {Boolean} onlySendHoldOnMouseUp - dispatch the hold event only when moused up\r\n * @param {Number} holdTime - milliseconds before it is considered a hold\r\n * @returns \r\n */\r\nexport const addMouseTapAndHoldEvents = ( button, onlySendHoldOnMouseUp=false, holdTime=800 ) => {\r\n\r\n\tlet mouseDownAt = -1\r\n\t// FIXME: Immediately test to see if this actually *is* false???\r\n\tlet isMouseOver = false\r\n\tlet isMouseDown = false\r\n\tlet isMouseHeld = false\r\n\t\r\n\t// fetch dom element\r\n\tconst dispatch = (name, detail={}) => {\r\n\t\tbutton.dispatchEvent( \r\n\t\t\tnew CustomEvent( name, { detail } )\r\n\t\t)\r\n\t}\r\n\r\n\t// test to see how long we are help down for?\r\n\tconst waitPatiently = () => {\r\n\r\n\t\t// we have lost focus\r\n\t\tif ( isMouseOver && isMouseDown )\r\n\t\t{\r\n\t\t\tconst elapsed = now() - mouseDownAt\t\r\n\t\t\r\n\t\t\tif ( elapsed < holdTime )\r\n\t\t\t{\r\n\t\t\t\t// BEFORE HOLDING TIME... ignore?\r\n\t\t\t\tconst remaining = 1 - elapsed / holdTime\r\n\t\t\t\tconst percentageRemaining = 100 - Math.ceil(remaining*100)\r\n\t\t\t\t\r\n\t\t\t\tdispatch( MOUSE_HOLDING, {elapsed, isMouseOver, remaining, percentageRemaining } )\r\n\t\t\t\t\r\n\t\t\t\trequestAnimationFrame( waitPatiently )\r\n\r\n\t\t\t}else{\r\n\t\t\t\tisMouseHeld = true\r\n\r\n\t\t\t\t// HELD long enough\r\n\t\t\t\tif (!onlySendHoldOnMouseUp)\r\n\t\t\t\t{\r\n\t\t\t\t\tdispatch( MOUSE_HELD, {elapsed, isMouseOver} )\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// FIXME\r\n\t\t\t\t// mouseDownAt = -1\r\n\t\t\t}\r\n\t\t} \r\n\t}\r\n\r\n\tconst onMouseUp = event => {\r\n\r\n\t\tevent.preventDefault()\r\n\t\tif (!isMouseDown )\r\n\t\t{\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// should this trigger something else depending on time?\r\n\t\tconst elapsed = now() - mouseDownAt\t\r\n\t\r\n\t\tif ( elapsed < holdTime )\r\n\t\t{\r\n\t\t\tdispatch( MOUSE_TAP, {elapsed, isMouseOver} )\r\n\t\t}else if (isMouseHeld && onlySendHoldOnMouseUp){\r\n\t\t\t\r\n\t\t\tdispatch( MOUSE_HELD, {elapsed, isMouseOver} )\r\n\t\t}\r\n\r\n\t\t//console.log(\"mouseDownFor\", elapsed )\r\n\r\n\t\t// CALLBACKS\r\n\t\t// dispatch( MOUSE_HELD, {elapsed, isMouseOver} )\r\n\t\r\n\t\t// and reset\r\n\t\tmouseDownAt = -1\r\n\t\tisMouseDown = false\r\n\t\tdocument.removeEventListener(\"mouse\", onMouseUp )\r\n\t}\r\n\r\n\t// BUTTON has been pressed!\r\n\tbutton.addEventListener( 'mousedown', event => {\r\n\r\n\t\tmouseDownAt = now()\r\n\t\tisMouseDown = true\r\n\t\tisMouseHeld = false\r\n\t\twaitPatiently()\r\n\t\t\r\n\t\t// TODO: add in document listener in case mouse out and back up?\r\n\t\tevent.preventDefault()\r\n\r\n\t\t// watch for any mouse up\r\n\t\tdocument.addEventListener(\"mouseup\", onMouseUp , false)\r\n\t})\r\n\r\n\t// FIXME: Is mouse out useful here?\r\n\t//button.addEventListener( 'mouseup', onMouseUp, false)\r\n\t\r\n\tbutton.addEventListener( 'mouseover', event => {\r\n\t\tisMouseOver = true\r\n\t})\r\n\t\r\n\tbutton.addEventListener( 'mouseout', event => {\r\n\t\tisMouseOver = false\r\n\t})\r\n\r\n\t// return some controls or destroy?\r\n\treturn button\r\n}\r\n\r\nconst coords = { x:0, y:0 }\r\n\r\nexport const getMouseCoords = () => coords\r\n\r\nexport const watchMouseCoords = (element, callback ) => {\r\n\telement.addEventListener('mousemove', event => {\r\n\t\tcoords.x = event.pageX || event.clientX\r\n\t\tcoords.y = event.pageY || event.clientY\r\n\t\tcallback && callback( coords )\r\n\t}, false )\r\n}\r\n\r\n\t// window.addEventListener('wheel' , event => {\r\n\t\t\r\n\t// \treturn\r\n\r\n\t// \tlet d = event.detail\r\n\t// \tconst w =  event.deltaY || event.wheelDelta\r\n\t// \tlet n = 225\r\n\t// \tlet n1 = n-1\r\n\t// \tlet f\r\n\r\n\t// \t// Normalize delta\r\n\t// \td = d ? w && (f = w/d) ? d/f : -d/1.35 : w/120\r\n\t// \t// Quadratic scale if |d| > 1\r\n\t// \td = d < 1 ? d < -1 ? (-Math.pow(d, 2) - n1) / n : d : (Math.pow(d, 2) + n1) / n\r\n\t// \t// Delta *should* not be greater than 2...\r\n\t// \tconst wheel = Math.min(Math.max(d / 2, -1), 1) * 0.1\r\n\t// \tconst volume = getVolume()\r\n\t// \t//const result = setMasterVolume(volume + wheel)\r\n\r\n\t// \tconsole.log(\"mouse wheel\",{ wheel, volume, result}, event)\t\r\n\t// })\r\n","/**\r\n * Checks to see if all of the things we need for\r\n * this to work are available such as camera, midi etc\r\n */\r\n\r\n// import {testForMIDI} from './audio/midi/midi-out'\r\nexport const testForMIDI = () => navigator.requestMIDIAccess === undefined ? false : true\r\n\r\nexport const hasTouchEvents = () => {\r\n\ttry{ document.createEvent(\"TouchEvent\"); return true; }\r\n\tcatch(e){ return false; }\r\n}\r\n\r\nexport const isTouchDevice = () => 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0\r\n\r\nexport const hasFileHandler = () => 'launchQueue' in window && 'files' in LaunchParams.prototype\r\n\r\n/**\r\n * Is this running inside a NODE environment (rather than browser?)\r\n * @returns Boolean\r\n */\r\nexport const isNode = () => {\r\n\treturn !(typeof process !== 'undefined')\r\n}\r\n\r\n/**\r\n * Is this running inside ELECTRON (rather than Chrome for example)\r\n * @returns Boolean\r\n */\r\n// https://github.com/electron/electron/issues/2288\r\nexport const isElectron = () => {\r\n    // Renderer process\r\n    if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {\r\n        return true\r\n    }\r\n\r\n    // Main process\r\n    if (typeof process !== 'undefined' && typeof process.versions === 'object' && !!process.versions.electron) {\r\n        return true\r\n    }\r\n\r\n    // Detect the user agent when the `nodeIntegration` option is set to false\r\n    if (typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent.indexOf('Electron') >= 0) {\r\n        return true\r\n    }\r\n\r\n    return false\r\n}\r\n\r\n\r\nexport default class Capabilities {\r\n\r\n\t// required = {\r\n\t// \tcamera:false\r\n\t// }\r\n\r\n\t// optional = {\r\n\t// \tmidi:false\r\n\t// }\r\n\r\n\tfileHandlerAvailable = undefined\r\n\twebMIDIAvailable = undefined\r\n\r\n\tcameraAvailble = navigator.getUserMedia !== undefined\r\n\tpwaPossible = (\"serviceWorker\" in navigator)\r\n\r\n\tmouse = undefined\r\n\ttouchScreen = undefined\r\n\telectron = undefined\r\n\tnode = undefined\r\n\t\t\r\n\t/**\r\n\t * returns {Boolean} is this machine capable of running this app?\r\n\t */\r\n\tget willWork(){\r\n\t\treturn this.cameraAvailble\r\n\t}\r\n\r\n\tconstructor(){\r\n\t\tthis.fileHandlerAvailable = hasFileHandler()\r\n\t\tthis.touchScreen = isTouchDevice()\r\n\t\tthis.webMIDIAvailable = testForMIDI()\r\n\t\tthis.mouse = !window.matchMedia( \"(hover: none)\" ).matches\r\n\t\tthis.electron = isElectron()\r\n\t\tthis.node = isNode()\r\n\t}\r\n}","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/**\r\n * Attract Mode! \r\n * This demos the app and allows for a player to totally immerse\r\n * themselves in play without having to concern with actually\r\n * interacting\r\n * getPerson,getPlayers\r\n\tfetchPlayerOptions,setPlayerOption, setPlayerOptions,\r\n\tlanguage, \r\n\t...ui, \r\n\t...information,\r\n\tsetBPM, setMasterVolume,\r\n\tloadInstruments, \r\n\tloadRandomInstrument, previousInstrument, nextInstrument,\r\n\ttoggleRecording\r\n */\r\n\r\n// in seconds\r\nconst DURATION_BEFORE_AUTOMATIC_INSTRUMENT_CHANGE = 60 * 3\r\n\r\nexport default class Attractor{\r\n\r\n\tbarCounter = 0\r\n\r\n\tconstructor( application ) {\r\n\t\tthis.application = application\r\n\t}\r\n\r\n\t/**\r\n\t * Tick this along!\r\n\t */\r\n\ttick(elapsed, barProgress=0){\r\n\r\n\t\tconst players = this.application.getPlayers() \r\n\t\tconst userActive = this.application.isUserActive()\r\n\t\tif (!userActive )\r\n\t\t{\r\n\t\t\t// inactive - ATTRACT MODE\r\n\t\t\tif (barProgress === 0)\r\n\t\t\t{\r\n\t\t\t\tthis.barCounter++\r\n\r\n\t\t\t\tplayers.forEach( player => {\r\n\t\t\t\t\tif ( !player.isFormShowing && player.timeSinceInstrumentChanged > DURATION_BEFORE_AUTOMATIC_INSTRUMENT_CHANGE )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t//console.log(\"Has player been stuck on this instrument too long?\", player.timeSinceInstrumentChanged, DURATION_BEFORE_AUTOMATIC_INSTRUMENT_CHANGE)\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tplayer.loadRandomInstrument()\r\n\r\n\t\t\t\t\t\t// change styles use array for 2 people...\r\n\t\t\t\t\t\t// this.application.setPlayerOption(\"scleraRadius\",value)\r\n\t\t\t\t\t\t// this.application.setPlayerOptions({ \r\n\t\t\t\t\t\t// \tscleraRadius:eye.s,\r\n\t\t\t\t\t\t// \tirisRadius:eye.i,\r\n\t\t\t\t\t\t// \tpupilRadius:eye.p,\r\n\t\t\t\t\t\t// \teyeRatio:eye.a || 1\r\n\t\t\t\t\t\t// saturation:palette.s,\r\n\t\t\t\t\t\t// luminosity:palette.l,\r\n\t\t\t\t\t\t// })\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t// occassionally turn on a feature or two...\r\n\t\t\t\t//this.application.setBPM( Math.random() * 100 + 60 )\r\n\t\t\t\t//console.log(this.counter, \"AUTOMATON:\", elapsed.toFixed(2), \"seconds\", barProgress * 100,  this.application )\r\n\r\n\t\t\t\tif (this.barCounter%2)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.application.setRandomDrumPattern()\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}else{\r\n\r\n\t\t\t// active - just change instruments every now and then\r\n\t\t\tif (barProgress === 0)\r\n\t\t\t{\r\n\t\t\t\t//this.application.setState( 'backingTrack', true )\r\n\t\t\t\tthis.barCounter++\r\n\t\t\t\tplayers.forEach( player => {\r\n\t\t\t\t\tif ( player.timeSinceInstrumentChanged > DURATION_BEFORE_AUTOMATIC_INSTRUMENT_CHANGE )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tplayer.loadRandomInstrument()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (this.barCounter%2)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.application.setRandomDrumPattern()\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}else{\r\n\t\t\t\t//this.application.setState( 'backingTrack', false )\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// FIXME: \r\n\t\t//console.log(this.barCounter, \"AUTOMATON:\", elapsed.toFixed(2) + \"seconds\", barProgress,  {players, userActive, photoSYNTH: this.application,} )\r\n\t}\r\n\r\n\t// every frame....\r\n\ttock(elapsed, barProgress){\r\n\t\t// FIXME: \r\n\t\t// console.log(this.counter, \"AUTOMATON:\", elapsed.toFixed(2), \"seconds\", barProgress * 100,  this.application )\r\n\t}\r\n\r\n}","module.exports = Promise.all([require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-url').getBundleURL('hAF7M') + \"interface.314bad26.js\" + \"?\" + Date.now()).catch(err => {delete module.bundle.cache[module.id]; throw err;}), require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-url').getBundleURL('hAF7M') + \"interface.6185bf9f.js\" + \"?\" + Date.now()).catch(err => {delete module.bundle.cache[module.id]; throw err;})]).then(() => module.bundle.root('eYDPu'));"],"names":[],"version":3,"file":"app.81e41450.js.map","sourceRoot":"/__parcel_source_root/"}