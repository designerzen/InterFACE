/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
import{_FusedMatMul as e,broadcast_util as t,util as n,Abs as a,backend_util as r,Add as s,AddN as u,Identity as i,Transpose as o,All as d,Any as l,ArgMax as p,AvgPool as c,Reshape as m,BatchMatMul as f,slice_util as h,buffer as b,Slice as _,BatchToSpaceND as y,Cast as g,Ceil as w,ClipByValue as k,Concat as I,Conv2D as v,Conv2DBackpropInput as S,Cos as M,Cosh as x,CropAndResize as A,Cumprod as F,Cumsum as N,DepthToSpace as E,DepthwiseConv2dNative as R,Elu as C,Equal as O,Exp as D,ExpandDims as T,Fill as P,FlipLeftRight as W,Floor as L,FloorDiv as z,FusedBatchNorm as j,FusedConv2D as H,FusedDepthwiseConv2D as U,GatherNd as B,gather_util as q,GatherV2 as G,Greater as V,GreaterEqual as $,LeakyRelu as K,Less as X,LessEqual as Q,Log as Z,LogicalAnd as Y,LogicalNot as J,LogicalOr as ee,LogicalXor as te,Max as ne,Maximum as ae,MaxPool as re,Mean as se,Min as ue,Minimum as ie,MirrorPad as oe,Multiply as de,Neg as le,NonMaxSuppressionV3 as pe,NonMaxSuppressionV4 as ce,NonMaxSuppressionV5 as me,NotEqual as fe,OneHot as he,OnesLike as be,Pack as _e,PadV2 as ye,Pow as ge,Prelu as we,Prod as ke,Range as Ie,RealDiv as ve,Relu as Se,Relu6 as Me,ResizeBilinear as xe,ResizeNearestNeighbor as Ae,Reverse as Fe,RotateWithOffset as Ne,Round as Ee,Rsqrt as Re,ScatterNd as Ce,scatter_util as Oe,Select as De,Sigmoid as Te,Sin as Pe,Softmax as We,SpaceToBatchND as Le,SparseFillEmptyRows as ze,SparseReshape as je,SparseSegmentMean as He,SparseSegmentSum as Ue,SplitV as Be,Sqrt as qe,Square as Ge,SquaredDifference as Ve,Step as $e,StridedSlice as Ke,StringNGrams as Xe,StringSplit as Qe,StringToHashBucketFast as Ze,Sub as Ye,Sum as Je,Tan as et,Tanh as tt,Tile as nt,TopK as at,Transform as rt,Unpack as st,ZerosLike as ut,registerKernel as it,env as ot,KernelBackend as dt,DataStorage as lt,engine as pt,deprecationWarn as ct,registerBackend as mt}from"@tensorflow/tfjs-core";import ft from"path";import ht from"fs";import bt from"worker_threads";import _t from"perf_hooks";import yt from"os";var gt,wt;let kt;!function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"}(gt||(gt={})),function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"}(wt||(wt={}));const It={kernelName:e,backendName:"wasm",setupFunc:function(t){kt=t.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{a:s,b:u,bias:i,preluActivationWeights:o}=n;if("float32"!==s.dtype||"float32"!==u.dtype)throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");const{transposeA:d,transposeB:l,activation:p,leakyreluAlpha:c}=r,m=a.dataIdMap.get(s.dataId).id,f=a.dataIdMap.get(u.dataId).id;let h=0;if(null!=i){const e=a.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${e.shape.length}.`);h=e.id}const b=null==o?0:a.dataIdMap.get(o.dataId).id,_=wt[p];if(null==_)throw new Error(`${p} activation not yet supported for FusedConv2D in the wasm backend.`);const y=d?s.shape[2]:s.shape[1],g=l?u.shape[1]:u.shape[2],w=t.assertAndGetBroadcastShape(s.shape.slice(0,-2),u.shape.slice(0,-2)),k=a.makeOutput([...w,y,g],s.dtype),I=a.dataIdMap.get(k.dataId).id,v=new Uint8Array(new Int32Array(s.shape).buffer),S=new Uint8Array(new Int32Array(u.shape).buffer);return kt(m,v,s.shape.length,f,S,u.shape.length,d,l,_,h,b,c||0,I),k}};function vt(e,t){let a;return{kernelName:e,backendName:"wasm",setupFunc:function(t){a=t.wasm.cwrap(e,null,["number","number","number"])},kernelFunc:function(e){const{backend:r,inputs:{x:s}}=e,u=r.dataIdMap.get(s.dataId).id,i=r.makeOutput(s.shape,t||s.dtype),o=r.dataIdMap.get(i.dataId).id;return 0===n.sizeFromShape(i.shape)||a(u,gt[s.dtype],o),i}}}const St=vt(a);function Mt(e,t,a){let s;return{kernelName:e,backendName:"wasm",setupFunc:function(t){s=t.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:u}=e,{a:i,b:o}=u,d=t.dataIdMap.get(i.dataId).id,l=t.dataIdMap.get(o.dataId).id,p=null!=a?a:i.dtype,c=r.assertAndGetBroadcastShape(i.shape,o.shape),m=t.makeOutput(c,p);if(0===n.sizeFromShape(c))return m;const f=new Uint8Array(new Int32Array(i.shape).buffer),h=new Uint8Array(new Int32Array(o.shape).buffer),b=t.dataIdMap.get(m.dataId).id;return s(d,f,i.shape.length,l,h,o.shape.length,gt[i.dtype],b),m}}}const xt=Mt(s);let At;const Ft={kernelName:u,backendName:"wasm",setupFunc:function(e){At=e.wasm.cwrap(u,null,["array","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:a}=e,r=a.makeOutput(t[0].shape,t[0].dtype);if(0===n.sizeFromShape(r.shape))return r;const s=t.map((e=>a.dataIdMap.get(e.dataId).id)),u=new Uint8Array(new Int32Array(s).buffer),i=a.dataIdMap.get(r.dataId).id;return At(u,s.length,gt[r.dtype],i),r}};function Nt(e){const{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype),r=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(a).set(r),a}const Et={kernelName:i,backendName:"wasm",kernelFunc:Nt};let Rt;function Ct(e){const{inputs:t,backend:n,attrs:a}=e,[r,s]=function(e,t){const n=[],a=[];for(let r=0;r<e.length;++r)1!==e[r]&&n.push(e[r]),1!==e[t[r]]&&a.push(t[r]);for(let e=0;e<a.length;++e){let t=-1;for(let n=0;n<a.length;++n)a[n]>=e&&(-1===t||a[t]>a[n])&&(t=n);a[t]=e}return[n,a]}(t.x.shape,a.perm);let u=!0;for(let e=0;e<s.length;e++)s[e]!==e&&(u=!1);const i=function(e,t){const n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];return n}(t.x.shape,a.perm),o={dataId:t.x.dataId,shape:r,dtype:t.x.dtype};if(u){const e=Nt({inputs:t,backend:n});return e.shape=i,e}const d=n.makeOutput(i,o.dtype),l=n.dataIdMap.get(o.dataId).id,p=n.dataIdMap.get(d.dataId).id,c=new Uint8Array(new Int32Array(s).buffer),m=new Uint8Array(new Int32Array(o.shape).buffer);return Rt(l,m,o.shape.length,gt[o.dtype],p,c,s.length),d}const Ot={kernelName:o,backendName:"wasm",kernelFunc:Ct,setupFunc:function(e){Rt=e.wasm.cwrap(o,null,["number","array","number","number","number","array","number"])}};function Dt(e,t,a){const s=e.shape,u=e.shape.length,i=n.parseAxisParam(t,s);let o=i;const d=r.getAxesPermutation(o,u);let l=null,p=!1;if(null!=d){const t=new Array(u);for(let e=0;e<t.length;e++)t[e]=s[d[e]];o=r.getInnerMostAxes(o.length,u),l=Ct({inputs:{x:e},attrs:{perm:d},backend:a});const n=a.dataIdMap.get(e.dataId).id;a.dataIdMap.get(l.dataId).id!==n&&(p=!0)}return{transposed:l,originalAxes:i,axes:o,inputWasTransposed:p}}let Tt;const Pt={kernelName:d,backendName:"wasm",setupFunc:function(e){Tt=e.wasm.cwrap(d,null,["number, number, number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:s}=e,{axis:u,keepDims:i}=s,{x:o}=a;let d=t.dataIdMap.get(o.dataId).id,l=o;const{transposed:p,axes:c,originalAxes:m,inputWasTransposed:f}=Dt(o,u,t);if(f){l=p,d=t.dataIdMap.get(p.dataId).id}const h=l.shape.length;r.assertAxesAreInnerMostDims("all",c,h);const[b,_]=r.computeOutAndReduceShapes(l.shape,c),y=n.sizeFromShape(_),g=t.makeOutput(b,o.dtype);if(0!==n.sizeFromShape(l.shape)){const e=t.dataIdMap.get(g.dataId).id;Tt(d,y,e)}if(f&&t.disposeData(p.dataId),i){const e=r.expandShapeToKeepDim(g.shape,m);g.shape=e}return g}};let Wt;const Lt={kernelName:l,backendName:"wasm",setupFunc:function(e){Wt=e.wasm.cwrap(l,null,["number, number, number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:s}=e,{axis:u,keepDims:i}=s,{x:o}=a;let d=t.dataIdMap.get(o.dataId).id,l=o;const{transposed:p,axes:c,originalAxes:m,inputWasTransposed:f}=Dt(o,u,t);if(f){l=p,d=t.dataIdMap.get(p.dataId).id}const h=l.shape.length;r.assertAxesAreInnerMostDims("any",c,h);const[b,_]=r.computeOutAndReduceShapes(l.shape,c),y=n.sizeFromShape(_),g=t.makeOutput(b,o.dtype);if(0!==n.sizeFromShape(l.shape)){const e=t.dataIdMap.get(g.dataId).id;Wt(d,y,e)}if(f&&t.disposeData(p.dataId),i){const e=r.expandShapeToKeepDim(g.shape,m);g.shape=e}return g}};let zt;const jt={kernelName:p,backendName:"wasm",kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{axis:s}=r,{x:u}=a,i=t.dataIdMap.get(u.dataId).id;let o=i,d=u;const{transposed:l,axes:p,inputWasTransposed:c}=Dt(u,s,t);if(c){const e=t.dataIdMap.get(l.dataId).id;e!==i&&(d=l,o=e)}const m=d.shape.slice(0,-1),f=t.makeOutput(m,"int32"),h=t.dataIdMap.get(f.dataId).id,b=n.sizeFromShape(f.shape),_=d.shape[p[0]];return zt(o,gt[d.dtype],b,_,h),c&&t.disposeData(l.dataId),f},setupFunc:function(e){zt=e.wasm.cwrap(p,null,["number","number","number","number","number"])}};let Ht;const Ut={kernelName:c,backendName:"wasm",setupFunc:function(e){Ht=e.wasm.cwrap(c,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:a}=e,s=t.x,u=a.dataIdMap.get(s.dataId).id,{filterSize:i,strides:o,pad:d,dimRoundingMode:l}=n,p=r.computePool2DInfo(s.shape,i,o,1,d,l),c=p.filterHeight,m=p.filterWidth,f=p.padInfo.top,h=p.padInfo.right,b=p.padInfo.bottom,_=p.padInfo.left,y=p.strideHeight,g=p.strideWidth,w=p.inChannels;if("channelsLast"!==p.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${p.dataFormat}'. Please use 'channelsLast'.`);if(1!==p.dilationWidth||1!==p.dilationHeight)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${p.dilationHeight}, ${p.dilationWidth}].`);const k=a.makeOutput(p.outShape,"float32"),I=a.dataIdMap.get(k.dataId).id;return Ht(u,s.shape[0],s.shape[1],s.shape[2],c,m,f,h,b,_,y,g,w,I),k}};function Bt(e){const{inputs:t,attrs:a}=e,{x:r}=t,{shape:s}=a,u=n.sizeFromShape(r.shape),i=n.inferFromImplicitShape(s,u);return n.assert(u===n.sizeFromShape(i),(()=>`new shape: ${i}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`)),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:i,dtype:r.dtype}}const qt={kernelName:m,backendName:"wasm",kernelFunc:Bt};let Gt;const Vt={kernelName:f,backendName:"wasm",setupFunc:function(e){Gt=e.wasm.cwrap(f,null,["number","array","number","number","array","number","number","number","number"])},kernelFunc:function(e){const{inputs:a,backend:r,attrs:s}=e,{a:u,b:i}=a,{transposeA:o,transposeB:d}=s;if("float32"!==u.dtype||"float32"!==i.dtype)throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");const l=u.shape.length,p=i.shape.length,c=o?u.shape[l-2]:u.shape[l-1],m=d?i.shape[p-1]:i.shape[p-2],f=o?u.shape[l-1]:u.shape[l-2],h=d?i.shape[p-2]:i.shape[p-1],b=u.shape.slice(0,-2),_=i.shape.slice(0,-2),y=n.sizeFromShape(b),g=n.sizeFromShape(_),w=t.assertAndGetBroadcastShape(u.shape.slice(0,-2),i.shape.slice(0,-2)).concat([f,h]);n.assert(c===m,(()=>`Error in matMul: inner shapes (${c}) and (${m}) of Tensors with shapes ${u.shape} and ${i.shape} and transposeA=${o} and transposeB=${d} must match.`));const k=d?[g,h,m]:[g,m,h],I=Bt({inputs:{x:u},backend:r,attrs:{shape:o?[y,c,f]:[y,f,c]}}),v=Bt({inputs:{x:i},backend:r,attrs:{shape:k}}),S=r.dataIdMap.get(I.dataId).id,M=r.dataIdMap.get(v.dataId).id,x=o?I.shape[2]:I.shape[1],A=d?v.shape[1]:v.shape[2],F=Math.max(y,g),N=r.makeOutput([F,x,A],I.dtype),E=r.dataIdMap.get(N.dataId).id,R=new Uint8Array(new Int32Array(I.shape).buffer),C=new Uint8Array(new Int32Array(v.shape).buffer);return Gt(S,R,I.shape.length,M,C,v.shape.length,o,d,E),r.disposeData(I.dataId),r.disposeData(v.dataId),N.shape=w,N}};function $t(e,t,a,s,u){const i=h.isSliceContinous(s,t,a),o=n.sizeFromShape(a),d=n.computeStrides(s);if(i){const n=h.computeFlatOffset(t,d);return"string"===u?e.slice(n,n+o):e.subarray(n,n+o)}const l="string"===u?r.fromUint8ToStringArray(e):e,p=b(s,u,l),c=b(a,u);for(let e=0;e<c.size;++e){const n=c.indexToLoc(e),a=n.map(((e,n)=>e+t[n]));c.set(p.get(...a),...n)}return"string"===u?r.fromStringArrayToUint8(c.values):c.values}class Kt{constructor(e,t,a,r,s,u){this.separator=n.encodeString(e),this.nGramWidths=t,this.leftPad=n.encodeString(a),this.rightPad=n.encodeString(r),this.padWidth=s,this.preserveShort=u}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,a,r,s){for(let u=0;u<r;++u){const i=this.getPadWidth(s),o=Math.max(0,i-u),d=Math.max(0,i-(r-(u+1))),l=s-(o+d),p=t+(o>0?0:u-i);let c=0;c+=o*this.leftPad.length;for(let t=0;t<l;++t)c+=e[p+t].length;c+=d*this.rightPad.length;c+=(o+d+l-1)*this.separator.length,n[a+u]=new Uint8Array(c);const m=n[a+u];let f=0;const h=e=>e.forEach((e=>m[f++]=e));for(let e=0;e<o;++e)h(this.leftPad),h(this.separator);for(let t=0;t<l-1;++t)h(e[p+t]),h(this.separator);if(l>0){h(e[p+l-1]);for(let e=0;e<d;++e)h(this.separator),h(this.rightPad)}else{for(let e=0;e<d-1;++e)h(this.rightPad),h(this.separator);h(this.rightPad)}}}compute(e,t){const a=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error(`First split value must be 0, got ${e}`);for(let n=1;n<r;++n){let r=t[n]>=e;if(r=r&&t[n]<=a,!r)throw new Error(`Invalid split value ${t[n]}, must be in [${e}, ${a}]`);e=t[n]}if(e!==a)throw new Error(`Last split value must be data size. Expected ${a}, got ${e}`)}const s=r-1,u=n.getArrayFromDType("int32",r);if(0===a||0===r){const e=new Array(a);for(let e=0;e<=s;++e)u[e]=0;return[e,u]}u[0]=0;for(let e=1;e<=s;++e){const n=t[e]-t[e-1];let a=0;this.nGramWidths.forEach((e=>{a+=this.getNumNGrams(n,e)})),this.preserveShort&&n>0&&0===a&&(a=1),u[e]=u[e-1]+a}const i=new Array(u[s]);for(let n=0;n<s;++n){const a=t[n];let r=u[n];if(this.nGramWidths.forEach((s=>{const u=t[n+1]-t[n],o=this.getNumNGrams(u,s);this.createNGrams(e,a,i,r,o,s),r+=o})),this.preserveShort&&r===u[n]){const s=t[n+1]-t[n];if(0===s)continue;const u=s+2*this.padWidth,o=1;this.createNGrams(e,a,i,r,o,u)}}return[i,u]}}function Xt(e,t,n,a){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)a.push(e.subarray(t,t+1));return}if(1===t.length){const r=t[0];let s=e.indexOf(r);for(;-1!==s;){const t=e.subarray(0,s);n&&0===t.length||a.push(t),s=(e=e.subarray(s+1)).indexOf(r)}return void(n&&0===e.length||a.push(e))}let r=0;for(let s=0;s<e.length+1;s++)if(s===e.length||-1!==t.indexOf(e[s])){const t=e.subarray(r,s);n&&0===t.length||a.push(t),r=s+1}}function Qt(e){const{inputs:{x:t},attrs:{begin:a,size:r},backend:s}=e,[u,i]=h.parseSliceParams(t,a,r),o=h.isSliceContinous(t.shape,u,i),d=s.readSync(t.dataId),l=s.makeOutput(i,t.dtype),p=n.computeStrides(t.shape),c=s.dataIdMap.get(l.dataId);if(o){const e=h.computeFlatOffset(u,p);if("string"===t.dtype)c.stringBytes=d.slice(e,e+n.sizeFromShape(i));else{s.typedArrayFromHeap(l).set(d.subarray(e,e+n.sizeFromShape(i)))}return l}if("string"===t.dtype){const e=$t(d,u,i,t.shape,t.dtype);return c.stringBytes=e,l}const m=s.typedArrayFromHeap(l),f=t.shape.length;if(2===f)!function(e,t,n,a,r){let s=0;const u=a[0],i=a[1],o=u+r[0];for(let a=u;a<o;a++){const u=a*t+i;n.set(e.subarray(u,u+r[1]),s),s+=r[1]}}(d,p[0],m,u,i);else if(3===f)!function(e,t,n,a,r,s){let u=0;const i=r[0],o=r[1],d=r[2],l=i+s[0],p=o+s[1];for(let r=i;r<l;r++)for(let i=o;i<p;i++){const o=r*t+i*n+d;a.set(e.subarray(o,o+s[2]),u),u+=s[2]}}(d,p[0],p[1],m,u,i);else if(4===f)!function(e,t,n,a,r,s,u){let i=0;const o=s[0],d=s[1],l=s[2],p=o+u[0],c=d+u[1],m=l+u[2],f=s[3];for(let s=o;s<p;s++)for(let o=d;o<c;o++)for(let d=l;d<m;d++){const l=s*t+o*n+d*a+f;r.set(e.subarray(l,l+u[3]),i),i+=u[3]}}(d,p[0],p[1],p[2],m,u,i);else{const e=$t(d,u,i,t.shape,t.dtype);m.set(e)}return l}const Zt={kernelName:_,backendName:"wasm",kernelFunc:Qt};const Yt={kernelName:y,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{blockShape:u,crops:i}=a,o=u.reduce(((e,t)=>e*t)),d=r.getReshaped(s.shape,u,o),l=r.getPermuted(d.length,u.length),p=r.getReshapedPermuted(s.shape,u,o),c=r.getSliceBeginCoords(i,u.length),m=r.getSliceSize(p,i,u.length),f=Bt({inputs:{x:s},backend:n,attrs:{shape:d}}),h=Ct({inputs:{x:f},backend:n,attrs:{perm:l}}),b=Qt({inputs:{x:Bt({inputs:{x:h},backend:n,attrs:{shape:p}})},backend:n,attrs:{begin:c,size:m}});return n.disposeData(f.dataId),n.disposeData(h.dataId),n.disposeData(f.dataId),b}};function Jt(e){const{inputs:{x:t},attrs:{dtype:n},backend:a}=e,r=a.makeOutput(t.shape,n),s=a.typedArrayFromHeap(t);return a.typedArrayFromHeap(r).set(s),r}const en={kernelName:g,backendName:"wasm",kernelFunc:Jt},tn=vt(w);let nn;const an={kernelName:k,backendName:"wasm",setupFunc:function(e){nn=e.wasm.cwrap(k,null,["number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{clipValueMin:s,clipValueMax:u}=a,i=n.dataIdMap.get(r.dataId).id,o=n.makeOutput(r.shape,r.dtype),d=n.dataIdMap.get(o.dataId).id;return nn(i,s,u,d),o}};function rn(e){const{inputs:t,backend:a}=e,s=n.parseAxisParam(e.attrs.axis,t[0].shape)[0];let u=r.computeOutShape(t.map((e=>e.shape)),s);const i=t.filter((e=>n.sizeFromShape(e.shape)>0));if(1===i.length)return Nt({inputs:{x:i[0]},backend:a});const o=a.makeOutput(u,t[0].dtype);if(0===n.sizeFromShape(u))return o;const d=i.map((e=>e.shape));if(r.assertParamsConsistent(d,s),"string"===i[0].dtype){const e=i.map((e=>{const t=n.sizeFromShape(e.shape.slice(s));return Bt({inputs:{x:e},backend:a,attrs:{shape:[-1,t]}})})),d=e.map((e=>({vals:a.readSync(e.dataId),shape:e.shape})));u=r.computeOutShape(e.map((e=>e.shape)),1);const l=1===e[0].shape[0],p=function(e,t,a,s){const u=n.getArrayFromDType(a,n.sizeFromShape(t));if(s&&"string"!==a){let t=0;e.forEach((e=>{const a=n.sizeFromShape(e.shape);u.set(e.vals,t),t+=a}))}else{let n=0;e.forEach((e=>{const s="string"===a?r.fromUint8ToStringArray(e.vals):e.vals;let i=0;for(let a=0;a<e.shape[0];++a){const r=a*t[1]+n;for(let t=0;t<e.shape[1];++t)u[r+t]=s[i++]}n+=e.shape[1]}))}return u}(d,u,t[0].dtype,l),c=r.computeOutShape(i.map((e=>e.shape)),s);o.shape=c;return a.dataIdMap.get(o.dataId).stringBytes=r.fromStringArrayToUint8(p),e.forEach((e=>a.disposeData(e.dataId))),o}const l=n.sizeFromShape(i[0].shape.slice(0,s));let p=0;const c=i.map((e=>{const t=n.sizeFromShape(e.shape.slice(s));return p+=t,t})),m=i.map((e=>a.typedArrayFromHeap(e))),f=a.typedArrayFromHeap(o);for(let e=0;e<l;e++){let t=e*p;for(let n=0;n<m.length;n++){const a=c[n],r=e*a,s=m[n].subarray(r,r+a);f.set(s,t),t+=a}}return o}const sn={kernelName:I,backendName:"wasm",kernelFunc:rn};let un;const on={kernelName:v,backendName:"wasm",setupFunc:function(e){un=e.wasm.cwrap(v,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:a}=e,{x:s,filter:u}=t,i=a.dataIdMap.get(s.dataId).id,o=a.dataIdMap.get(u.dataId).id,{strides:d,dilations:l,pad:p,dimRoundingMode:c,dataFormat:m}=n,f=r.convertConv2DDataFormat(m),h=r.computeConv2DInfo(s.shape,u.shape,d,l,p,c,!1,f),b=h.filterHeight,_=h.filterWidth,y=h.padInfo.top,g=h.padInfo.right,w=h.padInfo.bottom,k=h.padInfo.left,I=h.dilationHeight,v=h.dilationWidth,S=h.strideHeight,M=h.strideWidth,x=h.inChannels,A=h.outChannels,F="SAME"===h.padInfo.type?1:0;if("channelsLast"!==h.dataFormat)throw new Error(`wasm backend Conv2D does not support dataFormat:'${h.dataFormat}'. Please use 'channelsLast'.`);const N=a.makeOutput(h.outShape,"float32"),E=a.dataIdMap.get(N.dataId).id;return un(i,s.shape[0],s.shape[1],s.shape[2],o,b,_,y,g,w,k,F,I,v,S,M,x,A,E),N}};let dn;const ln={kernelName:S,backendName:"wasm",setupFunc:function(e){dn=e.wasm.cwrap(S,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:s}=e,{dy:u,filter:i}=a,{strides:o,pad:d,dataFormat:l,dimRoundingMode:p,inputShape:c}=s,m=r.convertConv2DDataFormat(l),f=r.computeConv2DInfo(c,i.shape,o,1,d,p,!1,m),{batchSize:h,filterHeight:b,filterWidth:_,inChannels:y,inHeight:g,inWidth:w,outChannels:k,outHeight:I,outWidth:v,strideHeight:S,strideWidth:M}=f,x=b-1-f.padInfo.top,A=_-1-f.padInfo.left,F="channelsLast"===f.dataFormat,N=n.computeStrides(f.inShape),E=n.computeStrides(u.shape),[R,C,O]=n.computeStrides(i.shape),D=N[0],T=F?N[1]:N[2],P=F?N[2]:1,W=F?1:N[1],L=E[0],z=F?E[1]:E[2],j=F?E[2]:1,H=F?1:E[1],U=t.makeOutput(f.inShape,"float32"),B=t.dataIdMap.get(U.dataId).id,q=t.dataIdMap.get(u.dataId).id,G=t.dataIdMap.get(i.dataId).id;return dn(q,G,h,b,_,g,w,y,I,v,k,S,M,x,A,R,C,O,D,T,P,W,L,z,j,H,B),U}},pn=vt(M),cn=vt(x);var mn;let fn;!function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"}(mn||(mn={}));const hn={kernelName:A,backendName:"wasm",setupFunc:function(e){fn=e.wasm.cwrap(A,null,["number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{method:r,extrapolationValue:s,cropSize:u}=a,{image:i,boxes:o,boxInd:d}=n,l=o.shape[0],[p,c]=u,m=[l,p,c,i.shape[3]];let f,h=t.dataIdMap.get(i.dataId);"float32"!==i.dtype&&(f=Jt({backend:t,inputs:{x:i},attrs:{dtype:"float32"}}),h=t.dataIdMap.get(f.dataId));const b=h.id,_=t.dataIdMap.get(o.dataId).id,y=t.dataIdMap.get(d.dataId).id,g=t.makeOutput(m,"float32"),w=t.dataIdMap.get(g.dataId).id,k=new Uint8Array(new Int32Array(i.shape).buffer);return fn(b,_,y,l,k,p,c,mn[r],s,w),null!=f&&t.disposeData(f.dataId),g}};let bn;const _n={kernelName:F,backendName:"wasm",setupFunc:function(e){bn=e.wasm.cwrap(F,null,["number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:a,attrs:s}=e,{x:u}=t,{axis:i,exclusive:o,reverse:d}=s,l=u.shape.length;n.assert("float32"===u.dtype||"int32"===u.dtype,(()=>`cumprod does not support ${u.dtype} tensors in the WASM backend`));const p=r.getAxesPermutation([i],l);let c=u;null!==p&&(c=Ct({inputs:{x:u},attrs:{perm:p},backend:a}));const m=r.getInnerMostAxes(1,l)[0];r.assertAxesAreInnerMostDims("cumprod",[m],l);const f=a.makeOutput(c.shape,c.dtype),h=c.shape[m],b=a.dataIdMap.get(c.dataId).id,_=a.dataIdMap.get(f.dataId).id;bn(b,o?1:0,d?1:0,h,_,gt[u.dtype]);let y=f;if(null!==p){y=Ct({inputs:{x:f},attrs:{perm:r.getUndoAxesPermutation(p)},backend:a}),a.disposeData(c.dataId),a.disposeData(f.dataId)}return y}};let yn;const gn={kernelName:N,backendName:"wasm",setupFunc:function(e){yn=e.wasm.cwrap(N,null,["number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:a,attrs:s}=e,{x:u}=t,{axis:i,exclusive:o,reverse:d}=s,l=u.shape.length;n.assert("float32"===u.dtype||"int32"===u.dtype,(()=>`cumsum does not support ${u.dtype} tensors in the WASM backend`));const p=r.getAxesPermutation([i],l);let c=u;null!==p&&(c=Ct({inputs:{x:u},attrs:{perm:p},backend:a}));const m=r.getInnerMostAxes(1,l)[0];r.assertAxesAreInnerMostDims("cumsum",[m],l);const f=a.makeOutput(c.shape,c.dtype),h=c.shape[m],b=a.dataIdMap.get(c.dataId).id,_=a.dataIdMap.get(f.dataId).id;yn(b,o?1:0,d?1:0,h,_,gt[u.dtype]);let y=f;if(null!==p){y=Ct({inputs:{x:f},attrs:{perm:r.getUndoAxesPermutation(p)},backend:a}),a.disposeData(c.dataId),a.disposeData(f.dataId)}return y}};let wn;const kn={kernelName:E,backendName:"wasm",setupFunc:function(e){wn=e.wasm.cwrap(E,null,["number","number","number","array","number","array","array","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{x:s}=a,{blockSize:u,dataFormat:i}=r,o=s.shape[0],d=("NHWC"===i?s.shape[1]:s.shape[2])*u,l=("NHWC"===i?s.shape[2]:s.shape[3])*u,p=("NHWC"===i?s.shape[3]:s.shape[1])/(u*u),c="NHWC"===i?[o,d,l,p]:[o,p,d,l],m=t.makeOutput(c,"float32"),f=t.dataIdMap.get(s.dataId).id,h=new Uint8Array(new Int32Array(n.computeStrides(s.shape)).buffer),b=new Uint8Array(new Int32Array(c).buffer),_=new Uint8Array(new Int32Array(n.computeStrides(c)).buffer),y=t.dataIdMap.get(m.dataId).id;return wn(f,u,"NHWC"===i?1:0,h,s.shape.length-1,b,_,c.length,y),m}};let In;const vn={kernelName:R,backendName:"wasm",setupFunc:function(e){In=e.wasm.cwrap(R,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:a}=e,{x:s,filter:u}=t,i=a.dataIdMap.get(s.dataId).id,o=a.dataIdMap.get(u.dataId).id,{strides:d,dilations:l,pad:p,dimRoundingMode:c}=n,m=null==l?[1,1]:l,f=r.computeConv2DInfo(s.shape,u.shape,d,m,p,c,!0),h=f.filterHeight,b=f.filterWidth,_=f.padInfo.top,y=f.padInfo.right,g=f.padInfo.bottom,w=f.padInfo.left,k=f.dilationHeight,I=f.dilationWidth,v=f.strideHeight,S=f.strideWidth,M=f.inChannels,x=f.outChannels,A="SAME"===f.padInfo.type?1:0;if("channelsLast"!==f.dataFormat)throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${f.dataFormat}'. Please use 'channelsLast'.`);const F=a.makeOutput(f.outShape,"float32"),N=a.dataIdMap.get(F.dataId).id;return In(i,s.shape[0],s.shape[1],s.shape[2],o,h,b,_,y,g,w,A,k,I,v,S,M,x,N),F}},Sn=vt(C),Mn=Mt(O,0,"bool"),xn=vt(D,"float32");function An(e){const{inputs:t,attrs:a,backend:r}=e,{input:s}=t,{dim:u}=a,i=s.shape.length,o=s.shape.slice();let d=u;return u<0&&(n.assert(-(i+1)<=u,(()=>`Axis must be in the interval [${-(i+1)}, ${i}]`)),d=i+u+1),o.splice(d,0,1),Bt({inputs:{x:s},backend:r,attrs:{shape:o}})}const Fn={kernelName:T,backendName:"wasm",kernelFunc:An};function Nn(e){const{attrs:{shape:t,value:n,dtype:a},backend:r}=e,s=r.makeOutput(t,a);return r.typedArrayFromHeap(s).fill(n),s}const En={kernelName:P,backendName:"wasm",kernelFunc:Nn};let Rn;const Cn={kernelName:W,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n}=e,{image:a}=t,r=n.makeOutput(a.shape,a.dtype),s=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(r.dataId).id,[i,o,d,l]=a.shape;return Rn(s,i,o,d,l,u),r},setupFunc:function(e){Rn=e.wasm.cwrap(W,null,["number","number","number","number","number","number"])}},On=vt(L),Dn=Mt(z);let Tn;const Pn={kernelName:j,backendName:"wasm",setupFunc:function(e){Tn=e.wasm.cwrap(j,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{varianceEpsilon:s}=r,{x:u,mean:i,variance:o,offset:d,scale:l}=a,p=t.dataIdMap.get(u.dataId).id,c=t.dataIdMap.get(i.dataId).id,m=t.dataIdMap.get(o.dataId).id,f=null!=d?t.dataIdMap.get(d.dataId).id:0,h=null!=l?t.dataIdMap.get(l.dataId).id:0,b=t.makeOutput(u.shape,u.dtype);if(0===n.sizeFromShape(u.shape))return b;const _=t.dataIdMap.get(b.dataId).id;return Tn(p,c,m,f,h,s,_),b}};let Wn;const Ln={kernelName:H,backendName:"wasm",setupFunc:function(e){Wn=e.wasm.cwrap(H,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:a}=e,{x:s,filter:u,bias:i,preluActivationWeights:o}=t,{strides:d,pad:l,dilations:p,dataFormat:c,dimRoundingMode:m,activation:f,leakyreluAlpha:h}=n,b=r.computeConv2DInfo(s.shape,u.shape,d,p,l,m),_=wt[f];if(null==_)throw new Error(`${f} activation not yet supported for FusedConv2D in the wasm backend.`);const y=a.dataIdMap.get(s.dataId).id,g=a.dataIdMap.get(u.dataId).id,w=b.outChannels;let k=0;if(null!=i){const e=a.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==w)throw new Error(`FusedConv2D bias shape (${e.shape}) does not match the number of output channels (${w})`);k=e.id}const I=b.filterHeight,v=b.filterWidth,S=b.padInfo.top,M=b.padInfo.right,x=b.padInfo.bottom,A=b.padInfo.left,F=b.dilationHeight,N=b.dilationWidth,E=b.strideHeight,R=b.strideWidth,C=b.inChannels,O="SAME"===b.padInfo.type?1:0,D=b.batchSize,T=b.inHeight,P=b.inWidth;if("NHWC"!==c)throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${c}'. Please use 'NHWC'.`);const W=a.makeOutput(b.outShape,"float32"),L=a.dataIdMap.get(W.dataId).id,z=null==o?0:a.dataIdMap.get(o.dataId).id;return Wn(y,D,T,P,g,I,v,k,S,M,x,A,O,F,N,E,R,C,w,_,z,h||0,L),W}};let zn;const jn={kernelName:U,backendName:"wasm",setupFunc:function(e){zn=e.wasm.cwrap(U,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:a}=e,{x:s,filter:u,bias:i,preluActivationWeights:o}=t,{strides:d,pad:l,dilations:p,dataFormat:c,dimRoundingMode:m,activation:f,leakyreluAlpha:h}=n,b=r.computeConv2DInfo(s.shape,u.shape,d,p,l,m,!0),_=wt[f];if(null==_)throw new Error(`${f} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);const y=a.dataIdMap.get(s.dataId).id,g=a.dataIdMap.get(u.dataId).id,w=b.outChannels;let k=0;if(null!=i){const e=a.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==w)throw new Error(`FusedDepthwiseConv2D bias shape (${e.shape}) does not match the number of output channels (${w})`);k=e.id}const I=b.filterHeight,v=b.filterWidth,S=b.padInfo.top,M=b.padInfo.right,x=b.padInfo.bottom,A=b.padInfo.left,F=b.dilationHeight,N=b.dilationWidth,E=b.strideHeight,R=b.strideWidth,C=b.inChannels,O="SAME"===b.padInfo.type?1:0,D=b.batchSize,T=b.inHeight,P=b.inWidth;if("NHWC"!==c)throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${c}'. Please use 'NHWC'.`);const W=a.makeOutput(b.outShape,"float32"),L=a.dataIdMap.get(W.dataId).id,z=null==o?0:a.dataIdMap.get(o.dataId).id;return zn(y,D,T,P,g,I,v,k,S,M,x,A,O,F,N,E,R,C,w,_,z,h||0,L),W}};let Hn;const Un={kernelName:B,backendName:"wasm",setupFunc:function(e){Hn=e.wasm.cwrap(B,null,["number","number","number","number","number","number","array","number"])},kernelFunc:function(e){const{backend:t,inputs:n}=e,{params:a,indices:r}=n,[s,u,i,o]=q.prepareAndValidate(a,r),d=t.makeOutput(s,a.dtype);if(0===u)return d;const l=r.shape,p=l[l.length-1],c=t.dataIdMap.get(a.dataId).id,m=t.dataIdMap.get(r.dataId).id,f=new Uint8Array(new Int32Array(o).buffer),h=t.dataIdMap.get(d.dataId).id;return Hn(c,gt[a.dtype],m,u,p,i,f,h),d}};let Bn;const qn={kernelName:G,backendName:"wasm",setupFunc:function(e){Bn=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:s}=e,{x:u,indices:i}=a,{axis:o,batchDims:d}=s,l=n.parseAxisParam(o,u.shape)[0],p=t.readSync(i.dataId),c=u.shape[l];for(let e=0;e<p.length;++e){const t=p[e];n.assert(t<=c-1&&t>=0,(()=>`GatherV2: the index value ${t} is not in [0, ${c-1}]`))}const m=r.segment_util.collectGatherOpShapeInfo(u,i,l,d),f=Bt({inputs:{x:u},attrs:{shape:[m.batchSize,m.outerSize,m.dimSize,m.sliceSize]},backend:t}),h=n.sizeFromShape(i.shape),b=Bt({inputs:{x:i},attrs:{shape:[m.batchSize,h/m.batchSize]},backend:t}),_=[m.batchSize,m.outerSize,h/m.batchSize,m.sliceSize],y=t.makeOutput(_,u.dtype);if(0===n.sizeFromShape(u.shape))return y;const g=f.shape.length-1,w=t.dataIdMap.get(f.dataId).id,k=t.dataIdMap.get(b.dataId).id,I=t.dataIdMap.get(y.dataId).id,v=new Uint8Array(new Int32Array(n.computeStrides(f.shape)).buffer),S=new Uint8Array(new Int32Array(n.computeStrides(_)).buffer);return Bn(w,gt[u.dtype],v,g,k,m.batchSize,S,I),t.disposeData(f.dataId),t.disposeData(b.dataId),y.shape=m.outputShape,y}},Gn=Mt(V,0,"bool"),Vn=Mt($,0,"bool");let $n;const Kn={kernelName:K,backendName:"wasm",setupFunc:function(e){$n=e.wasm.cwrap(K,null,["number","number","number","number"])},kernelFunc:function(e){const{inputs:{x:t},attrs:{alpha:a},backend:r}=e,s=r.dataIdMap.get(t.dataId).id,u=r.makeOutput(t.shape,"float32");if(0!==n.sizeFromShape(t.shape)){const e=r.dataIdMap.get(u.dataId).id;$n(s,gt[t.dtype],a,e)}return u}},Xn=Mt(X,0,"bool"),Qn=Mt(Q,0,"bool"),Zn=vt(Z),Yn=Mt(Y,0,"bool"),Jn=vt(J),ea=Mt(ee,0,"bool"),ta=Mt(te,0,"bool");let na;const aa={kernelName:ne,backendName:"wasm",setupFunc:function(e){na=e.wasm.cwrap(ne,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:s}=e,{reductionIndices:u,keepDims:i}=s,{x:o}=a;let d=t.dataIdMap.get(o.dataId).id,l=o;const{transposed:p,axes:c,originalAxes:m,inputWasTransposed:f}=Dt(o,u,t);if(f){l=p,d=t.dataIdMap.get(p.dataId).id}const h=l.shape.length;r.assertAxesAreInnerMostDims("max",c,h);const[b,_]=r.computeOutAndReduceShapes(l.shape,c),y=n.sizeFromShape(_),g=t.makeOutput(b,o.dtype);if(0!==n.sizeFromShape(l.shape)){const e=t.dataIdMap.get(g.dataId).id;na(d,gt[o.dtype],y,e)}if(f&&t.disposeData(p.dataId),i){const e=r.expandShapeToKeepDim(g.shape,m);g.shape=e}return g}},ra=Mt(ae);let sa;const ua={kernelName:re,backendName:"wasm",setupFunc:function(e){sa=e.wasm.cwrap(re,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:a,backend:s}=e,u=t.x,i=s.dataIdMap.get(u.dataId).id;n.assert("float32"===u.dtype,(()=>`Error in MaxPool: only float32 input is supported. Got ${u.dtype}.`));const{filterSize:o,strides:d,pad:l,dimRoundingMode:p}=a,c=r.computePool2DInfo(u.shape,o,d,1,l,p),m=c.filterHeight,f=c.filterWidth,h=c.padInfo.top,b=c.padInfo.right,_=c.padInfo.bottom,y=c.padInfo.left,g=c.dilationHeight,w=c.dilationWidth,k=c.strideHeight,I=c.strideWidth,v=c.inChannels,S=c.outChannels;if("channelsLast"!==c.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${c.dataFormat}'. Please use 'channelsLast'.`);const M=s.makeOutput(c.outShape,"float32"),x=s.dataIdMap.get(M.dataId).id;return sa(i,u.shape[0],u.shape[1],u.shape[2],m,f,h,b,_,y,g,w,k,I,v,S,x),M}};let ia;const oa={kernelName:se,backendName:"wasm",setupFunc:function(e){ia=e.wasm.cwrap(se,null,["number, number, number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:s}=e,{axis:u,keepDims:i}=s,{x:o}=a,d=t.dataIdMap.get(o.dataId).id;let l=d,p=o;const{transposed:c,axes:m,originalAxes:f,inputWasTransposed:h}=Dt(o,u,t);let b=m;if(h){const e=t.dataIdMap.get(c.dataId).id;e!==d&&(p=c,l=e,b=r.getInnerMostAxes(b.length,p.shape.length))}r.assertAxesAreInnerMostDims("mean",b,p.shape.length);const[_,y]=r.computeOutAndReduceShapes(p.shape,b),g=n.sizeFromShape(y);let w=p;"float32"!==p.dtype&&(w=Jt({backend:t,inputs:{x:p},attrs:{dtype:"float32"}}),l=t.dataIdMap.get(w.dataId).id);const k=t.makeOutput(_,"float32");if(0!==n.sizeFromShape(p.shape)){const e=t.dataIdMap.get(k.dataId).id;ia(l,g,e)}if(h&&t.disposeData(c.dataId),i){const e=r.expandShapeToKeepDim(k.shape,f);k.shape=e}return"float32"!==p.dtype&&t.disposeData(w.dataId),k}};let da;const la={kernelName:ue,backendName:"wasm",setupFunc:function(e){da=e.wasm.cwrap(ue,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:s}=e,{axis:u,keepDims:i}=s,{x:o}=a,d=t.dataIdMap.get(o.dataId).id;let l=d,p=o;const{transposed:c,axes:m,originalAxes:f,inputWasTransposed:h}=Dt(o,u,t);if(h){const e=t.dataIdMap.get(c.dataId).id;e!==d&&(p=c,l=e)}const b=p.shape.length;r.assertAxesAreInnerMostDims("min",m,b);const[_,y]=r.computeOutAndReduceShapes(p.shape,m),g=n.sizeFromShape(y),w=t.makeOutput(_,p.dtype);if(0!==n.sizeFromShape(p.shape)){const e=t.dataIdMap.get(w.dataId).id;da(l,gt[o.dtype],g,e)}if(h&&t.disposeData(c.dataId),i){const e=r.expandShapeToKeepDim(w.shape,f);w.shape=e}return w}},pa=Mt(ie);var ca;let ma;!function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"}(ca||(ca={}));const fa={kernelName:oe,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n,attrs:{paddings:a,mode:r}}=e,s=a.map(((e,n)=>e[0]+t.shape[n]+e[1])),u=n.dataIdMap.get(t.dataId).id,i=n.makeOutput(s,t.dtype),o=n.dataIdMap.get(i.dataId).id,d=new Uint8Array(new Int32Array(t.shape).buffer),l=a.map((e=>e[0])),p=a.map((e=>e[1])),c=new Uint8Array(new Int32Array(l).buffer),m=new Uint8Array(new Int32Array(p).buffer);return ma(u,d,t.shape.length,gt[t.dtype],c,m,ca[r],o),i},setupFunc:function(e){ma=e.wasm.cwrap(oe,null,["number","array","number","number","array","array","number","number"])}},ha=Mt(de),ba=vt(le);function _a(e,t){const n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),a=n[0],r=n[1],s=n[2],u=n[3];return e.wasm._free(t),{pSelectedIndices:a,selectedSize:r,pSelectedScores:s,pValidOutputs:u}}let ya;const ga={kernelName:pe,backendName:"wasm",setupFunc:function(e){ya=e.wasm.cwrap(pe,"number",["number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:u}=a,{boxes:i,scores:o}=n,d=t.dataIdMap.get(i.dataId).id,l=t.dataIdMap.get(o.dataId).id,p=ya(d,l,s,r,u),{pSelectedIndices:c,selectedSize:m,pSelectedScores:f,pValidOutputs:h}=_a(t,p);return t.wasm._free(f),t.wasm._free(h),t.makeOutput([m],"int32",c)}};let wa;const ka={kernelName:ce,backendName:"wasm",setupFunc:function(e){wa=e.wasm.cwrap(ce,"number",["number","number","number","number","number","bool"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:u,padToMaxOutputSize:i}=a,{boxes:o,scores:d}=n,l=t.dataIdMap.get(o.dataId).id,p=t.dataIdMap.get(d.dataId).id,c=wa(l,p,s,r,u,i),{pSelectedIndices:m,selectedSize:f,pSelectedScores:h,pValidOutputs:b}=_a(t,c);return t.wasm._free(h),[t.makeOutput([f],"int32",m),t.makeOutput([],"int32",b)]}};let Ia;const va={kernelName:me,backendName:"wasm",setupFunc:function(e){Ia=e.wasm.cwrap(me,"number",["number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:u,softNmsSigma:i}=a,{boxes:o,scores:d}=n,l=t.dataIdMap.get(o.dataId).id,p=t.dataIdMap.get(d.dataId).id,c=Ia(l,p,s,r,u,i),{pSelectedIndices:m,selectedSize:f,pSelectedScores:h,pValidOutputs:b}=_a(t,c);return t.wasm._free(b),[t.makeOutput([f],"int32",m),t.makeOutput([f],"float32",h)]}},Sa=Mt(fe,0,"bool");let Ma;const xa={kernelName:he,backendName:"wasm",setupFunc:function(e){Ma=e.wasm.cwrap(he,null,["number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:s,depth:u,onValue:i,offValue:o}=a,d=n.makeOutput([...r.shape,u],s),l=n.dataIdMap.get(d.dataId).id,p=n.dataIdMap.get(r.dataId).id;return Ma(p,u,i,o,l),d}};const Aa={kernelName:be,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(1),a}};const Fa={kernelName:_e,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:a,attrs:r}=e,{axis:s}=r;if(1===t.length)return An({inputs:{input:t[0]},backend:a,attrs:{dim:s}});const u=t[0].shape,i=t[0].dtype;t.forEach((e=>{n.assertShapesMatch(u,e.shape,"All tensors passed to stack must have matching shapes"),n.assert(i===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const o=[],d=rn({inputs:t.map((e=>{const t=An({inputs:{input:e},backend:a,attrs:{dim:s}});return o.push(t),t})),backend:a,attrs:{axis:s}});return o.forEach((e=>a.disposeData(e.dataId))),d}};let Na;const Ea={kernelName:ye,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:a,attrs:{paddings:r,constantValue:s}}=e,u=r.map(((e,n)=>e[0]+t.shape[n]+e[1]));if(0===n.sizeFromShape(t.shape))return Nn({backend:a,attrs:{shape:u,value:s,dtype:t.dtype}});const i=a.dataIdMap.get(t.dataId).id,o=a.makeOutput(u,t.dtype),d=a.dataIdMap.get(o.dataId).id,l=new Uint8Array(new Int32Array(t.shape).buffer),p=r.map((e=>e[0])),c=r.map((e=>e[1])),m=new Uint8Array(new Int32Array(p).buffer),f=new Uint8Array(new Int32Array(c).buffer);return Na(i,l,t.shape.length,gt[t.dtype],m,f,s,d),o},setupFunc:function(e){Na=e.wasm.cwrap(ye,null,["number","array","number","number","array","array","number","number"])}},Ra=Mt(ge);let Ca;const Oa={kernelName:we,backendName:"wasm",setupFunc:function(e){Ca=e.wasm.cwrap(we,null,["number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a,alpha:r}=t,s=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(r.dataId).id;let i=s;const o=a;let d=o;"float32"!==o.dtype&&(d=Jt({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),i=n.dataIdMap.get(d.dataId).id);const l=n.makeOutput(a.shape,"float32"),p=n.dataIdMap.get(l.dataId).id;return Ca(i,u,p),"float32"!==o.dtype&&n.disposeData(d.dataId),l}};let Da;const Ta={kernelName:ke,backendName:"wasm",setupFunc:function(e){Da=e.wasm.cwrap(ke,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:s}=e,{axis:u,keepDims:i}=s,{x:o}=a,d=t.dataIdMap.get(o.dataId).id;let l=d,p=o;const{transposed:c,axes:m,originalAxes:f,inputWasTransposed:h}=Dt(o,u,t);let b=m;if(h){const e=t.dataIdMap.get(c.dataId).id;e!==d&&(p=c,l=e,b=r.getInnerMostAxes(b.length,p.shape.length))}r.assertAxesAreInnerMostDims("prod",b,p.shape.length);const[_,y]=r.computeOutAndReduceShapes(p.shape,b),g=n.sizeFromShape(y),w=t.makeOutput(_,p.dtype);if(0!==n.sizeFromShape(p.shape)){const e=t.dataIdMap.get(w.dataId).id;Da(l,g,gt[w.dtype],e)}if(h&&t.disposeData(c.dataId),i){const e=r.expandShapeToKeepDim(w.shape,f);w.shape=e}return w}},Pa={kernelName:Ie,backendName:"wasm",kernelFunc:e=>{const{backend:t,attrs:a}=e,{start:r,stop:s,step:u,dtype:i}=a,o=function(e,t,a,r){if(e===t||e<t&&a<0||t<e&&a>1)return n.makeZerosTypedArray(0,r);const s=Math.abs(Math.ceil((t-e)/a)),u=n.makeZerosTypedArray(s,r);t<e&&1===a&&(a=-1),u[0]=e;for(let e=1;e<u.length;e++)u[e]=u[e-1]+a;return u}(r,s,u,i),d=t.makeOutput([o.length],i);return t.typedArrayFromHeap(d).set(o),d}},Wa=Mt(ve),La=vt(Se),za=vt(Me);let ja;const Ha={kernelName:xe,backendName:"wasm",setupFunc:function(e){ja=e.wasm.cwrap(xe,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{images:s}=a,{alignCorners:u,halfPixelCenters:i,size:o}=r,[d,l]=o,[p,c,m,f]=s.shape,h=[p,d,l,f];let b,_=t.dataIdMap.get(s.dataId);"float32"!==_.dtype&&(b=Jt({backend:t,inputs:{x:s},attrs:{dtype:"float32"}}),_=t.dataIdMap.get(b.dataId));const y=_.id,g=t.makeOutput(h,"float32");if(0===n.sizeFromShape(s.shape))return g;const w=t.dataIdMap.get(g.dataId).id;return ja(y,p,c,m,f,d,l,u?1:0,i?1:0,w),null!=b&&t.disposeData(b.dataId),g}};let Ua;const Ba={kernelName:Ae,backendName:"wasm",setupFunc:function(e){Ua=e.wasm.cwrap(Ae,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{images:s}=a,{alignCorners:u,halfPixelCenters:i,size:o}=r,[d,l]=o,[p,c,m,f]=s.shape,h=[p,d,l,f],b=t.makeOutput(h,"float32");if(0===n.sizeFromShape(s.shape))return b;let _,y=t.dataIdMap.get(s.dataId);"float32"!==y.dtype&&(_=Jt({backend:t,inputs:{x:s},attrs:{dtype:"float32"}}),y=t.dataIdMap.get(_.dataId));const g=y.id,w=t.dataIdMap.get(b.dataId).id;return Ua(g,p,c,m,f,d,l,u?1:0,i?1:0,w),null!=_&&t.disposeData(_.dataId),b}};let qa;const Ga={kernelName:Fe,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:a,attrs:r}=e,{x:s}=t,{dims:u}=r,i=n.parseAxisParam(u,s.shape);if(0===s.shape.length)return Nt({inputs:{x:s},backend:a});const o=a.makeOutput(s.shape,s.dtype),d=a.dataIdMap.get(s.dataId).id,l=a.dataIdMap.get(o.dataId).id,p=new Uint8Array(new Int32Array(i).buffer),c=new Uint8Array(new Int32Array(s.shape).buffer);qa(d,p,i.length,c,s.shape.length,l);const m=Bt({inputs:{x:o},attrs:{shape:s.shape},backend:a});return a.disposeData(o.dataId),m},setupFunc:function(e){qa=e.wasm.cwrap(Fe,null,["number","array","number","array","number","number"])}};let Va;const $a={kernelName:Ne,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{image:s}=t,{radians:u,fillValue:i,center:o}=a,d=n.makeOutput(s.shape,s.dtype),l=n.dataIdMap.get(s.dataId).id,p=n.dataIdMap.get(d.dataId).id,[c,m,f,h]=s.shape,[b,_]=r.getImageCenter(o,m,f),y="number"==typeof i?[i,i,i,0===i?0:255]:[...i,255],g=new Uint8Array(new Int32Array(y).buffer);return Va(l,c,m,f,h,u,b,_,g,y.length,p),d},setupFunc:function(e){Va=e.wasm.cwrap(Ne,null,["number","number","number","number","number","number","number","number","array","number","number"])}},Ka=vt(Ee),Xa=vt(Re);let Qa;const Za={kernelName:Ce,backendName:"wasm",setupFunc:function(e){Qa=e.wasm.cwrap(Ce,null,["number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{indices:s,updates:u}=a,{shape:i}=r,o=t.makeOutput(i,u.dtype);if(0===n.sizeFromShape(i))return o;const{sliceRank:d,numUpdates:l,sliceSize:p,strides:c,outputSize:m}=Oe.calculateShapes(u,s,i),f=t.dataIdMap.get(s.dataId).id,h=t.dataIdMap.get(u.dataId).id,b=new Uint8Array(new Int32Array(c).buffer),_=t.dataIdMap.get(o.dataId).id;return Qa(f,h,gt[u.dtype],d,l,p,b,m,_),o}};let Ya;const Ja={kernelName:De,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:a}=e,{condition:r,t:s,e:u}=t,i=a.dataIdMap.get(r.dataId).id,o=a.dataIdMap.get(s.dataId).id,d=a.dataIdMap.get(u.dataId).id,l=a.makeOutput(s.shape,s.dtype),p=a.dataIdMap.get(l.dataId).id,c=r.shape.length,m=s.shape.length,f=0===c||c>1||1===m?1:n.sizeFromShape(s.shape.slice(1));return Ya(i,o,d,f,p),l},setupFunc:function(e){Ya=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}};let er;const tr={kernelName:"Sigmoid",backendName:"wasm",setupFunc:function(e){er=e.wasm.cwrap(Te,null,["number","number"])},kernelFunc:function(e){const{backend:t,inputs:{x:a}}=e,r=t.dataIdMap.get(a.dataId).id,s=t.makeOutput(a.shape,a.dtype),u=t.dataIdMap.get(s.dataId).id;return 0===n.sizeFromShape(s.shape)||er(r,u),s}},nr=vt(Pe);let ar;const rr={kernelName:We,backendName:"wasm",setupFunc:function(e){ar=e.wasm.cwrap(We,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:{logits:a},attrs:{dim:r}}=e,s=t.dataIdMap.get(a.dataId).id,u=t.makeOutput(a.shape,a.dtype),i=t.dataIdMap.get(u.dataId).id,o=a.shape[r],d=n.sizeFromShape(a.shape)/o;return 0===n.sizeFromShape(u.shape)||ar(s,i,o,d),u}};const sr={kernelName:Le,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:a,attrs:s}=e,{x:u}=t,{blockShape:i,paddings:o}=s,d=n.sizeFromShape(i),l=[[0,0]];l.push(...o);for(let e=1+i.length;e<u.shape.length;++e)l.push([0,0]);const p=Ea.kernelFunc({inputs:{x:u},backend:a,attrs:{paddings:l,constantValue:0}}),c=r.getReshaped(p.shape,i,d,!1),m=r.getPermuted(c.length,i.length,!1),f=r.getReshapedPermuted(p.shape,i,d,!1),h=Bt({inputs:{x:p},backend:a,attrs:{shape:c}}),b=Ct({inputs:{x:h},backend:a,attrs:{perm:m}}),_=Bt({inputs:{x:b},backend:a,attrs:{shape:f}});return a.disposeData(p.dataId),a.disposeData(h.dataId),a.disposeData(b.dataId),_}};let ur;const ir={kernelName:ze,backendName:"wasm",setupFunc:function(e){ur=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n}=e,{indices:a,values:s,denseShape:u,defaultValue:i}=n,o=a.shape[0],d=a.shape[1],l=t.readSync(u.dataId)[0],p=[o+l,d],c=t.dataIdMap.get(a.dataId).id,m=t.dataIdMap.get(s.dataId).id,f=t.dataIdMap.get(i.dataId).id,h=t.makeOutput(p,a.dtype),b=t.dataIdMap.get(h.dataId).id,_=t.makeOutput(p.slice(0,1),s.dtype),y=t.dataIdMap.get(_.dataId).id,g=t.makeOutput([l],"bool"),w=t.dataIdMap.get(g.dataId).id,k=t.makeOutput([o],a.dtype),I=t.dataIdMap.get(k.dataId).id,v=t.makeOutput([4],"int32"),S=t.dataIdMap.get(v.dataId).id,M=ur(c,m,gt[s.dtype],o,l,d,f,b,y,w,I,S),x=t.readSync(v.dataId);let A;switch(x[0]){case 1:A=r.getSparseFillEmptyRowsIndicesDenseShapeMismatch(x[1]);break;case 2:A=r.getSparseFillEmptyRowsNegativeIndexErrorMessage(x[1],x[2]);break;case 3:A=r.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(x[1],x[2],x[3]);break;default:A=""}if(t.disposeData(v.dataId),A)throw t.disposeData(h.dataId),t.disposeData(_.dataId),t.disposeData(g.dataId),t.disposeData(k.dataId),new Error(A);let F=h,N=_;return M!==p[0]&&(F=Qt({inputs:{x:h},attrs:{begin:0,size:[M,d]},backend:t}),N=Qt({inputs:{x:_},attrs:{begin:0,size:M},backend:t}),t.disposeData(h.dataId),t.disposeData(_.dataId)),[F,N,g,k]}};let or;const dr={kernelName:je,backendName:"wasm",setupFunc:function(e){or=e.wasm.cwrap(je,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a}=e,{inputIndices:s,inputShape:u,newShape:i}=a;if(2!==s.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${s.shape}`);if(1!==u.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${u.shape}`);if(1!==i.shape.length)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=t.dataIdMap.get(s.dataId).id,d=t.dataIdMap.get(u.dataId).id,l=t.dataIdMap.get(i.dataId).id,p=s.shape[0],c=n.sizeFromShape(i.shape),m=t.makeOutput([p,c],s.dtype),f=t.dataIdMap.get(m.dataId).id,h=t.makeOutput([c],i.dtype),b=t.dataIdMap.get(h.dataId).id,_=t.makeOutput([3],"int32"),y=t.dataIdMap.get(_.dataId).id;or(o,d,l,p,f,b,y);const g=t.readSync(_.dataId);let w;switch(g[0]){case 0:w=r.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(g[1],g[2]);break;case 1:w=r.getSparseReshapeNegativeOutputDimErrorMessage(g[1],g[2]);break;case 2:w=r.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{const e=Array.from(t.readSync(u.dataId)),n=Array.from(t.readSync(h.dataId));w=r.getSparseReshapeInputOutputMultipleErrorMessage(e,n);break}case 4:{const e=Array.from(t.readSync(u.dataId)),n=Array.from(t.readSync(h.dataId));w=r.getSparseReshapeInputOutputMismatchErrorMessage(e,n);break}default:w=""}if(t.disposeData(_.dataId),w)throw t.disposeData(m.dataId),t.disposeData(h.dataId),new Error(w);return[m,h]}};let lr;function pr(e){lr=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function cr(e,t){const{backend:n,inputs:a}=e,{data:s,indices:u,segmentIds:i}=a,o=u.shape[0],d=n.readSync(i.dataId,o-1,o)[0],l=o>0?d+1:0;if(l<0)throw new Error(r.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());const p=s.shape.slice();p[0]=l;const c=n.dataIdMap.get(s.dataId).id,m=n.dataIdMap.get(u.dataId).id,f=n.dataIdMap.get(i.dataId).id,h=n.makeOutput(p,s.dtype),b=n.dataIdMap.get(h.dataId).id,_=n.makeOutput([4],"int32"),y=n.dataIdMap.get(_.dataId).id;lr(c,gt[s.dtype],s.shape[0],m,f,b,y,t,0);const g=n.readSync(_.dataId);let w;switch(g[0]){case 0:w=r.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break;case 1:w=r.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break;case 2:w=r.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(g[1],g[2]);break;case 3:w=r.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(g[1],g[2],g[3]);break;default:w=""}if(n.disposeData(_.dataId),w)throw n.disposeData(h.dataId),new Error(w);return h}const mr={kernelName:He,backendName:"wasm",setupFunc:pr,kernelFunc:function(e){return cr(e,!0)}};const fr={kernelName:Ue,backendName:"wasm",setupFunc:pr,kernelFunc:function(e){return cr(e,!1)}};const hr={kernelName:Be,backendName:"wasm",kernelFunc:function(e){const{inputs:t,attrs:a,backend:s}=e,{x:u}=t,{numOrSizeSplits:i,axis:o}=a,d=n.parseAxisParam(o,u.shape)[0],l=r.prepareSplitSize(u,i,d),p=new Array(u.shape.length).fill(0),c=u.shape.slice();return l.map((e=>{const t=[...c];t[d]=e;const n=Qt({inputs:{x:u},attrs:{begin:p,size:t},backend:s});return p[d]+=e,n}))}},br=vt(qe),_r=vt(Ge),yr=Mt(Ve);let gr;const wr={kernelName:$e,backendName:"wasm",setupFunc:function(e){gr=e.wasm.cwrap($e,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{alpha:r}=a,{x:s}=n,u=t.dataIdMap.get(s.dataId).id,i=t.makeOutput(s.shape,s.dtype),o=t.dataIdMap.get(i.dataId).id;return gr(u,r,gt[s.dtype],o),i}};let kr;const Ir={kernelName:Ke,backendName:"wasm",setupFunc:function(e){kr=e.wasm.cwrap(Ke,null,["number","array","number","array","array","array","array","array","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{x:s}=a,{begin:u,end:i,strides:o,beginMask:d,endMask:l,ellipsisMask:p,newAxisMask:c,shrinkAxisMask:m}=r,{finalShapeSparse:f,finalShape:b,isIdentity:_,sliceDim0:y,isSimpleSlice:g,begin:w,end:k,strides:I}=h.sliceInfo(s.shape,u,i,o,d,l,p,c,m);let v;if(_)v=Bt({inputs:{x:s},backend:t,attrs:{shape:b}});else if(y||g){n.assert(s.shape.length>=1,(()=>`Input must have rank at least 1, got: ${s.shape.length}`));const e=h.computeOutShape(w,k,I),a=Qt({inputs:{x:s},backend:t,attrs:{begin:w,size:e}});v=Bt({inputs:{x:a},backend:t,attrs:{shape:b}}),t.disposeData(a.dataId)}else{const e=t.makeOutput(f,"float32"),a=t.dataIdMap.get(s.dataId).id,r=new Uint8Array(new Int32Array(n.computeStrides(s.shape)).buffer),u=new Uint8Array(new Int32Array(w).buffer),i=new Uint8Array(new Int32Array(k).buffer),o=new Uint8Array(new Int32Array(I).buffer),d=new Uint8Array(new Int32Array(f).buffer),l=new Uint8Array(new Int32Array(n.computeStrides(f)).buffer),p=t.dataIdMap.get(e.dataId).id;kr(a,r,s.shape.length,u,i,o,d,l,f.length,p),v=Bt({inputs:{x:e},backend:t,attrs:{shape:b}}),t.disposeData(e.dataId)}return v}};const vr={kernelName:Xe,backendName:"wasm",kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{data:r,dataSplits:s}=n,{separator:u,nGramWidths:i,leftPad:o,rightPad:d,padWidth:l,preserveShortSequences:p}=a,c=t.readSync(r.dataId),m=t.readSync(s.dataId),[f,h]=function(e,t,n,a,r,s,u,i){return new Kt(n,a,r,s,u,i).compute(e,t)}(c,m,u,i,o,d,l,p),b=t.makeOutput([f.length],"string");t.dataIdMap.get(b.dataId).stringBytes=f;const _=t.makeOutput(s.shape,"int32");return t.typedArrayFromHeap(_).set(h),[b,_]}};const Sr={kernelName:Qe,backendName:"wasm",kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{input:s,delimiter:u}=a,{skipEmpty:i}=r,o=t.readSync(s.dataId),d=t.readSync(u.dataId),[l,p,c]=function(e,t,a){const r=e.length,s=[];let u=0,i=0;const o=new Array(r);for(let n=0;n<r;++n){const r=s.length;Xt(e[n],t,a,s);const d=s.length-r;o[n]=d,u+=d,i=Math.max(i,d)}const d=n.getArrayFromDType("int32",2*u),l=new Array(u),p=[r,i];let c=0;for(let e=0;e<r;++e)for(let t=0;t<o[e];++t)d[2*c]=e,d[2*c+1]=t,l[c]=s[c],++c;return[d,l,p]}(o,d[0],i),m=p.length,f=t.makeOutput([m,2],"int32");t.typedArrayFromHeap(f).set(l);const h=t.makeOutput([m],"string");t.dataIdMap.get(h.dataId).stringBytes=p;const b=t.makeOutput([2],"int32");return t.typedArrayFromHeap(b).set(c),[f,h,b]}};const Mr={kernelName:Ze,backendName:"wasm",kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{input:s}=a,{numBuckets:u}=r,i=function(e,t){const a=n.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)a[r]=n.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return a}(t.readSync(s.dataId),u),o=t.makeOutput(s.shape,"int32");return t.typedArrayFromHeap(o).set(i),o}},xr=Mt(Ye);let Ar;const Fr={kernelName:Je,backendName:"wasm",setupFunc:function(e){Ar=e.wasm.cwrap(Je,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:s}=e,{axis:u,keepDims:i}=s,{x:o}=a,d=t.dataIdMap.get(o.dataId).id;let l=d,p=o;const{transposed:c,axes:m,originalAxes:f,inputWasTransposed:h}=Dt(o,u,t);let b=m;if(h){const e=t.dataIdMap.get(c.dataId).id;e!==d&&(p=c,l=e,b=r.getInnerMostAxes(b.length,p.shape.length))}r.assertAxesAreInnerMostDims("sum",b,p.shape.length);const[_,y]=r.computeOutAndReduceShapes(p.shape,b),g=n.sizeFromShape(y),w=t.makeOutput(_,p.dtype);if(0!==n.sizeFromShape(p.shape)){const e=t.dataIdMap.get(w.dataId).id;Ar(l,g,gt[w.dtype],e)}if(h&&t.disposeData(c.dataId),i){const e=r.expandShapeToKeepDim(w.shape,f);w.shape=e}return w}},Nr=vt(et),Er=vt(tt);let Rr;let Cr;let Or;const Dr=[It,St,xt,Ft,Pt,Lt,jt,Ut,Vt,Yt,en,tn,an,sn,on,ln,pn,cn,hn,_n,gn,kn,vn,Sn,Mn,xn,Fn,En,Cn,On,Dn,Pn,Ln,jn,Un,qn,Gn,Vn,Et,Kn,Xn,Qn,Zn,Yn,Jn,ea,ta,aa,ra,ua,oa,la,pa,fa,ha,ba,ga,ka,va,Sa,xa,Aa,Fa,Ea,Ra,Oa,Ta,Pa,Wa,La,za,qt,Ha,Ba,Ga,$a,Ka,Xa,Za,Ja,tr,nr,Zt,rr,sr,ir,dr,mr,fr,hr,br,_r,yr,wr,Ir,vr,Sr,Mr,xr,Fr,Nr,Er,{kernelName:nt,backendName:"wasm",setupFunc:function(e){Rr=e.wasm.cwrap(nt,null,["number","array","number","array","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:r}=t,s=n.dataIdMap.get(r.dataId).id,{reps:u}=a,i=new Array(r.shape.length);for(let e=0;e<i.length;e++)i[e]=r.shape[e]*u[e];const o=new Uint8Array(new Int32Array(r.shape).buffer),d=new Uint8Array(new Int32Array(i).buffer),l=n.makeOutput(i,r.dtype),p=n.dataIdMap.get(l.dataId).id;return Rr(s,o,r.shape.length,d,i.length,gt[l.dtype],p),l}},{kernelName:at,backendName:"wasm",setupFunc:function(e){Cr=e.wasm.cwrap(at,null,["number","array","number","number","number","bool","number","number"])},kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:a}=e,{k:r,sorted:s}=n,u=t.dataIdMap.get(a.dataId).id,i=new Uint8Array(new Int32Array(a.shape).buffer),o=a.shape.slice();o[o.length-1]=r;const d=t.makeOutput(o,a.dtype),l=t.dataIdMap.get(d.dataId).id,p=t.makeOutput(o,"int32"),c=t.dataIdMap.get(p.dataId).id;return Cr(u,i,a.shape.length,gt[a.dtype],r,s,l,c),[d,p]}},{kernelName:rt,backendName:"wasm",setupFunc:function(e){Or=e.wasm.cwrap(rt,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:a,attrs:r}=e,{image:s,transforms:u}=a,{interpolation:i,fillMode:o,fillValue:d,outputShape:l}=r,[p,c,m,f]=s.shape,[h,b]=null!=l?l:[c,m],_=[p,h,b,f],y=new Uint8Array(new Int32Array(n.computeStrides(s.shape)).buffer),g=new Uint8Array(new Int32Array(n.computeStrides(_)).buffer),w=t.makeOutput(_,s.dtype),k=t.dataIdMap.get(w.dataId).id,I=t.dataIdMap.get(s.dataId).id,v=t.dataIdMap.get(u.dataId).id,S="nearest"===i?1:2;let M;switch(o){case"constant":default:M=1;break;case"reflect":M=2;break;case"wrap":M=3;break;case"nearest":M=4}return Or(I,v,u.shape[0]>1,p,h,b,f,m,c,y,s.shape.length-1,g,_.length-1,S,M,d,k),w}},Ot,{kernelName:st,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{value:r}=t;let{axis:s}=a;s<0&&(s+=r.shape.length);const u=r.shape[s],i=r.shape.length,o=new Array(i-1);let d=0;for(let e=0;e<i;e++)e!==s&&(o[d++]=r.shape[e]);const l=new Array(u),p=new Array(i).fill(0),c=r.shape.slice();c[s]=1;for(let e=0;e<l.length;e++)p[s]=e,l[e]=Qt({inputs:{x:r},attrs:{begin:p,size:c},backend:n});return l.map((({dataId:e,dtype:t})=>({dataId:e,dtype:t,shape:o})))}},{kernelName:ut,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(0),a}}];for(const e of Dr)it(e);const Tr=ot();Tr.registerFlag("WASM_HAS_SIMD_SUPPORT",(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11])))),Tr.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",(async()=>{if(Tr.get("IS_NODE"))return!1;try{return(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(e){return!1}}));var Pr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Wr(e){var t={exports:{}};return e(t,t.exports),t.exports}var Lr=Wr((function(e,t){var n,a=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(n=n||__filename),function(e){function t(){return E.buffer!=L&&$(E.buffer),z}function a(){return E.buffer!=L&&$(E.buffer),j}function r(){return E.buffer!=L&&$(E.buffer),H}function s(){return E.buffer!=L&&$(E.buffer),U}var u,i,o,d="undefined"!=typeof(e=e||{})?e:{};d.ready=new Promise((function(e,t){u=e,i=t})),"undefined"!=typeof process&&process.listeners&&(o={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var l,p,c,m,f,h,b=Object.assign({},d),_=(e,t)=>{throw t},y="object"==typeof window,g="function"==typeof importScripts,w="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,k=d.ENVIRONMENT_IS_PTHREAD||!1,I="";function v(e){return d.locateFile?d.locateFile(e,I):I+e}if(w){let e;I=g?ft.dirname(I)+"/":__dirname+"/",h=()=>{f||(m=ht,f=ft)},l=function(e,t){return h(),e=f.normalize(e),m.readFileSync(e,t?void 0:"utf8")},c=e=>{var t=l(e,!0);return t.buffer||(t=new Uint8Array(t)),t},p=(e,t,n)=>{h(),e=f.normalize(e),m.readFile(e,(function(e,a){e?n(e):t(a.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof rt))throw e})),process.on("unhandledRejection",(function(e){throw e})),_=(e,t)=>{if(J())throw process.exitCode=e,t;var n;(n=t)instanceof rt||F("exiting due to exception: "+n),process.exit(e)},d.inspect=function(){return"[Emscripten Module object]"};try{e=bt}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}Pr.Worker=e.Worker}else(y||g)&&(g?I=self.location.href:"undefined"!=typeof document&&document.currentScript&&(I=document.currentScript.src),"undefined"!=typeof n&&n&&(I=n),I=0!==I.indexOf("blob:")?I.substr(0,I.replace(/[?#].*/,"").lastIndexOf("/")+1):"",w||(l=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},g&&(c=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),p=(e,t,n)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)}));w&&"undefined"==typeof performance&&(Pr.performance=_t.performance);var S=console.log.bind(console),M=console.warn.bind(console);w&&(h(),S=e=>m.writeSync(1,e+"\n"),M=e=>m.writeSync(2,e+"\n"));var x,A=d.print||S,F=d.printErr||M;function N(e){N.shown||(N.shown={}),N.shown[e]||(N.shown[e]=1,F(e))}Object.assign(d,b),b=null,d.arguments,d.thisProgram,d.quit&&(_=d.quit),d.wasmBinary&&(x=d.wasmBinary);var E,R,C=d.noExitRuntime||!0;"object"!=typeof WebAssembly&&re("no native wasm support detected");var O,D=!1;function T(e){return d["_"+e]}function P(e,n,a,r,s){var u={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);V(e,t=Je(n),n)}return t},array:function(e){var n=Je(e.length);return function(e,n){t().set(e,n)}(e,n),n}},i=T(e),o=[],d=0;if(r)for(var l=0;l<r.length;l++){var p=u[a[l]];p?(0===d&&(d=Ze()),o[l]=p(r[l])):o[l]=r[l]}var c=i.apply(null,o);return c=function(e){return 0!==d&&Ye(d),function(e){return"string"===n?G(e):"boolean"===n?Boolean(e):e}(e)}(c)}function W(e){var t=new TextDecoder(e);this.decode=e=>(e.buffer instanceof SharedArrayBuffer&&(e=new Uint8Array(e)),t.decode.call(t,e))}var L,z,j,H,U,B="undefined"!=typeof TextDecoder?new W("utf8"):void 0;function q(e,t,n){for(var a=t+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.subarray&&B)return B.decode(e.subarray(t,r));for(var s="";t<r;){var u=e[t++];if(128&u){var i=63&e[t++];if(192!=(224&u)){var o=63&e[t++];if((u=224==(240&u)?(15&u)<<12|i<<6|o:(7&u)<<18|i<<12|o<<6|63&e[t++])<65536)s+=String.fromCharCode(u);else{var d=u-65536;s+=String.fromCharCode(55296|d>>10,56320|1023&d)}}else s+=String.fromCharCode((31&u)<<6|i)}else s+=String.fromCharCode(u)}return s}function G(e,t){return e?q(a(),e,t):""}function V(e,t,n){return function(e,t,n,a){if(!(a>0))return 0;for(var r=n,s=n+a-1,u=0;u<e.length;++u){var i=e.charCodeAt(u);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++u)),i<=127){if(n>=s)break;t[n++]=i}else if(i<=2047){if(n+1>=s)break;t[n++]=192|i>>6,t[n++]=128|63&i}else if(i<=65535){if(n+2>=s)break;t[n++]=224|i>>12,t[n++]=128|i>>6&63,t[n++]=128|63&i}else{if(n+3>=s)break;t[n++]=240|i>>18,t[n++]=128|i>>12&63,t[n++]=128|i>>6&63,t[n++]=128|63&i}}return t[n]=0,n-r}(e,a(),t,n)}function $(e){L=e,d.HEAP8=z=new Int8Array(e),d.HEAP16=new Int16Array(e),d.HEAP32=H=new Int32Array(e),d.HEAPU8=j=new Uint8Array(e),d.HEAPU16=new Uint16Array(e),d.HEAPU32=new Uint32Array(e),d.HEAPF32=new Float32Array(e),d.HEAPF64=U=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new W("utf-16le"),k&&(L=d.buffer);var K,X=d.INITIAL_MEMORY||16777216;if(k)E=d.wasmMemory,L=d.buffer;else if(d.wasmMemory)E=d.wasmMemory;else if(!((E=new WebAssembly.Memory({initial:X/65536,maximum:32768,shared:!0})).buffer instanceof SharedArrayBuffer))throw F("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),w&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");E&&(L=E.buffer),X=L.byteLength,$(L);var Q=[],Z=[],Y=[];function J(){return C||!1}function ee(){k||de(Z)}var te,ne=0,ae=null;function re(e){k?postMessage({cmd:"onAbort",arg:e}):d.onAbort&&d.onAbort(e),F(e="Aborted("+e+")"),D=!0,O=1,e+=". Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw i(t),t}function se(e){return e.startsWith("data:application/octet-stream;base64,")}function ue(e){return e.startsWith("file://")}function ie(e){try{if(e==te&&x)return new Uint8Array(x);if(c)return c(e);throw"both async and sync fetching of the wasm failed"}catch(e){re(e)}}d.preloadedImages={},d.preloadedAudios={},se(te="tfjs-backend-wasm-threaded-simd.wasm")||(te=v(te));var oe={};function de(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?_e(n)():_e(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(d)}}function le(e){var t=Ze(),n=e();return Ye(t),n}function pe(e){var t=me.pthreads[e];if(t){r()[e>>2]=0;var n=t.worker;me.returnWorkerToPool(n)}}function ce(e){!function(e,t){if(O=e,!t&&k)throw fe(e),"unwind";var n;J()||k||me.terminateAllThreads(),O=n=e,J()||(me.terminateAllThreads(),d.onExit&&d.onExit(n),D=!0),_(n,new rt(n))}(e)}var me={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],init:function(){k?me.initWorker():me.initMainThread()},initMainThread:function(){for(var e=0;e<8;++e)me.allocateUnusedWorker()},initWorker:function(){C=!1},pthreads:{},setExitStatus:function(e){O=e},terminateAllThreads:function(){for(var e in me.pthreads){var t=me.pthreads[e];t&&t.worker&&me.returnWorkerToPool(t.worker)}for(var n=0;n<me.unusedWorkers.length;++n)me.unusedWorkers[n].terminate();me.unusedWorkers=[]},returnWorkerToPool:function(e){me.runWithoutMainThreadQueuedCalls((function(){delete me.pthreads[e.pthread.threadInfoStruct],me.unusedWorkers.push(e),me.runningWorkers.splice(me.runningWorkers.indexOf(e),1),Xe(e.pthread.threadInfoStruct),e.pthread=void 0}))},runWithoutMainThreadQueuedCalls:function(e){r()[at>>2]=0;try{e()}finally{r()[at>>2]=1}},receiveObjectTransfer:function(e){},threadInit:function(){for(var e in me.tlsInitFunctions)me.tlsInitFunctions[e]()},loadWasmModuleToWorker:function(e,t){e.onmessage=n=>{var a,s=n.data,u=s.cmd;if(e.pthread&&(me.currentProxiedOperationCallerThread=e.pthread.threadInfoStruct),s.targetThread&&s.targetThread!=Be()){var i=me.pthreads[s.targetThread];return i?i.worker.postMessage(s,s.transferList):F('Internal error! Worker sent a message "'+u+'" to target pthread '+s.targetThread+", but that thread no longer exists!"),void(me.currentProxiedOperationCallerThread=void 0)}"processQueuedMainThreadWork"===u?qe():"spawnThread"===u?ge(s):"cleanupThread"===u?pe(s.thread):"killThread"===u?function(e){r()[e>>2]=0;var t=me.pthreads[e];delete me.pthreads[e],t.worker.terminate(),Xe(e),me.runningWorkers.splice(me.runningWorkers.indexOf(t.worker),1),t.worker.pthread=void 0}(s.thread):"cancelThread"===u?(a=s.thread,me.pthreads[a].worker.postMessage({cmd:"cancel"})):"loaded"===u?(e.loaded=!0,t&&t(e),e.runPthread&&(e.runPthread(),delete e.runPthread)):"print"===u?A("Thread "+s.threadId+": "+s.text):"printErr"===u?F("Thread "+s.threadId+": "+s.text):"alert"===u?alert("Thread "+s.threadId+": "+s.text):"setimmediate"===s.target?e.postMessage(s):"onAbort"===u?d.onAbort&&d.onAbort(s.arg):F("worker sent an unknown command "+u),me.currentProxiedOperationCallerThread=void 0},e.onerror=e=>{throw F("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},w&&(e.on("message",(function(t){e.onmessage({data:t})})),e.on("error",(function(t){e.onerror(t)})),e.on("detachedExit",(function(){}))),e.postMessage({cmd:"load",urlOrBlob:d.mainScriptUrlOrBlob||n,wasmMemory:E,wasmModule:R})},allocateUnusedWorker:function(){var e=v("tfjs-backend-wasm-threaded-simd.worker.js");me.unusedWorkers.push(new Worker(e))},getNewWorker:function(){return 0==me.unusedWorkers.length&&(me.allocateUnusedWorker(),me.loadWasmModuleToWorker(me.unusedWorkers[0])),me.unusedWorkers.pop()}};function fe(e){if(k)return ke(1,0,e);try{ce(e)}catch(e){!function(e){if(e instanceof rt||"unwind"==e)return O;_(1,e)}(e)}}d.establishStackSpace=function(){var e=Be(),t=r()[e+44>>2],n=r()[e+48>>2];Qe(t,t-n),Ye(t)};var he,be=[];function _e(e){var t=be[e];return t||(e>=be.length&&(be.length=e+1),be[e]=t=K.get(e)),t}function ye(e,t){var n,a;if(0===e)n=Date.now();else{if(1!==e&&4!==e)return a=28,r()[Ue()>>2]=a,-1;n=he()}return r()[t>>2]=n/1e3|0,r()[t+4>>2]=n%1e3*1e3*1e3|0,0}function ge(e){var t=me.getNewWorker();if(!t)return 6;me.runningWorkers.push(t);var n=me.pthreads[e.pthread_ptr]={worker:t,threadInfoStruct:e.pthread_ptr};t.pthread=n;var a={cmd:"run",start_routine:e.startRoutine,arg:e.arg,threadInfoStruct:e.pthread_ptr};return t.runPthread=()=>{a.time=performance.now(),t.postMessage(a,e.transferList)},t.loaded&&(t.runPthread(),delete t.runPthread),0}function we(){return 2147483648}function ke(e,t){var n=arguments.length-2,a=arguments;return le((function(){for(var r=n,u=Je(8*r),i=u>>3,o=0;o<n;o++){var d=a[2+o];s()[i+o]=d}return $e(e,r,u,t)}))}d.invokeEntryPoint=function(e,t){return _e(e)(t)},he=w?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:k?()=>performance.now()-d.__performance_now_clock_drift:()=>performance.now();var Ie=[];function ve(e){try{return E.grow(e-L.byteLength+65535>>>16),$(E.buffer),1}catch(e){}}var Se={inEventHandler:0,removeAllEventListeners:function(){for(var e=Se.eventHandlers.length-1;e>=0;--e)Se._removeHandler(e);Se.eventHandlers=[],Se.deferredCalls=[]},registerRemoveEventListeners:function(){Se.removeEventListenersRegistered||(Se.removeEventListenersRegistered=!0)},deferredCalls:[],deferCall:function(e,t,n){function a(e,t){if(e.length!=t.length)return!1;for(var n in e)if(e[n]!=t[n])return!1;return!0}for(var r in Se.deferredCalls){var s=Se.deferredCalls[r];if(s.targetFunction==e&&a(s.argsList,n))return}Se.deferredCalls.push({targetFunction:e,precedence:t,argsList:n}),Se.deferredCalls.sort((function(e,t){return e.precedence<t.precedence}))},removeDeferredCalls:function(e){for(var t=0;t<Se.deferredCalls.length;++t)Se.deferredCalls[t].targetFunction==e&&(Se.deferredCalls.splice(t,1),--t)},canPerformEventHandlerRequests:function(){return Se.inEventHandler&&Se.currentEventHandler.allowsDeferredCalls},runDeferredCalls:function(){if(Se.canPerformEventHandlerRequests())for(var e=0;e<Se.deferredCalls.length;++e){var t=Se.deferredCalls[e];Se.deferredCalls.splice(e,1),--e,t.targetFunction.apply(null,t.argsList)}},eventHandlers:[],removeAllHandlersOnTarget:function(e,t){for(var n=0;n<Se.eventHandlers.length;++n)Se.eventHandlers[n].target!=e||t&&t!=Se.eventHandlers[n].eventTypeString||Se._removeHandler(n--)},_removeHandler:function(e){var t=Se.eventHandlers[e];t.target.removeEventListener(t.eventTypeString,t.eventListenerFunc,t.useCapture),Se.eventHandlers.splice(e,1)},registerOrRemoveHandler:function(e){var t=function(t){++Se.inEventHandler,Se.currentEventHandler=e,Se.runDeferredCalls(),e.handlerFunc(t),Se.runDeferredCalls(),--Se.inEventHandler};if(e.callbackfunc)e.eventListenerFunc=t,e.target.addEventListener(e.eventTypeString,t,e.useCapture),Se.eventHandlers.push(e),Se.registerRemoveEventListeners();else for(var n=0;n<Se.eventHandlers.length;++n)Se.eventHandlers[n].target==e.target&&Se.eventHandlers[n].eventTypeString==e.eventTypeString&&Se._removeHandler(n--)},queueEventHandlerOnThread_iiii:function(e,t,n,a,s){le((function(){var u=Je(12);r()[u>>2]=n,r()[u+4>>2]=a,r()[u+8>>2]=s,Ke(e,637534208,t,a,u)}))},getTargetThreadForEventCallback:function(e){switch(e){case 1:return 0;case 2:return me.currentProxiedOperationCallerThread;default:return e}},getNodeNameForTarget:function(e){return e?e==window?"#window":e==screen?"#screen":e&&e.nodeName?e.nodeName:"":""},fullscreenEnabled:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}};function Me(e,t,n,a){le((function(){var s,u,i,o=Je(12),d=0;t&&(u=function(e){for(var t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++n)),a<=127?++t:t+=a<=2047?2:a<=65535?3:4}return t}(s=t)+1,i=je(u),V(s,i,u),d=i),r()[o>>2]=d,r()[o+4>>2]=n,r()[o+8>>2]=a,Ke(e,657457152,0,d,o)}))}var xe=[0,"undefined"!=typeof document?document:0,"undefined"!=typeof window?window:0];function Ae(e){var t;return e=(t=e)>2?G(t):t,xe[e]||("undefined"!=typeof document?document.querySelector(e):void 0)}function Fe(e){return Ae(e)}function Ne(e,t,n){var a=Fe(e);if(!a)return-4;if(a.canvasSharedPtr&&(r()[a.canvasSharedPtr>>2]=t,r()[a.canvasSharedPtr+4>>2]=n),!a.offscreenCanvas&&a.controlTransferredOffscreen)return a.canvasSharedPtr?(function(e,t,n,a){Me(e,t=t?G(t):"",n,a)}(r()[a.canvasSharedPtr+8>>2],e,t,n),1):-4;a.offscreenCanvas&&(a=a.offscreenCanvas);var s=!1;if(a.GLctxObject&&a.GLctxObject.GLctx){var u=a.GLctxObject.GLctx.getParameter(2978);s=0===u[0]&&0===u[1]&&u[2]===a.width&&u[3]===a.height}return a.width=t,a.height=n,s&&a.GLctxObject.GLctx.viewport(0,0,t,n),0}function Ee(e,t,n){return k?ke(2,1,e,t,n):Ne(e,t,n)}var Re,Ce={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:{},offscreenCanvases:{},queries:[],stringCache:{},unpackAlignment:4,recordError:function(e){Ce.lastError||(Ce.lastError=e)},getNewId:function(e){for(var t=Ce.counter++,n=e.length;n<t;n++)e[n]=null;return t},getSource:function(e,t,n,a){for(var s="",u=0;u<t;++u){var i=a?r()[a+4*u>>2]:-1;s+=G(r()[n+4*u>>2],i<0?void 0:i)}return s},createContext:function(e,t){e.getContextSafariWebGL2Fixed||(e.getContextSafariWebGL2Fixed=e.getContext,e.getContext=function(t,n){var a=e.getContextSafariWebGL2Fixed(t,n);return"webgl"==t==a instanceof WebGLRenderingContext?a:null});var n=e.getContext("webgl",t);return n?Ce.registerContext(n,t):0},registerContext:function(e,t){var n=je(8);r()[n+4>>2]=Be();var a={handle:n,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=a),Ce.contexts[n]=a,("undefined"==typeof t.enableExtensionsByDefault||t.enableExtensionsByDefault)&&Ce.initExtensions(a),n},makeContextCurrent:function(e){return Ce.currentContext=Ce.contexts[e],d.ctx=Re=Ce.currentContext&&Ce.currentContext.GLctx,!(e&&!Re)},getContext:function(e){return Ce.contexts[e]},deleteContext:function(e){Ce.currentContext===Ce.contexts[e]&&(Ce.currentContext=null),"object"==typeof Se&&Se.removeAllHandlersOnTarget(Ce.contexts[e].GLctx.canvas),Ce.contexts[e]&&Ce.contexts[e].GLctx.canvas&&(Ce.contexts[e].GLctx.canvas.GLctxObject=void 0),He(Ce.contexts[e].handle),Ce.contexts[e]=null},initExtensions:function(e){if(e||(e=Ce.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var t,n=e.GLctx;!function(e){var t=e.getExtension("ANGLE_instanced_arrays");t&&(e.vertexAttribDivisor=function(e,n){t.vertexAttribDivisorANGLE(e,n)},e.drawArraysInstanced=function(e,n,a,r){t.drawArraysInstancedANGLE(e,n,a,r)},e.drawElementsInstanced=function(e,n,a,r,s){t.drawElementsInstancedANGLE(e,n,a,r,s)})}(n),function(e){var t=e.getExtension("OES_vertex_array_object");t&&(e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(e){t.deleteVertexArrayOES(e)},e.bindVertexArray=function(e){t.bindVertexArrayOES(e)},e.isVertexArray=function(e){return t.isVertexArrayOES(e)})}(n),function(e){var t=e.getExtension("WEBGL_draw_buffers");t&&(e.drawBuffers=function(e,n){t.drawBuffersWEBGL(e,n)})}(n),n.disjointTimerQueryExt=n.getExtension("EXT_disjoint_timer_query"),(t=n).multiDrawWebgl=t.getExtension("WEBGL_multi_draw"),(n.getSupportedExtensions()||[]).forEach((function(e){e.includes("lose_context")||e.includes("debug")||n.getExtension(e)}))}}},Oe=["default","low-power","high-performance"],De={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=De.buffers[e];0===t||10===t?((1===e?A:F)(q(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return De.varargs+=4,r()[De.varargs-4>>2]},getStr:function(e){return G(e)},get64:function(e,t){return e}};function Te(e){return k?ke(3,1,e):0}function Pe(e,t,n,a,r){if(k)return ke(4,1,e,t,n,a,r)}function We(e,t,n,s){if(k)return ke(5,1,e,t,n,s);for(var u=0,i=0;i<n;i++){var o=r()[t>>2],d=r()[t+4>>2];t+=8;for(var l=0;l<d;l++)De.printChar(e,a()[o+l]);u+=d}return r()[s>>2]=u,0}me.init();var Le=[null,fe,Ee,Te,Pe,We],ze={__clock_gettime:function(e,t){return ye(e,t)},__emscripten_init_main_thread_js:function(e){Ge(e,!g,1,!y),me.threadInit()},__emscripten_thread_cleanup:function(e){k?postMessage({cmd:"cleanupThread",thread:e}):pe(e)},__pthread_create_js:function(e,t,n,a){if("undefined"==typeof SharedArrayBuffer)return F("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var r=[];if(k&&0===r.length)return Ve(687865856,e,t,n,a);var s={startRoutine:n,pthread_ptr:e,arg:a,transferList:r};return k?(s.cmd="spawnThread",postMessage(s,r),0):ge(s)},_emscripten_default_pthread_stack_size:function(){return 2097152},_emscripten_notify_thread_queue:function(e,t){if(e==t)postMessage({cmd:"processQueuedMainThreadWork"});else if(k)postMessage({targetThread:e,cmd:"processThreadQueue"});else{var n=me.pthreads[e],a=n&&n.worker;if(!a)return;a.postMessage({cmd:"processThreadQueue"})}return 1},abort:function(){re("")},emscripten_check_blocking_allowed:function(){w||g||N("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")},emscripten_get_heap_max:we,emscripten_get_now:he,emscripten_memcpy_big:function(e,t,n){a().copyWithin(e,t,t+n)},emscripten_num_logical_cores:function(){return w?yt.cpus().length:navigator.hardwareConcurrency},emscripten_receive_on_main_thread_js:function(e,t,n){Ie.length=t;for(var a=n>>3,r=0;r<t;r++)Ie[r]=s()[a+r];return(e<0?oe[-e-1]:Le[e]).apply(null,Ie)},emscripten_resize_heap:function(e){var t=a().length;if((e>>>=0)<=t)return!1;var n,r,s=2147483648;if(e>s)return!1;for(var u=1;u<=4;u*=2){var i=t*(1+.2/u);if(i=Math.min(i,e+100663296),ve(Math.min(s,((n=Math.max(e,i))%(r=65536)>0&&(n+=r-n%r),n))))return!0}return!1},emscripten_set_canvas_element_size:function(e,t,n){return Fe(e)?Ne(e,t,n):Ee(e,t,n)},emscripten_unwind_to_js_event_loop:function(){throw"unwind"},emscripten_webgl_create_context:function(e,t){return n=e,a=t>>2,s=r()[a+6],u={alpha:!!r()[a+0],depth:!!r()[a+1],stencil:!!r()[a+2],antialias:!!r()[a+3],premultipliedAlpha:!!r()[a+4],preserveDrawingBuffer:!!r()[a+5],powerPreference:Oe[s],failIfMajorPerformanceCaveat:!!r()[a+7],majorVersion:r()[a+8],minorVersion:r()[a+9],enableExtensionsByDefault:r()[a+10],explicitSwapControl:r()[a+11],proxyContextToMainThread:r()[a+12],renderViaOffscreenBackBuffer:r()[a+13]},(i=Fe(n))?u.explicitSwapControl?0:Ce.createContext(i,u):0;var n,a,s,u,i},exit:ce,fd_close:Te,fd_seek:Pe,fd_write:We,memory:E||d.wasmMemory,setTempRet0:function(e){}};!function(){var e={env:ze,wasi_snapshot_preview1:ze};function t(e,t){var n,a,r=e.exports;if(d.asm=r,n=d.asm.emscripten_tls_init,me.tlsInitFunctions.push(n),K=d.asm.__indirect_function_table,a=d.asm.__wasm_call_ctors,Z.unshift(a),R=t,!k){var s=me.unusedWorkers.length;me.unusedWorkers.forEach((function(e){me.loadWasmModuleToWorker(e,(function(){--s||function(e){if(ne--,d.monitorRunDependencies&&d.monitorRunDependencies(ne),0==ne&&ae){var t=ae;ae=null,t()}}()}))}))}}function n(e){t(e.instance,e.module)}function a(t){return function(){if(!x&&(y||g)){if("function"==typeof fetch&&!ue(te))return fetch(te,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+te+"'";return e.arrayBuffer()})).catch((function(){return ie(te)}));if(p)return new Promise((function(e,t){p(te,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ie(te)}))}().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){F("failed to asynchronously prepare wasm: "+e),re(e)}))}if(k||(ne++,d.monitorRunDependencies&&d.monitorRunDependencies(ne)),d.instantiateWasm)try{return d.instantiateWasm(e,t)}catch(e){return F("Module.instantiateWasm callback failed with error: "+e),!1}(x||"function"!=typeof WebAssembly.instantiateStreaming||se(te)||ue(te)||"function"!=typeof fetch?a(n):fetch(te,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return F("wasm streaming compile failed: "+e),F("falling back to ArrayBuffer instantiation"),a(n)}))}))).catch(i)}(),d.___wasm_call_ctors=function(){return(d.___wasm_call_ctors=d.asm.__wasm_call_ctors).apply(null,arguments)},d._init=function(){return(d._init=d.asm.init).apply(null,arguments)},d._init_with_threads_count=function(){return(d._init_with_threads_count=d.asm.init_with_threads_count).apply(null,arguments)},d._get_threads_count=function(){return(d._get_threads_count=d.asm.get_threads_count).apply(null,arguments)},d._register_tensor=function(){return(d._register_tensor=d.asm.register_tensor).apply(null,arguments)},d._dispose_data=function(){return(d._dispose_data=d.asm.dispose_data).apply(null,arguments)},d._dispose=function(){return(d._dispose=d.asm.dispose).apply(null,arguments)},d._Abs=function(){return(d._Abs=d.asm.Abs).apply(null,arguments)},d._Add=function(){return(d._Add=d.asm.Add).apply(null,arguments)},d._AddN=function(){return(d._AddN=d.asm.AddN).apply(null,arguments)},d._All=function(){return(d._All=d.asm.All).apply(null,arguments)},d._Any=function(){return(d._Any=d.asm.Any).apply(null,arguments)},d._ArgMax=function(){return(d._ArgMax=d.asm.ArgMax).apply(null,arguments)},d._AvgPool=function(){return(d._AvgPool=d.asm.AvgPool).apply(null,arguments)},d._BatchMatMul=function(){return(d._BatchMatMul=d.asm.BatchMatMul).apply(null,arguments)},d._Ceil=function(){return(d._Ceil=d.asm.Ceil).apply(null,arguments)},d._ClipByValue=function(){return(d._ClipByValue=d.asm.ClipByValue).apply(null,arguments)},d._Conv2D=function(){return(d._Conv2D=d.asm.Conv2D).apply(null,arguments)},d._Conv2DBackpropInput=function(){return(d._Conv2DBackpropInput=d.asm.Conv2DBackpropInput).apply(null,arguments)},d._Cos=function(){return(d._Cos=d.asm.Cos).apply(null,arguments)},d._Cosh=function(){return(d._Cosh=d.asm.Cosh).apply(null,arguments)},d._CropAndResize=function(){return(d._CropAndResize=d.asm.CropAndResize).apply(null,arguments)},d._Cumprod=function(){return(d._Cumprod=d.asm.Cumprod).apply(null,arguments)},d._Cumsum=function(){return(d._Cumsum=d.asm.Cumsum).apply(null,arguments)},d._DepthToSpace=function(){return(d._DepthToSpace=d.asm.DepthToSpace).apply(null,arguments)},d._DepthwiseConv2dNative=function(){return(d._DepthwiseConv2dNative=d.asm.DepthwiseConv2dNative).apply(null,arguments)},d._Elu=function(){return(d._Elu=d.asm.Elu).apply(null,arguments)},d._Equal=function(){return(d._Equal=d.asm.Equal).apply(null,arguments)},d._Exp=function(){return(d._Exp=d.asm.Exp).apply(null,arguments)},d._FlipLeftRight=function(){return(d._FlipLeftRight=d.asm.FlipLeftRight).apply(null,arguments)},d._Floor=function(){return(d._Floor=d.asm.Floor).apply(null,arguments)},d._FloorDiv=function(){return(d._FloorDiv=d.asm.FloorDiv).apply(null,arguments)},d._FusedBatchNorm=function(){return(d._FusedBatchNorm=d.asm.FusedBatchNorm).apply(null,arguments)},d._FusedConv2D=function(){return(d._FusedConv2D=d.asm.FusedConv2D).apply(null,arguments)},d._FusedDepthwiseConv2D=function(){return(d._FusedDepthwiseConv2D=d.asm.FusedDepthwiseConv2D).apply(null,arguments)},d._Gather=function(){return(d._Gather=d.asm.Gather).apply(null,arguments)},d._GatherNd=function(){return(d._GatherNd=d.asm.GatherNd).apply(null,arguments)},d._Greater=function(){return(d._Greater=d.asm.Greater).apply(null,arguments)},d._GreaterEqual=function(){return(d._GreaterEqual=d.asm.GreaterEqual).apply(null,arguments)},d._LeakyRelu=function(){return(d._LeakyRelu=d.asm.LeakyRelu).apply(null,arguments)},d._Less=function(){return(d._Less=d.asm.Less).apply(null,arguments)},d._LessEqual=function(){return(d._LessEqual=d.asm.LessEqual).apply(null,arguments)},d._Log=function(){return(d._Log=d.asm.Log).apply(null,arguments)},d._LogicalAnd=function(){return(d._LogicalAnd=d.asm.LogicalAnd).apply(null,arguments)},d._LogicalNot=function(){return(d._LogicalNot=d.asm.LogicalNot).apply(null,arguments)},d._LogicalOr=function(){return(d._LogicalOr=d.asm.LogicalOr).apply(null,arguments)},d._LogicalXor=function(){return(d._LogicalXor=d.asm.LogicalXor).apply(null,arguments)},d._Max=function(){return(d._Max=d.asm.Max).apply(null,arguments)},d._MaxPool=function(){return(d._MaxPool=d.asm.MaxPool).apply(null,arguments)},d._Maximum=function(){return(d._Maximum=d.asm.Maximum).apply(null,arguments)},d._Mean=function(){return(d._Mean=d.asm.Mean).apply(null,arguments)},d._Min=function(){return(d._Min=d.asm.Min).apply(null,arguments)},d._Minimum=function(){return(d._Minimum=d.asm.Minimum).apply(null,arguments)},d._MirrorPad=function(){return(d._MirrorPad=d.asm.MirrorPad).apply(null,arguments)},d._Multiply=function(){return(d._Multiply=d.asm.Multiply).apply(null,arguments)},d._Neg=function(){return(d._Neg=d.asm.Neg).apply(null,arguments)},d._NonMaxSuppressionV3=function(){return(d._NonMaxSuppressionV3=d.asm.NonMaxSuppressionV3).apply(null,arguments)},d._NonMaxSuppressionV4=function(){return(d._NonMaxSuppressionV4=d.asm.NonMaxSuppressionV4).apply(null,arguments)},d._NonMaxSuppressionV5=function(){return(d._NonMaxSuppressionV5=d.asm.NonMaxSuppressionV5).apply(null,arguments)},d._NotEqual=function(){return(d._NotEqual=d.asm.NotEqual).apply(null,arguments)},d._OneHot=function(){return(d._OneHot=d.asm.OneHot).apply(null,arguments)},d._PadV2=function(){return(d._PadV2=d.asm.PadV2).apply(null,arguments)},d._Pow=function(){return(d._Pow=d.asm.Pow).apply(null,arguments)},d._Prelu=function(){return(d._Prelu=d.asm.Prelu).apply(null,arguments)},d._Prod=function(){return(d._Prod=d.asm.Prod).apply(null,arguments)},d._RealDiv=function(){return(d._RealDiv=d.asm.RealDiv).apply(null,arguments)},d._Relu=function(){return(d._Relu=d.asm.Relu).apply(null,arguments)},d._Relu6=function(){return(d._Relu6=d.asm.Relu6).apply(null,arguments)},d._ResizeBilinear=function(){return(d._ResizeBilinear=d.asm.ResizeBilinear).apply(null,arguments)},d._ResizeNearestNeighbor=function(){return(d._ResizeNearestNeighbor=d.asm.ResizeNearestNeighbor).apply(null,arguments)},d._Reverse=function(){return(d._Reverse=d.asm.Reverse).apply(null,arguments)},d._RotateWithOffset=function(){return(d._RotateWithOffset=d.asm.RotateWithOffset).apply(null,arguments)},d._Round=function(){return(d._Round=d.asm.Round).apply(null,arguments)},d._Rsqrt=function(){return(d._Rsqrt=d.asm.Rsqrt).apply(null,arguments)},d._ScatterNd=function(){return(d._ScatterNd=d.asm.ScatterNd).apply(null,arguments)},d._SelectV2=function(){return(d._SelectV2=d.asm.SelectV2).apply(null,arguments)},d._Sigmoid=function(){return(d._Sigmoid=d.asm.Sigmoid).apply(null,arguments)},d._Sin=function(){return(d._Sin=d.asm.Sin).apply(null,arguments)},d._Softmax=function(){return(d._Softmax=d.asm.Softmax).apply(null,arguments)},d._SparseFillEmptyRows=function(){return(d._SparseFillEmptyRows=d.asm.SparseFillEmptyRows).apply(null,arguments)},d._SparseReshape=function(){return(d._SparseReshape=d.asm.SparseReshape).apply(null,arguments)},d._SparseSegmentReduction=function(){return(d._SparseSegmentReduction=d.asm.SparseSegmentReduction).apply(null,arguments)},d._Sqrt=function(){return(d._Sqrt=d.asm.Sqrt).apply(null,arguments)},d._Square=function(){return(d._Square=d.asm.Square).apply(null,arguments)},d._SquaredDifference=function(){return(d._SquaredDifference=d.asm.SquaredDifference).apply(null,arguments)},d._Step=function(){return(d._Step=d.asm.Step).apply(null,arguments)},d._StridedSlice=function(){return(d._StridedSlice=d.asm.StridedSlice).apply(null,arguments)},d._Sub=function(){return(d._Sub=d.asm.Sub).apply(null,arguments)},d._Sum=function(){return(d._Sum=d.asm.Sum).apply(null,arguments)},d._Tan=function(){return(d._Tan=d.asm.Tan).apply(null,arguments)},d._Tanh=function(){return(d._Tanh=d.asm.Tanh).apply(null,arguments)},d._Tile=function(){return(d._Tile=d.asm.Tile).apply(null,arguments)},d._TopK=function(){return(d._TopK=d.asm.TopK).apply(null,arguments)},d._Transform=function(){return(d._Transform=d.asm.Transform).apply(null,arguments)},d._Transpose=function(){return(d._Transpose=d.asm.Transpose).apply(null,arguments)},d.__FusedMatMul=function(){return(d.__FusedMatMul=d.asm._FusedMatMul).apply(null,arguments)};var je=d._malloc=function(){return(je=d._malloc=d.asm.malloc).apply(null,arguments)},He=d._free=function(){return(He=d._free=d.asm.free).apply(null,arguments)};d._emscripten_tls_init=function(){return(d._emscripten_tls_init=d.asm.emscripten_tls_init).apply(null,arguments)};var Ue=d.___errno_location=function(){return(Ue=d.___errno_location=d.asm.__errno_location).apply(null,arguments)},Be=d._pthread_self=function(){return(Be=d._pthread_self=d.asm.pthread_self).apply(null,arguments)},qe=d._emscripten_main_thread_process_queued_calls=function(){return(qe=d._emscripten_main_thread_process_queued_calls=d.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)};d.__emscripten_thread_crashed=function(){return(d.__emscripten_thread_crashed=d.asm._emscripten_thread_crashed).apply(null,arguments)};var Ge=d.__emscripten_thread_init=function(){return(Ge=d.__emscripten_thread_init=d.asm._emscripten_thread_init).apply(null,arguments)};d._emscripten_current_thread_process_queued_calls=function(){return(d._emscripten_current_thread_process_queued_calls=d.asm.emscripten_current_thread_process_queued_calls).apply(null,arguments)},d._emscripten_main_browser_thread_id=function(){return(d._emscripten_main_browser_thread_id=d.asm.emscripten_main_browser_thread_id).apply(null,arguments)},d._emscripten_sync_run_in_main_thread_2=function(){return(d._emscripten_sync_run_in_main_thread_2=d.asm.emscripten_sync_run_in_main_thread_2).apply(null,arguments)};var Ve=d._emscripten_sync_run_in_main_thread_4=function(){return(Ve=d._emscripten_sync_run_in_main_thread_4=d.asm.emscripten_sync_run_in_main_thread_4).apply(null,arguments)},$e=d._emscripten_run_in_main_runtime_thread_js=function(){return($e=d._emscripten_run_in_main_runtime_thread_js=d.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)},Ke=d._emscripten_dispatch_to_thread_=function(){return(Ke=d._emscripten_dispatch_to_thread_=d.asm.emscripten_dispatch_to_thread_).apply(null,arguments)},Xe=d.__emscripten_thread_free_data=function(){return(Xe=d.__emscripten_thread_free_data=d.asm._emscripten_thread_free_data).apply(null,arguments)};d.__emscripten_thread_exit=function(){return(d.__emscripten_thread_exit=d.asm._emscripten_thread_exit).apply(null,arguments)},d._memalign=function(){return(d._memalign=d.asm.memalign).apply(null,arguments)};var Qe=d._emscripten_stack_set_limits=function(){return(Qe=d._emscripten_stack_set_limits=d.asm.emscripten_stack_set_limits).apply(null,arguments)},Ze=d.stackSave=function(){return(Ze=d.stackSave=d.asm.stackSave).apply(null,arguments)},Ye=d.stackRestore=function(){return(Ye=d.stackRestore=d.asm.stackRestore).apply(null,arguments)},Je=d.stackAlloc=function(){return(Je=d.stackAlloc=d.asm.stackAlloc).apply(null,arguments)};d.dynCall_iijjiiii=function(){return(d.dynCall_iijjiiii=d.asm.dynCall_iijjiiii).apply(null,arguments)},d.dynCall_jiji=function(){return(d.dynCall_jiji=d.asm.dynCall_jiji).apply(null,arguments)};var et,tt,nt,at=d.__emscripten_allow_main_runtime_queued_calls=21672;function rt(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function st(e){if(!(ne>0)){if(k)return u(d),ee(),void postMessage({cmd:"loaded"});!function(){if(d.preRun)for("function"==typeof d.preRun&&(d.preRun=[d.preRun]);d.preRun.length;)e=d.preRun.shift(),Q.unshift(e);var e;de(Q)}(),ne>0||(d.setStatus?(d.setStatus("Running..."),setTimeout((function(){setTimeout((function(){d.setStatus("")}),1),t()}),1)):t())}function t(){et||(et=!0,d.calledRun=!0,D||(ee(),u(d),d.onRuntimeInitialized&&d.onRuntimeInitialized(),function(){if(!k){if(d.postRun)for("function"==typeof d.postRun&&(d.postRun=[d.postRun]);d.postRun.length;)e=d.postRun.shift(),Y.unshift(e);var e;de(Y)}}()))}}if(d.cwrap=function(e,t,n,a){var r=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!a?T(e):function(){return P(e,t,n,arguments)}},d.keepRuntimeAlive=J,d.PThread=me,d.PThread=me,d.wasmMemory=E,d.ExitStatus=rt,ae=function e(){et||st(),et||(ae=e)},d.run=st,d.preInit)for("function"==typeof d.preInit&&(d.preInit=[d.preInit]);d.preInit.length>0;)d.preInit.pop()();if(st(),o&&(tt={uncaughtException:process.listeners("uncaughtException").filter((function(e){return!o.uncaughtException.indexOf(e)>-1})),unhandledRejection:process.listeners("unhandledRejection").filter((function(e){return!o.unhandledRejection.indexOf(e)>-1}))}),"undefined"!=typeof WasmBackendModule)nt=WasmBackendModule;else{if("undefined"==typeof e)throw new Error("Could not find wasm module in post.js");nt=e}if(tt){var ut=nt._dispose;nt._dispose=function(){ut(),tt.uncaughtException.forEach((function(e){process.removeListener("uncaughtException",e)})),tt.unhandledRejection.forEach((function(e){process.removeListener("unhandledRejection",e)}))}}return e.ready});e.exports=a})),zr=Object.assign(Object.create(null),Lr,{default:Lr}),jr='"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",function(data){onmessage({data:data})});var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8"))},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"\n");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=((info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports});self.onmessage=(e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob==="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module).then(function(instance){Module=instance})}else if(e.data.cmd==="run"){Module["__performance_now_clock_drift"]=performance.now()-e.data.time;Module["__emscripten_thread_init"](e.data.threadInfoStruct,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInit();try{var result=Module["invokeEntryPoint"](e.data.start_routine,e.data.arg);if(Module["keepRuntimeAlive"]()){Module["PThread"].setExitStatus(result)}else{Module["__emscripten_thread_exit"](result)}}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processThreadQueue"){if(Module["_pthread_self"]()){Module["_emscripten_current_thread_process_queued_calls"]()}}else if(e.data.cmd==="processProxyingQueue"){if(Module["_pthread_self"]()){Module["_emscripten_proxy_execute_queue"](e.data.queue)}}else{err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){err("worker.js onmessage() captured an uncaught exception: "+ex);if(ex&&ex.stack)err(ex.stack);if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}});',Hr=Wr((function(e,t){var n,a=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(n=n||__filename),function(e){var t,a,r,s="undefined"!=typeof(e=e||{})?e:{};s.ready=new Promise((function(e,n){t=e,a=n})),"undefined"!=typeof process&&process.listeners&&(r={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var u,i,o,d,l,p,c=Object.assign({},s),m="object"==typeof window,f="function"==typeof importScripts,h="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,b="";h?(b=f?ft.dirname(b)+"/":__dirname+"/",p=()=>{l||(d=ht,l=ft)},u=function(e,t){return p(),e=l.normalize(e),d.readFileSync(e,t?void 0:"utf8")},o=e=>{var t=u(e,!0);return t.buffer||(t=new Uint8Array(t)),t},i=(e,t,n)=>{p(),e=l.normalize(e),d.readFile(e,(function(e,a){e?n(e):t(a.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof ae))throw e})),process.on("unhandledRejection",(function(e){throw e})),s.inspect=function(){return"[Emscripten Module object]"}):(m||f)&&(f?b=self.location.href:"undefined"!=typeof document&&document.currentScript&&(b=document.currentScript.src),n&&(b=n),b=0!==b.indexOf("blob:")?b.substr(0,b.replace(/[?#].*/,"").lastIndexOf("/")+1):"",u=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},f&&(o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),i=(e,t,n)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)});var _,y,g=s.print||console.log.bind(console),w=s.printErr||console.warn.bind(console);Object.assign(s,c),c=null,s.arguments,s.thisProgram,s.quit,s.wasmBinary&&(_=s.wasmBinary),s.noExitRuntime,"object"!=typeof WebAssembly&&j("no native wasm support detected");var k=!1;function I(e){return s["_"+e]}function v(e,t,n,a,r){var s={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);!function(e,t,n){!function(e,t,n,a){if(!(a>0))return 0;for(var r=n+a-1,s=0;s<e.length;++s){var u=e.charCodeAt(s);if(u>=55296&&u<=57343&&(u=65536+((1023&u)<<10)|1023&e.charCodeAt(++s)),u<=127){if(n>=r)break;t[n++]=u}else if(u<=2047){if(n+1>=r)break;t[n++]=192|u>>6,t[n++]=128|63&u}else if(u<=65535){if(n+2>=r)break;t[n++]=224|u>>12,t[n++]=128|u>>6&63,t[n++]=128|63&u}else{if(n+3>=r)break;t[n++]=240|u>>18,t[n++]=128|u>>12&63,t[n++]=128|u>>6&63,t[n++]=128|63&u}}t[n]=0}(e,x,t,n)}(e,t=ne(n),n)}return t},array:function(e){var t=ne(e.length);return function(e,t){M.set(e,t)}(e,t),t}},u=I(e),i=[],o=0;if(a)for(var d=0;d<a.length;d++){var l=s[n[d]];l?(0===o&&(o=ee()),i[d]=l(a[d])):i[d]=a[d]}var p=u.apply(null,i);return p=function(e){return 0!==o&&te(o),function(e){return"string"===t?R(e):"boolean"===t?Boolean(e):e}(e)}(p)}var S,M,x,A,F,N="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(e,t,n){for(var a=t+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.subarray&&N)return N.decode(e.subarray(t,r));for(var s="";t<r;){var u=e[t++];if(128&u){var i=63&e[t++];if(192!=(224&u)){var o=63&e[t++];if((u=224==(240&u)?(15&u)<<12|i<<6|o:(7&u)<<18|i<<12|o<<6|63&e[t++])<65536)s+=String.fromCharCode(u);else{var d=u-65536;s+=String.fromCharCode(55296|d>>10,56320|1023&d)}}else s+=String.fromCharCode((31&u)<<6|i)}else s+=String.fromCharCode(u)}return s}function R(e,t){return e?E(x,e,t):""}function C(e){S=e,s.HEAP8=M=new Int8Array(e),s.HEAP16=new Int16Array(e),s.HEAP32=A=new Int32Array(e),s.HEAPU8=x=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAPU32=new Uint32Array(e),s.HEAPF32=new Float32Array(e),s.HEAPF64=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),s.INITIAL_MEMORY;var O,D,T=[],P=[],W=[],L=0,z=null;function j(e){s.onAbort&&s.onAbort(e),w(e="Aborted("+e+")"),k=!0,e+=". Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw a(t),t}function H(e){return e.startsWith("data:application/octet-stream;base64,")}function U(e){return e.startsWith("file://")}function B(e){try{if(e==O&&_)return new Uint8Array(_);if(o)return o(e);throw"both async and sync fetching of the wasm failed"}catch(e){j(e)}}function q(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?V(n)():V(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(s)}}s.preloadedImages={},s.preloadedAudios={},H(O="tfjs-backend-wasm.wasm")||(D=O,O=s.locateFile?s.locateFile(D,b):b+D);var G=[];function V(e){var t=G[e];return t||(e>=G.length&&(G.length=e+1),G[e]=t=F.get(e)),t}function $(){return 2147483648}function K(e){try{return y.grow(e-S.byteLength+65535>>>16),C(y.buffer),1}catch(e){}}var X={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=X.buffers[e];0===t||10===t?((1===e?g:w)(E(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return X.varargs+=4,A[X.varargs-4>>2]},getStr:function(e){return R(e)},get64:function(e,t){return e}},Q={abort:function(){j("")},emscripten_get_heap_max:$,emscripten_memcpy_big:function(e,t,n){x.copyWithin(e,t,t+n)},emscripten_resize_heap:function(e){var t,n,a=x.length,r=2147483648;if((e>>>=0)>r)return!1;for(var s=1;s<=4;s*=2){var u=a*(1+.2/s);if(u=Math.min(u,e+100663296),K(Math.min(r,((t=Math.max(e,u))%(n=65536)>0&&(t+=n-t%n),t))))return!0}return!1},fd_close:function(e){return 0},fd_seek:function(e,t,n,a,r){},fd_write:function(e,t,n,a){for(var r=0,s=0;s<n;s++){var u=A[t>>2],i=A[t+4>>2];t+=8;for(var o=0;o<i;o++)X.printChar(e,x[u+o]);r+=i}return A[a>>2]=r,0},setTempRet0:function(e){}};!function(){var e={env:Q,wasi_snapshot_preview1:Q};function t(e,t){var n,a=e.exports;s.asm=a,C((y=s.asm.memory).buffer),F=s.asm.__indirect_function_table,n=s.asm.__wasm_call_ctors,P.unshift(n),function(e){if(L--,s.monitorRunDependencies&&s.monitorRunDependencies(L),0==L&&z){var t=z;z=null,t()}}()}function n(e){t(e.instance)}function r(t){return function(){if(!_&&(m||f)){if("function"==typeof fetch&&!U(O))return fetch(O,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+O+"'";return e.arrayBuffer()})).catch((function(){return B(O)}));if(i)return new Promise((function(e,t){i(O,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return B(O)}))}().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){w("failed to asynchronously prepare wasm: "+e),j(e)}))}if(L++,s.monitorRunDependencies&&s.monitorRunDependencies(L),s.instantiateWasm)try{return s.instantiateWasm(e,t)}catch(e){return w("Module.instantiateWasm callback failed with error: "+e),!1}(_||"function"!=typeof WebAssembly.instantiateStreaming||H(O)||U(O)||"function"!=typeof fetch?r(n):fetch(O,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return w("wasm streaming compile failed: "+e),w("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(a)}(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm.__wasm_call_ctors).apply(null,arguments)},s._init=function(){return(s._init=s.asm.init).apply(null,arguments)},s._init_with_threads_count=function(){return(s._init_with_threads_count=s.asm.init_with_threads_count).apply(null,arguments)},s._get_threads_count=function(){return(s._get_threads_count=s.asm.get_threads_count).apply(null,arguments)},s._register_tensor=function(){return(s._register_tensor=s.asm.register_tensor).apply(null,arguments)},s._dispose_data=function(){return(s._dispose_data=s.asm.dispose_data).apply(null,arguments)},s._dispose=function(){return(s._dispose=s.asm.dispose).apply(null,arguments)},s._Abs=function(){return(s._Abs=s.asm.Abs).apply(null,arguments)},s._Add=function(){return(s._Add=s.asm.Add).apply(null,arguments)},s._AddN=function(){return(s._AddN=s.asm.AddN).apply(null,arguments)},s._All=function(){return(s._All=s.asm.All).apply(null,arguments)},s._Any=function(){return(s._Any=s.asm.Any).apply(null,arguments)},s._ArgMax=function(){return(s._ArgMax=s.asm.ArgMax).apply(null,arguments)},s._AvgPool=function(){return(s._AvgPool=s.asm.AvgPool).apply(null,arguments)},s._BatchMatMul=function(){return(s._BatchMatMul=s.asm.BatchMatMul).apply(null,arguments)},s._Ceil=function(){return(s._Ceil=s.asm.Ceil).apply(null,arguments)},s._ClipByValue=function(){return(s._ClipByValue=s.asm.ClipByValue).apply(null,arguments)},s._Conv2D=function(){return(s._Conv2D=s.asm.Conv2D).apply(null,arguments)},s._Conv2DBackpropInput=function(){return(s._Conv2DBackpropInput=s.asm.Conv2DBackpropInput).apply(null,arguments)},s._Cos=function(){return(s._Cos=s.asm.Cos).apply(null,arguments)},s._Cosh=function(){return(s._Cosh=s.asm.Cosh).apply(null,arguments)},s._CropAndResize=function(){return(s._CropAndResize=s.asm.CropAndResize).apply(null,arguments)},s._Cumprod=function(){return(s._Cumprod=s.asm.Cumprod).apply(null,arguments)},s._Cumsum=function(){return(s._Cumsum=s.asm.Cumsum).apply(null,arguments)},s._DepthToSpace=function(){return(s._DepthToSpace=s.asm.DepthToSpace).apply(null,arguments)},s._DepthwiseConv2dNative=function(){return(s._DepthwiseConv2dNative=s.asm.DepthwiseConv2dNative).apply(null,arguments)},s._Elu=function(){return(s._Elu=s.asm.Elu).apply(null,arguments)},s._Equal=function(){return(s._Equal=s.asm.Equal).apply(null,arguments)},s._Exp=function(){return(s._Exp=s.asm.Exp).apply(null,arguments)},s._FlipLeftRight=function(){return(s._FlipLeftRight=s.asm.FlipLeftRight).apply(null,arguments)},s._Floor=function(){return(s._Floor=s.asm.Floor).apply(null,arguments)},s._FloorDiv=function(){return(s._FloorDiv=s.asm.FloorDiv).apply(null,arguments)},s._FusedBatchNorm=function(){return(s._FusedBatchNorm=s.asm.FusedBatchNorm).apply(null,arguments)},s._FusedConv2D=function(){return(s._FusedConv2D=s.asm.FusedConv2D).apply(null,arguments)},s._FusedDepthwiseConv2D=function(){return(s._FusedDepthwiseConv2D=s.asm.FusedDepthwiseConv2D).apply(null,arguments)},s._Gather=function(){return(s._Gather=s.asm.Gather).apply(null,arguments)},s._GatherNd=function(){return(s._GatherNd=s.asm.GatherNd).apply(null,arguments)},s._Greater=function(){return(s._Greater=s.asm.Greater).apply(null,arguments)},s._GreaterEqual=function(){return(s._GreaterEqual=s.asm.GreaterEqual).apply(null,arguments)},s._LeakyRelu=function(){return(s._LeakyRelu=s.asm.LeakyRelu).apply(null,arguments)},s._Less=function(){return(s._Less=s.asm.Less).apply(null,arguments)},s._LessEqual=function(){return(s._LessEqual=s.asm.LessEqual).apply(null,arguments)},s._Log=function(){return(s._Log=s.asm.Log).apply(null,arguments)},s._LogicalAnd=function(){return(s._LogicalAnd=s.asm.LogicalAnd).apply(null,arguments)},s._LogicalNot=function(){return(s._LogicalNot=s.asm.LogicalNot).apply(null,arguments)},s._LogicalOr=function(){return(s._LogicalOr=s.asm.LogicalOr).apply(null,arguments)},s._LogicalXor=function(){return(s._LogicalXor=s.asm.LogicalXor).apply(null,arguments)},s._Max=function(){return(s._Max=s.asm.Max).apply(null,arguments)},s._MaxPool=function(){return(s._MaxPool=s.asm.MaxPool).apply(null,arguments)},s._Maximum=function(){return(s._Maximum=s.asm.Maximum).apply(null,arguments)},s._Mean=function(){return(s._Mean=s.asm.Mean).apply(null,arguments)},s._Min=function(){return(s._Min=s.asm.Min).apply(null,arguments)},s._Minimum=function(){return(s._Minimum=s.asm.Minimum).apply(null,arguments)},s._MirrorPad=function(){return(s._MirrorPad=s.asm.MirrorPad).apply(null,arguments)},s._Multiply=function(){return(s._Multiply=s.asm.Multiply).apply(null,arguments)},s._Neg=function(){return(s._Neg=s.asm.Neg).apply(null,arguments)},s._NonMaxSuppressionV3=function(){return(s._NonMaxSuppressionV3=s.asm.NonMaxSuppressionV3).apply(null,arguments)},s._NonMaxSuppressionV4=function(){return(s._NonMaxSuppressionV4=s.asm.NonMaxSuppressionV4).apply(null,arguments)},s._NonMaxSuppressionV5=function(){return(s._NonMaxSuppressionV5=s.asm.NonMaxSuppressionV5).apply(null,arguments)},s._NotEqual=function(){return(s._NotEqual=s.asm.NotEqual).apply(null,arguments)},s._OneHot=function(){return(s._OneHot=s.asm.OneHot).apply(null,arguments)},s._PadV2=function(){return(s._PadV2=s.asm.PadV2).apply(null,arguments)},s._Pow=function(){return(s._Pow=s.asm.Pow).apply(null,arguments)},s._Prelu=function(){return(s._Prelu=s.asm.Prelu).apply(null,arguments)},s._Prod=function(){return(s._Prod=s.asm.Prod).apply(null,arguments)},s._RealDiv=function(){return(s._RealDiv=s.asm.RealDiv).apply(null,arguments)},s._Relu=function(){return(s._Relu=s.asm.Relu).apply(null,arguments)},s._Relu6=function(){return(s._Relu6=s.asm.Relu6).apply(null,arguments)},s._ResizeBilinear=function(){return(s._ResizeBilinear=s.asm.ResizeBilinear).apply(null,arguments)},s._ResizeNearestNeighbor=function(){return(s._ResizeNearestNeighbor=s.asm.ResizeNearestNeighbor).apply(null,arguments)},s._Reverse=function(){return(s._Reverse=s.asm.Reverse).apply(null,arguments)},s._RotateWithOffset=function(){return(s._RotateWithOffset=s.asm.RotateWithOffset).apply(null,arguments)},s._Round=function(){return(s._Round=s.asm.Round).apply(null,arguments)},s._Rsqrt=function(){return(s._Rsqrt=s.asm.Rsqrt).apply(null,arguments)},s._ScatterNd=function(){return(s._ScatterNd=s.asm.ScatterNd).apply(null,arguments)},s._SelectV2=function(){return(s._SelectV2=s.asm.SelectV2).apply(null,arguments)},s._Sigmoid=function(){return(s._Sigmoid=s.asm.Sigmoid).apply(null,arguments)},s._Sin=function(){return(s._Sin=s.asm.Sin).apply(null,arguments)},s._Softmax=function(){return(s._Softmax=s.asm.Softmax).apply(null,arguments)},s._SparseFillEmptyRows=function(){return(s._SparseFillEmptyRows=s.asm.SparseFillEmptyRows).apply(null,arguments)},s._SparseReshape=function(){return(s._SparseReshape=s.asm.SparseReshape).apply(null,arguments)},s._SparseSegmentReduction=function(){return(s._SparseSegmentReduction=s.asm.SparseSegmentReduction).apply(null,arguments)},s._Sqrt=function(){return(s._Sqrt=s.asm.Sqrt).apply(null,arguments)},s._Square=function(){return(s._Square=s.asm.Square).apply(null,arguments)},s._SquaredDifference=function(){return(s._SquaredDifference=s.asm.SquaredDifference).apply(null,arguments)},s._Step=function(){return(s._Step=s.asm.Step).apply(null,arguments)},s._StridedSlice=function(){return(s._StridedSlice=s.asm.StridedSlice).apply(null,arguments)},s._Sub=function(){return(s._Sub=s.asm.Sub).apply(null,arguments)},s._Sum=function(){return(s._Sum=s.asm.Sum).apply(null,arguments)},s._Tan=function(){return(s._Tan=s.asm.Tan).apply(null,arguments)},s._Tanh=function(){return(s._Tanh=s.asm.Tanh).apply(null,arguments)},s._Tile=function(){return(s._Tile=s.asm.Tile).apply(null,arguments)},s._TopK=function(){return(s._TopK=s.asm.TopK).apply(null,arguments)},s._Transform=function(){return(s._Transform=s.asm.Transform).apply(null,arguments)},s._Transpose=function(){return(s._Transpose=s.asm.Transpose).apply(null,arguments)},s.__FusedMatMul=function(){return(s.__FusedMatMul=s.asm._FusedMatMul).apply(null,arguments)},s._malloc=function(){return(s._malloc=s.asm.malloc).apply(null,arguments)},s._free=function(){return(s._free=s.asm.free).apply(null,arguments)},s.___errno_location=function(){return(s.___errno_location=s.asm.__errno_location).apply(null,arguments)},s._emscripten_main_thread_process_queued_calls=function(){return(s._emscripten_main_thread_process_queued_calls=s.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)};var Z,Y,J,ee=s.stackSave=function(){return(ee=s.stackSave=s.asm.stackSave).apply(null,arguments)},te=s.stackRestore=function(){return(te=s.stackRestore=s.asm.stackRestore).apply(null,arguments)},ne=s.stackAlloc=function(){return(ne=s.stackAlloc=s.asm.stackAlloc).apply(null,arguments)};function ae(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function re(e){function n(){Z||(Z=!0,s.calledRun=!0,k||(q(P),t(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),function(){if(s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;)e=s.postRun.shift(),W.unshift(e);var e;q(W)}()))}L>0||(function(){if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)e=s.preRun.shift(),T.unshift(e);var e;q(T)}(),L>0||(s.setStatus?(s.setStatus("Running..."),setTimeout((function(){setTimeout((function(){s.setStatus("")}),1),n()}),1)):n()))}if(s.dynCall_iijjiiii=function(){return(s.dynCall_iijjiiii=s.asm.dynCall_iijjiiii).apply(null,arguments)},s.dynCall_jiji=function(){return(s.dynCall_jiji=s.asm.dynCall_jiji).apply(null,arguments)},s.cwrap=function(e,t,n,a){var r=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!a?I(e):function(){return v(e,t,n,arguments)}},z=function e(){Z||re(),Z||(z=e)},s.run=re,s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();if(re(),r&&(Y={uncaughtException:process.listeners("uncaughtException").filter((function(e){return!r.uncaughtException.indexOf(e)>-1})),unhandledRejection:process.listeners("unhandledRejection").filter((function(e){return!r.unhandledRejection.indexOf(e)>-1}))}),"undefined"!=typeof e)J=e;else{if("undefined"==typeof WasmBackendModuleThreadedSimd)throw new Error("Could not find wasm module in post.js");J=WasmBackendModuleThreadedSimd}if(Y){var se=J._dispose;J._dispose=function(){se(),Y.uncaughtException.forEach((function(e){process.removeListener("uncaughtException",e)})),Y.unhandledRejection.forEach((function(e){process.removeListener("unhandledRejection",e)}))}}return e.ready});e.exports=a}));const Ur=Lr||zr,Br=Hr||Object.assign(Object.create(null),Hr,{default:Hr});class qr extends dt{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(ts),ns=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new lt(this,pt())}write(e,t,n){const a={id:this.dataIdNextNumber++};return this.move(a,e,t,n,1),a}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){const t=n.now();e();return{kernelMs:n.now()-t}}move(e,t,a,r,s){const u=this.dataIdNextNumber++;if("string"===r){const n=t;return void this.dataIdMap.set(e,{id:u,stringBytes:n,shape:a,dtype:r,memoryOffset:null,refCount:s})}const i=n.sizeFromShape(a),o=i*n.bytesPerElement(r),d=this.wasm._malloc(o);this.dataIdMap.set(e,{id:u,memoryOffset:d,shape:a,dtype:r,refCount:s}),this.wasm.tfjs.registerTensor(u,i,d),null!=t&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,o),d)}async read(e){return this.readSync(e)}readSync(e,t,a){const{memoryOffset:r,dtype:s,shape:u,stringBytes:i}=this.dataIdMap.get(e);if("string"===s)return null!=t&&0!==t||!(null==a||a>=i.length)?i.slice(t,a):i;t=t||0,a=a||n.sizeFromShape(u);const o=n.bytesPerElement(s);return function(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error(`Unknown dtype ${t}`)}}(this.wasm.HEAPU8.slice(r+t*o,r+a*o).buffer,s)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){const n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){if(this.dataIdMap.has(e)){return this.dataIdMap.get(e).refCount}return 0}incRef(e){const t=this.dataIdMap.get(e);null!=t&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,a){let r;if(null==a)r=this.write(null,e,t);else{const s=this.dataIdNextNumber++;r={id:s},this.dataIdMap.set(r,{id:s,memoryOffset:a,shape:e,dtype:t,refCount:1});const u=n.sizeFromShape(e);this.wasm.tfjs.registerTensor(s,u,a)}return{dataId:r,shape:e,dtype:t}}typedArrayFromHeap({shape:e,dtype:t,dataId:a}){const r=this.wasm.HEAPU8.buffer,{memoryOffset:s}=this.dataIdMap.get(a),u=n.sizeFromShape(e);switch(t){case"float32":return new Float32Array(r,s,u);case"int32":return new Int32Array(r,s,u);case"bool":return new Uint8Array(r,s,u);default:throw new Error(`Unknown dtype ${t}`)}}}function Gr(e,t,n){if(null!=Kr)return Kr;let a="tfjs-backend-wasm.wasm";return e&&t?a="tfjs-backend-wasm-threaded-simd.wasm":e&&(a="tfjs-backend-wasm-simd.wasm"),null!=Qr&&null!=Qr[a]?Qr[a]:n+a}async function Vr(){const[e,t]=await Promise.all([ot().getAsync("WASM_HAS_SIMD_SUPPORT"),ot().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise(((a,r)=>{const s={};var u;s.locateFile=(n,a)=>{if(n.endsWith(".worker.js")){const e=jr.replace(/\n/g,"\\n"),t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}return n.endsWith(".wasm")?Gr(e,t,null!=Xr?Xr:a):a+n},Yr&&(s.instantiateWasm=(u=Gr(e,t,null!=Xr?Xr:""),(e,t)=>(n.fetch(u,{credentials:"same-origin"}).then((n=>{n.ok||e.env.a(`failed to load wasm binary file at '${u}'`),n.arrayBuffer().then((n=>{WebAssembly.instantiate(n,e).then((e=>{t(e.instance,e.module)}))}))})),{})));let i,o=!1;s.onAbort=()=>{if(o)return;if(Zr)return;Zr=!0;r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"})},t&&e&&null==Kr?(s.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+Ur.toString()],{type:"text/javascript"}),i=Ur(s)):i=Br(s),i.then((e=>{o=!0,Zr=!1;e.tfjs={init:e.cwrap("init",null,[]),initWithThreadsCount:e.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:e.cwrap("get_threads_count","number",[]),registerTensor:e.cwrap("register_tensor",null,["number","number","number"]),disposeData:e.cwrap("dispose_data",null,["number"]),dispose:e.cwrap("dispose",null,[])},a({wasm:e})})).catch(r)}))}const $r=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"];let Kr=null,Xr=null,Qr={},Zr=!1,Yr=!1;function Jr(e,t=!1){if(ct("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),Zr)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");Kr=e,Yr=t}function es(e,t=!1){if(Zr)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if("string"==typeof e)Xr=e;else{Qr=e;const t=$r.filter((e=>null==Qr[e]));if(t.length>0)throw new Error(`There were no entries found for the following binaries: ${t.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}Yr=t}let ts=-1,ns=-1;function as(e){ts=e}function rs(){if(-1===ns)throw new Error("WASM backend not initialized.");return ns}const ss="3.20.0";mt("wasm",(async()=>{const{wasm:e}=await Vr();return new qr(e)}),2);export{qr as BackendWasm,rs as getThreadsCount,as as setThreadsCount,Jr as setWasmPath,es as setWasmPaths,ss as version_wasm};
//# sourceMappingURL=tf-backend-wasm.fesm.min.js.map
