/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@tensorflow/tfjs-core"),require("path"),require("fs"),require("worker_threads"),require("perf_hooks"),require("os")):"function"==typeof define&&define.amd?define(["exports","@tensorflow/tfjs-core","path","fs","worker_threads","perf_hooks","os"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).tf=e.tf||{},e.tf.wasm=e.tf.wasm||{}),e.tf,e.path,e.fs,e.worker_threads,e.perf_hooks,e.require$$4)}(this,(function(e,t,n,a,r,s,u){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o,d,l=i(n),p=i(a),c=i(r),m=i(s),f=i(u);let h;!function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"}(o||(o={})),function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"}(d||(d={}));const b={kernelName:t._FusedMatMul,backendName:"wasm",setupFunc:function(e){h=e.wasm.cwrap(t._FusedMatMul,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{a:s,b:u,bias:i,preluActivationWeights:o}=n;if("float32"!==s.dtype||"float32"!==u.dtype)throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");const{transposeA:l,transposeB:p,activation:c,leakyreluAlpha:m}=r,f=a.dataIdMap.get(s.dataId).id,b=a.dataIdMap.get(u.dataId).id;let _=0;if(null!=i){const e=a.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${e.shape.length}.`);_=e.id}const y=null==o?0:a.dataIdMap.get(o.dataId).id,g=d[c];if(null==g)throw new Error(`${c} activation not yet supported for FusedConv2D in the wasm backend.`);const k=l?s.shape[2]:s.shape[1],w=p?u.shape[1]:u.shape[2],I=t.broadcast_util.assertAndGetBroadcastShape(s.shape.slice(0,-2),u.shape.slice(0,-2)),S=a.makeOutput([...I,k,w],s.dtype),v=a.dataIdMap.get(S.dataId).id,M=new Uint8Array(new Int32Array(s.shape).buffer),x=new Uint8Array(new Int32Array(u.shape).buffer);return h(f,M,s.shape.length,b,x,u.shape.length,l,p,g,_,y,m||0,v),S}};function _(e,n){let a;return{kernelName:e,backendName:"wasm",setupFunc:function(t){a=t.wasm.cwrap(e,null,["number","number","number"])},kernelFunc:function(e){const{backend:r,inputs:{x:s}}=e,u=r.dataIdMap.get(s.dataId).id,i=r.makeOutput(s.shape,n||s.dtype),d=r.dataIdMap.get(i.dataId).id;return 0===t.util.sizeFromShape(i.shape)||a(u,o[s.dtype],d),i}}}const y=_(t.Abs);function g(e,n,a){let r;return{kernelName:e,backendName:"wasm",setupFunc:function(t){r=t.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:s}=e,{a:u,b:i}=s,d=n.dataIdMap.get(u.dataId).id,l=n.dataIdMap.get(i.dataId).id,p=null!=a?a:u.dtype,c=t.backend_util.assertAndGetBroadcastShape(u.shape,i.shape),m=n.makeOutput(c,p);if(0===t.util.sizeFromShape(c))return m;const f=new Uint8Array(new Int32Array(u.shape).buffer),h=new Uint8Array(new Int32Array(i.shape).buffer),b=n.dataIdMap.get(m.dataId).id;return r(d,f,u.shape.length,l,h,i.shape.length,o[u.dtype],b),m}}}const k=g(t.Add);let w;const I={kernelName:t.AddN,backendName:"wasm",setupFunc:function(e){w=e.wasm.cwrap(t.AddN,null,["array","number","number","number"])},kernelFunc:function(e){const{inputs:n,backend:a}=e,r=a.makeOutput(n[0].shape,n[0].dtype);if(0===t.util.sizeFromShape(r.shape))return r;const s=n.map((e=>a.dataIdMap.get(e.dataId).id)),u=new Uint8Array(new Int32Array(s).buffer),i=a.dataIdMap.get(r.dataId).id;return w(u,s.length,o[r.dtype],i),r}};function S(e){const{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype),r=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(a).set(r),a}const v={kernelName:t.Identity,backendName:"wasm",kernelFunc:S};let M;function x(e){const{inputs:t,backend:n,attrs:a}=e,[r,s]=function(e,t){const n=[],a=[];for(let r=0;r<e.length;++r)1!==e[r]&&n.push(e[r]),1!==e[t[r]]&&a.push(t[r]);for(let e=0;e<a.length;++e){let t=-1;for(let n=0;n<a.length;++n)a[n]>=e&&(-1===t||a[t]>a[n])&&(t=n);a[t]=e}return[n,a]}(t.x.shape,a.perm);let u=!0;for(let e=0;e<s.length;e++)s[e]!==e&&(u=!1);const i=function(e,t){const n=new Array(e.length);for(let a=0;a<n.length;a++)n[a]=e[t[a]];return n}(t.x.shape,a.perm),d={dataId:t.x.dataId,shape:r,dtype:t.x.dtype};if(u){const e=S({inputs:t,backend:n});return e.shape=i,e}const l=n.makeOutput(i,d.dtype),p=n.dataIdMap.get(d.dataId).id,c=n.dataIdMap.get(l.dataId).id,m=new Uint8Array(new Int32Array(s).buffer),f=new Uint8Array(new Int32Array(d.shape).buffer);return M(p,f,d.shape.length,o[d.dtype],c,m,s.length),l}const A={kernelName:t.Transpose,backendName:"wasm",kernelFunc:x,setupFunc:function(e){M=e.wasm.cwrap(t.Transpose,null,["number","array","number","number","number","array","number"])}};function F(e,n,a){const r=e.shape,s=e.shape.length,u=t.util.parseAxisParam(n,r);let i=u;const o=t.backend_util.getAxesPermutation(i,s);let d=null,l=!1;if(null!=o){const n=new Array(s);for(let e=0;e<n.length;e++)n[e]=r[o[e]];i=t.backend_util.getInnerMostAxes(i.length,s),d=x({inputs:{x:e},attrs:{perm:o},backend:a});const u=a.dataIdMap.get(e.dataId).id;a.dataIdMap.get(d.dataId).id!==u&&(l=!0)}return{transposed:d,originalAxes:u,axes:i,inputWasTransposed:l}}let N;const E={kernelName:t.All,backendName:"wasm",setupFunc:function(e){N=e.wasm.cwrap(t.All,null,["number, number, number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:i}=a;let o=n.dataIdMap.get(i.dataId).id,d=i;const{transposed:l,axes:p,originalAxes:c,inputWasTransposed:m}=F(i,s,n);if(m){d=l,o=n.dataIdMap.get(l.dataId).id}const f=d.shape.length;t.backend_util.assertAxesAreInnerMostDims("all",p,f);const[h,b]=t.backend_util.computeOutAndReduceShapes(d.shape,p),_=t.util.sizeFromShape(b),y=n.makeOutput(h,i.dtype);if(0!==t.util.sizeFromShape(d.shape)){const e=n.dataIdMap.get(y.dataId).id;N(o,_,e)}if(m&&n.disposeData(l.dataId),u){const e=t.backend_util.expandShapeToKeepDim(y.shape,c);y.shape=e}return y}};let R;const C={kernelName:t.Any,backendName:"wasm",setupFunc:function(e){R=e.wasm.cwrap(t.Any,null,["number, number, number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:i}=a;let o=n.dataIdMap.get(i.dataId).id,d=i;const{transposed:l,axes:p,originalAxes:c,inputWasTransposed:m}=F(i,s,n);if(m){d=l,o=n.dataIdMap.get(l.dataId).id}const f=d.shape.length;t.backend_util.assertAxesAreInnerMostDims("any",p,f);const[h,b]=t.backend_util.computeOutAndReduceShapes(d.shape,p),_=t.util.sizeFromShape(b),y=n.makeOutput(h,i.dtype);if(0!==t.util.sizeFromShape(d.shape)){const e=n.dataIdMap.get(y.dataId).id;R(o,_,e)}if(m&&n.disposeData(l.dataId),u){const e=t.backend_util.expandShapeToKeepDim(y.shape,c);y.shape=e}return y}};let D;const T={kernelName:t.ArgMax,backendName:"wasm",kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s}=r,{x:u}=a,i=n.dataIdMap.get(u.dataId).id;let d=i,l=u;const{transposed:p,axes:c,inputWasTransposed:m}=F(u,s,n);if(m){const e=n.dataIdMap.get(p.dataId).id;e!==i&&(l=p,d=e)}const f=l.shape.slice(0,-1),h=n.makeOutput(f,"int32"),b=n.dataIdMap.get(h.dataId).id,_=t.util.sizeFromShape(h.shape),y=l.shape[c[0]];return D(d,o[l.dtype],_,y,b),m&&n.disposeData(p.dataId),h},setupFunc:function(e){D=e.wasm.cwrap(t.ArgMax,null,["number","number","number","number","number"])}};let O;const P={kernelName:t.AvgPool,backendName:"wasm",setupFunc:function(e){O=e.wasm.cwrap(t.AvgPool,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,s=n.x,u=r.dataIdMap.get(s.dataId).id,{filterSize:i,strides:o,pad:d,dimRoundingMode:l}=a,p=t.backend_util.computePool2DInfo(s.shape,i,o,1,d,l),c=p.filterHeight,m=p.filterWidth,f=p.padInfo.top,h=p.padInfo.right,b=p.padInfo.bottom,_=p.padInfo.left,y=p.strideHeight,g=p.strideWidth,k=p.inChannels;if("channelsLast"!==p.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${p.dataFormat}'. Please use 'channelsLast'.`);if(1!==p.dilationWidth||1!==p.dilationHeight)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${p.dilationHeight}, ${p.dilationWidth}].`);const w=r.makeOutput(p.outShape,"float32"),I=r.dataIdMap.get(w.dataId).id;return O(u,s.shape[0],s.shape[1],s.shape[2],c,m,f,h,b,_,y,g,k,I),w}};function W(e){const{inputs:n,attrs:a}=e,{x:r}=n,{shape:s}=a,u=t.util.sizeFromShape(r.shape),i=t.util.inferFromImplicitShape(s,u);return t.util.assert(u===t.util.sizeFromShape(i),(()=>`new shape: ${i}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`)),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:i,dtype:r.dtype}}const L={kernelName:t.Reshape,backendName:"wasm",kernelFunc:W};let z;const j={kernelName:t.BatchMatMul,backendName:"wasm",setupFunc:function(e){z=e.wasm.cwrap(t.BatchMatMul,null,["number","array","number","number","array","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{a:s,b:u}=n,{transposeA:i,transposeB:o}=r;if("float32"!==s.dtype||"float32"!==u.dtype)throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");const d=s.shape.length,l=u.shape.length,p=i?s.shape[d-2]:s.shape[d-1],c=o?u.shape[l-1]:u.shape[l-2],m=i?s.shape[d-1]:s.shape[d-2],f=o?u.shape[l-2]:u.shape[l-1],h=s.shape.slice(0,-2),b=u.shape.slice(0,-2),_=t.util.sizeFromShape(h),y=t.util.sizeFromShape(b),g=t.broadcast_util.assertAndGetBroadcastShape(s.shape.slice(0,-2),u.shape.slice(0,-2)).concat([m,f]);t.util.assert(p===c,(()=>`Error in matMul: inner shapes (${p}) and (${c}) of Tensors with shapes ${s.shape} and ${u.shape} and transposeA=${i} and transposeB=${o} must match.`));const k=o?[y,f,c]:[y,c,f],w=W({inputs:{x:s},backend:a,attrs:{shape:i?[_,p,m]:[_,m,p]}}),I=W({inputs:{x:u},backend:a,attrs:{shape:k}}),S=a.dataIdMap.get(w.dataId).id,v=a.dataIdMap.get(I.dataId).id,M=i?w.shape[2]:w.shape[1],x=o?I.shape[1]:I.shape[2],A=Math.max(_,y),F=a.makeOutput([A,M,x],w.dtype),N=a.dataIdMap.get(F.dataId).id,E=new Uint8Array(new Int32Array(w.shape).buffer),R=new Uint8Array(new Int32Array(I.shape).buffer);return z(S,E,w.shape.length,v,R,I.shape.length,i,o,N),a.disposeData(w.dataId),a.disposeData(I.dataId),F.shape=g,F}};function H(e,n,a,r,s){const u=t.slice_util.isSliceContinous(r,n,a),i=t.util.sizeFromShape(a),o=t.util.computeStrides(r);if(u){const a=t.slice_util.computeFlatOffset(n,o);return"string"===s?e.slice(a,a+i):e.subarray(a,a+i)}const d="string"===s?t.backend_util.fromUint8ToStringArray(e):e,l=t.buffer(r,s,d),p=t.buffer(a,s);for(let e=0;e<p.size;++e){const t=p.indexToLoc(e),a=t.map(((e,t)=>e+n[t]));p.set(l.get(...a),...t)}return"string"===s?t.backend_util.fromStringArrayToUint8(p.values):p.values}class B{constructor(e,n,a,r,s,u){this.separator=t.util.encodeString(e),this.nGramWidths=n,this.leftPad=t.util.encodeString(a),this.rightPad=t.util.encodeString(r),this.padWidth=s,this.preserveShort=u}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,a,r,s){for(let u=0;u<r;++u){const i=this.getPadWidth(s),o=Math.max(0,i-u),d=Math.max(0,i-(r-(u+1))),l=s-(o+d),p=t+(o>0?0:u-i);let c=0;c+=o*this.leftPad.length;for(let t=0;t<l;++t)c+=e[p+t].length;c+=d*this.rightPad.length;c+=(o+d+l-1)*this.separator.length,n[a+u]=new Uint8Array(c);const m=n[a+u];let f=0;const h=e=>e.forEach((e=>m[f++]=e));for(let e=0;e<o;++e)h(this.leftPad),h(this.separator);for(let t=0;t<l-1;++t)h(e[p+t]),h(this.separator);if(l>0){h(e[p+l-1]);for(let e=0;e<d;++e)h(this.separator),h(this.rightPad)}else{for(let e=0;e<d-1;++e)h(this.rightPad),h(this.separator);h(this.rightPad)}}}compute(e,n){const a=e.length,r=n.length;if(r>0){let e=n[0];if(0!==e)throw new Error(`First split value must be 0, got ${e}`);for(let t=1;t<r;++t){let r=n[t]>=e;if(r=r&&n[t]<=a,!r)throw new Error(`Invalid split value ${n[t]}, must be in [${e}, ${a}]`);e=n[t]}if(e!==a)throw new Error(`Last split value must be data size. Expected ${a}, got ${e}`)}const s=r-1,u=t.util.getArrayFromDType("int32",r);if(0===a||0===r){const e=new Array(a);for(let e=0;e<=s;++e)u[e]=0;return[e,u]}u[0]=0;for(let e=1;e<=s;++e){const t=n[e]-n[e-1];let a=0;this.nGramWidths.forEach((e=>{a+=this.getNumNGrams(t,e)})),this.preserveShort&&t>0&&0===a&&(a=1),u[e]=u[e-1]+a}const i=new Array(u[s]);for(let t=0;t<s;++t){const a=n[t];let r=u[t];if(this.nGramWidths.forEach((s=>{const u=n[t+1]-n[t],o=this.getNumNGrams(u,s);this.createNGrams(e,a,i,r,o,s),r+=o})),this.preserveShort&&r===u[t]){const s=n[t+1]-n[t];if(0===s)continue;const u=s+2*this.padWidth,o=1;this.createNGrams(e,a,i,r,o,u)}}return[i,u]}}function U(e,t,n,a){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)a.push(e.subarray(t,t+1));return}if(1===t.length){const r=t[0];let s=e.indexOf(r);for(;-1!==s;){const t=e.subarray(0,s);n&&0===t.length||a.push(t),s=(e=e.subarray(s+1)).indexOf(r)}return void(n&&0===e.length||a.push(e))}let r=0;for(let s=0;s<e.length+1;s++)if(s===e.length||-1!==t.indexOf(e[s])){const t=e.subarray(r,s);n&&0===t.length||a.push(t),r=s+1}}function q(e){const{inputs:{x:n},attrs:{begin:a,size:r},backend:s}=e,[u,i]=t.slice_util.parseSliceParams(n,a,r),o=t.slice_util.isSliceContinous(n.shape,u,i),d=s.readSync(n.dataId),l=s.makeOutput(i,n.dtype),p=t.util.computeStrides(n.shape),c=s.dataIdMap.get(l.dataId);if(o){const e=t.slice_util.computeFlatOffset(u,p);if("string"===n.dtype)c.stringBytes=d.slice(e,e+t.util.sizeFromShape(i));else{s.typedArrayFromHeap(l).set(d.subarray(e,e+t.util.sizeFromShape(i)))}return l}if("string"===n.dtype){const e=H(d,u,i,n.shape,n.dtype);return c.stringBytes=e,l}const m=s.typedArrayFromHeap(l),f=n.shape.length;if(2===f)!function(e,t,n,a,r){let s=0;const u=a[0],i=a[1],o=u+r[0];for(let a=u;a<o;a++){const u=a*t+i;n.set(e.subarray(u,u+r[1]),s),s+=r[1]}}(d,p[0],m,u,i);else if(3===f)!function(e,t,n,a,r,s){let u=0;const i=r[0],o=r[1],d=r[2],l=i+s[0],p=o+s[1];for(let r=i;r<l;r++)for(let i=o;i<p;i++){const o=r*t+i*n+d;a.set(e.subarray(o,o+s[2]),u),u+=s[2]}}(d,p[0],p[1],m,u,i);else if(4===f)!function(e,t,n,a,r,s,u){let i=0;const o=s[0],d=s[1],l=s[2],p=o+u[0],c=d+u[1],m=l+u[2],f=s[3];for(let s=o;s<p;s++)for(let o=d;o<c;o++)for(let d=l;d<m;d++){const l=s*t+o*n+d*a+f;r.set(e.subarray(l,l+u[3]),i),i+=u[3]}}(d,p[0],p[1],p[2],m,u,i);else{const e=H(d,u,i,n.shape,n.dtype);m.set(e)}return l}const V={kernelName:t.Slice,backendName:"wasm",kernelFunc:q};const G={kernelName:t.BatchToSpaceND,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{blockShape:u,crops:i}=r,o=u.reduce(((e,t)=>e*t)),d=t.backend_util.getReshaped(s.shape,u,o),l=t.backend_util.getPermuted(d.length,u.length),p=t.backend_util.getReshapedPermuted(s.shape,u,o),c=t.backend_util.getSliceBeginCoords(i,u.length),m=t.backend_util.getSliceSize(p,i,u.length),f=W({inputs:{x:s},backend:a,attrs:{shape:d}}),h=x({inputs:{x:f},backend:a,attrs:{perm:l}}),b=q({inputs:{x:W({inputs:{x:h},backend:a,attrs:{shape:p}})},backend:a,attrs:{begin:c,size:m}});return a.disposeData(f.dataId),a.disposeData(h.dataId),a.disposeData(f.dataId),b}};function $(e){const{inputs:{x:t},attrs:{dtype:n},backend:a}=e,r=a.makeOutput(t.shape,n),s=a.typedArrayFromHeap(t);return a.typedArrayFromHeap(r).set(s),r}const K={kernelName:t.Cast,backendName:"wasm",kernelFunc:$},X=_(t.Ceil);let Q;const Z={kernelName:t.ClipByValue,backendName:"wasm",setupFunc:function(e){Q=e.wasm.cwrap(t.ClipByValue,null,["number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:r}=t,{clipValueMin:s,clipValueMax:u}=a,i=n.dataIdMap.get(r.dataId).id,o=n.makeOutput(r.shape,r.dtype),d=n.dataIdMap.get(o.dataId).id;return Q(i,s,u,d),o}};function Y(e){const{inputs:n,backend:a}=e,r=t.util.parseAxisParam(e.attrs.axis,n[0].shape)[0];let s=t.backend_util.computeOutShape(n.map((e=>e.shape)),r);const u=n.filter((e=>t.util.sizeFromShape(e.shape)>0));if(1===u.length)return S({inputs:{x:u[0]},backend:a});const i=a.makeOutput(s,n[0].dtype);if(0===t.util.sizeFromShape(s))return i;const o=u.map((e=>e.shape));if(t.backend_util.assertParamsConsistent(o,r),"string"===u[0].dtype){const e=u.map((e=>{const n=t.util.sizeFromShape(e.shape.slice(r));return W({inputs:{x:e},backend:a,attrs:{shape:[-1,n]}})})),o=e.map((e=>({vals:a.readSync(e.dataId),shape:e.shape})));s=t.backend_util.computeOutShape(e.map((e=>e.shape)),1);const d=1===e[0].shape[0],l=function(e,n,a,r){const s=t.util.getArrayFromDType(a,t.util.sizeFromShape(n));if(r&&"string"!==a){let n=0;e.forEach((e=>{const a=t.util.sizeFromShape(e.shape);s.set(e.vals,n),n+=a}))}else{let r=0;e.forEach((e=>{const u="string"===a?t.backend_util.fromUint8ToStringArray(e.vals):e.vals;let i=0;for(let t=0;t<e.shape[0];++t){const a=t*n[1]+r;for(let t=0;t<e.shape[1];++t)s[a+t]=u[i++]}r+=e.shape[1]}))}return s}(o,s,n[0].dtype,d),p=t.backend_util.computeOutShape(u.map((e=>e.shape)),r);i.shape=p;return a.dataIdMap.get(i.dataId).stringBytes=t.backend_util.fromStringArrayToUint8(l),e.forEach((e=>a.disposeData(e.dataId))),i}const d=t.util.sizeFromShape(u[0].shape.slice(0,r));let l=0;const p=u.map((e=>{const n=t.util.sizeFromShape(e.shape.slice(r));return l+=n,n})),c=u.map((e=>a.typedArrayFromHeap(e))),m=a.typedArrayFromHeap(i);for(let e=0;e<d;e++){let t=e*l;for(let n=0;n<c.length;n++){const a=p[n],r=e*a,s=c[n].subarray(r,r+a);m.set(s,t),t+=a}}return i}const J={kernelName:t.Concat,backendName:"wasm",kernelFunc:Y};let ee;const te={kernelName:t.Conv2D,backendName:"wasm",setupFunc:function(e){ee=e.wasm.cwrap(t.Conv2D,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s,filter:u}=n,i=r.dataIdMap.get(s.dataId).id,o=r.dataIdMap.get(u.dataId).id,{strides:d,dilations:l,pad:p,dimRoundingMode:c,dataFormat:m}=a,f=t.backend_util.convertConv2DDataFormat(m),h=t.backend_util.computeConv2DInfo(s.shape,u.shape,d,l,p,c,!1,f),b=h.filterHeight,_=h.filterWidth,y=h.padInfo.top,g=h.padInfo.right,k=h.padInfo.bottom,w=h.padInfo.left,I=h.dilationHeight,S=h.dilationWidth,v=h.strideHeight,M=h.strideWidth,x=h.inChannels,A=h.outChannels,F="SAME"===h.padInfo.type?1:0;if("channelsLast"!==h.dataFormat)throw new Error(`wasm backend Conv2D does not support dataFormat:'${h.dataFormat}'. Please use 'channelsLast'.`);const N=r.makeOutput(h.outShape,"float32"),E=r.dataIdMap.get(N.dataId).id;return ee(i,s.shape[0],s.shape[1],s.shape[2],o,b,_,y,g,k,w,F,I,S,v,M,x,A,E),N}};let ne;const ae={kernelName:t.Conv2DBackpropInput,backendName:"wasm",setupFunc:function(e){ne=e.wasm.cwrap(t.Conv2DBackpropInput,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{dy:s,filter:u}=a,{strides:i,pad:o,dataFormat:d,dimRoundingMode:l,inputShape:p}=r,c=t.backend_util.convertConv2DDataFormat(d),m=t.backend_util.computeConv2DInfo(p,u.shape,i,1,o,l,!1,c),{batchSize:f,filterHeight:h,filterWidth:b,inChannels:_,inHeight:y,inWidth:g,outChannels:k,outHeight:w,outWidth:I,strideHeight:S,strideWidth:v}=m,M=h-1-m.padInfo.top,x=b-1-m.padInfo.left,A="channelsLast"===m.dataFormat,F=t.util.computeStrides(m.inShape),N=t.util.computeStrides(s.shape),[E,R,C]=t.util.computeStrides(u.shape),D=F[0],T=A?F[1]:F[2],O=A?F[2]:1,P=A?1:F[1],W=N[0],L=A?N[1]:N[2],z=A?N[2]:1,j=A?1:N[1],H=n.makeOutput(m.inShape,"float32"),B=n.dataIdMap.get(H.dataId).id,U=n.dataIdMap.get(s.dataId).id,q=n.dataIdMap.get(u.dataId).id;return ne(U,q,f,h,b,y,g,_,w,I,k,S,v,M,x,E,R,C,D,T,O,P,W,L,z,j,B),H}},re=_(t.Cos),se=_(t.Cosh);var ue;let ie;!function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"}(ue||(ue={}));const oe={kernelName:t.CropAndResize,backendName:"wasm",setupFunc:function(e){ie=e.wasm.cwrap(t.CropAndResize,null,["number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{method:r,extrapolationValue:s,cropSize:u}=a,{image:i,boxes:o,boxInd:d}=n,l=o.shape[0],[p,c]=u,m=[l,p,c,i.shape[3]];let f,h=t.dataIdMap.get(i.dataId);"float32"!==i.dtype&&(f=$({backend:t,inputs:{x:i},attrs:{dtype:"float32"}}),h=t.dataIdMap.get(f.dataId));const b=h.id,_=t.dataIdMap.get(o.dataId).id,y=t.dataIdMap.get(d.dataId).id,g=t.makeOutput(m,"float32"),k=t.dataIdMap.get(g.dataId).id,w=new Uint8Array(new Int32Array(i.shape).buffer);return ie(b,_,y,l,w,p,c,ue[r],s,k),null!=f&&t.disposeData(f.dataId),g}};let de;const le={kernelName:t.Cumprod,backendName:"wasm",setupFunc:function(e){de=e.wasm.cwrap(t.Cumprod,null,["number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{axis:u,exclusive:i,reverse:d}=r,l=s.shape.length;t.util.assert("float32"===s.dtype||"int32"===s.dtype,(()=>`cumprod does not support ${s.dtype} tensors in the WASM backend`));const p=t.backend_util.getAxesPermutation([u],l);let c=s;null!==p&&(c=x({inputs:{x:s},attrs:{perm:p},backend:a}));const m=t.backend_util.getInnerMostAxes(1,l)[0];t.backend_util.assertAxesAreInnerMostDims("cumprod",[m],l);const f=a.makeOutput(c.shape,c.dtype),h=c.shape[m],b=a.dataIdMap.get(c.dataId).id,_=a.dataIdMap.get(f.dataId).id;de(b,i?1:0,d?1:0,h,_,o[s.dtype]);let y=f;if(null!==p){y=x({inputs:{x:f},attrs:{perm:t.backend_util.getUndoAxesPermutation(p)},backend:a}),a.disposeData(c.dataId),a.disposeData(f.dataId)}return y}};let pe;const ce={kernelName:t.Cumsum,backendName:"wasm",setupFunc:function(e){pe=e.wasm.cwrap(t.Cumsum,null,["number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{axis:u,exclusive:i,reverse:d}=r,l=s.shape.length;t.util.assert("float32"===s.dtype||"int32"===s.dtype,(()=>`cumsum does not support ${s.dtype} tensors in the WASM backend`));const p=t.backend_util.getAxesPermutation([u],l);let c=s;null!==p&&(c=x({inputs:{x:s},attrs:{perm:p},backend:a}));const m=t.backend_util.getInnerMostAxes(1,l)[0];t.backend_util.assertAxesAreInnerMostDims("cumsum",[m],l);const f=a.makeOutput(c.shape,c.dtype),h=c.shape[m],b=a.dataIdMap.get(c.dataId).id,_=a.dataIdMap.get(f.dataId).id;pe(b,i?1:0,d?1:0,h,_,o[s.dtype]);let y=f;if(null!==p){y=x({inputs:{x:f},attrs:{perm:t.backend_util.getUndoAxesPermutation(p)},backend:a}),a.disposeData(c.dataId),a.disposeData(f.dataId)}return y}};let me;const fe={kernelName:t.DepthToSpace,backendName:"wasm",setupFunc:function(e){me=e.wasm.cwrap(t.DepthToSpace,null,["number","number","number","array","number","array","array","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{x:s}=a,{blockSize:u,dataFormat:i}=r,o=s.shape[0],d=("NHWC"===i?s.shape[1]:s.shape[2])*u,l=("NHWC"===i?s.shape[2]:s.shape[3])*u,p=("NHWC"===i?s.shape[3]:s.shape[1])/(u*u),c="NHWC"===i?[o,d,l,p]:[o,p,d,l],m=n.makeOutput(c,"float32"),f=n.dataIdMap.get(s.dataId).id,h=new Uint8Array(new Int32Array(t.util.computeStrides(s.shape)).buffer),b=new Uint8Array(new Int32Array(c).buffer),_=new Uint8Array(new Int32Array(t.util.computeStrides(c)).buffer),y=n.dataIdMap.get(m.dataId).id;return me(f,u,"NHWC"===i?1:0,h,s.shape.length-1,b,_,c.length,y),m}};let he;const be={kernelName:t.DepthwiseConv2dNative,backendName:"wasm",setupFunc:function(e){he=e.wasm.cwrap(t.DepthwiseConv2dNative,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s,filter:u}=n,i=r.dataIdMap.get(s.dataId).id,o=r.dataIdMap.get(u.dataId).id,{strides:d,dilations:l,pad:p,dimRoundingMode:c}=a,m=null==l?[1,1]:l,f=t.backend_util.computeConv2DInfo(s.shape,u.shape,d,m,p,c,!0),h=f.filterHeight,b=f.filterWidth,_=f.padInfo.top,y=f.padInfo.right,g=f.padInfo.bottom,k=f.padInfo.left,w=f.dilationHeight,I=f.dilationWidth,S=f.strideHeight,v=f.strideWidth,M=f.inChannels,x=f.outChannels,A="SAME"===f.padInfo.type?1:0;if("channelsLast"!==f.dataFormat)throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${f.dataFormat}'. Please use 'channelsLast'.`);const F=r.makeOutput(f.outShape,"float32"),N=r.dataIdMap.get(F.dataId).id;return he(i,s.shape[0],s.shape[1],s.shape[2],o,h,b,_,y,g,k,A,w,I,S,v,M,x,N),F}},_e=_(t.Elu),ye=g(t.Equal,0,"bool"),ge=_(t.Exp,"float32");function ke(e){const{inputs:n,attrs:a,backend:r}=e,{input:s}=n,{dim:u}=a,i=s.shape.length,o=s.shape.slice();let d=u;return u<0&&(t.util.assert(-(i+1)<=u,(()=>`Axis must be in the interval [${-(i+1)}, ${i}]`)),d=i+u+1),o.splice(d,0,1),W({inputs:{x:s},backend:r,attrs:{shape:o}})}const we={kernelName:t.ExpandDims,backendName:"wasm",kernelFunc:ke};function Ie(e){const{attrs:{shape:t,value:n,dtype:a},backend:r}=e,s=r.makeOutput(t,a);return r.typedArrayFromHeap(s).fill(n),s}const Se={kernelName:t.Fill,backendName:"wasm",kernelFunc:Ie};let ve;const Me={kernelName:t.FlipLeftRight,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n}=e,{image:a}=t,r=n.makeOutput(a.shape,a.dtype),s=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(r.dataId).id,[i,o,d,l]=a.shape;return ve(s,i,o,d,l,u),r},setupFunc:function(e){ve=e.wasm.cwrap(t.FlipLeftRight,null,["number","number","number","number","number","number"])}},xe=_(t.Floor),Ae=g(t.FloorDiv);let Fe;const Ne={kernelName:t.FusedBatchNorm,backendName:"wasm",setupFunc:function(e){Fe=e.wasm.cwrap(t.FusedBatchNorm,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{varianceEpsilon:s}=r,{x:u,mean:i,variance:o,offset:d,scale:l}=a,p=n.dataIdMap.get(u.dataId).id,c=n.dataIdMap.get(i.dataId).id,m=n.dataIdMap.get(o.dataId).id,f=null!=d?n.dataIdMap.get(d.dataId).id:0,h=null!=l?n.dataIdMap.get(l.dataId).id:0,b=n.makeOutput(u.shape,u.dtype);if(0===t.util.sizeFromShape(u.shape))return b;const _=n.dataIdMap.get(b.dataId).id;return Fe(p,c,m,f,h,s,_),b}};let Ee;const Re={kernelName:t.FusedConv2D,backendName:"wasm",setupFunc:function(e){Ee=e.wasm.cwrap(t.FusedConv2D,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s,filter:u,bias:i,preluActivationWeights:o}=n,{strides:l,pad:p,dilations:c,dataFormat:m,dimRoundingMode:f,activation:h,leakyreluAlpha:b}=a,_=t.backend_util.computeConv2DInfo(s.shape,u.shape,l,c,p,f),y=d[h];if(null==y)throw new Error(`${h} activation not yet supported for FusedConv2D in the wasm backend.`);const g=r.dataIdMap.get(s.dataId).id,k=r.dataIdMap.get(u.dataId).id,w=_.outChannels;let I=0;if(null!=i){const e=r.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==w)throw new Error(`FusedConv2D bias shape (${e.shape}) does not match the number of output channels (${w})`);I=e.id}const S=_.filterHeight,v=_.filterWidth,M=_.padInfo.top,x=_.padInfo.right,A=_.padInfo.bottom,F=_.padInfo.left,N=_.dilationHeight,E=_.dilationWidth,R=_.strideHeight,C=_.strideWidth,D=_.inChannels,T="SAME"===_.padInfo.type?1:0,O=_.batchSize,P=_.inHeight,W=_.inWidth;if("NHWC"!==m)throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${m}'. Please use 'NHWC'.`);const L=r.makeOutput(_.outShape,"float32"),z=r.dataIdMap.get(L.dataId).id,j=null==o?0:r.dataIdMap.get(o.dataId).id;return Ee(g,O,P,W,k,S,v,I,M,x,A,F,T,N,E,R,C,D,w,y,j,b||0,z),L}};let Ce;const De={kernelName:t.FusedDepthwiseConv2D,backendName:"wasm",setupFunc:function(e){Ce=e.wasm.cwrap(t.FusedDepthwiseConv2D,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s,filter:u,bias:i,preluActivationWeights:o}=n,{strides:l,pad:p,dilations:c,dataFormat:m,dimRoundingMode:f,activation:h,leakyreluAlpha:b}=a,_=t.backend_util.computeConv2DInfo(s.shape,u.shape,l,c,p,f,!0),y=d[h];if(null==y)throw new Error(`${h} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);const g=r.dataIdMap.get(s.dataId).id,k=r.dataIdMap.get(u.dataId).id,w=_.outChannels;let I=0;if(null!=i){const e=r.dataIdMap.get(i.dataId);if(1!==e.shape.length)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==w)throw new Error(`FusedDepthwiseConv2D bias shape (${e.shape}) does not match the number of output channels (${w})`);I=e.id}const S=_.filterHeight,v=_.filterWidth,M=_.padInfo.top,x=_.padInfo.right,A=_.padInfo.bottom,F=_.padInfo.left,N=_.dilationHeight,E=_.dilationWidth,R=_.strideHeight,C=_.strideWidth,D=_.inChannels,T="SAME"===_.padInfo.type?1:0,O=_.batchSize,P=_.inHeight,W=_.inWidth;if("NHWC"!==m)throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${m}'. Please use 'NHWC'.`);const L=r.makeOutput(_.outShape,"float32"),z=r.dataIdMap.get(L.dataId).id,j=null==o?0:r.dataIdMap.get(o.dataId).id;return Ce(g,O,P,W,k,S,v,I,M,x,A,F,T,N,E,R,C,D,w,y,j,b||0,z),L}};let Te;const Oe={kernelName:t.GatherNd,backendName:"wasm",setupFunc:function(e){Te=e.wasm.cwrap(t.GatherNd,null,["number","number","number","number","number","number","array","number"])},kernelFunc:function(e){const{backend:n,inputs:a}=e,{params:r,indices:s}=a,[u,i,d,l]=t.gather_util.prepareAndValidate(r,s),p=n.makeOutput(u,r.dtype);if(0===i)return p;const c=s.shape,m=c[c.length-1],f=n.dataIdMap.get(r.dataId).id,h=n.dataIdMap.get(s.dataId).id,b=new Uint8Array(new Int32Array(l).buffer),_=n.dataIdMap.get(p.dataId).id;return Te(f,o[r.dtype],h,i,m,d,b,_),p}};let Pe;const We={kernelName:t.GatherV2,backendName:"wasm",setupFunc:function(e){Pe=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{x:s,indices:u}=a,{axis:i,batchDims:d}=r,l=t.util.parseAxisParam(i,s.shape)[0],p=n.readSync(u.dataId),c=s.shape[l];for(let e=0;e<p.length;++e){const n=p[e];t.util.assert(n<=c-1&&n>=0,(()=>`GatherV2: the index value ${n} is not in [0, ${c-1}]`))}const m=t.backend_util.segment_util.collectGatherOpShapeInfo(s,u,l,d),f=W({inputs:{x:s},attrs:{shape:[m.batchSize,m.outerSize,m.dimSize,m.sliceSize]},backend:n}),h=t.util.sizeFromShape(u.shape),b=W({inputs:{x:u},attrs:{shape:[m.batchSize,h/m.batchSize]},backend:n}),_=[m.batchSize,m.outerSize,h/m.batchSize,m.sliceSize],y=n.makeOutput(_,s.dtype);if(0===t.util.sizeFromShape(s.shape))return y;const g=f.shape.length-1,k=n.dataIdMap.get(f.dataId).id,w=n.dataIdMap.get(b.dataId).id,I=n.dataIdMap.get(y.dataId).id,S=new Uint8Array(new Int32Array(t.util.computeStrides(f.shape)).buffer),v=new Uint8Array(new Int32Array(t.util.computeStrides(_)).buffer);return Pe(k,o[s.dtype],S,g,w,m.batchSize,v,I),n.disposeData(f.dataId),n.disposeData(b.dataId),y.shape=m.outputShape,y}},Le=g(t.Greater,0,"bool"),ze=g(t.GreaterEqual,0,"bool");let je;const He={kernelName:t.LeakyRelu,backendName:"wasm",setupFunc:function(e){je=e.wasm.cwrap(t.LeakyRelu,null,["number","number","number","number"])},kernelFunc:function(e){const{inputs:{x:n},attrs:{alpha:a},backend:r}=e,s=r.dataIdMap.get(n.dataId).id,u=r.makeOutput(n.shape,"float32");if(0!==t.util.sizeFromShape(n.shape)){const e=r.dataIdMap.get(u.dataId).id;je(s,o[n.dtype],a,e)}return u}},Be=g(t.Less,0,"bool"),Ue=g(t.LessEqual,0,"bool"),qe=_(t.Log),Ve=g(t.LogicalAnd,0,"bool"),Ge=_(t.LogicalNot),$e=g(t.LogicalOr,0,"bool"),Ke=g(t.LogicalXor,0,"bool");let Xe;const Qe={kernelName:t.Max,backendName:"wasm",setupFunc:function(e){Xe=e.wasm.cwrap(t.Max,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{reductionIndices:s,keepDims:u}=r,{x:i}=a;let d=n.dataIdMap.get(i.dataId).id,l=i;const{transposed:p,axes:c,originalAxes:m,inputWasTransposed:f}=F(i,s,n);if(f){l=p,d=n.dataIdMap.get(p.dataId).id}const h=l.shape.length;t.backend_util.assertAxesAreInnerMostDims("max",c,h);const[b,_]=t.backend_util.computeOutAndReduceShapes(l.shape,c),y=t.util.sizeFromShape(_),g=n.makeOutput(b,i.dtype);if(0!==t.util.sizeFromShape(l.shape)){const e=n.dataIdMap.get(g.dataId).id;Xe(d,o[i.dtype],y,e)}if(f&&n.disposeData(p.dataId),u){const e=t.backend_util.expandShapeToKeepDim(g.shape,m);g.shape=e}return g}},Ze=g(t.Maximum);let Ye;const Je={kernelName:t.MaxPool,backendName:"wasm",setupFunc:function(e){Ye=e.wasm.cwrap(t.MaxPool,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,s=n.x,u=r.dataIdMap.get(s.dataId).id;t.util.assert("float32"===s.dtype,(()=>`Error in MaxPool: only float32 input is supported. Got ${s.dtype}.`));const{filterSize:i,strides:o,pad:d,dimRoundingMode:l}=a,p=t.backend_util.computePool2DInfo(s.shape,i,o,1,d,l),c=p.filterHeight,m=p.filterWidth,f=p.padInfo.top,h=p.padInfo.right,b=p.padInfo.bottom,_=p.padInfo.left,y=p.dilationHeight,g=p.dilationWidth,k=p.strideHeight,w=p.strideWidth,I=p.inChannels,S=p.outChannels;if("channelsLast"!==p.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${p.dataFormat}'. Please use 'channelsLast'.`);const v=r.makeOutput(p.outShape,"float32"),M=r.dataIdMap.get(v.dataId).id;return Ye(u,s.shape[0],s.shape[1],s.shape[2],c,m,f,h,b,_,y,g,k,w,I,S,M),v}};let et;const tt={kernelName:t.Mean,backendName:"wasm",setupFunc:function(e){et=e.wasm.cwrap(t.Mean,null,["number, number, number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:i}=a,o=n.dataIdMap.get(i.dataId).id;let d=o,l=i;const{transposed:p,axes:c,originalAxes:m,inputWasTransposed:f}=F(i,s,n);let h=c;if(f){const e=n.dataIdMap.get(p.dataId).id;e!==o&&(l=p,d=e,h=t.backend_util.getInnerMostAxes(h.length,l.shape.length))}t.backend_util.assertAxesAreInnerMostDims("mean",h,l.shape.length);const[b,_]=t.backend_util.computeOutAndReduceShapes(l.shape,h),y=t.util.sizeFromShape(_);let g=l;"float32"!==l.dtype&&(g=$({backend:n,inputs:{x:l},attrs:{dtype:"float32"}}),d=n.dataIdMap.get(g.dataId).id);const k=n.makeOutput(b,"float32");if(0!==t.util.sizeFromShape(l.shape)){const e=n.dataIdMap.get(k.dataId).id;et(d,y,e)}if(f&&n.disposeData(p.dataId),u){const e=t.backend_util.expandShapeToKeepDim(k.shape,m);k.shape=e}return"float32"!==l.dtype&&n.disposeData(g.dataId),k}};let nt;const at={kernelName:t.Min,backendName:"wasm",setupFunc:function(e){nt=e.wasm.cwrap(t.Min,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:i}=a,d=n.dataIdMap.get(i.dataId).id;let l=d,p=i;const{transposed:c,axes:m,originalAxes:f,inputWasTransposed:h}=F(i,s,n);if(h){const e=n.dataIdMap.get(c.dataId).id;e!==d&&(p=c,l=e)}const b=p.shape.length;t.backend_util.assertAxesAreInnerMostDims("min",m,b);const[_,y]=t.backend_util.computeOutAndReduceShapes(p.shape,m),g=t.util.sizeFromShape(y),k=n.makeOutput(_,p.dtype);if(0!==t.util.sizeFromShape(p.shape)){const e=n.dataIdMap.get(k.dataId).id;nt(l,o[i.dtype],g,e)}if(h&&n.disposeData(c.dataId),u){const e=t.backend_util.expandShapeToKeepDim(k.shape,f);k.shape=e}return k}},rt=g(t.Minimum);var st;let ut;!function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"}(st||(st={}));const it={kernelName:t.MirrorPad,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n,attrs:{paddings:a,mode:r}}=e,s=a.map(((e,n)=>e[0]+t.shape[n]+e[1])),u=n.dataIdMap.get(t.dataId).id,i=n.makeOutput(s,t.dtype),d=n.dataIdMap.get(i.dataId).id,l=new Uint8Array(new Int32Array(t.shape).buffer),p=a.map((e=>e[0])),c=a.map((e=>e[1])),m=new Uint8Array(new Int32Array(p).buffer),f=new Uint8Array(new Int32Array(c).buffer);return ut(u,l,t.shape.length,o[t.dtype],m,f,st[r],d),i},setupFunc:function(e){ut=e.wasm.cwrap(t.MirrorPad,null,["number","array","number","number","array","array","number","number"])}},ot=g(t.Multiply),dt=_(t.Neg);function lt(e,t){const n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),a=n[0],r=n[1],s=n[2],u=n[3];return e.wasm._free(t),{pSelectedIndices:a,selectedSize:r,pSelectedScores:s,pValidOutputs:u}}let pt;const ct={kernelName:t.NonMaxSuppressionV3,backendName:"wasm",setupFunc:function(e){pt=e.wasm.cwrap(t.NonMaxSuppressionV3,"number",["number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:u}=a,{boxes:i,scores:o}=n,d=t.dataIdMap.get(i.dataId).id,l=t.dataIdMap.get(o.dataId).id,p=pt(d,l,s,r,u),{pSelectedIndices:c,selectedSize:m,pSelectedScores:f,pValidOutputs:h}=lt(t,p);return t.wasm._free(f),t.wasm._free(h),t.makeOutput([m],"int32",c)}};let mt;const ft={kernelName:t.NonMaxSuppressionV4,backendName:"wasm",setupFunc:function(e){mt=e.wasm.cwrap(t.NonMaxSuppressionV4,"number",["number","number","number","number","number","bool"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:u,padToMaxOutputSize:i}=a,{boxes:o,scores:d}=n,l=t.dataIdMap.get(o.dataId).id,p=t.dataIdMap.get(d.dataId).id,c=mt(l,p,s,r,u,i),{pSelectedIndices:m,selectedSize:f,pSelectedScores:h,pValidOutputs:b}=lt(t,c);return t.wasm._free(h),[t.makeOutput([f],"int32",m),t.makeOutput([],"int32",b)]}};let ht;const bt={kernelName:t.NonMaxSuppressionV5,backendName:"wasm",setupFunc:function(e){ht=e.wasm.cwrap(t.NonMaxSuppressionV5,"number",["number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{iouThreshold:r,maxOutputSize:s,scoreThreshold:u,softNmsSigma:i}=a,{boxes:o,scores:d}=n,l=t.dataIdMap.get(o.dataId).id,p=t.dataIdMap.get(d.dataId).id,c=ht(l,p,s,r,u,i),{pSelectedIndices:m,selectedSize:f,pSelectedScores:h,pValidOutputs:b}=lt(t,c);return t.wasm._free(b),[t.makeOutput([f],"int32",m),t.makeOutput([f],"float32",h)]}},_t=g(t.NotEqual,0,"bool");let yt;const gt={kernelName:t.OneHot,backendName:"wasm",setupFunc:function(e){yt=e.wasm.cwrap(t.OneHot,null,["number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{indices:r}=t,{dtype:s,depth:u,onValue:i,offValue:o}=a,d=n.makeOutput([...r.shape,u],s),l=n.dataIdMap.get(d.dataId).id,p=n.dataIdMap.get(r.dataId).id;return yt(p,u,i,o,l),d}};const kt={kernelName:t.OnesLike,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(1),a}};const wt={kernelName:t.Pack,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{axis:s}=r;if(1===n.length)return ke({inputs:{input:n[0]},backend:a,attrs:{dim:s}});const u=n[0].shape,i=n[0].dtype;n.forEach((e=>{t.util.assertShapesMatch(u,e.shape,"All tensors passed to stack must have matching shapes"),t.util.assert(i===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const o=[],d=Y({inputs:n.map((e=>{const t=ke({inputs:{input:e},backend:a,attrs:{dim:s}});return o.push(t),t})),backend:a,attrs:{axis:s}});return o.forEach((e=>a.disposeData(e.dataId))),d}};let It;const St={kernelName:t.PadV2,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:n},backend:a,attrs:{paddings:r,constantValue:s}}=e,u=r.map(((e,t)=>e[0]+n.shape[t]+e[1]));if(0===t.util.sizeFromShape(n.shape))return Ie({backend:a,attrs:{shape:u,value:s,dtype:n.dtype}});const i=a.dataIdMap.get(n.dataId).id,d=a.makeOutput(u,n.dtype),l=a.dataIdMap.get(d.dataId).id,p=new Uint8Array(new Int32Array(n.shape).buffer),c=r.map((e=>e[0])),m=r.map((e=>e[1])),f=new Uint8Array(new Int32Array(c).buffer),h=new Uint8Array(new Int32Array(m).buffer);return It(i,p,n.shape.length,o[n.dtype],f,h,s,l),d},setupFunc:function(e){It=e.wasm.cwrap(t.PadV2,null,["number","array","number","number","array","array","number","number"])}},vt=g(t.Pow);let Mt;const xt={kernelName:t.Prelu,backendName:"wasm",setupFunc:function(e){Mt=e.wasm.cwrap(t.Prelu,null,["number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a,alpha:r}=t,s=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(r.dataId).id;let i=s;const o=a;let d=o;"float32"!==o.dtype&&(d=$({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),i=n.dataIdMap.get(d.dataId).id);const l=n.makeOutput(a.shape,"float32"),p=n.dataIdMap.get(l.dataId).id;return Mt(i,u,p),"float32"!==o.dtype&&n.disposeData(d.dataId),l}};let At;const Ft={kernelName:t.Prod,backendName:"wasm",setupFunc:function(e){At=e.wasm.cwrap(t.Prod,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:i}=a,d=n.dataIdMap.get(i.dataId).id;let l=d,p=i;const{transposed:c,axes:m,originalAxes:f,inputWasTransposed:h}=F(i,s,n);let b=m;if(h){const e=n.dataIdMap.get(c.dataId).id;e!==d&&(p=c,l=e,b=t.backend_util.getInnerMostAxes(b.length,p.shape.length))}t.backend_util.assertAxesAreInnerMostDims("prod",b,p.shape.length);const[_,y]=t.backend_util.computeOutAndReduceShapes(p.shape,b),g=t.util.sizeFromShape(y),k=n.makeOutput(_,p.dtype);if(0!==t.util.sizeFromShape(p.shape)){const e=n.dataIdMap.get(k.dataId).id;At(l,g,o[k.dtype],e)}if(h&&n.disposeData(c.dataId),u){const e=t.backend_util.expandShapeToKeepDim(k.shape,f);k.shape=e}return k}},Nt={kernelName:t.Range,backendName:"wasm",kernelFunc:e=>{const{backend:n,attrs:a}=e,{start:r,stop:s,step:u,dtype:i}=a,o=function(e,n,a,r){if(e===n||e<n&&a<0||n<e&&a>1)return t.util.makeZerosTypedArray(0,r);const s=Math.abs(Math.ceil((n-e)/a)),u=t.util.makeZerosTypedArray(s,r);n<e&&1===a&&(a=-1),u[0]=e;for(let e=1;e<u.length;e++)u[e]=u[e-1]+a;return u}(r,s,u,i),d=n.makeOutput([o.length],i);return n.typedArrayFromHeap(d).set(o),d}},Et=g(t.RealDiv),Rt=_(t.Relu),Ct=_(t.Relu6);let Dt;const Tt={kernelName:t.ResizeBilinear,backendName:"wasm",setupFunc:function(e){Dt=e.wasm.cwrap(t.ResizeBilinear,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{images:s}=a,{alignCorners:u,halfPixelCenters:i,size:o}=r,[d,l]=o,[p,c,m,f]=s.shape,h=[p,d,l,f];let b,_=n.dataIdMap.get(s.dataId);"float32"!==_.dtype&&(b=$({backend:n,inputs:{x:s},attrs:{dtype:"float32"}}),_=n.dataIdMap.get(b.dataId));const y=_.id,g=n.makeOutput(h,"float32");if(0===t.util.sizeFromShape(s.shape))return g;const k=n.dataIdMap.get(g.dataId).id;return Dt(y,p,c,m,f,d,l,u?1:0,i?1:0,k),null!=b&&n.disposeData(b.dataId),g}};let Ot;const Pt={kernelName:t.ResizeNearestNeighbor,backendName:"wasm",setupFunc:function(e){Ot=e.wasm.cwrap(t.ResizeNearestNeighbor,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{images:s}=a,{alignCorners:u,halfPixelCenters:i,size:o}=r,[d,l]=o,[p,c,m,f]=s.shape,h=[p,d,l,f],b=n.makeOutput(h,"float32");if(0===t.util.sizeFromShape(s.shape))return b;let _,y=n.dataIdMap.get(s.dataId);"float32"!==y.dtype&&(_=$({backend:n,inputs:{x:s},attrs:{dtype:"float32"}}),y=n.dataIdMap.get(_.dataId));const g=y.id,k=n.dataIdMap.get(b.dataId).id;return Ot(g,p,c,m,f,d,l,u?1:0,i?1:0,k),null!=_&&n.disposeData(_.dataId),b}};let Wt;const Lt={kernelName:t.Reverse,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{dims:u}=r,i=t.util.parseAxisParam(u,s.shape);if(0===s.shape.length)return S({inputs:{x:s},backend:a});const o=a.makeOutput(s.shape,s.dtype),d=a.dataIdMap.get(s.dataId).id,l=a.dataIdMap.get(o.dataId).id,p=new Uint8Array(new Int32Array(i).buffer),c=new Uint8Array(new Int32Array(s.shape).buffer);Wt(d,p,i.length,c,s.shape.length,l);const m=W({inputs:{x:o},attrs:{shape:s.shape},backend:a});return a.disposeData(o.dataId),m},setupFunc:function(e){Wt=e.wasm.cwrap(t.Reverse,null,["number","array","number","array","number","number"])}};let zt;const jt={kernelName:t.RotateWithOffset,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{image:s}=n,{radians:u,fillValue:i,center:o}=r,d=a.makeOutput(s.shape,s.dtype),l=a.dataIdMap.get(s.dataId).id,p=a.dataIdMap.get(d.dataId).id,[c,m,f,h]=s.shape,[b,_]=t.backend_util.getImageCenter(o,m,f),y="number"==typeof i?[i,i,i,0===i?0:255]:[...i,255],g=new Uint8Array(new Int32Array(y).buffer);return zt(l,c,m,f,h,u,b,_,g,y.length,p),d},setupFunc:function(e){zt=e.wasm.cwrap(t.RotateWithOffset,null,["number","number","number","number","number","number","number","number","array","number","number"])}},Ht=_(t.Round),Bt=_(t.Rsqrt);let Ut;const qt={kernelName:t.ScatterNd,backendName:"wasm",setupFunc:function(e){Ut=e.wasm.cwrap(t.ScatterNd,null,["number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{indices:s,updates:u}=a,{shape:i}=r,d=n.makeOutput(i,u.dtype);if(0===t.util.sizeFromShape(i))return d;const{sliceRank:l,numUpdates:p,sliceSize:c,strides:m,outputSize:f}=t.scatter_util.calculateShapes(u,s,i),h=n.dataIdMap.get(s.dataId).id,b=n.dataIdMap.get(u.dataId).id,_=new Uint8Array(new Int32Array(m).buffer),y=n.dataIdMap.get(d.dataId).id;return Ut(h,b,o[u.dtype],l,p,c,_,f,y),d}};let Vt;const Gt={kernelName:t.Select,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a}=e,{condition:r,t:s,e:u}=n,i=a.dataIdMap.get(r.dataId).id,o=a.dataIdMap.get(s.dataId).id,d=a.dataIdMap.get(u.dataId).id,l=a.makeOutput(s.shape,s.dtype),p=a.dataIdMap.get(l.dataId).id,c=r.shape.length,m=s.shape.length,f=0===c||c>1||1===m?1:t.util.sizeFromShape(s.shape.slice(1));return Vt(i,o,d,f,p),l},setupFunc:function(e){Vt=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}};let $t;const Kt={kernelName:"Sigmoid",backendName:"wasm",setupFunc:function(e){$t=e.wasm.cwrap(t.Sigmoid,null,["number","number"])},kernelFunc:function(e){const{backend:n,inputs:{x:a}}=e,r=n.dataIdMap.get(a.dataId).id,s=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(s.dataId).id;return 0===t.util.sizeFromShape(s.shape)||$t(r,u),s}},Xt=_(t.Sin);let Qt;const Zt={kernelName:t.Softmax,backendName:"wasm",setupFunc:function(e){Qt=e.wasm.cwrap(t.Softmax,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:{logits:a},attrs:{dim:r}}=e,s=n.dataIdMap.get(a.dataId).id,u=n.makeOutput(a.shape,a.dtype),i=n.dataIdMap.get(u.dataId).id,o=a.shape[r],d=t.util.sizeFromShape(a.shape)/o;return 0===t.util.sizeFromShape(u.shape)||Qt(s,i,o,d),u}};const Yt={kernelName:t.SpaceToBatchND,backendName:"wasm",kernelFunc:function(e){const{inputs:n,backend:a,attrs:r}=e,{x:s}=n,{blockShape:u,paddings:i}=r,o=t.util.sizeFromShape(u),d=[[0,0]];d.push(...i);for(let e=1+u.length;e<s.shape.length;++e)d.push([0,0]);const l=St.kernelFunc({inputs:{x:s},backend:a,attrs:{paddings:d,constantValue:0}}),p=t.backend_util.getReshaped(l.shape,u,o,!1),c=t.backend_util.getPermuted(p.length,u.length,!1),m=t.backend_util.getReshapedPermuted(l.shape,u,o,!1),f=W({inputs:{x:l},backend:a,attrs:{shape:p}}),h=x({inputs:{x:f},backend:a,attrs:{perm:c}}),b=W({inputs:{x:h},backend:a,attrs:{shape:m}});return a.disposeData(l.dataId),a.disposeData(f.dataId),a.disposeData(h.dataId),b}};let Jt;const en={kernelName:t.SparseFillEmptyRows,backendName:"wasm",setupFunc:function(e){Jt=e.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a}=e,{indices:r,values:s,denseShape:u,defaultValue:i}=a,d=r.shape[0],l=r.shape[1],p=n.readSync(u.dataId)[0],c=[d+p,l],m=n.dataIdMap.get(r.dataId).id,f=n.dataIdMap.get(s.dataId).id,h=n.dataIdMap.get(i.dataId).id,b=n.makeOutput(c,r.dtype),_=n.dataIdMap.get(b.dataId).id,y=n.makeOutput(c.slice(0,1),s.dtype),g=n.dataIdMap.get(y.dataId).id,k=n.makeOutput([p],"bool"),w=n.dataIdMap.get(k.dataId).id,I=n.makeOutput([d],r.dtype),S=n.dataIdMap.get(I.dataId).id,v=n.makeOutput([4],"int32"),M=n.dataIdMap.get(v.dataId).id,x=Jt(m,f,o[s.dtype],d,p,l,h,_,g,w,S,M),A=n.readSync(v.dataId);let F;switch(A[0]){case 1:F=t.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(A[1]);break;case 2:F=t.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(A[1],A[2]);break;case 3:F=t.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(A[1],A[2],A[3]);break;default:F=""}if(n.disposeData(v.dataId),F)throw n.disposeData(b.dataId),n.disposeData(y.dataId),n.disposeData(k.dataId),n.disposeData(I.dataId),new Error(F);let N=b,E=y;return x!==c[0]&&(N=q({inputs:{x:b},attrs:{begin:0,size:[x,l]},backend:n}),E=q({inputs:{x:y},attrs:{begin:0,size:x},backend:n}),n.disposeData(b.dataId),n.disposeData(y.dataId)),[N,E,k,I]}};let tn;const nn={kernelName:t.SparseReshape,backendName:"wasm",setupFunc:function(e){tn=e.wasm.cwrap(t.SparseReshape,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a}=e,{inputIndices:r,inputShape:s,newShape:u}=a;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==s.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${s.shape}`);if(1!==u.shape.length)throw new Error(`Target shape should be a vector but received shape ${u.shape}`);const i=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(s.dataId).id,d=n.dataIdMap.get(u.dataId).id,l=r.shape[0],p=t.util.sizeFromShape(u.shape),c=n.makeOutput([l,p],r.dtype),m=n.dataIdMap.get(c.dataId).id,f=n.makeOutput([p],u.dtype),h=n.dataIdMap.get(f.dataId).id,b=n.makeOutput([3],"int32"),_=n.dataIdMap.get(b.dataId).id;tn(i,o,d,l,m,h,_);const y=n.readSync(b.dataId);let g;switch(y[0]){case 0:g=t.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(y[1],y[2]);break;case 1:g=t.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(y[1],y[2]);break;case 2:g=t.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage();break;case 3:{const e=Array.from(n.readSync(s.dataId)),a=Array.from(n.readSync(f.dataId));g=t.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(e,a);break}case 4:{const e=Array.from(n.readSync(s.dataId)),a=Array.from(n.readSync(f.dataId));g=t.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(e,a);break}default:g=""}if(n.disposeData(b.dataId),g)throw n.disposeData(c.dataId),n.disposeData(f.dataId),new Error(g);return[c,f]}};let an;function rn(e){an=e.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function sn(e,n){const{backend:a,inputs:r}=e,{data:s,indices:u,segmentIds:i}=r,d=u.shape[0],l=a.readSync(i.dataId,d-1,d)[0],p=d>0?l+1:0;if(p<0)throw new Error(t.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());const c=s.shape.slice();c[0]=p;const m=a.dataIdMap.get(s.dataId).id,f=a.dataIdMap.get(u.dataId).id,h=a.dataIdMap.get(i.dataId).id,b=a.makeOutput(c,s.dtype),_=a.dataIdMap.get(b.dataId).id,y=a.makeOutput([4],"int32"),g=a.dataIdMap.get(y.dataId).id;an(m,o[s.dtype],s.shape[0],f,h,_,g,n,0);const k=a.readSync(y.dataId);let w;switch(k[0]){case 0:w=t.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage();break;case 1:w=t.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage();break;case 2:w=t.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(k[1],k[2]);break;case 3:w=t.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(k[1],k[2],k[3]);break;default:w=""}if(a.disposeData(y.dataId),w)throw a.disposeData(b.dataId),new Error(w);return b}const un={kernelName:t.SparseSegmentMean,backendName:"wasm",setupFunc:rn,kernelFunc:function(e){return sn(e,!0)}};const on={kernelName:t.SparseSegmentSum,backendName:"wasm",setupFunc:rn,kernelFunc:function(e){return sn(e,!1)}};const dn={kernelName:t.SplitV,backendName:"wasm",kernelFunc:function(e){const{inputs:n,attrs:a,backend:r}=e,{x:s}=n,{numOrSizeSplits:u,axis:i}=a,o=t.util.parseAxisParam(i,s.shape)[0],d=t.backend_util.prepareSplitSize(s,u,o),l=new Array(s.shape.length).fill(0),p=s.shape.slice();return d.map((e=>{const t=[...p];t[o]=e;const n=q({inputs:{x:s},attrs:{begin:l,size:t},backend:r});return l[o]+=e,n}))}},ln=_(t.Sqrt),pn=_(t.Square),cn=g(t.SquaredDifference);let mn;const fn={kernelName:t.Step,backendName:"wasm",setupFunc:function(e){mn=e.wasm.cwrap(t.Step,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{alpha:r}=a,{x:s}=n,u=t.dataIdMap.get(s.dataId).id,i=t.makeOutput(s.shape,s.dtype),d=t.dataIdMap.get(i.dataId).id;return mn(u,r,o[s.dtype],d),i}};let hn;const bn={kernelName:t.StridedSlice,backendName:"wasm",setupFunc:function(e){hn=e.wasm.cwrap(t.StridedSlice,null,["number","array","number","array","array","array","array","array","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{x:s}=a,{begin:u,end:i,strides:o,beginMask:d,endMask:l,ellipsisMask:p,newAxisMask:c,shrinkAxisMask:m}=r,{finalShapeSparse:f,finalShape:h,isIdentity:b,sliceDim0:_,isSimpleSlice:y,begin:g,end:k,strides:w}=t.slice_util.sliceInfo(s.shape,u,i,o,d,l,p,c,m);let I;if(b)I=W({inputs:{x:s},backend:n,attrs:{shape:h}});else if(_||y){t.util.assert(s.shape.length>=1,(()=>`Input must have rank at least 1, got: ${s.shape.length}`));const e=t.slice_util.computeOutShape(g,k,w),a=q({inputs:{x:s},backend:n,attrs:{begin:g,size:e}});I=W({inputs:{x:a},backend:n,attrs:{shape:h}}),n.disposeData(a.dataId)}else{const e=n.makeOutput(f,"float32"),a=n.dataIdMap.get(s.dataId).id,r=new Uint8Array(new Int32Array(t.util.computeStrides(s.shape)).buffer),u=new Uint8Array(new Int32Array(g).buffer),i=new Uint8Array(new Int32Array(k).buffer),o=new Uint8Array(new Int32Array(w).buffer),d=new Uint8Array(new Int32Array(f).buffer),l=new Uint8Array(new Int32Array(t.util.computeStrides(f)).buffer),p=n.dataIdMap.get(e.dataId).id;hn(a,r,s.shape.length,u,i,o,d,l,f.length,p),I=W({inputs:{x:e},backend:n,attrs:{shape:h}}),n.disposeData(e.dataId)}return I}};const _n={kernelName:t.StringNGrams,backendName:"wasm",kernelFunc:function(e){const{backend:t,inputs:n,attrs:a}=e,{data:r,dataSplits:s}=n,{separator:u,nGramWidths:i,leftPad:o,rightPad:d,padWidth:l,preserveShortSequences:p}=a,c=t.readSync(r.dataId),m=t.readSync(s.dataId),[f,h]=function(e,t,n,a,r,s,u,i){return new B(n,a,r,s,u,i).compute(e,t)}(c,m,u,i,o,d,l,p),b=t.makeOutput([f.length],"string");t.dataIdMap.get(b.dataId).stringBytes=f;const _=t.makeOutput(s.shape,"int32");return t.typedArrayFromHeap(_).set(h),[b,_]}};const yn={kernelName:t.StringSplit,backendName:"wasm",kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{input:s,delimiter:u}=a,{skipEmpty:i}=r,o=n.readSync(s.dataId),d=n.readSync(u.dataId),[l,p,c]=function(e,n,a){const r=e.length,s=[];let u=0,i=0;const o=new Array(r);for(let t=0;t<r;++t){const r=s.length;U(e[t],n,a,s);const d=s.length-r;o[t]=d,u+=d,i=Math.max(i,d)}const d=t.util.getArrayFromDType("int32",2*u),l=new Array(u),p=[r,i];let c=0;for(let e=0;e<r;++e)for(let t=0;t<o[e];++t)d[2*c]=e,d[2*c+1]=t,l[c]=s[c],++c;return[d,l,p]}(o,d[0],i),m=p.length,f=n.makeOutput([m,2],"int32");n.typedArrayFromHeap(f).set(l);const h=n.makeOutput([m],"string");n.dataIdMap.get(h.dataId).stringBytes=p;const b=n.makeOutput([2],"int32");return n.typedArrayFromHeap(b).set(c),[f,h,b]}};const gn={kernelName:t.StringToHashBucketFast,backendName:"wasm",kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{input:s}=a,{numBuckets:u}=r,i=function(e,n){const a=t.util.getArrayFromDType("int32",e.length);for(let r=0;r<e.length;++r)a[r]=t.util.fingerPrint64(e[r]).modulo(n).getLowBitsUnsigned();return a}(n.readSync(s.dataId),u),o=n.makeOutput(s.shape,"int32");return n.typedArrayFromHeap(o).set(i),o}},kn=g(t.Sub);let wn;const In={kernelName:t.Sum,backendName:"wasm",setupFunc:function(e){wn=e.wasm.cwrap(t.Sum,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{axis:s,keepDims:u}=r,{x:i}=a,d=n.dataIdMap.get(i.dataId).id;let l=d,p=i;const{transposed:c,axes:m,originalAxes:f,inputWasTransposed:h}=F(i,s,n);let b=m;if(h){const e=n.dataIdMap.get(c.dataId).id;e!==d&&(p=c,l=e,b=t.backend_util.getInnerMostAxes(b.length,p.shape.length))}t.backend_util.assertAxesAreInnerMostDims("sum",b,p.shape.length);const[_,y]=t.backend_util.computeOutAndReduceShapes(p.shape,b),g=t.util.sizeFromShape(y),k=n.makeOutput(_,p.dtype);if(0!==t.util.sizeFromShape(p.shape)){const e=n.dataIdMap.get(k.dataId).id;wn(l,g,o[k.dtype],e)}if(h&&n.disposeData(c.dataId),u){const e=t.backend_util.expandShapeToKeepDim(k.shape,f);k.shape=e}return k}},Sn=_(t.Tan),vn=_(t.Tanh);let Mn;const xn={kernelName:t.Tile,backendName:"wasm",setupFunc:function(e){Mn=e.wasm.cwrap(t.Tile,null,["number","array","number","array","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:r}=t,s=n.dataIdMap.get(r.dataId).id,{reps:u}=a,i=new Array(r.shape.length);for(let e=0;e<i.length;e++)i[e]=r.shape[e]*u[e];const d=new Uint8Array(new Int32Array(r.shape).buffer),l=new Uint8Array(new Int32Array(i).buffer),p=n.makeOutput(i,r.dtype),c=n.dataIdMap.get(p.dataId).id;return Mn(s,d,r.shape.length,l,i.length,o[p.dtype],c),p}};let An;const Fn={kernelName:t.TopK,backendName:"wasm",setupFunc:function(e){An=e.wasm.cwrap(t.TopK,null,["number","array","number","number","number","bool","number","number"])},kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:a}=e,{k:r,sorted:s}=n,u=t.dataIdMap.get(a.dataId).id,i=new Uint8Array(new Int32Array(a.shape).buffer),d=a.shape.slice();d[d.length-1]=r;const l=t.makeOutput(d,a.dtype),p=t.dataIdMap.get(l.dataId).id,c=t.makeOutput(d,"int32"),m=t.dataIdMap.get(c.dataId).id;return An(u,i,a.shape.length,o[a.dtype],r,s,p,m),[l,c]}};let Nn;const En={kernelName:t.Transform,backendName:"wasm",setupFunc:function(e){Nn=e.wasm.cwrap(t.Transform,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])},kernelFunc:function(e){const{backend:n,inputs:a,attrs:r}=e,{image:s,transforms:u}=a,{interpolation:i,fillMode:o,fillValue:d,outputShape:l}=r,[p,c,m,f]=s.shape,[h,b]=null!=l?l:[c,m],_=[p,h,b,f],y=new Uint8Array(new Int32Array(t.util.computeStrides(s.shape)).buffer),g=new Uint8Array(new Int32Array(t.util.computeStrides(_)).buffer),k=n.makeOutput(_,s.dtype),w=n.dataIdMap.get(k.dataId).id,I=n.dataIdMap.get(s.dataId).id,S=n.dataIdMap.get(u.dataId).id,v="nearest"===i?1:2;let M;switch(o){case"constant":default:M=1;break;case"reflect":M=2;break;case"wrap":M=3;break;case"nearest":M=4}return Nn(I,S,u.shape[0]>1,p,h,b,f,m,c,y,s.shape.length-1,g,_.length-1,v,M,d,w),k}};const Rn={kernelName:t.Unpack,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{value:r}=t;let{axis:s}=a;s<0&&(s+=r.shape.length);const u=r.shape[s],i=r.shape.length,o=new Array(i-1);let d=0;for(let e=0;e<i;e++)e!==s&&(o[d++]=r.shape[e]);const l=new Array(u),p=new Array(i).fill(0),c=r.shape.slice();c[s]=1;for(let e=0;e<l.length;e++)p[s]=e,l[e]=q({inputs:{x:r},attrs:{begin:p,size:c},backend:n});return l.map((({dataId:e,dtype:t})=>({dataId:e,dtype:t,shape:o})))}};const Cn={kernelName:t.ZerosLike,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n}=e,a=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(a).fill(0),a}},Dn=[b,y,k,I,E,C,T,P,j,G,K,X,Z,J,te,ae,re,se,oe,le,ce,fe,be,_e,ye,ge,we,Se,Me,xe,Ae,Ne,Re,De,Oe,We,Le,ze,v,He,Be,Ue,qe,Ve,Ge,$e,Ke,Qe,Ze,Je,tt,at,rt,it,ot,dt,ct,ft,bt,_t,gt,kt,wt,St,vt,xt,Ft,Nt,Et,Rt,Ct,L,Tt,Pt,Lt,jt,Ht,Bt,qt,Gt,Kt,Xt,V,Zt,Yt,en,nn,un,on,dn,ln,pn,cn,fn,bn,_n,yn,gn,kn,In,Sn,vn,xn,Fn,En,A,Rn,Cn];for(const e of Dn)t.registerKernel(e);const Tn=t.env();Tn.registerFlag("WASM_HAS_SIMD_SUPPORT",(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11])))),Tn.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",(async()=>{if(Tn.get("IS_NODE"))return!1;try{return(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(e){return!1}}));var On="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Pn(e){var t={exports:{}};return e(t,t.exports),t.exports}var Wn=Pn((function(e,t){var n,a=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(n=n||__filename),function(e){function t(){return O.buffer!=U&&Y(O.buffer),q}function a(){return O.buffer!=U&&Y(O.buffer),V}function r(){return O.buffer!=U&&Y(O.buffer),G}function s(){return O.buffer!=U&&Y(O.buffer),$}var u,i,o,d="undefined"!=typeof(e=e||{})?e:{};d.ready=new Promise((function(e,t){u=e,i=t})),"undefined"!=typeof process&&process.listeners&&(o={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var h,b,_,y,g,k,w=Object.assign({},d),I=(e,t)=>{throw t},S="object"==typeof window,v="function"==typeof importScripts,M="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,x=d.ENVIRONMENT_IS_PTHREAD||!1,A="";function F(e){return d.locateFile?d.locateFile(e,A):A+e}if(M){let e;A=v?l.default.dirname(A)+"/":__dirname+"/",k=()=>{g||(y=p.default,g=l.default)},h=function(e,t){return k(),e=g.normalize(e),y.readFileSync(e,t?void 0:"utf8")},_=e=>{var t=h(e,!0);return t.buffer||(t=new Uint8Array(t)),t},b=(e,t,n)=>{k(),e=g.normalize(e),y.readFile(e,(function(e,a){e?n(e):t(a.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof dt))throw e})),process.on("unhandledRejection",(function(e){throw e})),I=(e,t)=>{if(re())throw process.exitCode=e,t;var n;(n=t)instanceof dt||D("exiting due to exception: "+n),process.exit(e)},d.inspect=function(){return"[Emscripten Module object]"};try{e=c.default}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}On.Worker=e.Worker}else(S||v)&&(v?A=self.location.href:"undefined"!=typeof document&&document.currentScript&&(A=document.currentScript.src),"undefined"!=typeof n&&n&&(A=n),A=0!==A.indexOf("blob:")?A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1):"",M||(h=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},v&&(_=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),b=(e,t,n)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)}));M&&"undefined"==typeof performance&&(On.performance=m.default.performance);var N=console.log.bind(console),E=console.warn.bind(console);M&&(k(),N=e=>y.writeSync(1,e+"\n"),E=e=>y.writeSync(2,e+"\n"));var R,C=d.print||N,D=d.printErr||E;function T(e){T.shown||(T.shown={}),T.shown[e]||(T.shown[e]=1,D(e))}Object.assign(d,w),w=null,d.arguments,d.thisProgram,d.quit&&(I=d.quit),d.wasmBinary&&(R=d.wasmBinary);var O,P,W=d.noExitRuntime||!0;"object"!=typeof WebAssembly&&de("no native wasm support detected");var L,z=!1;function j(e){return d["_"+e]}function H(e,n,a,r,s){var u={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);Z(e,t=rt(n),n)}return t},array:function(e){var n=rt(e.length);return function(e,n){t().set(e,n)}(e,n),n}},i=j(e),o=[],d=0;if(r)for(var l=0;l<r.length;l++){var p=u[a[l]];p?(0===d&&(d=nt()),o[l]=p(r[l])):o[l]=r[l]}var c=i.apply(null,o);return c=function(e){return 0!==d&&at(d),function(e){return"string"===n?Q(e):"boolean"===n?Boolean(e):e}(e)}(c)}function B(e){var t=new TextDecoder(e);this.decode=e=>(e.buffer instanceof SharedArrayBuffer&&(e=new Uint8Array(e)),t.decode.call(t,e))}var U,q,V,G,$,K="undefined"!=typeof TextDecoder?new B("utf8"):void 0;function X(e,t,n){for(var a=t+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.subarray&&K)return K.decode(e.subarray(t,r));for(var s="";t<r;){var u=e[t++];if(128&u){var i=63&e[t++];if(192!=(224&u)){var o=63&e[t++];if((u=224==(240&u)?(15&u)<<12|i<<6|o:(7&u)<<18|i<<12|o<<6|63&e[t++])<65536)s+=String.fromCharCode(u);else{var d=u-65536;s+=String.fromCharCode(55296|d>>10,56320|1023&d)}}else s+=String.fromCharCode((31&u)<<6|i)}else s+=String.fromCharCode(u)}return s}function Q(e,t){return e?X(a(),e,t):""}function Z(e,t,n){return function(e,t,n,a){if(!(a>0))return 0;for(var r=n,s=n+a-1,u=0;u<e.length;++u){var i=e.charCodeAt(u);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++u)),i<=127){if(n>=s)break;t[n++]=i}else if(i<=2047){if(n+1>=s)break;t[n++]=192|i>>6,t[n++]=128|63&i}else if(i<=65535){if(n+2>=s)break;t[n++]=224|i>>12,t[n++]=128|i>>6&63,t[n++]=128|63&i}else{if(n+3>=s)break;t[n++]=240|i>>18,t[n++]=128|i>>12&63,t[n++]=128|i>>6&63,t[n++]=128|63&i}}return t[n]=0,n-r}(e,a(),t,n)}function Y(e){U=e,d.HEAP8=q=new Int8Array(e),d.HEAP16=new Int16Array(e),d.HEAP32=G=new Int32Array(e),d.HEAPU8=V=new Uint8Array(e),d.HEAPU16=new Uint16Array(e),d.HEAPU32=new Uint32Array(e),d.HEAPF32=new Float32Array(e),d.HEAPF64=$=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new B("utf-16le"),x&&(U=d.buffer);var J,ee=d.INITIAL_MEMORY||16777216;if(x)O=d.wasmMemory,U=d.buffer;else if(d.wasmMemory)O=d.wasmMemory;else if(!((O=new WebAssembly.Memory({initial:ee/65536,maximum:32768,shared:!0})).buffer instanceof SharedArrayBuffer))throw D("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),M&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");O&&(U=O.buffer),ee=U.byteLength,Y(U);var te=[],ne=[],ae=[];function re(){return W||!1}function se(){x||fe(ne)}var ue,ie=0,oe=null;function de(e){x?postMessage({cmd:"onAbort",arg:e}):d.onAbort&&d.onAbort(e),D(e="Aborted("+e+")"),z=!0,L=1,e+=". Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw i(t),t}function le(e){return e.startsWith("data:application/octet-stream;base64,")}function pe(e){return e.startsWith("file://")}function ce(e){try{if(e==ue&&R)return new Uint8Array(R);if(_)return _(e);throw"both async and sync fetching of the wasm failed"}catch(e){de(e)}}d.preloadedImages={},d.preloadedAudios={},le(ue="tfjs-backend-wasm-threaded-simd.wasm")||(ue=F(ue));var me={};function fe(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?Ie(n)():Ie(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(d)}}function he(e){var t=nt(),n=e();return at(t),n}function be(e){var t=ye.pthreads[e];if(t){r()[e>>2]=0;var n=t.worker;ye.returnWorkerToPool(n)}}function _e(e){!function(e,t){if(L=e,!t&&x)throw ge(e),"unwind";var n;re()||x||ye.terminateAllThreads(),L=n=e,re()||(ye.terminateAllThreads(),d.onExit&&d.onExit(n),z=!0),I(n,new dt(n))}(e)}var ye={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],init:function(){x?ye.initWorker():ye.initMainThread()},initMainThread:function(){for(var e=0;e<8;++e)ye.allocateUnusedWorker()},initWorker:function(){W=!1},pthreads:{},setExitStatus:function(e){L=e},terminateAllThreads:function(){for(var e in ye.pthreads){var t=ye.pthreads[e];t&&t.worker&&ye.returnWorkerToPool(t.worker)}for(var n=0;n<ye.unusedWorkers.length;++n)ye.unusedWorkers[n].terminate();ye.unusedWorkers=[]},returnWorkerToPool:function(e){ye.runWithoutMainThreadQueuedCalls((function(){delete ye.pthreads[e.pthread.threadInfoStruct],ye.unusedWorkers.push(e),ye.runningWorkers.splice(ye.runningWorkers.indexOf(e),1),et(e.pthread.threadInfoStruct),e.pthread=void 0}))},runWithoutMainThreadQueuedCalls:function(e){r()[ot>>2]=0;try{e()}finally{r()[ot>>2]=1}},receiveObjectTransfer:function(e){},threadInit:function(){for(var e in ye.tlsInitFunctions)ye.tlsInitFunctions[e]()},loadWasmModuleToWorker:function(e,t){e.onmessage=n=>{var a,s=n.data,u=s.cmd;if(e.pthread&&(ye.currentProxiedOperationCallerThread=e.pthread.threadInfoStruct),s.targetThread&&s.targetThread!=Ke()){var i=ye.pthreads[s.targetThread];return i?i.worker.postMessage(s,s.transferList):D('Internal error! Worker sent a message "'+u+'" to target pthread '+s.targetThread+", but that thread no longer exists!"),void(ye.currentProxiedOperationCallerThread=void 0)}"processQueuedMainThreadWork"===u?Xe():"spawnThread"===u?ve(s):"cleanupThread"===u?be(s.thread):"killThread"===u?function(e){r()[e>>2]=0;var t=ye.pthreads[e];delete ye.pthreads[e],t.worker.terminate(),et(e),ye.runningWorkers.splice(ye.runningWorkers.indexOf(t.worker),1),t.worker.pthread=void 0}(s.thread):"cancelThread"===u?(a=s.thread,ye.pthreads[a].worker.postMessage({cmd:"cancel"})):"loaded"===u?(e.loaded=!0,t&&t(e),e.runPthread&&(e.runPthread(),delete e.runPthread)):"print"===u?C("Thread "+s.threadId+": "+s.text):"printErr"===u?D("Thread "+s.threadId+": "+s.text):"alert"===u?alert("Thread "+s.threadId+": "+s.text):"setimmediate"===s.target?e.postMessage(s):"onAbort"===u?d.onAbort&&d.onAbort(s.arg):D("worker sent an unknown command "+u),ye.currentProxiedOperationCallerThread=void 0},e.onerror=e=>{throw D("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},M&&(e.on("message",(function(t){e.onmessage({data:t})})),e.on("error",(function(t){e.onerror(t)})),e.on("detachedExit",(function(){}))),e.postMessage({cmd:"load",urlOrBlob:d.mainScriptUrlOrBlob||n,wasmMemory:O,wasmModule:P})},allocateUnusedWorker:function(){var e=F("tfjs-backend-wasm-threaded-simd.worker.js");ye.unusedWorkers.push(new Worker(e))},getNewWorker:function(){return 0==ye.unusedWorkers.length&&(ye.allocateUnusedWorker(),ye.loadWasmModuleToWorker(ye.unusedWorkers[0])),ye.unusedWorkers.pop()}};function ge(e){if(x)return xe(1,0,e);try{_e(e)}catch(e){!function(e){if(e instanceof dt||"unwind"==e)return L;I(1,e)}(e)}}d.establishStackSpace=function(){var e=Ke(),t=r()[e+44>>2],n=r()[e+48>>2];tt(t,t-n),at(t)};var ke,we=[];function Ie(e){var t=we[e];return t||(e>=we.length&&(we.length=e+1),we[e]=t=J.get(e)),t}function Se(e,t){var n,a;if(0===e)n=Date.now();else{if(1!==e&&4!==e)return a=28,r()[$e()>>2]=a,-1;n=ke()}return r()[t>>2]=n/1e3|0,r()[t+4>>2]=n%1e3*1e3*1e3|0,0}function ve(e){var t=ye.getNewWorker();if(!t)return 6;ye.runningWorkers.push(t);var n=ye.pthreads[e.pthread_ptr]={worker:t,threadInfoStruct:e.pthread_ptr};t.pthread=n;var a={cmd:"run",start_routine:e.startRoutine,arg:e.arg,threadInfoStruct:e.pthread_ptr};return t.runPthread=()=>{a.time=performance.now(),t.postMessage(a,e.transferList)},t.loaded&&(t.runPthread(),delete t.runPthread),0}function Me(){return 2147483648}function xe(e,t){var n=arguments.length-2,a=arguments;return he((function(){for(var r=n,u=rt(8*r),i=u>>3,o=0;o<n;o++){var d=a[2+o];s()[i+o]=d}return Ye(e,r,u,t)}))}d.invokeEntryPoint=function(e,t){return Ie(e)(t)},ke=M?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:x?()=>performance.now()-d.__performance_now_clock_drift:()=>performance.now();var Ae=[];function Fe(e){try{return O.grow(e-U.byteLength+65535>>>16),Y(O.buffer),1}catch(e){}}var Ne={inEventHandler:0,removeAllEventListeners:function(){for(var e=Ne.eventHandlers.length-1;e>=0;--e)Ne._removeHandler(e);Ne.eventHandlers=[],Ne.deferredCalls=[]},registerRemoveEventListeners:function(){Ne.removeEventListenersRegistered||(Ne.removeEventListenersRegistered=!0)},deferredCalls:[],deferCall:function(e,t,n){function a(e,t){if(e.length!=t.length)return!1;for(var n in e)if(e[n]!=t[n])return!1;return!0}for(var r in Ne.deferredCalls){var s=Ne.deferredCalls[r];if(s.targetFunction==e&&a(s.argsList,n))return}Ne.deferredCalls.push({targetFunction:e,precedence:t,argsList:n}),Ne.deferredCalls.sort((function(e,t){return e.precedence<t.precedence}))},removeDeferredCalls:function(e){for(var t=0;t<Ne.deferredCalls.length;++t)Ne.deferredCalls[t].targetFunction==e&&(Ne.deferredCalls.splice(t,1),--t)},canPerformEventHandlerRequests:function(){return Ne.inEventHandler&&Ne.currentEventHandler.allowsDeferredCalls},runDeferredCalls:function(){if(Ne.canPerformEventHandlerRequests())for(var e=0;e<Ne.deferredCalls.length;++e){var t=Ne.deferredCalls[e];Ne.deferredCalls.splice(e,1),--e,t.targetFunction.apply(null,t.argsList)}},eventHandlers:[],removeAllHandlersOnTarget:function(e,t){for(var n=0;n<Ne.eventHandlers.length;++n)Ne.eventHandlers[n].target!=e||t&&t!=Ne.eventHandlers[n].eventTypeString||Ne._removeHandler(n--)},_removeHandler:function(e){var t=Ne.eventHandlers[e];t.target.removeEventListener(t.eventTypeString,t.eventListenerFunc,t.useCapture),Ne.eventHandlers.splice(e,1)},registerOrRemoveHandler:function(e){var t=function(t){++Ne.inEventHandler,Ne.currentEventHandler=e,Ne.runDeferredCalls(),e.handlerFunc(t),Ne.runDeferredCalls(),--Ne.inEventHandler};if(e.callbackfunc)e.eventListenerFunc=t,e.target.addEventListener(e.eventTypeString,t,e.useCapture),Ne.eventHandlers.push(e),Ne.registerRemoveEventListeners();else for(var n=0;n<Ne.eventHandlers.length;++n)Ne.eventHandlers[n].target==e.target&&Ne.eventHandlers[n].eventTypeString==e.eventTypeString&&Ne._removeHandler(n--)},queueEventHandlerOnThread_iiii:function(e,t,n,a,s){he((function(){var u=rt(12);r()[u>>2]=n,r()[u+4>>2]=a,r()[u+8>>2]=s,Je(e,637534208,t,a,u)}))},getTargetThreadForEventCallback:function(e){switch(e){case 1:return 0;case 2:return ye.currentProxiedOperationCallerThread;default:return e}},getNodeNameForTarget:function(e){return e?e==window?"#window":e==screen?"#screen":e&&e.nodeName?e.nodeName:"":""},fullscreenEnabled:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}};function Ee(e,t,n,a){he((function(){var s,u,i,o=rt(12),d=0;t&&(u=function(e){for(var t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++n)),a<=127?++t:t+=a<=2047?2:a<=65535?3:4}return t}(s=t)+1,i=Ve(u),Z(s,i,u),d=i),r()[o>>2]=d,r()[o+4>>2]=n,r()[o+8>>2]=a,Je(e,657457152,0,d,o)}))}var Re=[0,"undefined"!=typeof document?document:0,"undefined"!=typeof window?window:0];function Ce(e){var t;return e=(t=e)>2?Q(t):t,Re[e]||("undefined"!=typeof document?document.querySelector(e):void 0)}function De(e){return Ce(e)}function Te(e,t,n){var a=De(e);if(!a)return-4;if(a.canvasSharedPtr&&(r()[a.canvasSharedPtr>>2]=t,r()[a.canvasSharedPtr+4>>2]=n),!a.offscreenCanvas&&a.controlTransferredOffscreen)return a.canvasSharedPtr?(function(e,t,n,a){Ee(e,t=t?Q(t):"",n,a)}(r()[a.canvasSharedPtr+8>>2],e,t,n),1):-4;a.offscreenCanvas&&(a=a.offscreenCanvas);var s=!1;if(a.GLctxObject&&a.GLctxObject.GLctx){var u=a.GLctxObject.GLctx.getParameter(2978);s=0===u[0]&&0===u[1]&&u[2]===a.width&&u[3]===a.height}return a.width=t,a.height=n,s&&a.GLctxObject.GLctx.viewport(0,0,t,n),0}function Oe(e,t,n){return x?xe(2,1,e,t,n):Te(e,t,n)}var Pe,We={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:{},offscreenCanvases:{},queries:[],stringCache:{},unpackAlignment:4,recordError:function(e){We.lastError||(We.lastError=e)},getNewId:function(e){for(var t=We.counter++,n=e.length;n<t;n++)e[n]=null;return t},getSource:function(e,t,n,a){for(var s="",u=0;u<t;++u){var i=a?r()[a+4*u>>2]:-1;s+=Q(r()[n+4*u>>2],i<0?void 0:i)}return s},createContext:function(e,t){e.getContextSafariWebGL2Fixed||(e.getContextSafariWebGL2Fixed=e.getContext,e.getContext=function(t,n){var a=e.getContextSafariWebGL2Fixed(t,n);return"webgl"==t==a instanceof WebGLRenderingContext?a:null});var n=e.getContext("webgl",t);return n?We.registerContext(n,t):0},registerContext:function(e,t){var n=Ve(8);r()[n+4>>2]=Ke();var a={handle:n,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=a),We.contexts[n]=a,("undefined"==typeof t.enableExtensionsByDefault||t.enableExtensionsByDefault)&&We.initExtensions(a),n},makeContextCurrent:function(e){return We.currentContext=We.contexts[e],d.ctx=Pe=We.currentContext&&We.currentContext.GLctx,!(e&&!Pe)},getContext:function(e){return We.contexts[e]},deleteContext:function(e){We.currentContext===We.contexts[e]&&(We.currentContext=null),"object"==typeof Ne&&Ne.removeAllHandlersOnTarget(We.contexts[e].GLctx.canvas),We.contexts[e]&&We.contexts[e].GLctx.canvas&&(We.contexts[e].GLctx.canvas.GLctxObject=void 0),Ge(We.contexts[e].handle),We.contexts[e]=null},initExtensions:function(e){if(e||(e=We.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var t,n=e.GLctx;!function(e){var t=e.getExtension("ANGLE_instanced_arrays");t&&(e.vertexAttribDivisor=function(e,n){t.vertexAttribDivisorANGLE(e,n)},e.drawArraysInstanced=function(e,n,a,r){t.drawArraysInstancedANGLE(e,n,a,r)},e.drawElementsInstanced=function(e,n,a,r,s){t.drawElementsInstancedANGLE(e,n,a,r,s)})}(n),function(e){var t=e.getExtension("OES_vertex_array_object");t&&(e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(e){t.deleteVertexArrayOES(e)},e.bindVertexArray=function(e){t.bindVertexArrayOES(e)},e.isVertexArray=function(e){return t.isVertexArrayOES(e)})}(n),function(e){var t=e.getExtension("WEBGL_draw_buffers");t&&(e.drawBuffers=function(e,n){t.drawBuffersWEBGL(e,n)})}(n),n.disjointTimerQueryExt=n.getExtension("EXT_disjoint_timer_query"),(t=n).multiDrawWebgl=t.getExtension("WEBGL_multi_draw"),(n.getSupportedExtensions()||[]).forEach((function(e){e.includes("lose_context")||e.includes("debug")||n.getExtension(e)}))}}},Le=["default","low-power","high-performance"],ze={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=ze.buffers[e];0===t||10===t?((1===e?C:D)(X(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return ze.varargs+=4,r()[ze.varargs-4>>2]},getStr:function(e){return Q(e)},get64:function(e,t){return e}};function je(e){return x?xe(3,1,e):0}function He(e,t,n,a,r){if(x)return xe(4,1,e,t,n,a,r)}function Be(e,t,n,s){if(x)return xe(5,1,e,t,n,s);for(var u=0,i=0;i<n;i++){var o=r()[t>>2],d=r()[t+4>>2];t+=8;for(var l=0;l<d;l++)ze.printChar(e,a()[o+l]);u+=d}return r()[s>>2]=u,0}ye.init();var Ue=[null,ge,Oe,je,He,Be],qe={__clock_gettime:function(e,t){return Se(e,t)},__emscripten_init_main_thread_js:function(e){Qe(e,!v,1,!S),ye.threadInit()},__emscripten_thread_cleanup:function(e){x?postMessage({cmd:"cleanupThread",thread:e}):be(e)},__pthread_create_js:function(e,t,n,a){if("undefined"==typeof SharedArrayBuffer)return D("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var r=[];if(x&&0===r.length)return Ze(687865856,e,t,n,a);var s={startRoutine:n,pthread_ptr:e,arg:a,transferList:r};return x?(s.cmd="spawnThread",postMessage(s,r),0):ve(s)},_emscripten_default_pthread_stack_size:function(){return 2097152},_emscripten_notify_thread_queue:function(e,t){if(e==t)postMessage({cmd:"processQueuedMainThreadWork"});else if(x)postMessage({targetThread:e,cmd:"processThreadQueue"});else{var n=ye.pthreads[e],a=n&&n.worker;if(!a)return;a.postMessage({cmd:"processThreadQueue"})}return 1},abort:function(){de("")},emscripten_check_blocking_allowed:function(){M||v||T("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")},emscripten_get_heap_max:Me,emscripten_get_now:ke,emscripten_memcpy_big:function(e,t,n){a().copyWithin(e,t,t+n)},emscripten_num_logical_cores:function(){return M?f.default.cpus().length:navigator.hardwareConcurrency},emscripten_receive_on_main_thread_js:function(e,t,n){Ae.length=t;for(var a=n>>3,r=0;r<t;r++)Ae[r]=s()[a+r];return(e<0?me[-e-1]:Ue[e]).apply(null,Ae)},emscripten_resize_heap:function(e){var t=a().length;if((e>>>=0)<=t)return!1;var n,r,s=2147483648;if(e>s)return!1;for(var u=1;u<=4;u*=2){var i=t*(1+.2/u);if(i=Math.min(i,e+100663296),Fe(Math.min(s,((n=Math.max(e,i))%(r=65536)>0&&(n+=r-n%r),n))))return!0}return!1},emscripten_set_canvas_element_size:function(e,t,n){return De(e)?Te(e,t,n):Oe(e,t,n)},emscripten_unwind_to_js_event_loop:function(){throw"unwind"},emscripten_webgl_create_context:function(e,t){return n=e,a=t>>2,s=r()[a+6],u={alpha:!!r()[a+0],depth:!!r()[a+1],stencil:!!r()[a+2],antialias:!!r()[a+3],premultipliedAlpha:!!r()[a+4],preserveDrawingBuffer:!!r()[a+5],powerPreference:Le[s],failIfMajorPerformanceCaveat:!!r()[a+7],majorVersion:r()[a+8],minorVersion:r()[a+9],enableExtensionsByDefault:r()[a+10],explicitSwapControl:r()[a+11],proxyContextToMainThread:r()[a+12],renderViaOffscreenBackBuffer:r()[a+13]},(i=De(n))?u.explicitSwapControl?0:We.createContext(i,u):0;var n,a,s,u,i},exit:_e,fd_close:je,fd_seek:He,fd_write:Be,memory:O||d.wasmMemory,setTempRet0:function(e){}};!function(){var e={env:qe,wasi_snapshot_preview1:qe};function t(e,t){var n,a,r=e.exports;if(d.asm=r,n=d.asm.emscripten_tls_init,ye.tlsInitFunctions.push(n),J=d.asm.__indirect_function_table,a=d.asm.__wasm_call_ctors,ne.unshift(a),P=t,!x){var s=ye.unusedWorkers.length;ye.unusedWorkers.forEach((function(e){ye.loadWasmModuleToWorker(e,(function(){--s||function(e){if(ie--,d.monitorRunDependencies&&d.monitorRunDependencies(ie),0==ie&&oe){var t=oe;oe=null,t()}}()}))}))}}function n(e){t(e.instance,e.module)}function a(t){return function(){if(!R&&(S||v)){if("function"==typeof fetch&&!pe(ue))return fetch(ue,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ue+"'";return e.arrayBuffer()})).catch((function(){return ce(ue)}));if(b)return new Promise((function(e,t){b(ue,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ce(ue)}))}().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){D("failed to asynchronously prepare wasm: "+e),de(e)}))}if(x||(ie++,d.monitorRunDependencies&&d.monitorRunDependencies(ie)),d.instantiateWasm)try{return d.instantiateWasm(e,t)}catch(e){return D("Module.instantiateWasm callback failed with error: "+e),!1}(R||"function"!=typeof WebAssembly.instantiateStreaming||le(ue)||pe(ue)||"function"!=typeof fetch?a(n):fetch(ue,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return D("wasm streaming compile failed: "+e),D("falling back to ArrayBuffer instantiation"),a(n)}))}))).catch(i)}(),d.___wasm_call_ctors=function(){return(d.___wasm_call_ctors=d.asm.__wasm_call_ctors).apply(null,arguments)},d._init=function(){return(d._init=d.asm.init).apply(null,arguments)},d._init_with_threads_count=function(){return(d._init_with_threads_count=d.asm.init_with_threads_count).apply(null,arguments)},d._get_threads_count=function(){return(d._get_threads_count=d.asm.get_threads_count).apply(null,arguments)},d._register_tensor=function(){return(d._register_tensor=d.asm.register_tensor).apply(null,arguments)},d._dispose_data=function(){return(d._dispose_data=d.asm.dispose_data).apply(null,arguments)},d._dispose=function(){return(d._dispose=d.asm.dispose).apply(null,arguments)},d._Abs=function(){return(d._Abs=d.asm.Abs).apply(null,arguments)},d._Add=function(){return(d._Add=d.asm.Add).apply(null,arguments)},d._AddN=function(){return(d._AddN=d.asm.AddN).apply(null,arguments)},d._All=function(){return(d._All=d.asm.All).apply(null,arguments)},d._Any=function(){return(d._Any=d.asm.Any).apply(null,arguments)},d._ArgMax=function(){return(d._ArgMax=d.asm.ArgMax).apply(null,arguments)},d._AvgPool=function(){return(d._AvgPool=d.asm.AvgPool).apply(null,arguments)},d._BatchMatMul=function(){return(d._BatchMatMul=d.asm.BatchMatMul).apply(null,arguments)},d._Ceil=function(){return(d._Ceil=d.asm.Ceil).apply(null,arguments)},d._ClipByValue=function(){return(d._ClipByValue=d.asm.ClipByValue).apply(null,arguments)},d._Conv2D=function(){return(d._Conv2D=d.asm.Conv2D).apply(null,arguments)},d._Conv2DBackpropInput=function(){return(d._Conv2DBackpropInput=d.asm.Conv2DBackpropInput).apply(null,arguments)},d._Cos=function(){return(d._Cos=d.asm.Cos).apply(null,arguments)},d._Cosh=function(){return(d._Cosh=d.asm.Cosh).apply(null,arguments)},d._CropAndResize=function(){return(d._CropAndResize=d.asm.CropAndResize).apply(null,arguments)},d._Cumprod=function(){return(d._Cumprod=d.asm.Cumprod).apply(null,arguments)},d._Cumsum=function(){return(d._Cumsum=d.asm.Cumsum).apply(null,arguments)},d._DepthToSpace=function(){return(d._DepthToSpace=d.asm.DepthToSpace).apply(null,arguments)},d._DepthwiseConv2dNative=function(){return(d._DepthwiseConv2dNative=d.asm.DepthwiseConv2dNative).apply(null,arguments)},d._Elu=function(){return(d._Elu=d.asm.Elu).apply(null,arguments)},d._Equal=function(){return(d._Equal=d.asm.Equal).apply(null,arguments)},d._Exp=function(){return(d._Exp=d.asm.Exp).apply(null,arguments)},d._FlipLeftRight=function(){return(d._FlipLeftRight=d.asm.FlipLeftRight).apply(null,arguments)},d._Floor=function(){return(d._Floor=d.asm.Floor).apply(null,arguments)},d._FloorDiv=function(){return(d._FloorDiv=d.asm.FloorDiv).apply(null,arguments)},d._FusedBatchNorm=function(){return(d._FusedBatchNorm=d.asm.FusedBatchNorm).apply(null,arguments)},d._FusedConv2D=function(){return(d._FusedConv2D=d.asm.FusedConv2D).apply(null,arguments)},d._FusedDepthwiseConv2D=function(){return(d._FusedDepthwiseConv2D=d.asm.FusedDepthwiseConv2D).apply(null,arguments)},d._Gather=function(){return(d._Gather=d.asm.Gather).apply(null,arguments)},d._GatherNd=function(){return(d._GatherNd=d.asm.GatherNd).apply(null,arguments)},d._Greater=function(){return(d._Greater=d.asm.Greater).apply(null,arguments)},d._GreaterEqual=function(){return(d._GreaterEqual=d.asm.GreaterEqual).apply(null,arguments)},d._LeakyRelu=function(){return(d._LeakyRelu=d.asm.LeakyRelu).apply(null,arguments)},d._Less=function(){return(d._Less=d.asm.Less).apply(null,arguments)},d._LessEqual=function(){return(d._LessEqual=d.asm.LessEqual).apply(null,arguments)},d._Log=function(){return(d._Log=d.asm.Log).apply(null,arguments)},d._LogicalAnd=function(){return(d._LogicalAnd=d.asm.LogicalAnd).apply(null,arguments)},d._LogicalNot=function(){return(d._LogicalNot=d.asm.LogicalNot).apply(null,arguments)},d._LogicalOr=function(){return(d._LogicalOr=d.asm.LogicalOr).apply(null,arguments)},d._LogicalXor=function(){return(d._LogicalXor=d.asm.LogicalXor).apply(null,arguments)},d._Max=function(){return(d._Max=d.asm.Max).apply(null,arguments)},d._MaxPool=function(){return(d._MaxPool=d.asm.MaxPool).apply(null,arguments)},d._Maximum=function(){return(d._Maximum=d.asm.Maximum).apply(null,arguments)},d._Mean=function(){return(d._Mean=d.asm.Mean).apply(null,arguments)},d._Min=function(){return(d._Min=d.asm.Min).apply(null,arguments)},d._Minimum=function(){return(d._Minimum=d.asm.Minimum).apply(null,arguments)},d._MirrorPad=function(){return(d._MirrorPad=d.asm.MirrorPad).apply(null,arguments)},d._Multiply=function(){return(d._Multiply=d.asm.Multiply).apply(null,arguments)},d._Neg=function(){return(d._Neg=d.asm.Neg).apply(null,arguments)},d._NonMaxSuppressionV3=function(){return(d._NonMaxSuppressionV3=d.asm.NonMaxSuppressionV3).apply(null,arguments)},d._NonMaxSuppressionV4=function(){return(d._NonMaxSuppressionV4=d.asm.NonMaxSuppressionV4).apply(null,arguments)},d._NonMaxSuppressionV5=function(){return(d._NonMaxSuppressionV5=d.asm.NonMaxSuppressionV5).apply(null,arguments)},d._NotEqual=function(){return(d._NotEqual=d.asm.NotEqual).apply(null,arguments)},d._OneHot=function(){return(d._OneHot=d.asm.OneHot).apply(null,arguments)},d._PadV2=function(){return(d._PadV2=d.asm.PadV2).apply(null,arguments)},d._Pow=function(){return(d._Pow=d.asm.Pow).apply(null,arguments)},d._Prelu=function(){return(d._Prelu=d.asm.Prelu).apply(null,arguments)},d._Prod=function(){return(d._Prod=d.asm.Prod).apply(null,arguments)},d._RealDiv=function(){return(d._RealDiv=d.asm.RealDiv).apply(null,arguments)},d._Relu=function(){return(d._Relu=d.asm.Relu).apply(null,arguments)},d._Relu6=function(){return(d._Relu6=d.asm.Relu6).apply(null,arguments)},d._ResizeBilinear=function(){return(d._ResizeBilinear=d.asm.ResizeBilinear).apply(null,arguments)},d._ResizeNearestNeighbor=function(){return(d._ResizeNearestNeighbor=d.asm.ResizeNearestNeighbor).apply(null,arguments)},d._Reverse=function(){return(d._Reverse=d.asm.Reverse).apply(null,arguments)},d._RotateWithOffset=function(){return(d._RotateWithOffset=d.asm.RotateWithOffset).apply(null,arguments)},d._Round=function(){return(d._Round=d.asm.Round).apply(null,arguments)},d._Rsqrt=function(){return(d._Rsqrt=d.asm.Rsqrt).apply(null,arguments)},d._ScatterNd=function(){return(d._ScatterNd=d.asm.ScatterNd).apply(null,arguments)},d._SelectV2=function(){return(d._SelectV2=d.asm.SelectV2).apply(null,arguments)},d._Sigmoid=function(){return(d._Sigmoid=d.asm.Sigmoid).apply(null,arguments)},d._Sin=function(){return(d._Sin=d.asm.Sin).apply(null,arguments)},d._Softmax=function(){return(d._Softmax=d.asm.Softmax).apply(null,arguments)},d._SparseFillEmptyRows=function(){return(d._SparseFillEmptyRows=d.asm.SparseFillEmptyRows).apply(null,arguments)},d._SparseReshape=function(){return(d._SparseReshape=d.asm.SparseReshape).apply(null,arguments)},d._SparseSegmentReduction=function(){return(d._SparseSegmentReduction=d.asm.SparseSegmentReduction).apply(null,arguments)},d._Sqrt=function(){return(d._Sqrt=d.asm.Sqrt).apply(null,arguments)},d._Square=function(){return(d._Square=d.asm.Square).apply(null,arguments)},d._SquaredDifference=function(){return(d._SquaredDifference=d.asm.SquaredDifference).apply(null,arguments)},d._Step=function(){return(d._Step=d.asm.Step).apply(null,arguments)},d._StridedSlice=function(){return(d._StridedSlice=d.asm.StridedSlice).apply(null,arguments)},d._Sub=function(){return(d._Sub=d.asm.Sub).apply(null,arguments)},d._Sum=function(){return(d._Sum=d.asm.Sum).apply(null,arguments)},d._Tan=function(){return(d._Tan=d.asm.Tan).apply(null,arguments)},d._Tanh=function(){return(d._Tanh=d.asm.Tanh).apply(null,arguments)},d._Tile=function(){return(d._Tile=d.asm.Tile).apply(null,arguments)},d._TopK=function(){return(d._TopK=d.asm.TopK).apply(null,arguments)},d._Transform=function(){return(d._Transform=d.asm.Transform).apply(null,arguments)},d._Transpose=function(){return(d._Transpose=d.asm.Transpose).apply(null,arguments)},d.__FusedMatMul=function(){return(d.__FusedMatMul=d.asm._FusedMatMul).apply(null,arguments)};var Ve=d._malloc=function(){return(Ve=d._malloc=d.asm.malloc).apply(null,arguments)},Ge=d._free=function(){return(Ge=d._free=d.asm.free).apply(null,arguments)};d._emscripten_tls_init=function(){return(d._emscripten_tls_init=d.asm.emscripten_tls_init).apply(null,arguments)};var $e=d.___errno_location=function(){return($e=d.___errno_location=d.asm.__errno_location).apply(null,arguments)},Ke=d._pthread_self=function(){return(Ke=d._pthread_self=d.asm.pthread_self).apply(null,arguments)},Xe=d._emscripten_main_thread_process_queued_calls=function(){return(Xe=d._emscripten_main_thread_process_queued_calls=d.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)};d.__emscripten_thread_crashed=function(){return(d.__emscripten_thread_crashed=d.asm._emscripten_thread_crashed).apply(null,arguments)};var Qe=d.__emscripten_thread_init=function(){return(Qe=d.__emscripten_thread_init=d.asm._emscripten_thread_init).apply(null,arguments)};d._emscripten_current_thread_process_queued_calls=function(){return(d._emscripten_current_thread_process_queued_calls=d.asm.emscripten_current_thread_process_queued_calls).apply(null,arguments)},d._emscripten_main_browser_thread_id=function(){return(d._emscripten_main_browser_thread_id=d.asm.emscripten_main_browser_thread_id).apply(null,arguments)},d._emscripten_sync_run_in_main_thread_2=function(){return(d._emscripten_sync_run_in_main_thread_2=d.asm.emscripten_sync_run_in_main_thread_2).apply(null,arguments)};var Ze=d._emscripten_sync_run_in_main_thread_4=function(){return(Ze=d._emscripten_sync_run_in_main_thread_4=d.asm.emscripten_sync_run_in_main_thread_4).apply(null,arguments)},Ye=d._emscripten_run_in_main_runtime_thread_js=function(){return(Ye=d._emscripten_run_in_main_runtime_thread_js=d.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)},Je=d._emscripten_dispatch_to_thread_=function(){return(Je=d._emscripten_dispatch_to_thread_=d.asm.emscripten_dispatch_to_thread_).apply(null,arguments)},et=d.__emscripten_thread_free_data=function(){return(et=d.__emscripten_thread_free_data=d.asm._emscripten_thread_free_data).apply(null,arguments)};d.__emscripten_thread_exit=function(){return(d.__emscripten_thread_exit=d.asm._emscripten_thread_exit).apply(null,arguments)},d._memalign=function(){return(d._memalign=d.asm.memalign).apply(null,arguments)};var tt=d._emscripten_stack_set_limits=function(){return(tt=d._emscripten_stack_set_limits=d.asm.emscripten_stack_set_limits).apply(null,arguments)},nt=d.stackSave=function(){return(nt=d.stackSave=d.asm.stackSave).apply(null,arguments)},at=d.stackRestore=function(){return(at=d.stackRestore=d.asm.stackRestore).apply(null,arguments)},rt=d.stackAlloc=function(){return(rt=d.stackAlloc=d.asm.stackAlloc).apply(null,arguments)};d.dynCall_iijjiiii=function(){return(d.dynCall_iijjiiii=d.asm.dynCall_iijjiiii).apply(null,arguments)},d.dynCall_jiji=function(){return(d.dynCall_jiji=d.asm.dynCall_jiji).apply(null,arguments)};var st,ut,it,ot=d.__emscripten_allow_main_runtime_queued_calls=21672;function dt(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function lt(e){if(!(ie>0)){if(x)return u(d),se(),void postMessage({cmd:"loaded"});!function(){if(d.preRun)for("function"==typeof d.preRun&&(d.preRun=[d.preRun]);d.preRun.length;)e=d.preRun.shift(),te.unshift(e);var e;fe(te)}(),ie>0||(d.setStatus?(d.setStatus("Running..."),setTimeout((function(){setTimeout((function(){d.setStatus("")}),1),t()}),1)):t())}function t(){st||(st=!0,d.calledRun=!0,z||(se(),u(d),d.onRuntimeInitialized&&d.onRuntimeInitialized(),function(){if(!x){if(d.postRun)for("function"==typeof d.postRun&&(d.postRun=[d.postRun]);d.postRun.length;)e=d.postRun.shift(),ae.unshift(e);var e;fe(ae)}}()))}}if(d.cwrap=function(e,t,n,a){var r=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!a?j(e):function(){return H(e,t,n,arguments)}},d.keepRuntimeAlive=re,d.PThread=ye,d.PThread=ye,d.wasmMemory=O,d.ExitStatus=dt,oe=function e(){st||lt(),st||(oe=e)},d.run=lt,d.preInit)for("function"==typeof d.preInit&&(d.preInit=[d.preInit]);d.preInit.length>0;)d.preInit.pop()();if(lt(),o&&(ut={uncaughtException:process.listeners("uncaughtException").filter((function(e){return!o.uncaughtException.indexOf(e)>-1})),unhandledRejection:process.listeners("unhandledRejection").filter((function(e){return!o.unhandledRejection.indexOf(e)>-1}))}),"undefined"!=typeof WasmBackendModule)it=WasmBackendModule;else{if("undefined"==typeof e)throw new Error("Could not find wasm module in post.js");it=e}if(ut){var pt=it._dispose;it._dispose=function(){pt(),ut.uncaughtException.forEach((function(e){process.removeListener("uncaughtException",e)})),ut.unhandledRejection.forEach((function(e){process.removeListener("unhandledRejection",e)}))}}return e.ready});e.exports=a})),Ln=Object.assign(Object.create(null),Wn,{default:Wn}),zn='"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",function(data){onmessage({data:data})});var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8"))},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"\n");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=((info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports});self.onmessage=(e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob==="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module).then(function(instance){Module=instance})}else if(e.data.cmd==="run"){Module["__performance_now_clock_drift"]=performance.now()-e.data.time;Module["__emscripten_thread_init"](e.data.threadInfoStruct,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInit();try{var result=Module["invokeEntryPoint"](e.data.start_routine,e.data.arg);if(Module["keepRuntimeAlive"]()){Module["PThread"].setExitStatus(result)}else{Module["__emscripten_thread_exit"](result)}}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processThreadQueue"){if(Module["_pthread_self"]()){Module["_emscripten_current_thread_process_queued_calls"]()}}else if(e.data.cmd==="processProxyingQueue"){if(Module["_pthread_self"]()){Module["_emscripten_proxy_execute_queue"](e.data.queue)}}else{err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){err("worker.js onmessage() captured an uncaught exception: "+ex);if(ex&&ex.stack)err(ex.stack);if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}});',jn=Pn((function(e,t){var n,a=(n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(n=n||__filename),function(e){var t,a,r,s="undefined"!=typeof(e=e||{})?e:{};s.ready=new Promise((function(e,n){t=e,a=n})),"undefined"!=typeof process&&process.listeners&&(r={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var u,i,o,d,c,m,f=Object.assign({},s),h="object"==typeof window,b="function"==typeof importScripts,_="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,y="";_?(y=b?l.default.dirname(y)+"/":__dirname+"/",m=()=>{c||(d=p.default,c=l.default)},u=function(e,t){return m(),e=c.normalize(e),d.readFileSync(e,t?void 0:"utf8")},o=e=>{var t=u(e,!0);return t.buffer||(t=new Uint8Array(t)),t},i=(e,t,n)=>{m(),e=c.normalize(e),d.readFile(e,(function(e,a){e?n(e):t(a.buffer)}))},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof se))throw e})),process.on("unhandledRejection",(function(e){throw e})),s.inspect=function(){return"[Emscripten Module object]"}):(h||b)&&(b?y=self.location.href:"undefined"!=typeof document&&document.currentScript&&(y=document.currentScript.src),n&&(y=n),y=0!==y.indexOf("blob:")?y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):"",u=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},b&&(o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),i=(e,t,n)=>{var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?t(a.response):n()},a.onerror=n,a.send(null)});var g,k,w=s.print||console.log.bind(console),I=s.printErr||console.warn.bind(console);Object.assign(s,f),f=null,s.arguments,s.thisProgram,s.quit,s.wasmBinary&&(g=s.wasmBinary),s.noExitRuntime,"object"!=typeof WebAssembly&&B("no native wasm support detected");var S=!1;function v(e){return s["_"+e]}function M(e,t,n,a,r){var s={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);!function(e,t,n){!function(e,t,n,a){if(!(a>0))return 0;for(var r=n+a-1,s=0;s<e.length;++s){var u=e.charCodeAt(s);if(u>=55296&&u<=57343&&(u=65536+((1023&u)<<10)|1023&e.charCodeAt(++s)),u<=127){if(n>=r)break;t[n++]=u}else if(u<=2047){if(n+1>=r)break;t[n++]=192|u>>6,t[n++]=128|63&u}else if(u<=65535){if(n+2>=r)break;t[n++]=224|u>>12,t[n++]=128|u>>6&63,t[n++]=128|63&u}else{if(n+3>=r)break;t[n++]=240|u>>18,t[n++]=128|u>>12&63,t[n++]=128|u>>6&63,t[n++]=128|63&u}}t[n]=0}(e,F,t,n)}(e,t=re(n),n)}return t},array:function(e){var t=re(e.length);return function(e,t){A.set(e,t)}(e,t),t}},u=v(e),i=[],o=0;if(a)for(var d=0;d<a.length;d++){var l=s[n[d]];l?(0===o&&(o=ne()),i[d]=l(a[d])):i[d]=a[d]}var p=u.apply(null,i);return p=function(e){return 0!==o&&ae(o),function(e){return"string"===t?D(e):"boolean"===t?Boolean(e):e}(e)}(p)}var x,A,F,N,E,R="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function C(e,t,n){for(var a=t+n,r=t;e[r]&&!(r>=a);)++r;if(r-t>16&&e.subarray&&R)return R.decode(e.subarray(t,r));for(var s="";t<r;){var u=e[t++];if(128&u){var i=63&e[t++];if(192!=(224&u)){var o=63&e[t++];if((u=224==(240&u)?(15&u)<<12|i<<6|o:(7&u)<<18|i<<12|o<<6|63&e[t++])<65536)s+=String.fromCharCode(u);else{var d=u-65536;s+=String.fromCharCode(55296|d>>10,56320|1023&d)}}else s+=String.fromCharCode((31&u)<<6|i)}else s+=String.fromCharCode(u)}return s}function D(e,t){return e?C(F,e,t):""}function T(e){x=e,s.HEAP8=A=new Int8Array(e),s.HEAP16=new Int16Array(e),s.HEAP32=N=new Int32Array(e),s.HEAPU8=F=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAPU32=new Uint32Array(e),s.HEAPF32=new Float32Array(e),s.HEAPF64=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),s.INITIAL_MEMORY;var O,P,W=[],L=[],z=[],j=0,H=null;function B(e){s.onAbort&&s.onAbort(e),I(e="Aborted("+e+")"),S=!0,e+=". Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw a(t),t}function U(e){return e.startsWith("data:application/octet-stream;base64,")}function q(e){return e.startsWith("file://")}function V(e){try{if(e==O&&g)return new Uint8Array(g);if(o)return o(e);throw"both async and sync fetching of the wasm failed"}catch(e){B(e)}}function G(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?K(n)():K(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(s)}}s.preloadedImages={},s.preloadedAudios={},U(O="tfjs-backend-wasm.wasm")||(P=O,O=s.locateFile?s.locateFile(P,y):y+P);var $=[];function K(e){var t=$[e];return t||(e>=$.length&&($.length=e+1),$[e]=t=E.get(e)),t}function X(){return 2147483648}function Q(e){try{return k.grow(e-x.byteLength+65535>>>16),T(k.buffer),1}catch(e){}}var Z={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=Z.buffers[e];0===t||10===t?((1===e?w:I)(C(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return Z.varargs+=4,N[Z.varargs-4>>2]},getStr:function(e){return D(e)},get64:function(e,t){return e}},Y={abort:function(){B("")},emscripten_get_heap_max:X,emscripten_memcpy_big:function(e,t,n){F.copyWithin(e,t,t+n)},emscripten_resize_heap:function(e){var t,n,a=F.length,r=2147483648;if((e>>>=0)>r)return!1;for(var s=1;s<=4;s*=2){var u=a*(1+.2/s);if(u=Math.min(u,e+100663296),Q(Math.min(r,((t=Math.max(e,u))%(n=65536)>0&&(t+=n-t%n),t))))return!0}return!1},fd_close:function(e){return 0},fd_seek:function(e,t,n,a,r){},fd_write:function(e,t,n,a){for(var r=0,s=0;s<n;s++){var u=N[t>>2],i=N[t+4>>2];t+=8;for(var o=0;o<i;o++)Z.printChar(e,F[u+o]);r+=i}return N[a>>2]=r,0},setTempRet0:function(e){}};!function(){var e={env:Y,wasi_snapshot_preview1:Y};function t(e,t){var n,a=e.exports;s.asm=a,T((k=s.asm.memory).buffer),E=s.asm.__indirect_function_table,n=s.asm.__wasm_call_ctors,L.unshift(n),function(e){if(j--,s.monitorRunDependencies&&s.monitorRunDependencies(j),0==j&&H){var t=H;H=null,t()}}()}function n(e){t(e.instance)}function r(t){return function(){if(!g&&(h||b)){if("function"==typeof fetch&&!q(O))return fetch(O,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+O+"'";return e.arrayBuffer()})).catch((function(){return V(O)}));if(i)return new Promise((function(e,t){i(O,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return V(O)}))}().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){I("failed to asynchronously prepare wasm: "+e),B(e)}))}if(j++,s.monitorRunDependencies&&s.monitorRunDependencies(j),s.instantiateWasm)try{return s.instantiateWasm(e,t)}catch(e){return I("Module.instantiateWasm callback failed with error: "+e),!1}(g||"function"!=typeof WebAssembly.instantiateStreaming||U(O)||q(O)||"function"!=typeof fetch?r(n):fetch(O,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return I("wasm streaming compile failed: "+e),I("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(a)}(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm.__wasm_call_ctors).apply(null,arguments)},s._init=function(){return(s._init=s.asm.init).apply(null,arguments)},s._init_with_threads_count=function(){return(s._init_with_threads_count=s.asm.init_with_threads_count).apply(null,arguments)},s._get_threads_count=function(){return(s._get_threads_count=s.asm.get_threads_count).apply(null,arguments)},s._register_tensor=function(){return(s._register_tensor=s.asm.register_tensor).apply(null,arguments)},s._dispose_data=function(){return(s._dispose_data=s.asm.dispose_data).apply(null,arguments)},s._dispose=function(){return(s._dispose=s.asm.dispose).apply(null,arguments)},s._Abs=function(){return(s._Abs=s.asm.Abs).apply(null,arguments)},s._Add=function(){return(s._Add=s.asm.Add).apply(null,arguments)},s._AddN=function(){return(s._AddN=s.asm.AddN).apply(null,arguments)},s._All=function(){return(s._All=s.asm.All).apply(null,arguments)},s._Any=function(){return(s._Any=s.asm.Any).apply(null,arguments)},s._ArgMax=function(){return(s._ArgMax=s.asm.ArgMax).apply(null,arguments)},s._AvgPool=function(){return(s._AvgPool=s.asm.AvgPool).apply(null,arguments)},s._BatchMatMul=function(){return(s._BatchMatMul=s.asm.BatchMatMul).apply(null,arguments)},s._Ceil=function(){return(s._Ceil=s.asm.Ceil).apply(null,arguments)},s._ClipByValue=function(){return(s._ClipByValue=s.asm.ClipByValue).apply(null,arguments)},s._Conv2D=function(){return(s._Conv2D=s.asm.Conv2D).apply(null,arguments)},s._Conv2DBackpropInput=function(){return(s._Conv2DBackpropInput=s.asm.Conv2DBackpropInput).apply(null,arguments)},s._Cos=function(){return(s._Cos=s.asm.Cos).apply(null,arguments)},s._Cosh=function(){return(s._Cosh=s.asm.Cosh).apply(null,arguments)},s._CropAndResize=function(){return(s._CropAndResize=s.asm.CropAndResize).apply(null,arguments)},s._Cumprod=function(){return(s._Cumprod=s.asm.Cumprod).apply(null,arguments)},s._Cumsum=function(){return(s._Cumsum=s.asm.Cumsum).apply(null,arguments)},s._DepthToSpace=function(){return(s._DepthToSpace=s.asm.DepthToSpace).apply(null,arguments)},s._DepthwiseConv2dNative=function(){return(s._DepthwiseConv2dNative=s.asm.DepthwiseConv2dNative).apply(null,arguments)},s._Elu=function(){return(s._Elu=s.asm.Elu).apply(null,arguments)},s._Equal=function(){return(s._Equal=s.asm.Equal).apply(null,arguments)},s._Exp=function(){return(s._Exp=s.asm.Exp).apply(null,arguments)},s._FlipLeftRight=function(){return(s._FlipLeftRight=s.asm.FlipLeftRight).apply(null,arguments)},s._Floor=function(){return(s._Floor=s.asm.Floor).apply(null,arguments)},s._FloorDiv=function(){return(s._FloorDiv=s.asm.FloorDiv).apply(null,arguments)},s._FusedBatchNorm=function(){return(s._FusedBatchNorm=s.asm.FusedBatchNorm).apply(null,arguments)},s._FusedConv2D=function(){return(s._FusedConv2D=s.asm.FusedConv2D).apply(null,arguments)},s._FusedDepthwiseConv2D=function(){return(s._FusedDepthwiseConv2D=s.asm.FusedDepthwiseConv2D).apply(null,arguments)},s._Gather=function(){return(s._Gather=s.asm.Gather).apply(null,arguments)},s._GatherNd=function(){return(s._GatherNd=s.asm.GatherNd).apply(null,arguments)},s._Greater=function(){return(s._Greater=s.asm.Greater).apply(null,arguments)},s._GreaterEqual=function(){return(s._GreaterEqual=s.asm.GreaterEqual).apply(null,arguments)},s._LeakyRelu=function(){return(s._LeakyRelu=s.asm.LeakyRelu).apply(null,arguments)},s._Less=function(){return(s._Less=s.asm.Less).apply(null,arguments)},s._LessEqual=function(){return(s._LessEqual=s.asm.LessEqual).apply(null,arguments)},s._Log=function(){return(s._Log=s.asm.Log).apply(null,arguments)},s._LogicalAnd=function(){return(s._LogicalAnd=s.asm.LogicalAnd).apply(null,arguments)},s._LogicalNot=function(){return(s._LogicalNot=s.asm.LogicalNot).apply(null,arguments)},s._LogicalOr=function(){return(s._LogicalOr=s.asm.LogicalOr).apply(null,arguments)},s._LogicalXor=function(){return(s._LogicalXor=s.asm.LogicalXor).apply(null,arguments)},s._Max=function(){return(s._Max=s.asm.Max).apply(null,arguments)},s._MaxPool=function(){return(s._MaxPool=s.asm.MaxPool).apply(null,arguments)},s._Maximum=function(){return(s._Maximum=s.asm.Maximum).apply(null,arguments)},s._Mean=function(){return(s._Mean=s.asm.Mean).apply(null,arguments)},s._Min=function(){return(s._Min=s.asm.Min).apply(null,arguments)},s._Minimum=function(){return(s._Minimum=s.asm.Minimum).apply(null,arguments)},s._MirrorPad=function(){return(s._MirrorPad=s.asm.MirrorPad).apply(null,arguments)},s._Multiply=function(){return(s._Multiply=s.asm.Multiply).apply(null,arguments)},s._Neg=function(){return(s._Neg=s.asm.Neg).apply(null,arguments)},s._NonMaxSuppressionV3=function(){return(s._NonMaxSuppressionV3=s.asm.NonMaxSuppressionV3).apply(null,arguments)},s._NonMaxSuppressionV4=function(){return(s._NonMaxSuppressionV4=s.asm.NonMaxSuppressionV4).apply(null,arguments)},s._NonMaxSuppressionV5=function(){return(s._NonMaxSuppressionV5=s.asm.NonMaxSuppressionV5).apply(null,arguments)},s._NotEqual=function(){return(s._NotEqual=s.asm.NotEqual).apply(null,arguments)},s._OneHot=function(){return(s._OneHot=s.asm.OneHot).apply(null,arguments)},s._PadV2=function(){return(s._PadV2=s.asm.PadV2).apply(null,arguments)},s._Pow=function(){return(s._Pow=s.asm.Pow).apply(null,arguments)},s._Prelu=function(){return(s._Prelu=s.asm.Prelu).apply(null,arguments)},s._Prod=function(){return(s._Prod=s.asm.Prod).apply(null,arguments)},s._RealDiv=function(){return(s._RealDiv=s.asm.RealDiv).apply(null,arguments)},s._Relu=function(){return(s._Relu=s.asm.Relu).apply(null,arguments)},s._Relu6=function(){return(s._Relu6=s.asm.Relu6).apply(null,arguments)},s._ResizeBilinear=function(){return(s._ResizeBilinear=s.asm.ResizeBilinear).apply(null,arguments)},s._ResizeNearestNeighbor=function(){return(s._ResizeNearestNeighbor=s.asm.ResizeNearestNeighbor).apply(null,arguments)},s._Reverse=function(){return(s._Reverse=s.asm.Reverse).apply(null,arguments)},s._RotateWithOffset=function(){return(s._RotateWithOffset=s.asm.RotateWithOffset).apply(null,arguments)},s._Round=function(){return(s._Round=s.asm.Round).apply(null,arguments)},s._Rsqrt=function(){return(s._Rsqrt=s.asm.Rsqrt).apply(null,arguments)},s._ScatterNd=function(){return(s._ScatterNd=s.asm.ScatterNd).apply(null,arguments)},s._SelectV2=function(){return(s._SelectV2=s.asm.SelectV2).apply(null,arguments)},s._Sigmoid=function(){return(s._Sigmoid=s.asm.Sigmoid).apply(null,arguments)},s._Sin=function(){return(s._Sin=s.asm.Sin).apply(null,arguments)},s._Softmax=function(){return(s._Softmax=s.asm.Softmax).apply(null,arguments)},s._SparseFillEmptyRows=function(){return(s._SparseFillEmptyRows=s.asm.SparseFillEmptyRows).apply(null,arguments)},s._SparseReshape=function(){return(s._SparseReshape=s.asm.SparseReshape).apply(null,arguments)},s._SparseSegmentReduction=function(){return(s._SparseSegmentReduction=s.asm.SparseSegmentReduction).apply(null,arguments)},s._Sqrt=function(){return(s._Sqrt=s.asm.Sqrt).apply(null,arguments)},s._Square=function(){return(s._Square=s.asm.Square).apply(null,arguments)},s._SquaredDifference=function(){return(s._SquaredDifference=s.asm.SquaredDifference).apply(null,arguments)},s._Step=function(){return(s._Step=s.asm.Step).apply(null,arguments)},s._StridedSlice=function(){return(s._StridedSlice=s.asm.StridedSlice).apply(null,arguments)},s._Sub=function(){return(s._Sub=s.asm.Sub).apply(null,arguments)},s._Sum=function(){return(s._Sum=s.asm.Sum).apply(null,arguments)},s._Tan=function(){return(s._Tan=s.asm.Tan).apply(null,arguments)},s._Tanh=function(){return(s._Tanh=s.asm.Tanh).apply(null,arguments)},s._Tile=function(){return(s._Tile=s.asm.Tile).apply(null,arguments)},s._TopK=function(){return(s._TopK=s.asm.TopK).apply(null,arguments)},s._Transform=function(){return(s._Transform=s.asm.Transform).apply(null,arguments)},s._Transpose=function(){return(s._Transpose=s.asm.Transpose).apply(null,arguments)},s.__FusedMatMul=function(){return(s.__FusedMatMul=s.asm._FusedMatMul).apply(null,arguments)},s._malloc=function(){return(s._malloc=s.asm.malloc).apply(null,arguments)},s._free=function(){return(s._free=s.asm.free).apply(null,arguments)},s.___errno_location=function(){return(s.___errno_location=s.asm.__errno_location).apply(null,arguments)},s._emscripten_main_thread_process_queued_calls=function(){return(s._emscripten_main_thread_process_queued_calls=s.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)};var J,ee,te,ne=s.stackSave=function(){return(ne=s.stackSave=s.asm.stackSave).apply(null,arguments)},ae=s.stackRestore=function(){return(ae=s.stackRestore=s.asm.stackRestore).apply(null,arguments)},re=s.stackAlloc=function(){return(re=s.stackAlloc=s.asm.stackAlloc).apply(null,arguments)};function se(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ue(e){function n(){J||(J=!0,s.calledRun=!0,S||(G(L),t(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),function(){if(s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;)e=s.postRun.shift(),z.unshift(e);var e;G(z)}()))}j>0||(function(){if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)e=s.preRun.shift(),W.unshift(e);var e;G(W)}(),j>0||(s.setStatus?(s.setStatus("Running..."),setTimeout((function(){setTimeout((function(){s.setStatus("")}),1),n()}),1)):n()))}if(s.dynCall_iijjiiii=function(){return(s.dynCall_iijjiiii=s.asm.dynCall_iijjiiii).apply(null,arguments)},s.dynCall_jiji=function(){return(s.dynCall_jiji=s.asm.dynCall_jiji).apply(null,arguments)},s.cwrap=function(e,t,n,a){var r=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!a?v(e):function(){return M(e,t,n,arguments)}},H=function e(){J||ue(),J||(H=e)},s.run=ue,s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();if(ue(),r&&(ee={uncaughtException:process.listeners("uncaughtException").filter((function(e){return!r.uncaughtException.indexOf(e)>-1})),unhandledRejection:process.listeners("unhandledRejection").filter((function(e){return!r.unhandledRejection.indexOf(e)>-1}))}),"undefined"!=typeof e)te=e;else{if("undefined"==typeof WasmBackendModuleThreadedSimd)throw new Error("Could not find wasm module in post.js");te=WasmBackendModuleThreadedSimd}if(ee){var ie=te._dispose;te._dispose=function(){ie(),ee.uncaughtException.forEach((function(e){process.removeListener("uncaughtException",e)})),ee.unhandledRejection.forEach((function(e){process.removeListener("unhandledRejection",e)}))}}return e.ready});e.exports=a}));const Hn=Wn||Ln,Bn=jn||Object.assign(Object.create(null),jn,{default:jn});class Un extends t.KernelBackend{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(Yn),Jn=this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new t.DataStorage(this,t.engine())}write(e,t,n){const a={id:this.dataIdNextNumber++};return this.move(a,e,t,n,1),a}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){const n=t.util.now();e();return{kernelMs:t.util.now()-n}}move(e,n,a,r,s){const u=this.dataIdNextNumber++;if("string"===r){const t=n;return void this.dataIdMap.set(e,{id:u,stringBytes:t,shape:a,dtype:r,memoryOffset:null,refCount:s})}const i=t.util.sizeFromShape(a),o=i*t.util.bytesPerElement(r),d=this.wasm._malloc(o);this.dataIdMap.set(e,{id:u,memoryOffset:d,shape:a,dtype:r,refCount:s}),this.wasm.tfjs.registerTensor(u,i,d),null!=n&&this.wasm.HEAPU8.set(new Uint8Array(n.buffer,n.byteOffset,o),d)}async read(e){return this.readSync(e)}readSync(e,n,a){const{memoryOffset:r,dtype:s,shape:u,stringBytes:i}=this.dataIdMap.get(e);if("string"===s)return null!=n&&0!==n||!(null==a||a>=i.length)?i.slice(n,a):i;n=n||0,a=a||t.util.sizeFromShape(u);const o=t.util.bytesPerElement(s);return function(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error(`Unknown dtype ${t}`)}}(this.wasm.HEAPU8.slice(r+n*o,r+a*o).buffer,s)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){const n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){if(this.dataIdMap.has(e)){return this.dataIdMap.get(e).refCount}return 0}incRef(e){const t=this.dataIdMap.get(e);null!=t&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,n,a){let r;if(null==a)r=this.write(null,e,n);else{const s=this.dataIdNextNumber++;r={id:s},this.dataIdMap.set(r,{id:s,memoryOffset:a,shape:e,dtype:n,refCount:1});const u=t.util.sizeFromShape(e);this.wasm.tfjs.registerTensor(s,u,a)}return{dataId:r,shape:e,dtype:n}}typedArrayFromHeap({shape:e,dtype:n,dataId:a}){const r=this.wasm.HEAPU8.buffer,{memoryOffset:s}=this.dataIdMap.get(a),u=t.util.sizeFromShape(e);switch(n){case"float32":return new Float32Array(r,s,u);case"int32":return new Int32Array(r,s,u);case"bool":return new Uint8Array(r,s,u);default:throw new Error(`Unknown dtype ${n}`)}}}function qn(e,t,n){if(null!=$n)return $n;let a="tfjs-backend-wasm.wasm";return e&&t?a="tfjs-backend-wasm-threaded-simd.wasm":e&&(a="tfjs-backend-wasm-simd.wasm"),null!=Xn&&null!=Xn[a]?Xn[a]:n+a}async function Vn(){const[e,n]=await Promise.all([t.env().getAsync("WASM_HAS_SIMD_SUPPORT"),t.env().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise(((a,r)=>{const s={};var u;s.locateFile=(t,a)=>{if(t.endsWith(".worker.js")){const e=zn.replace(/\n/g,"\\n"),t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}return t.endsWith(".wasm")?qn(e,n,null!=Kn?Kn:a):a+t},Zn&&(s.instantiateWasm=(u=qn(e,n,null!=Kn?Kn:""),(e,n)=>(t.util.fetch(u,{credentials:"same-origin"}).then((t=>{t.ok||e.env.a(`failed to load wasm binary file at '${u}'`),t.arrayBuffer().then((t=>{WebAssembly.instantiate(t,e).then((e=>{n(e.instance,e.module)}))}))})),{})));let i,o=!1;s.onAbort=()=>{if(o)return;if(Qn)return;Qn=!0;r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"})},n&&e&&null==$n?(s.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+Hn.toString()],{type:"text/javascript"}),i=Hn(s)):i=Bn(s),i.then((e=>{o=!0,Qn=!1;e.tfjs={init:e.cwrap("init",null,[]),initWithThreadsCount:e.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:e.cwrap("get_threads_count","number",[]),registerTensor:e.cwrap("register_tensor",null,["number","number","number"]),disposeData:e.cwrap("dispose_data",null,["number"]),dispose:e.cwrap("dispose",null,[])},a({wasm:e})})).catch(r)}))}const Gn=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"];let $n=null,Kn=null,Xn={},Qn=!1,Zn=!1;let Yn=-1,Jn=-1;t.registerBackend("wasm",(async()=>{const{wasm:e}=await Vn();return new Un(e)}),2),e.BackendWasm=Un,e.getThreadsCount=function(){if(-1===Jn)throw new Error("WASM backend not initialized.");return Jn},e.setThreadsCount=function(e){Yn=e},e.setWasmPath=function(e,n=!1){if(t.deprecationWarn("setWasmPath has been deprecated in favor of setWasmPaths and will be removed in a future release."),Qn)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPath()` before you call `tf.setBackend()` or `tf.ready()`");$n=e,Zn=n},e.setWasmPaths=function(e,t=!1){if(Qn)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if("string"==typeof e)Kn=e;else{Xn=e;const t=Gn.filter((e=>null==Xn[e]));if(t.length>0)throw new Error(`There were no entries found for the following binaries: ${t.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}Zn=t},e.version_wasm="3.20.0",Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=tf-backend-wasm.es2017.min.js.map
