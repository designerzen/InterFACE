!function(e,t,s,a,r){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n="function"==typeof i[a]&&i[a],o=n.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(t,s){if(!o[t]){if(!e[t]){var r="function"==typeof i[a]&&i[a];if(!s&&r)return r(t,!0);if(n)return n(t,!0);if(l&&"string"==typeof t)return l(t);var h=new Error("Cannot find module '"+t+"'");throw h.code="MODULE_NOT_FOUND",h}d.resolve=function(s){var a=e[t][1][s];return null!=a?a:s},d.cache={};var c=o[t]=new u.Module(t);e[t][0].call(c.exports,d,c,c.exports,this)}return o[t].exports;function d(e){var t=d.resolve(e);return!1===t?{}:u(t)}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=o,u.parent=n,u.register=function(t,s){e[t]=[function(e,t){t.exports=s},{}]},Object.defineProperty(u,"root",{get:function(){return i[a]}}),i[a]=u;for(var h=0;h<t.length;h++)u(t[h])}({hWxzW:[function(e,t,s){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(s),a.export(s,"WamNode",(()=>f)),a.export(s,"WebAudioModule",(()=>r)),a.export(s,"addFunctionModule",(()=>h)),a.export(s,"apiVersion",(()=>v)),a.export(s,"getRingBuffer",(()=>i)),a.export(s,"getWamArrayRingBuffer",(()=>n)),a.export(s,"getWamEventRingBuffer",(()=>u)),a.export(s,"getWamParameter",(()=>c)),a.export(s,"getWamParameterInfo",(()=>d)),a.export(s,"getWamParameterInterpolator",(()=>m)),a.export(s,"getWamProcessor",(()=>p)),a.export(s,"initializeWamEnv",(()=>o)),a.export(s,"initializeWamGroup",(()=>l)),a.export(s,"initializeWamHost",(()=>y));var r=class{static get isWebAudioModuleConstructor(){return!0}static createInstance(e,t,s){return new this(e,t).initialize(s)}constructor(e,t){this._groupId=e,this._audioContext=t,this._initialized=!1,this._audioNode=void 0,this._timestamp=performance.now(),this._guiModuleUrl=void 0,this._descriptorUrl="./descriptor.json",this._descriptor={identifier:"com.webaudiomodule.default",name:`WebAudioModule_${this.constructor.name}`,vendor:"WebAudioModuleVendor",description:"",version:"0.0.0",apiVersion:"2.0.0",thumbnail:"",keywords:[],isInstrument:!1,website:"",hasAudioInput:!0,hasAudioOutput:!0,hasAutomationInput:!0,hasAutomationOutput:!0,hasMidiInput:!0,hasMidiOutput:!0,hasMpeInput:!0,hasMpeOutput:!0,hasOscInput:!0,hasOscOutput:!0,hasSysexInput:!0,hasSysexOutput:!0}}get isWebAudioModule(){return!0}get groupId(){return this._groupId}get moduleId(){return this.descriptor.identifier}get instanceId(){return this.moduleId+this._timestamp}get descriptor(){return this._descriptor}get identifier(){return this.descriptor.identifier}get name(){return this.descriptor.name}get vendor(){return this.descriptor.vendor}get audioContext(){return this._audioContext}get audioNode(){return this.initialized||console.warn("WAM should be initialized before getting the audioNode"),this._audioNode}set audioNode(e){this._audioNode=e}get initialized(){return this._initialized}set initialized(e){this._initialized=e}async createAudioNode(e){throw new TypeError("createAudioNode() not provided")}async initialize(e){return this._audioNode||(this.audioNode=await this.createAudioNode()),this.initialized=!0,this}async _loadGui(){const t=this._guiModuleUrl;if(!t)throw new TypeError("Gui module not found");return e(t)}async _loadDescriptor(){const e=this._descriptorUrl;if(!e)throw new TypeError("Descriptor not found");const t=await fetch(e),s=await t.json();return Object.assign(this._descriptor,s),this._descriptor}async createGui(){if(this.initialized||console.warn("Plugin should be initialized before getting the gui"),!this._guiModuleUrl)return;const{createElement:e}=await this._loadGui();return e(this)}destroyGui(){}},i=e=>{const t=globalThis;class s{static getStorageForCapacity(e,t){if(!t.BYTES_PER_ELEMENT)throw new Error("Pass in a ArrayBuffer subclass");const s=8+(e+1)*t.BYTES_PER_ELEMENT;return new SharedArrayBuffer(s)}constructor(e,t){if(!t.BYTES_PER_ELEMENT)throw new Error("Pass a concrete typed array class as second argument");this._Type=t,this._capacity=(e.byteLength-8)/t.BYTES_PER_ELEMENT,this.buf=e,this.write_ptr=new Uint32Array(this.buf,0,1),this.read_ptr=new Uint32Array(this.buf,4,1),this.storage=new t(this.buf,8,this._capacity)}get type(){return this._Type.name}push(e){const t=Atomics.load(this.read_ptr,0),s=Atomics.load(this.write_ptr,0);if((s+1)%this._storageCapacity()===t)return 0;const a=Math.min(this._availableWrite(t,s),e.length),r=Math.min(this._storageCapacity()-s,a),i=a-r;return this._copy(e,0,this.storage,s,r),this._copy(e,r,this.storage,0,i),Atomics.store(this.write_ptr,0,(s+a)%this._storageCapacity()),a}pop(e){const t=Atomics.load(this.read_ptr,0),s=Atomics.load(this.write_ptr,0);if(s===t)return 0;const a=!Number.isInteger(e),r=Math.min(this._availableRead(t,s),a?e.length:e);if(a){const s=Math.min(this._storageCapacity()-t,r),a=r-s;this._copy(this.storage,t,e,0,s),this._copy(this.storage,0,e,s,a)}return Atomics.store(this.read_ptr,0,(t+r)%this._storageCapacity()),r}get empty(){const e=Atomics.load(this.read_ptr,0);return Atomics.load(this.write_ptr,0)===e}get full(){const e=Atomics.load(this.read_ptr,0);return(Atomics.load(this.write_ptr,0)+1)%this._capacity!==e}get capacity(){return this._capacity-1}get availableRead(){const e=Atomics.load(this.read_ptr,0),t=Atomics.load(this.write_ptr,0);return this._availableRead(e,t)}get availableWrite(){const e=Atomics.load(this.read_ptr,0),t=Atomics.load(this.write_ptr,0);return this._availableWrite(e,t)}_availableRead(e,t){return t>e?t-e:t+this._storageCapacity()-e}_availableWrite(e,t){let s=e-t-1;return t>=e&&(s+=this._storageCapacity()),s}_storageCapacity(){return this._capacity}_copy(e,t,s,a,r){for(let i=0;i<r;i++)s[a+i]=e[t+i]}}if(t.AudioWorkletProcessor){const a=t.webAudioModules.getModuleScope(e);a.RingBuffer||(a.RingBuffer=s)}return s},n=e=>{const t=globalThis;class s{static DefaultArrayCapacity=2;static getStorageForEventCapacity(e,t,a,r){if(r=void 0===r?s.DefaultArrayCapacity:Math.max(r,s.DefaultArrayCapacity),!a.BYTES_PER_ELEMENT)throw new Error("Pass in a ArrayBuffer subclass");const i=t*r;return e.getStorageForCapacity(i,a)}constructor(e,t,a,r,i){if(!r.BYTES_PER_ELEMENT)throw new Error("Pass in a ArrayBuffer subclass");this._arrayLength=a,this._arrayType=r,this._arrayElementSizeBytes=r.BYTES_PER_ELEMENT,this._arraySizeBytes=this._arrayLength*this._arrayElementSizeBytes,this._sab=t,i=void 0===i?s.DefaultArrayCapacity:Math.max(i,s.DefaultArrayCapacity),this._arrayArray=new r(this._arrayLength),this._rb=new e(this._sab,r)}write(e){if(e.length!==this._arrayLength)return!1;if(this._rb.availableWrite<this._arrayLength)return!1;let t=!0;return this._rb.push(e)!=this._arrayLength&&(t=!1),t}read(e,t){if(e.length!==this._arrayLength)return!1;const s=this._rb.availableRead;if(s<this._arrayLength)return!1;t&&s>this._arrayLength&&this._rb.pop(s-this._arrayLength);let a=!1;return this._rb.pop(e)===this._arrayLength&&(a=!0),a}}if(t.AudioWorkletProcessor){const a=t.webAudioModules.getModuleScope(e);a.WamArrayRingBuffer||(a.WamArrayRingBuffer=s)}return s},o=e=>{const t=globalThis;if(t.AudioWorkletProcessor&&t.webAudioModules)return;const s=new Map,a=new Map;class r{constructor(){}get apiVersion(){return e}getModuleScope(e){return s.has(e)||s.set(e,{}),s.get(e)}getGroup(e,t){const s=a.get(e);if(s.validate(t))return s;throw"Invalid key"}addGroup(e){a.has(e.groupId)||a.set(e.groupId,e)}removeGroup(e){a.delete(e.groupId)}addWam(e){a.get(e.groupId).addWam(e)}removeWam(e){a.get(e.groupId).removeWam(e)}connectEvents(e,t,s,r=0){a.get(e).connectEvents(t,s,r)}disconnectEvents(e,t,s,r){a.get(e).disconnectEvents(t,s,r)}emitEvents(e,...t){a.get(e.groupId).emitEvents(e,...t)}}t.AudioWorkletProcessor&&(t.webAudioModules||(t.webAudioModules=new r))},l=(e,t)=>{const s=globalThis;s.AudioWorkletProcessor&&s.webAudioModules.addGroup(new class{constructor(e,t){this._groupId=e,this._validate=e=>e==t,this._processors=new Map,this._eventGraph=new Map}get groupId(){return this._groupId}get processors(){return this._processors}get eventGraph(){return this._eventGraph}validate(e){return this._validate(e)}addWam(e){this._processors.set(e.instanceId,e)}removeWam(e){this._eventGraph.has(e)&&this._eventGraph.delete(e),this._eventGraph.forEach((t=>{t.forEach((t=>{t&&t.has(e)&&t.delete(e)}))})),this._processors.delete(e.instanceId)}connectEvents(e,t,s){const a=this._processors.get(e),r=this._processors.get(t);let i;if(this._eventGraph.has(a)?i=this._eventGraph.get(a):(i=[],this._eventGraph.set(a,i)),i[s])i[s].add(r);else{const e=new Set;e.add(r),i[s]=e}}disconnectEvents(e,t,s){const a=this._processors.get(e);if(!this._eventGraph.has(a))return;const r=this._eventGraph.get(a);if(void 0===t)return void r.forEach((e=>{e&&e.clear()}));const i=this._processors.get(t);void 0!==s?r[s]&&r[s].delete(i):r.forEach((e=>{e&&e.delete(i)}))}emitEvents(e,...t){if(!this._eventGraph.has(e))return;this._eventGraph.get(e).forEach((e=>{e&&e.forEach((e=>e.scheduleEvents(...t)))}))}}(e,t))},u=e=>{const t=globalThis;class s{static DefaultExtraBytesPerEvent=64;static WamEventBaseBytes=13;static WamAutomationEventBytes=s.WamEventBaseBytes+2+8+1;static WamTransportEventBytes=s.WamEventBaseBytes+4+8+8+1+1+1;static WamMidiEventBytes=s.WamEventBaseBytes+1+1+1;static WamBinaryEventBytes=s.WamEventBaseBytes+4;static getStorageForEventCapacity(e,t,a){a=void 0===a?s.DefaultExtraBytesPerEvent:Math.max(a,s.DefaultExtraBytesPerEvent);const r=(Math.max(s.WamAutomationEventBytes,s.WamTransportEventBytes,s.WamMidiEventBytes,s.WamBinaryEventBytes)+a)*t;return e.getStorageForCapacity(r,Uint8Array)}constructor(e,t,a,r){this._eventSizeBytes={},this._encodeEventType={},this._decodeEventType={};["wam-automation","wam-transport","wam-midi","wam-sysex","wam-mpe","wam-osc","wam-info"].forEach(((e,t)=>{let a=0;switch(e){case"wam-automation":a=s.WamAutomationEventBytes;break;case"wam-transport":a=s.WamTransportEventBytes;break;case"wam-mpe":case"wam-midi":a=s.WamMidiEventBytes;break;case"wam-osc":case"wam-sysex":case"wam-info":a=s.WamBinaryEventBytes}this._eventSizeBytes[e]=a,this._encodeEventType[e]=t,this._decodeEventType[t]=e})),this._parameterCode=0,this._parameterCodes={},this._encodeParameterId={},this._decodeParameterId={},this.setParameterIds(a),this._sab=t,r=void 0===r?s.DefaultExtraBytesPerEvent:Math.max(r,s.DefaultExtraBytesPerEvent),this._eventBytesAvailable=Math.max(s.WamAutomationEventBytes,s.WamTransportEventBytes,s.WamMidiEventBytes,s.WamBinaryEventBytes)+r,this._eventBytes=new ArrayBuffer(this._eventBytesAvailable),this._eventBytesView=new DataView(this._eventBytes),this._rb=new e(this._sab,Uint8Array),this._eventSizeArray=new Uint8Array(this._eventBytes,0,4),this._eventSizeView=new DataView(this._eventBytes,0,4)}_writeHeader(e,t,s){let a=0;return this._eventBytesView.setUint32(a,e),a+=4,this._eventBytesView.setUint8(a,this._encodeEventType[t]),a+=1,this._eventBytesView.setFloat64(a,Number.isFinite(s)?s:-1),a+=8,a}_encode(e){let t=0;const{type:s,time:a}=e;switch(e.type){case"wam-automation":{if(!(e.data.id in this._encodeParameterId))break;const r=this._eventSizeBytes[s];t=this._writeHeader(r,s,a);const{data:i}=e,n=this._encodeParameterId[i.id],{value:o,normalized:l}=i;this._eventBytesView.setUint16(t,n),t+=2,this._eventBytesView.setFloat64(t,o),t+=8,this._eventBytesView.setUint8(t,l?1:0),t+=1}break;case"wam-transport":{const r=this._eventSizeBytes[s];t=this._writeHeader(r,s,a);const{data:i}=e,{currentBar:n,currentBarStarted:o,tempo:l,timeSigNumerator:u,timeSigDenominator:h,playing:c}=i;this._eventBytesView.setUint32(t,n),t+=4,this._eventBytesView.setFloat64(t,o),t+=8,this._eventBytesView.setFloat64(t,l),t+=8,this._eventBytesView.setUint8(t,u),t+=1,this._eventBytesView.setUint8(t,h),t+=1,this._eventBytesView.setUint8(t,c?1:0),t+=1}break;case"wam-mpe":case"wam-midi":{const r=this._eventSizeBytes[s];t=this._writeHeader(r,s,a);const{data:i}=e,{bytes:n}=i;let o=0;for(;o<3;)this._eventBytesView.setUint8(t,n[o]),t+=1,o++}break;case"wam-osc":case"wam-sysex":case"wam-info":{let r=null;if("wam-info"===e.type){const{data:t}=e;r=(new TextEncoder).encode(t.instanceId)}else{const{data:t}=e;r=t.bytes}const i=r.length,n=this._eventSizeBytes[s];t=this._writeHeader(n+i,s,a),this._eventBytesView.setUint32(t,i),t+=4;const o=t+i;o>this._eventBytesAvailable&&console.error(`Event requires ${o} bytes but only ${this._eventBytesAvailable} have been allocated!`);new Uint8Array(this._eventBytes,t,i).set(r),t+=i}}return new Uint8Array(this._eventBytes,0,t)}_decode(){let e=0;const t=this._decodeEventType[this._eventBytesView.getUint8(e)];e+=1;let s=this._eventBytesView.getFloat64(e);switch(-1===s&&(s=void 0),e+=8,t){case"wam-automation":{const a=this._eventBytesView.getUint16(e);e+=2;const r=this._eventBytesView.getFloat64(e);e+=8;const i=!!this._eventBytesView.getUint8(e);if(e+=1,!(a in this._decodeParameterId))break;return{type:t,time:s,data:{id:this._decodeParameterId[a],value:r,normalized:i}}}case"wam-transport":{const a=this._eventBytesView.getUint32(e);e+=4;const r=this._eventBytesView.getFloat64(e);e+=8;const i=this._eventBytesView.getFloat64(e);e+=8;const n=this._eventBytesView.getUint8(e);e+=1;const o=this._eventBytesView.getUint8(e);e+=1;const l=1==this._eventBytesView.getUint8(e);e+=1;return{type:t,time:s,data:{currentBar:a,currentBarStarted:r,tempo:i,timeSigNumerator:n,timeSigDenominator:o,playing:l}}}case"wam-mpe":case"wam-midi":{const a=[0,0,0];let r=0;for(;r<3;)a[r]=this._eventBytesView.getUint8(e),e+=1,r++;return{type:t,time:s,data:{bytes:a}}}case"wam-osc":case"wam-sysex":case"wam-info":{const a=this._eventBytesView.getUint32(e);e+=4;const r=new Uint8Array(a);if(r.set(new Uint8Array(this._eventBytes,e,a)),e+=a,"wam-info"===t){return{type:t,time:s,data:{instanceId:(new TextDecoder).decode(r)}}}return{type:t,time:s,data:{bytes:r}}}}return!1}write(...e){const t=e.length;let s=this._rb.availableWrite,a=0,r=0;for(;r<t;){const t=e[r],i=this._encode(t),n=i.byteLength;let o=0;if(!(s>=n))break;0===n?a++:o=this._rb.push(i),s-=o,r++}return r-a}read(){if(this._rb.empty)return[];const e=[];let t=this._rb.availableRead,s=0;for(;t>0;){s=this._rb.pop(this._eventSizeArray),t-=s;const a=this._eventSizeView.getUint32(0),r=new Uint8Array(this._eventBytes,0,a-4);s=this._rb.pop(r),t-=s;const i=this._decode();i&&e.push(i)}return e}setParameterIds(e){this._encodeParameterId={},this._decodeParameterId={},e.forEach((e=>{let t=-1;e in this._parameterCodes?t=this._parameterCodes[e]:(t=this._generateParameterCode(),this._parameterCodes[e]=t),this._encodeParameterId[e]=t,this._decodeParameterId[t]=e}))}_generateParameterCode(){if(this._parameterCode>65535)throw Error("Too many parameters have been registered!");return this._parameterCode++}}if(t.AudioWorkletProcessor){const a=t.webAudioModules.getModuleScope(e);a.WamEventRingBuffer||(a.WamEventRingBuffer=s)}return s},h=(e,t,...s)=>{const a=`(${t.toString()})(${s.map((e=>JSON.stringify(e))).join(", ")});`,r=URL.createObjectURL(new Blob([a],{type:"text/javascript"}));return e.addModule(r)},c=e=>{const t=globalThis;class s{constructor(e){this.info=e,this._value=e.defaultValue}set value(e){this._value=e}get value(){return this._value}set normalizedValue(e){this.value=this.info.denormalize(e)}get normalizedValue(){return this.info.normalize(this.value)}}if(t.AudioWorkletProcessor){const a=t.webAudioModules.getModuleScope(e);a.WamParameter||(a.WamParameter=s)}return s},d=e=>{const t=globalThis,s=(e,t)=>0===t?e:e**(1.5**-t),a=(e,t)=>0===t?e:e**(1.5**t);class r{constructor(e,t={}){let{type:s,label:a,defaultValue:r,minValue:i,maxValue:n,discreteStep:o,exponent:l,choices:u,units:h}=t;void 0===s&&(s="float"),void 0===a&&(a=""),void 0===r&&(r=0),void 0===u&&(u=[]),"boolean"===s||"choice"===s?(o=1,i=0,n=u.length?u.length-1:1):(void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=0),void 0===l&&(l=0),void 0===h&&(h=""));const c=`Param config error | ${e}: `;if(i>=n)throw Error(c.concat("minValue must be less than maxValue"));if(m=n,!((d=r)>=i&&d<=m))throw Error(c.concat("defaultValue out of range"));var d,m;if(o%1||o<0)throw Error(c.concat("discreteStep must be a non-negative integer"));if(o>0&&(i%1||n%1||r%1))throw Error(c.concat("non-zero discreteStep requires integer minValue, maxValue, and defaultValue"));if("choice"===s&&!u.length)throw Error(c.concat("choice type parameter requires list of strings in choices"));this.id=e,this.label=a,this.type=s,this.defaultValue=r,this.minValue=i,this.maxValue=n,this.discreteStep=o,this.exponent=l,this.choices=u,this.units=h}normalize(e){return((e,t,a,r=0)=>s(0===t&&1===a?e:(e-t)/(a-t)||0,r))(e,this.minValue,this.maxValue,this.exponent)}denormalize(e){return((e,t,s,r=0)=>0===t&&1===s?a(e,r):a(e,r)*(s-t)+t)(e,this.minValue,this.maxValue,this.exponent)}valueString(e){return this.choices?this.choices[e]:""!==this.units?`${e} ${this.units}`:`${e}`}}if(t.AudioWorkletProcessor){const s=t.webAudioModules.getModuleScope(e);s.WamParameterInfo||(s.WamParameterInfo=r)}return r},m=e=>{const t=globalThis;class s{static _tables;static _tableReferences;constructor(e,t,a=0){s._tables||(s._tables={nullTableKey:new Float32Array(0)},s._tableReferences={nullTableKey:[]}),this.info=e,this.values=new Float32Array(128),this._tableKey="0_0",this._table=s._tables[this._tableKey],this._skew=2;const{discreteStep:r}=e;this._discrete=!!r,this._N=this._discrete?0:t,this._n=0,this._startValue=e.defaultValue,this._endValue=e.defaultValue,this._currentValue=e.defaultValue,this._deltaValue=0,this._inverted=!1,this._changed=!0,this._filled=0,this._discrete?this._skew=0:this.setSkew(a),this.setStartValue(this._startValue)}_removeTableReference(e){if("0_0"===e)return;const{id:t}=this.info,a=s._tableReferences[e];if(a){const r=a.indexOf(t);-1!==r&&a.splice(r,1),0===a.length&&(delete s._tables[e],delete s._tableReferences[e])}}setSkew(e){if(this._skew===e||this._discrete)return;if(e<-1||e>1)throw Error("skew must be in range [-1.0, 1.0]");const t=[this._N,e].join("_"),a=this._tableKey,{id:r}=this.info;if(t!==a){if(s._tables[t]){const e=s._tableReferences[t];e?e.push(r):s._tableReferences[t]=[r]}else{let a=Math.abs(e);a=Math.pow(3-a,a*(a+2));const i=1===a,n=this._N,o=new Float32Array(n+1);if(i)for(let e=0;e<=n;++e)o[e]=e/n;else for(let e=0;e<=n;++e)o[e]=(e/n)**a;s._tables[t]=o,s._tableReferences[t]=[r]}this._removeTableReference(a),this._skew=e,this._tableKey=t,this._table=s._tables[this._tableKey]}}setStartValue(e,t=!0){this._n=this._N,this._startValue=e,this._endValue=e,this._currentValue=e,this._deltaValue=0,this._inverted=!1,t?(this.values.fill(e),this._changed=!0,this._filled=this.values.length):(this._changed=!1,this._filled=0)}setEndValue(e){e!==this._endValue&&(this._n=0,this._startValue=this._currentValue,this._endValue=e,this._deltaValue=this._endValue-this._startValue,this._inverted=this._deltaValue>0&&this._skew>=0||this._deltaValue<=0&&this._skew<0,this._changed=!1,this._filled=0)}process(e,t){if(this.done)return;const s=t-e;let a=0;const r=this._N-this._n;if(this._discrete||!r)a=s;else{if(r<s&&(a=Math.min(s-r,128),t-=a),t>e)if(this._inverted)for(let s=e;s<t;++s){const e=1-this._table[this._N-++this._n];this.values[s]=this._startValue+e*this._deltaValue}else for(let s=e;s<t;++s){const e=this._table[++this._n];this.values[s]=this._startValue+e*this._deltaValue}a>0&&(e=t,t+=a)}a>0&&(this.values.fill(this._endValue,e,t),this._filled+=a),this._currentValue=this.values[t-1],this._n===this._N&&(this._changed?this._filled>=this.values.length&&(this.setStartValue(this._endValue,!1),this._changed=!0,this._filled=this.values.length):this._changed=!0)}get done(){return this._changed&&this._filled===this.values.length}is(e){return this._endValue===e&&this.done}destroy(){this._removeTableReference(this._tableKey)}}if(t.AudioWorkletProcessor){const a=t.webAudioModules.getModuleScope(e);a.WamParameterInterpolator||(a.WamParameterInterpolator=s)}return s},p=e=>{const t=globalThis,{AudioWorkletProcessor:s,webAudioModules:a}=t,r=t.webAudioModules.getModuleScope(e),{RingBuffer:i,WamEventRingBuffer:n,WamParameter:o,WamParameterInterpolator:l}=r;class u extends s{constructor(e){super();const{groupId:t,moduleId:s,instanceId:r,useSab:i}=e.processorOptions;if(!s)throw Error("must provide moduleId argument in processorOptions!");if(!r)throw Error("must provide instanceId argument in processorOptions!");this.groupId=t,this.moduleId=s,this.instanceId=r,this._samplesPerQuantum=128,this._compensationDelay=0,this._parameterInfo={},this._parameterState={},this._parameterInterpolators={},this._eventQueue=[],this._pendingResponses={},this._useSab=!!i&&!!globalThis.SharedArrayBuffer,this._eventSabReady=!1,this._audioToMainEventSab=null,this._mainToAudioEventSab=null,this._eventWriter=null,this._eventReader=null,this._initialized=!1,this._destroyed=!1,a.addWam(this),this.port.onmessage=this._onMessage.bind(this),this._useSab&&this._configureSab()}getCompensationDelay(){return this._compensationDelay}scheduleEvents(...e){let t=0;for(;t<e.length;)this._eventQueue.push({id:0,event:e[t]}),t++}emitEvents(...e){a.emitEvents(this,...e)}clearEvents(){this._eventQueue=[]}process(e,t,s){if(!this._initialized)return!0;if(this._destroyed)return!1;this._eventSabReady&&this.scheduleEvents(...this._eventReader.read());const a=this._getProcessingSlices();let r=0;for(;r<a.length;){const{range:i,events:n}=a[r],[o,l]=i;let u=0;for(;u<n.length;)this._processEvent(n[u]),u++;this._interpolateParameterValues(o,l),this._process(o,l,e,t,s),r++}return!0}destroy(){this._destroyed=!0,this.port.close(),a.removeWam(this)}_generateWamParameterInfo(){return{}}_initialize(){this._parameterState={},this._parameterInterpolators={},this._parameterInfo=this._generateWamParameterInfo(),Object.keys(this._parameterInfo).forEach((e=>{const t=this._parameterInfo[e];this._parameterState[e]=new o(this._parameterInfo[e]),this._parameterInterpolators[e]=new l(t,256)}))}_configureSab(){const e=Object.keys(this._parameterInfo);this._eventSabReady&&(this._eventWriter.setParameterIds(e),this._eventReader.setParameterIds(e)),this.port.postMessage({eventSab:{eventCapacity:1024,parameterIds:e}})}async _onMessage(e){if(e.data.request){const{id:t,request:s,content:a}=e.data,r={id:t,response:s},o=s.split("/"),l=o[0],u=o[1];if(r.content="error","get"===l)if("parameterInfo"===u){let{parameterIds:e}=a;e.length||(e=Object.keys(this._parameterInfo));const t={};let s=0;for(;s<e.length;){const a=e[s];t[a]=this._parameterInfo[a],s++}r.content=t}else if("parameterValues"===u){let{normalized:e,parameterIds:t}=a;r.content=this._getParameterValues(e,t)}else"state"===u?r.content=this._getState():"compensationDelay"===u&&(r.content=this.getCompensationDelay());else if("set"===l){if("parameterValues"===u){const{parameterValues:e}=a;this._setParameterValues(e,!0),delete r.content}else if("state"===u){const{state:e}=a;this._setState(e),delete r.content}}else if("add"===l){if("event"===u){const{event:e}=a;return void this._eventQueue.push({id:t,event:e})}}else if("remove"===l){if("events"===u){const e=this._eventQueue.map((e=>e.id));this.clearEvents(),r.content=e}}else if("connect"===l){if("events"===u){const{wamInstanceId:e,output:t}=a;this._connectEvents(e,t),delete r.content}}else if("disconnect"===l){if("events"===u){const{wamInstanceId:e,output:t}=a;this._disconnectEvents(e,t),delete r.content}}else if("initialize"===l)if("processor"===u)this._initialize(),this._initialized=!0,delete r.content;else if("eventSab"===u){const{mainToAudioEventSab:e,audioToMainEventSab:t}=a;this._audioToMainEventSab=t,this._mainToAudioEventSab=e;const s=Object.keys(this._parameterInfo);this._eventWriter=new n(i,this._audioToMainEventSab,s),this._eventReader=new n(i,this._mainToAudioEventSab,s),this._eventSabReady=!0,delete r.content}this.port.postMessage(r)}else e.data.destroy&&this.destroy()}_onTransport(e){console.error("_onTransport not implemented!")}_onMidi(e){console.error("_onMidi not implemented!")}_onSysex(e){console.error("_onMidi not implemented!")}_onMpe(e){console.error("_onMpe not implemented!")}_onOsc(e){console.error("_onOsc not implemented!")}_setState(e){e.parameterValues&&this._setParameterValues(e.parameterValues,!1)}_getState(){return{parameterValues:this._getParameterValues(!1)}}_getParameterValues(e,t){const s={};t&&t.length||(t=Object.keys(this._parameterState));let a=0;for(;a<t.length;){const r=t[a],i=this._parameterState[r];s[r]={id:r,value:e?i.normalizedValue:i.value,normalized:e},a++}return s}_setParameterValues(e,t){const s=Object.keys(e);let a=0;for(;a<s.length;)this._setParameterValue(e[s[a]],t),a++}_setParameterValue(e,t){const{id:s,value:a,normalized:r}=e,i=this._parameterState[s];if(!i)return;r?i.normalizedValue=a:i.value=a;const n=this._parameterInterpolators[s];t?n.setEndValue(i.value):n.setStartValue(i.value)}_interpolateParameterValues(e,t){const s=Object.keys(this._parameterInterpolators);let a=0;for(;a<s.length;)this._parameterInterpolators[s[a]].process(e,t),a++}_connectEvents(e,t){a.connectEvents(this.groupId,this.instanceId,e,t)}_disconnectEvents(e,t){void 0!==e?a.disconnectEvents(this.groupId,this.instanceId,e,t):a.disconnectEvents(this.groupId,this.instanceId)}_getProcessingSlices(){const{currentTime:e,sampleRate:s}=t,a={};let r=0;for(;r<this._eventQueue.length;){const{id:t,event:i}=this._eventQueue[r],n=i.time-e,o=n>0?Math.round(n*s):0;if(!(o<this._samplesPerQuantum))break;a[o]?a[o].push(i):a[o]=[i],t?this.port.postMessage({id:t,response:"add/event"}):this._eventSabReady?this._eventWriter.write(i):this.port.postMessage({event:i}),this._eventQueue.shift(),r=-1,r++}const i=[],n=Object.keys(a);"0"!==n[0]&&(n.unshift("0"),a[0]=[]);const o=n.length-1;for(r=0;r<n.length;){const e=n[r],t=parseInt(e),s=r<o?parseInt(n[r+1]):this._samplesPerQuantum;i.push({range:[t,s],events:a[e]}),r++}return i}_processEvent(e){switch(e.type){case"wam-automation":this._setParameterValue(e.data,!0);break;case"wam-transport":this._onTransport(e.data);break;case"wam-midi":this._onMidi(e.data);break;case"wam-sysex":this._onSysex(e.data);break;case"wam-mpe":this._onMpe(e.data);break;case"wam-osc":this._onOsc(e.data)}}_process(e,t,s,a,r){console.error("_process not implemented!")}}return t.AudioWorkletProcessor&&(r.WamProcessor||(r.WamProcessor=u)),u},_=i(),g=u(),f=class extends AudioWorkletNode{static async addModules(e,t){const{audioWorklet:s}=e;await h(s,i,t),await h(s,u,t),await h(s,n,t),await h(s,c,t),await h(s,d,t),await h(s,m,t),await h(s,p,t)}constructor(e,t){const{audioContext:s,groupId:a,moduleId:r,instanceId:i}=e;t.processorOptions={groupId:a,moduleId:r,instanceId:i,...t.processorOptions},super(s,r,t),this.module=e,this._supportedEventTypes=new Set(["wam-automation","wam-transport","wam-midi","wam-sysex","wam-mpe","wam-osc"]),this._messageId=1,this._pendingResponses={},this._pendingEvents={},this._useSab=!1,this._eventSabReady=!1,this._destroyed=!1,this.port.onmessage=this._onMessage.bind(this)}get groupId(){return this.module.groupId}get moduleId(){return this.module.moduleId}get instanceId(){return this.module.instanceId}async getParameterInfo(...e){const t=this._generateMessageId();return new Promise((s=>{this._pendingResponses[t]=s,this.port.postMessage({id:t,request:"get/parameterInfo",content:{parameterIds:e}})}))}async getParameterValues(e,...t){const s=this._generateMessageId();return new Promise((a=>{this._pendingResponses[s]=a,this.port.postMessage({id:s,request:"get/parameterValues",content:{normalized:e,parameterIds:t}})}))}async setParameterValues(e){const t=this._generateMessageId();return new Promise((s=>{this._pendingResponses[t]=s,this.port.postMessage({id:t,request:"set/parameterValues",content:{parameterValues:e}})}))}async getState(){const e=this._generateMessageId();return new Promise((t=>{this._pendingResponses[e]=t,this.port.postMessage({id:e,request:"get/state"})}))}async setState(e){const t=this._generateMessageId();return new Promise((s=>{this._pendingResponses[t]=s,this.port.postMessage({id:t,request:"set/state",content:{state:e}})}))}async getCompensationDelay(){const e=this._generateMessageId();return new Promise((t=>{this._pendingResponses[e]=t,this.port.postMessage({id:e,request:"get/compensationDelay"})}))}addEventListener(e,t,s){this._supportedEventTypes.has(e)&&super.addEventListener(e,t,s)}removeEventListener(e,t,s){this._supportedEventTypes.has(e)&&super.removeEventListener(e,t,s)}scheduleEvents(...e){let t=0;const s=e.length;for(this._eventSabReady&&(t=this._eventWriter.write(...e));t<s;){const s=e[t],a="add/event",r=this._generateMessageId();let i=!1;new Promise(((e,t)=>{this._pendingResponses[r]=e,this._pendingEvents[r]=()=>{i||t()},this.port.postMessage({id:r,request:a,content:{event:s}})})).then((e=>{i=!0,delete this._pendingEvents[r],this._onEvent(s)})).catch((e=>{delete this._pendingResponses[r]})),t++}}async clearEvents(){const e=this._generateMessageId();if(Object.keys(this._pendingEvents).length)return new Promise((t=>{this._pendingResponses[e]=t,this.port.postMessage({id:e,request:"remove/events"})})).then((e=>{e.forEach((e=>{this._pendingEvents[e](),delete this._pendingEvents[e]}))}))}connectEvents(e,t){const s=this._generateMessageId();new Promise(((a,r)=>{this._pendingResponses[s]=a,this.port.postMessage({id:s,request:"connect/events",content:{wamInstanceId:e,output:t}})}))}disconnectEvents(e,t){const s=this._generateMessageId();new Promise(((a,r)=>{this._pendingResponses[s]=a,this.port.postMessage({id:s,request:"disconnect/events",content:{wamInstanceId:e,output:t}})}))}destroy(){this._audioToMainInterval&&clearInterval(this._audioToMainInterval),this.port.postMessage({destroy:!0}),this.port.close(),this.disconnect(),this._destroyed=!0}_generateMessageId(){return this._messageId++}async _initialize(){const e=this._generateMessageId();return new Promise((t=>{this._pendingResponses[e]=t,this.port.postMessage({id:e,request:"initialize/processor"})}))}_onMessage(e){const{data:t}=e,{response:s,event:a,eventSab:r}=t;if(s){const{id:e,content:s}=t,a=this._pendingResponses[e];a&&(delete this._pendingResponses[e],a(s))}else if(r){this._useSab=!0;const{eventCapacity:e,parameterIds:t}=r;if(this._eventSabReady)return this._eventWriter.setParameterIds(t),void this._eventReader.setParameterIds(t);this._mainToAudioEventSab=g.getStorageForEventCapacity(_,e),this._audioToMainEventSab=g.getStorageForEventCapacity(_,e),this._eventWriter=new g(_,this._mainToAudioEventSab,t),this._eventReader=new g(_,this._audioToMainEventSab,t);const s="initialize/eventSab",a=this._generateMessageId();new Promise(((e,t)=>{this._pendingResponses[a]=e,this.port.postMessage({id:a,request:s,content:{mainToAudioEventSab:this._mainToAudioEventSab,audioToMainEventSab:this._audioToMainEventSab}})})).then((e=>{this._eventSabReady=!0,this._audioToMainInterval=setInterval((()=>{this._eventReader.read().forEach((e=>{this._onEvent(e)}))}),100)}))}else a&&this._onEvent(a)}_onEvent(e){const{type:t}=e;this.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:e}))}},v="2.0.0-alpha.6",y=async(e,t=`wam-host-${performance.now().toString()}`,s=performance.now().toString())=>(await h(e.audioWorklet,o,v),await h(e.audioWorklet,l,t,s),[t,s])},{"@parcel/transformer-js/src/esmodule-helpers.js":"14tkN"}],iUHts:[function(e,t,s){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(s),a.export(s,"CompositeAudioNode",(()=>m)),a.export(s,"ParamMgrFactory",(()=>w));var r=Object.defineProperty,i=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,h=(e,t,s)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,c=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&h(e,s,t[s]);if(o)for(var s of o(t))u.call(t,s)&&h(e,s,t[s]);return e},d=(e,t,s)=>(h(e,"symbol"!=typeof t?t+"":t,s),s),m=class extends GainNode{constructor(){super(...arguments),d(this,"_output"),d(this,"_wamNode")}get groupId(){return this.module.groupId}get moduleId(){return this.module.moduleId}get instanceId(){return this.module.instanceId}get module(){return this._wamNode.module}addEventListener(...e){return this._wamNode.addEventListener(...e)}removeEventListener(...e){return this._wamNode.removeEventListener(...e)}dispatchEvent(...e){return this._wamNode.dispatchEvent(...e)}getParameterInfo(...e){return this._wamNode.getParameterInfo(...e)}getParameterValues(...e){return this._wamNode.getParameterValues(...e)}setParameterValues(...e){return this._wamNode.setParameterValues(...e)}getState(){return this._wamNode.getState()}setState(...e){return this._wamNode.setState(...e)}getCompensationDelay(){return this._wamNode.getCompensationDelay()}scheduleEvents(...e){return this._wamNode.scheduleEvents(...e)}clearEvents(){return this._wamNode.clearEvents()}connectEvents(...e){return this._wamNode.connectEvents(...e)}disconnectEvents(...e){return this._wamNode.disconnectEvents(...e)}destroy(){return this._wamNode.destroy()}set channelCount(e){this._output?this._output.channelCount=e:super.channelCount=e}get channelCount(){return this._output?this._output.channelCount:super.channelCount}set channelCountMode(e){this._output?this._output.channelCountMode=e:super.channelCountMode=e}get channelCountMode(){return this._output?this._output.channelCountMode:super.channelCountMode}set channelInterpretation(e){this._output?this._output.channelInterpretation=e:super.channelInterpretation=e}get channelInterpretation(){return this._output?this._output.channelInterpretation:super.channelInterpretation}get numberOfInputs(){return super.numberOfInputs}get numberOfOutputs(){return this._output?this._output.numberOfOutputs:super.numberOfOutputs}get gain(){}connect(...e){return this._output&&this._output!==this?this._output.connect(...e):super.connect(...e)}disconnect(...e){return this._output&&this._output!==this?this._output.disconnect(...e):super.disconnect(...e)}},p=(e,t,...s)=>{const a=`(${t.toString()})(${s.map((e=>JSON.stringify(e))).join(", ")});`,r=URL.createObjectURL(new Blob([a],{type:"text/javascript"}));return e.addModule(r)},_=(e,t)=>{const s=globalThis,{AudioWorkletProcessor:a,registerProcessor:r,webAudioModules:i}=s,n=s.webAudioModules.getModuleScope(e),o=!!globalThis.SharedArrayBuffer,l=globalThis.SharedArrayBuffer||globalThis.ArrayBuffer,u=(e,t)=>0===t?e:e**(1.5**-t),h=(e,t,s,a=0)=>u(0===t&&1===s?e:(e-t)/(s-t)||0,a),c=(e,t,s)=>0===t&&1===s?e:(e-t)/(s-t)||0;class d extends a{static get parameterDescriptors(){return Object.entries(t).map((([e,{defaultValue:t,minValue:s,maxValue:a}])=>({name:e,defaultValue:t,minValue:s,maxValue:a})))}constructor(a){super(),this.destroyed=!1,this.supportSharedArrayBuffer=o;const{paramsMapping:r,internalParamsMinValues:i,internalParams:u,groupId:h,instanceId:c}=a.processorOptions;this.groupId=h,this.moduleId=e,this.instanceId=c,this.internalParamsMinValues=i,this.paramsConfig=t,this.paramsMapping=r,this.paramsValues={},Object.entries(t).forEach((([e,{defaultValue:t}])=>{this.paramsValues[e]=t})),this.internalParams=u,this.internalParamsCount=this.internalParams.length,this.buffer=new l((this.internalParamsCount+1)*Float32Array.BYTES_PER_ELEMENT),this.$lock=new Int32Array(this.buffer,0,1),this.$internalParamsBuffer=new Float32Array(this.buffer,4,this.internalParamsCount),this.eventQueue=[],this.handleEvent=null,s.webAudioModules.addWam(this),n.paramMgrProcessors||(n.paramMgrProcessors={}),n.paramMgrProcessors[this.instanceId]=this,this.messagePortRequestId=-1;const d={},m={};this.call=(e,...t)=>new Promise(((s,a)=>{const r=this.messagePortRequestId--;d[r]=s,m[r]=a,this.port.postMessage({id:r,call:e,args:t})})),this.handleMessage=({data:e})=>{var t,s;const{id:a,call:r,args:i,value:n,error:o}=e;if(r){const e={id:a};try{e.value=this[r](...i)}catch(t){e.error=t}this.port.postMessage(e)}else o?null==(t=m[a])||t.call(m,o):null==(s=d[a])||s.call(d,n),delete d[a],delete m[a]},this.port.start(),this.port.addEventListener("message",this.handleMessage)}setParamsMapping(e){this.paramsMapping=e}getBuffer(){return{lock:this.$lock,paramsBuffer:this.$internalParamsBuffer}}getCompensationDelay(){return 128}getParameterInfo(...e){0===e.length&&(e=Object.keys(this.paramsConfig));const t={};return e.forEach((e=>{t[e]=this.paramsConfig[e]})),t}getParameterValues(e,...t){0===t.length&&(t=Object.keys(this.paramsConfig));const s={};return t.forEach((t=>{if(!(t in this.paramsValues))return;const{minValue:a,maxValue:r,exponent:i}=this.paramsConfig[t],n=this.paramsValues[t];s[t]={id:t,value:e?h(n,a,r,i):n,normalized:e}})),s}scheduleEvents(...e){this.eventQueue.push(...e);const{currentTime:t}=s;this.eventQueue.sort(((e,s)=>(e.time||t)-(s.time||t)))}emitEvents(...e){i.emitEvents(this,...e)}clearEvents(){this.eventQueue=[]}lock(){globalThis.Atomics&&Atomics.store(this.$lock,0,1)}unlock(){globalThis.Atomics&&Atomics.store(this.$lock,0,0)}process(e,t,a){if(this.destroyed)return!1;this.lock(),Object.entries(this.paramsConfig).forEach((([e,{minValue:s,maxValue:r}])=>{const i=a[e];e in this.paramsValues&&(this.paramsValues[e]=i[i.length-1]),this.paramsMapping[e]&&Object.entries(this.paramsMapping[e]).forEach((([e,a])=>{const n=this.internalParams.indexOf(e);if(-1===n)return;const o=this.internalParamsMinValues[n],{sourceRange:l,targetRange:u}=a,[h,d]=l,[m,p]=u;let _;_=s!==m||r!==p||s!==h||r!==d?i.map((e=>{const t=((e,t,s,a,r,i,n)=>((e,t,s)=>0===t&&1===s?e:e*(s-t)+t)(c(c(Math.min(r,Math.max(a,e)),t,s),c(a,t,s),c(r,t,s)),i,n))(e,s,r,h,d,m,p);return t-o})):o?i.map((e=>e-o)):i,1===_.length?t[n+1][0].fill(_[0]):t[n+1][0].set(_),this.$internalParamsBuffer[n]=_[0]}))})),this.unlock(),this.supportSharedArrayBuffer||this.call("setBuffer",{lock:this.$lock,paramsBuffer:this.$internalParamsBuffer});const{currentTime:r}=s;let i;for(i=0;i<this.eventQueue.length;i++){const e=this.eventQueue[i];if(e.time&&e.time>r)break;"function"==typeof this.handleEvent&&this.handleEvent(e),this.call("dispatchWamEvent",e)}return i&&this.eventQueue.splice(0,i),!0}connectEvents(e,t){i.connectEvents(this.groupId,this.instanceId,e,t)}disconnectEvents(e,t){void 0!==e?i.disconnectEvents(this.groupId,this.instanceId,e,t):i.disconnectEvents(this.groupId,this.instanceId)}destroy(){s.webAudioModules.removeWam(this),n.paramMgrProcessors&&delete n.paramMgrProcessors[this.instanceId],this.destroyed=!0,this.port.close()}}try{r(e,d)}catch(e){console.warn(e)}},g=(e=>{const t=globalThis,s=(e,t)=>0===t?e:e**(1.5**-t),a=(e,t)=>0===t?e:e**(1.5**t);class r{constructor(e,t={}){let{type:s,label:a,defaultValue:r,minValue:i,maxValue:n,discreteStep:o,exponent:l,choices:u,units:h}=t;void 0===s&&(s="float"),void 0===a&&(a=""),void 0===r&&(r=0),void 0===u&&(u=[]),"boolean"===s||"choice"===s?(o=1,i=0,n=u.length?u.length-1:1):(void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=0),void 0===l&&(l=0),void 0===h&&(h=""));const c=`Param config error | ${e}: `;if(i>=n)throw Error(c.concat("minValue must be less than maxValue"));if(m=n,!((d=r)>=i&&d<=m))throw Error(c.concat("defaultValue out of range"));var d,m;if(o%1||o<0)throw Error(c.concat("discreteStep must be a non-negative integer"));if(o>0&&(i%1||n%1||r%1))throw Error(c.concat("non-zero discreteStep requires integer minValue, maxValue, and defaultValue"));if("choice"===s&&!u.length)throw Error(c.concat("choice type parameter requires list of strings in choices"));this.id=e,this.label=a,this.type=s,this.defaultValue=r,this.minValue=i,this.maxValue=n,this.discreteStep=o,this.exponent=l,this.choices=u,this.units=h}normalize(e){return((e,t,a,r=0)=>s(0===t&&1===a?e:(e-t)/(a-t)||0,r))(e,this.minValue,this.maxValue,this.exponent)}denormalize(e){return((e,t,s,r=0)=>0===t&&1===s?a(e,r):a(e,r)*(s-t)+t)(e,this.minValue,this.maxValue,this.exponent)}valueString(e){return this.choices?this.choices[e]:""!==this.units?`${e} ${this.units}`:`${e}`}}if(t.AudioWorkletProcessor){const s=t.webAudioModules.getModuleScope(e);s.WamParameterInfo||(s.WamParameterInfo=r)}return r})(),f=class extends AudioParam{constructor(){super(...arguments),d(this,"_info")}get exponent(){return this.info.exponent}get info(){return this._info}set info(e){this._info=e}set normalizedValue(e){this.value=this.info.denormalize(e)}get normalizedValue(){return this.info.normalize(this.value)}setValueAtTime(e,t){return super.setValueAtTime(e,t)}setNormalizedValueAtTime(e,t){const s=this.info.denormalize(e);return this.setValueAtTime(s,t)}linearRampToValueAtTime(e,t){return super.linearRampToValueAtTime(e,t)}linearRampToNormalizedValueAtTime(e,t){const s=this.info.denormalize(e);return this.linearRampToValueAtTime(s,t)}exponentialRampToValueAtTime(e,t){return super.exponentialRampToValueAtTime(e,t)}exponentialRampToNormalizedValueAtTime(e,t){const s=this.info.denormalize(e);return this.exponentialRampToValueAtTime(s,t)}setTargetAtTime(e,t,s){return super.setTargetAtTime(e,t,s)}setNormalizedTargetAtTime(e,t,s){const a=this.info.denormalize(e);return this.setTargetAtTime(a,t,s)}setValueCurveAtTime(e,t,s){return super.setValueCurveAtTime(e,t,s)}setNormalizedValueCurveAtTime(e,t,s){const a=Array.from(e).map((e=>this.info.denormalize(e)));return this.setValueCurveAtTime(a,t,s)}cancelScheduledParamValues(e){return super.cancelScheduledValues(e)}cancelAndHoldParamAtTime(e){return super.cancelAndHoldAtTime(e)}},v=globalThis.AudioWorkletNode,y=class extends v{constructor(e,t){super(e.audioContext,e.moduleId,{numberOfInputs:0,numberOfOutputs:1+t.processorOptions.internalParams.length,parameterData:t.parameterData,processorOptions:t.processorOptions}),d(this,"requestDispatchIParamChange",(e=>{const t=this.internalParamsConfig[e];if(!("onChange"in t))return;const{automationRate:s,onChange:a}=t;if("number"!=typeof s||!s)return;const r=1e3/s,i=this.internalParams.indexOf(e);-1!==i&&(i>=this.internalParams.length||("number"==typeof this.paramsUpdateCheckFnRef[i]&&window.clearTimeout(this.paramsUpdateCheckFnRef[i]),this.paramsUpdateCheckFn[i]=()=>{const e=this.$prevParamsBuffer[i],t=this.$paramsBuffer[i];t!==e&&(a(t,e),this.$prevParamsBuffer[i]=t),this.paramsUpdateCheckFnRef[i]=window.setTimeout(this.paramsUpdateCheckFn[i],r)},this.paramsUpdateCheckFn[i]()))}));const{processorOptions:s,internalParamsConfig:a}=t;this.initialized=!1,this.module=e,this.instanceId=t.processorOptions.instanceId,this.groupId=t.processorOptions.groupId,this.paramsConfig=s.paramsConfig,this.internalParams=s.internalParams,this.internalParamsConfig=a,this.$prevParamsBuffer=new Float32Array(this.internalParams.length),this.paramsUpdateCheckFn=[],this.paramsUpdateCheckFnRef=[],this.messageRequestId=0,Object.entries(this.getParams()).forEach((([e,t])=>{Object.setPrototypeOf(t,f.prototype),t._info=this.paramsConfig[e]}));const r={},i={};this.call=(e,...t)=>{const s=this.messageRequestId;return this.messageRequestId+=1,new Promise(((a,n)=>{r[s]=a,i[s]=n,this.port.postMessage({id:s,call:e,args:t})}))},this.handleMessage=({data:e})=>{var t,s;const{id:a,call:n,args:o,value:l,error:u}=e;if(n){const e={id:a};try{e.value=this[n](...o)}catch(t){e.error=t}this.port.postMessage(e)}else u?null==(t=i[a])||t.call(i,u):null==(s=r[a])||s.call(r,l),delete r[a],delete i[a]},this.port.start(),this.port.addEventListener("message",this.handleMessage)}get parameters(){return super.parameters}get moduleId(){return this.module.moduleId}async initialize(){const e=await this.call("getBuffer"),{lock:t,paramsBuffer:s}=e;this.$lock=t,this.$paramsBuffer=s;return Object.entries(this.internalParamsConfig).forEach((([e,t],s)=>{if("suspended"===this.context.state&&(this.$paramsBuffer[s]=t.defaultValue),t instanceof AudioParam)try{t.automationRate="a-rate"}catch(e){}finally{t.value=Math.max(0,t.minValue),this.connect(t,1+s)}else t instanceof AudioNode?this.connect(t,1+s):this.requestDispatchIParamChange(e)})),this.connect(this.module.audioContext.destination,0,0),this.initialized=!0,this}setBuffer({lock:e,paramsBuffer:t}){this.$lock=e,this.$paramsBuffer=t}setParamsMapping(e){return this.call("setParamsMapping",e)}getCompensationDelay(){return this.call("getCompensationDelay")}getParameterInfo(...e){return this.call("getParameterInfo",...e)}getParameterValues(e,...t){return this.call("getParameterValues",e,...t)}scheduleAutomation(e){const t=e.time||this.context.currentTime,{id:s,normalized:a,value:r}=e.data,i=this.getParam(s);i&&("float"===i.info.type?a?i.linearRampToNormalizedValueAtTime(r,t):i.linearRampToValueAtTime(r,t):a?i.setNormalizedValueAtTime(r,t):i.setValueAtTime(r,t))}scheduleEvents(...e){e.forEach((e=>{"wam-automation"===e.type&&this.scheduleAutomation(e)})),this.call("scheduleEvents",...e)}emitEvents(...e){this.call("emitEvents",...e)}clearEvents(){this.call("clearEvents")}dispatchWamEvent(e){"wam-automation"===e.type?this.scheduleAutomation(e):this.dispatchEvent(new CustomEvent(e.type,{detail:e}))}async setParameterValues(e){Object.keys(e).forEach((t=>{const s=e[t],a=this.parameters.get(t);a&&(s.normalized?a.normalizedValue=s.value:a.value=s.value)}))}async getState(){return this.getParamsValues()}async setState(e){this.setParamsValues(e)}convertTimeToFrame(e){return Math.round(e*this.context.sampleRate)}convertFrameToTime(e){return e/this.context.sampleRate}getIParamIndex(e){const t=this.internalParams.indexOf(e);return-1===t?null:t}connectIParam(e,t,s){const a=this.getIParamIndex(e);null!==a&&(t instanceof AudioNode&&"number"==typeof s?this.connect(t,1+a,s):this.connect(t,1+a))}disconnectIParam(e,t,s){const a=this.getIParamIndex(e);null!==a&&(t instanceof AudioNode&&"number"==typeof s?this.disconnect(t,1+a,s):this.disconnect(t,1+a))}getIParamValue(e){const t=this.getIParamIndex(e);return null!==t?this.$paramsBuffer[t]:null}getIParamsValues(){const e={};return this.internalParams.forEach(((t,s)=>{e[t]=this.$paramsBuffer[s]})),e}getParam(e){return this.parameters.get(e)||null}getParams(){return Object.fromEntries(this.parameters)}getParamValue(e){const t=this.parameters.get(e);return t?t.value:null}setParamValue(e,t){const s=this.parameters.get(e);s&&(s.value=t)}getParamsValues(){const e={};return this.parameters.forEach(((t,s)=>{e[s]=t.value})),e}setParamsValues(e){e&&Object.entries(e).forEach((([e,t])=>{this.setParamValue(e,t)}))}getNormalizedParamValue(e){const t=this.parameters.get(e);return t?t.normalizedValue:null}setNormalizedParamValue(e,t){const s=this.parameters.get(e);s&&(s.normalizedValue=t)}getNormalizedParamsValues(){const e={};return this.parameters.forEach(((t,s)=>{e[s]=this.getNormalizedParamValue(s)})),e}setNormalizedParamsValues(e){e&&Object.entries(e).forEach((([e,t])=>{this.setNormalizedParamValue(e,t)}))}setParamValueAtTime(e,t,s){const a=this.parameters.get(e);return a?a.setValueAtTime(t,s):null}setNormalizedParamValueAtTime(e,t,s){const a=this.parameters.get(e);return a?a.setNormalizedValueAtTime(t,s):null}linearRampToParamValueAtTime(e,t,s){const a=this.parameters.get(e);return a?a.linearRampToValueAtTime(t,s):null}linearRampToNormalizedParamValueAtTime(e,t,s){const a=this.parameters.get(e);return a?a.linearRampToNormalizedValueAtTime(t,s):null}exponentialRampToParamValueAtTime(e,t,s){const a=this.parameters.get(e);return a?a.exponentialRampToValueAtTime(t,s):null}exponentialRampToNormalizedParamValueAtTime(e,t,s){const a=this.parameters.get(e);return a?a.exponentialRampToNormalizedValueAtTime(t,s):null}setParamTargetAtTime(e,t,s,a){const r=this.parameters.get(e);return r?r.setTargetAtTime(t,s,a):null}setNormalizedParamTargetAtTime(e,t,s,a){const r=this.parameters.get(e);return r?r.setNormalizedTargetAtTime(t,s,a):null}setParamValueCurveAtTime(e,t,s,a){const r=this.parameters.get(e);return r?r.setValueCurveAtTime(t,s,a):null}setNormalizedParamValueCurveAtTime(e,t,s,a){const r=this.parameters.get(e);return r?r.setNormalizedValueCurveAtTime(t,s,a):null}cancelScheduledParamValues(e,t){const s=this.parameters.get(e);return s?s.cancelScheduledValues(t):null}cancelAndHoldParamAtTime(e,t){const s=this.parameters.get(e);return s?s.cancelAndHoldAtTime(t):null}connectEvents(e,t){this.call("connectEvents",e,t)}disconnectEvents(e,t){this.call("disconnectEvents",e,t)}async destroy(){this.disconnect(),this.paramsUpdateCheckFnRef.forEach((e=>{"number"==typeof e&&window.clearTimeout(e)})),await this.call("destroy"),this.port.close()}},w=class{static async create(e,t={}){const{audioContext:s,moduleId:a}=e,r=t.instanceId||e.instanceId,o=t.groupId||e.groupId,{paramsConfig:l,paramsMapping:u,internalParamsConfig:h}=new class{constructor(e={}){d(this,"_paramsConfig"),d(this,"_internalParamsConfig"),d(this,"_paramsMapping",{});const{paramsConfig:t,paramsMapping:s,internalParamsConfig:a}=e;this._paramsConfig=t,this._paramsMapping=s,this._internalParamsConfig=a}get paramsConfig(){const{internalParamsConfig:e}=this;return Object.entries(this._paramsConfig||e).reduce(((t,[s,a])=>{var r,o,l,u;const h=e[s];var d,m;return t[s]=new g(s,(d=c({},a),m={label:null!=(r=a.label)?r:s,defaultValue:null!=(o=a.defaultValue)?o:null==h?void 0:h.defaultValue,minValue:null!=(l=a.minValue)?l:null==h?void 0:h.minValue,maxValue:null!=(u=a.maxValue)?u:null==h?void 0:h.maxValue},i(d,n(m)))),t}),{})}get internalParamsConfig(){return Object.entries(this._internalParamsConfig||{}).reduce(((e,[t,s])=>{if(s instanceof AudioParam)e[t]=s;else{const a={minValue:0,maxValue:1,defaultValue:0,automationRate:30};e[t]=c(c({},a),s)}return e}),{})}get paramsMapping(){const e=this._paramsMapping||{},t=this.paramsConfig,s=this.internalParamsConfig;return Object.entries(t).reduce(((t,[a,{minValue:r,maxValue:i}])=>{const n=[r,i],o={sourceRange:n,targetRange:[...n]};if(e[a]){const r=Object.entries(e[a]).reduce(((e,[t,a])=>(s[t]&&(e[t]=c(c({},o),a)),e)),{});t[a]=r}else s[a]&&(t[a]={[a]:c({},o)});return t}),{})}}(t),m=Object.entries(l).reduce(((e,[t,{defaultValue:s}])=>(e[t]=s,e)),{}),f=Object.entries(l).reduce(((e,[t,{id:s,label:a,type:r,defaultValue:i,minValue:n,maxValue:o,discreteStep:l,exponent:u,choices:h,units:c}])=>(e[t]={id:s,label:a,type:r,defaultValue:i,minValue:n,maxValue:o,discreteStep:l,exponent:u,choices:h,units:c},e)),{});await p(s.audioWorklet,_,a,f);const v={internalParamsConfig:h,parameterData:m,processorOptions:{paramsConfig:l,paramsMapping:u,internalParamsMinValues:Object.values(h).map((e=>Math.max(0,(null==e?void 0:e.minValue)||0))),internalParams:Object.keys(h),groupId:o,instanceId:r,moduleId:a}},w=new y(e,v);return await w.initialize(),w}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"14tkN"}]},[],0,"parcelRequireaaed");