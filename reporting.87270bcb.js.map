{"mappings":"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","sources":["node_modules/@parcel/runtime-browser-hmr/lib/runtime-0439161b20ab48bb.js","source/reporting.js","node_modules/analytics/lib/analytics.browser.es.js","node_modules/@analytics/core/dist/client/analytics-core.module.js","node_modules/@analytics/src/vendor/redux/utils/defs.js","node_modules/@analytics/src/vendor/redux/createStore.js","node_modules/@analytics/src/vendor/redux/combineReducers.js","node_modules/@analytics/src/vendor/redux/compose.js","node_modules/@analytics/src/vendor/redux/applyMiddleware.js","node_modules/@analytics/src/constants.js","node_modules/@analytics/src/utils/internalConstants.js","node_modules/@analytics/src/events.js","node_modules/@analytics/src/middleware/initialize.js","node_modules/@analytics/src/modules/user.js","node_modules/@analytics/src/middleware/identify.js","node_modules/@analytics/src/utils/callback-stack.js","node_modules/@analytics/src/utils/waitForReady.js","node_modules/@analytics/src/utils/heartbeat.js","node_modules/@analytics/src/middleware/plugins/engine.js","node_modules/@analytics/src/middleware/plugins/index.js","node_modules/@analytics/src/utils/filterDisabled.js","node_modules/@analytics/src/middleware/storage.js","node_modules/@analytics/src/middleware/dynamic.js","node_modules/@analytics/src/modules/plugins.js","node_modules/@analytics/src/utils/serialize.js","node_modules/@analytics/src/modules/track.js","node_modules/@analytics/src/modules/queue.js","node_modules/@analytics/src/modules/page.js","node_modules/@analytics/src/modules/context.js","node_modules/@analytics/src/utils/getOSName/browser.js","node_modules/@analytics/src/utils/handleNetworkEvents.js","node_modules/@analytics/src/utils/debug.js","node_modules/@analytics/src/utils/ensureArray.js","node_modules/@analytics/src/utils/enrichMeta.js","node_modules/@analytics/src/utils/getCallback.js","node_modules/@analytics/src/utils/timestamp.js","node_modules/@analytics/src/index.js","node_modules/analytics-utils/dist/analytics-utils.module.js","node_modules/analytics-utils/src/decodeUri.js","node_modules/analytics-utils/src/getBrowserLocale.js","node_modules/analytics-utils/src/getTimeZone.js","node_modules/analytics-utils/src/isExternalReferrer.js","node_modules/analytics-utils/src/isScriptLoaded.js","node_modules/analytics-utils/src/paramsClean.js","node_modules/analytics-utils/src/paramsGet.js","node_modules/analytics-utils/src/paramsParse.js","node_modules/analytics-utils/src/paramsRemove.js","node_modules/analytics-utils/src/url.js","node_modules/analytics-utils/src/parseReferrer.js","node_modules/analytics-utils/src/uuid.js","node_modules/analytics-utils/src/throttle.js","node_modules/dlv/dist/dlv.umd.js","node_modules/dlv/index.js","node_modules/@analytics/type-utils/dist/analytics-util-types.module.js","node_modules/@analytics/type-utils/src/index.js","node_modules/@analytics/global-storage-utils/dist/analytics-util-global-storage.module.js","node_modules/@analytics/global-storage-utils/src/index.js","node_modules/@analytics/storage-utils/dist/analytics-util-storage.module.js","node_modules/@analytics/storage-utils/src/utils/parse.js","node_modules/@analytics/storage-utils/src/index.js","node_modules/@analytics/cookie-utils/dist/analytics-util-cookie.module.js","node_modules/@analytics/cookie-utils/src/index.js","node_modules/@analytics/localstorage-utils/dist/analytics-util-localstorage.module.js","node_modules/@analytics/localstorage-utils/src/index.js","node_modules/@analytics/session-storage-utils/dist/analytics-util-session-storage.module.js","node_modules/@analytics/session-storage-utils/src/index.js","node_modules/@analytics/google-analytics/lib/analytics-plugin-ga.browser.es.js"],"sourcesContent":["var HMR_HOST = null;var HMR_PORT = null;var HMR_SECURE = false;var HMR_ENV_HASH = \"d6ea1d42532a7575\";module.bundle.HMR_BUNDLE_ID = \"7cd9f9bb87270bcb\";\"use strict\";\n\n/* global HMR_HOST, HMR_PORT, HMR_ENV_HASH, HMR_SECURE, chrome, browser, __parcel__import__, __parcel__importScripts__, ServiceWorkerGlobalScope */\n/*::\nimport type {\n  HMRAsset,\n  HMRMessage,\n} from '@parcel/reporter-dev-server/src/HMRServer.js';\ninterface ParcelRequire {\n  (string): mixed;\n  cache: {|[string]: ParcelModule|};\n  hotData: {|[string]: mixed|};\n  Module: any;\n  parent: ?ParcelRequire;\n  isParcelRequire: true;\n  modules: {|[string]: [Function, {|[string]: string|}]|};\n  HMR_BUNDLE_ID: string;\n  root: ParcelRequire;\n}\ninterface ParcelModule {\n  hot: {|\n    data: mixed,\n    accept(cb: (Function) => void): void,\n    dispose(cb: (mixed) => void): void,\n    // accept(deps: Array<string> | string, cb: (Function) => void): void,\n    // decline(): void,\n    _acceptCallbacks: Array<(Function) => void>,\n    _disposeCallbacks: Array<(mixed) => void>,\n  |};\n}\ninterface ExtensionContext {\n  runtime: {|\n    reload(): void,\n    getURL(url: string): string;\n    getManifest(): {manifest_version: number, ...};\n  |};\n}\ndeclare var module: {bundle: ParcelRequire, ...};\ndeclare var HMR_HOST: string;\ndeclare var HMR_PORT: string;\ndeclare var HMR_ENV_HASH: string;\ndeclare var HMR_SECURE: boolean;\ndeclare var chrome: ExtensionContext;\ndeclare var browser: ExtensionContext;\ndeclare var __parcel__import__: (string) => Promise<void>;\ndeclare var __parcel__importScripts__: (string) => Promise<void>;\ndeclare var globalThis: typeof self;\ndeclare var ServiceWorkerGlobalScope: Object;\n*/\nvar OVERLAY_ID = '__parcel__error__overlay__';\nvar OldModule = module.bundle.Module;\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData[moduleName],\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n  module.bundle.hotData[moduleName] = undefined;\n}\nmodule.bundle.Module = Module;\nmodule.bundle.hotData = {};\nvar checkedAssets /*: {|[string]: boolean|} */, assetsToDispose /*: Array<[ParcelRequire, string]> */, assetsToAccept /*: Array<[ParcelRequire, string]> */;\n\nfunction getHostname() {\n  return HMR_HOST || (location.protocol.indexOf('http') === 0 ? location.hostname : 'localhost');\n}\nfunction getPort() {\n  return HMR_PORT || location.port;\n}\n\n// eslint-disable-next-line no-redeclare\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = getHostname();\n  var port = getPort();\n  var protocol = HMR_SECURE || location.protocol == 'https:' && !/localhost|127.0.0.1|0.0.0.0/.test(hostname) ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + (port ? ':' + port : '') + '/');\n\n  // Web extension context\n  var extCtx = typeof chrome === 'undefined' ? typeof browser === 'undefined' ? null : browser : chrome;\n\n  // Safari doesn't support sourceURL in error stacks.\n  // eval may also be disabled via CSP, so do a quick check.\n  var supportsSourceURL = false;\n  try {\n    (0, eval)('throw new Error(\"test\"); //# sourceURL=test.js');\n  } catch (err) {\n    supportsSourceURL = err.stack.includes('test.js');\n  }\n\n  // $FlowFixMe\n  ws.onmessage = async function (event /*: {data: string, ...} */) {\n    checkedAssets = {} /*: {|[string]: boolean|} */;\n    assetsToAccept = [];\n    assetsToDispose = [];\n    var data /*: HMRMessage */ = JSON.parse(event.data);\n    if (data.type === 'update') {\n      // Remove error overlay if there is one\n      if (typeof document !== 'undefined') {\n        removeErrorOverlay();\n      }\n      let assets = data.assets.filter(asset => asset.envHash === HMR_ENV_HASH);\n\n      // Handle HMR Update\n      let handled = assets.every(asset => {\n        return asset.type === 'css' || asset.type === 'js' && hmrAcceptCheck(module.bundle.root, asset.id, asset.depsByBundle);\n      });\n      if (handled) {\n        console.clear();\n\n        // Dispatch custom event so other runtimes (e.g React Refresh) are aware.\n        if (typeof window !== 'undefined' && typeof CustomEvent !== 'undefined') {\n          window.dispatchEvent(new CustomEvent('parcelhmraccept'));\n        }\n        await hmrApplyUpdates(assets);\n\n        // Dispose all old assets.\n        let processedAssets = {} /*: {|[string]: boolean|} */;\n        for (let i = 0; i < assetsToDispose.length; i++) {\n          let id = assetsToDispose[i][1];\n          if (!processedAssets[id]) {\n            hmrDispose(assetsToDispose[i][0], id);\n            processedAssets[id] = true;\n          }\n        }\n\n        // Run accept callbacks. This will also re-execute other disposed assets in topological order.\n        processedAssets = {};\n        for (let i = 0; i < assetsToAccept.length; i++) {\n          let id = assetsToAccept[i][1];\n          if (!processedAssets[id]) {\n            hmrAccept(assetsToAccept[i][0], id);\n            processedAssets[id] = true;\n          }\n        }\n      } else fullReload();\n    }\n    if (data.type === 'error') {\n      // Log parcel errors to console\n      for (let ansiDiagnostic of data.diagnostics.ansi) {\n        let stack = ansiDiagnostic.codeframe ? ansiDiagnostic.codeframe : ansiDiagnostic.stack;\n        console.error(' [parcel]: ' + ansiDiagnostic.message + '\\n' + stack + '\\n\\n' + ansiDiagnostic.hints.join('\\n'));\n      }\n      if (typeof document !== 'undefined') {\n        // Render the fancy html overlay\n        removeErrorOverlay();\n        var overlay = createErrorOverlay(data.diagnostics.html);\n        // $FlowFixMe\n        document.body.appendChild(overlay);\n      }\n    }\n  };\n  ws.onerror = function (e) {\n    console.error(e.message);\n  };\n  ws.onclose = function () {\n    console.warn('[parcel]  Connection to the HMR server was lost');\n  };\n}\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n    console.log('[parcel]  Error resolved');\n  }\n}\nfunction createErrorOverlay(diagnostics) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n  let errorHTML = '<div style=\"background: black; opacity: 0.85; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; font-family: Menlo, Consolas, monospace; z-index: 9999;\">';\n  for (let diagnostic of diagnostics) {\n    let stack = diagnostic.frames.length ? diagnostic.frames.reduce((p, frame) => {\n      return `${p}\n<a href=\"/__parcel_launch_editor?file=${encodeURIComponent(frame.location)}\" style=\"text-decoration: underline; color: #888\" onclick=\"fetch(this.href); return false\">${frame.location}</a>\n${frame.code}`;\n    }, '') : diagnostic.stack;\n    errorHTML += `\n      <div>\n        <div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">\n           ${diagnostic.message}\n        </div>\n        <pre>${stack}</pre>\n        <div>\n          ${diagnostic.hints.map(hint => '<div> ' + hint + '</div>').join('')}\n        </div>\n        ${diagnostic.documentation ? `<div> <a style=\"color: violet\" href=\"${diagnostic.documentation}\" target=\"_blank\">Learn more</a></div>` : ''}\n      </div>\n    `;\n  }\n  errorHTML += '</div>';\n  overlay.innerHTML = errorHTML;\n  return overlay;\n}\nfunction fullReload() {\n  if ('reload' in location) {\n    location.reload();\n  } else if (extCtx && extCtx.runtime && extCtx.runtime.reload) {\n    extCtx.runtime.reload();\n  }\n}\nfunction getParents(bundle, id) /*: Array<[ParcelRequire, string]> */{\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n  var parents = [];\n  var k, d, dep;\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || Array.isArray(dep) && dep[dep.length - 1] === id) {\n        parents.push([bundle, k]);\n      }\n    }\n  }\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n  return parents;\n}\nfunction updateLink(link) {\n  var href = link.getAttribute('href');\n  if (!href) {\n    return;\n  }\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    if (link.parentNode !== null) {\n      // $FlowFixMe\n      link.parentNode.removeChild(link);\n    }\n  };\n  newLink.setAttribute('href',\n  // $FlowFixMe\n  href.split('?')[0] + '?' + Date.now());\n  // $FlowFixMe\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      // $FlowFixMe[incompatible-type]\n      var href /*: string */ = links[i].getAttribute('href');\n      var hostname = getHostname();\n      var servedFromHMRServer = hostname === 'localhost' ? new RegExp('^(https?:\\\\/\\\\/(0.0.0.0|127.0.0.1)|localhost):' + getPort()).test(href) : href.indexOf(hostname + ':' + getPort());\n      var absolute = /^https?:\\/\\//i.test(href) && href.indexOf(location.origin) !== 0 && !servedFromHMRServer;\n      if (!absolute) {\n        updateLink(links[i]);\n      }\n    }\n    cssTimeout = null;\n  }, 50);\n}\nfunction hmrDownload(asset) {\n  if (asset.type === 'js') {\n    if (typeof document !== 'undefined') {\n      let script = document.createElement('script');\n      script.src = asset.url + '?t=' + Date.now();\n      if (asset.outputFormat === 'esmodule') {\n        script.type = 'module';\n      }\n      return new Promise((resolve, reject) => {\n        var _document$head;\n        script.onload = () => resolve(script);\n        script.onerror = reject;\n        (_document$head = document.head) === null || _document$head === void 0 ? void 0 : _document$head.appendChild(script);\n      });\n    } else if (typeof importScripts === 'function') {\n      // Worker scripts\n      if (asset.outputFormat === 'esmodule') {\n        return __parcel__import__(asset.url + '?t=' + Date.now());\n      } else {\n        return new Promise((resolve, reject) => {\n          try {\n            __parcel__importScripts__(asset.url + '?t=' + Date.now());\n            resolve();\n          } catch (err) {\n            reject(err);\n          }\n        });\n      }\n    }\n  }\n}\nasync function hmrApplyUpdates(assets) {\n  global.parcelHotUpdate = Object.create(null);\n  let scriptsToRemove;\n  try {\n    // If sourceURL comments aren't supported in eval, we need to load\n    // the update from the dev server over HTTP so that stack traces\n    // are correct in errors/logs. This is much slower than eval, so\n    // we only do it if needed (currently just Safari).\n    // https://bugs.webkit.org/show_bug.cgi?id=137297\n    // This path is also taken if a CSP disallows eval.\n    if (!supportsSourceURL) {\n      let promises = assets.map(asset => {\n        var _hmrDownload;\n        return (_hmrDownload = hmrDownload(asset)) === null || _hmrDownload === void 0 ? void 0 : _hmrDownload.catch(err => {\n          // Web extension bugfix for Chromium\n          // https://bugs.chromium.org/p/chromium/issues/detail?id=1255412#c12\n          if (extCtx && extCtx.runtime && extCtx.runtime.getManifest().manifest_version == 3) {\n            if (typeof ServiceWorkerGlobalScope != 'undefined' && global instanceof ServiceWorkerGlobalScope) {\n              extCtx.runtime.reload();\n              return;\n            }\n            asset.url = extCtx.runtime.getURL('/__parcel_hmr_proxy__?url=' + encodeURIComponent(asset.url + '?t=' + Date.now()));\n            return hmrDownload(asset);\n          }\n          throw err;\n        });\n      });\n      scriptsToRemove = await Promise.all(promises);\n    }\n    assets.forEach(function (asset) {\n      hmrApply(module.bundle.root, asset);\n    });\n  } finally {\n    delete global.parcelHotUpdate;\n    if (scriptsToRemove) {\n      scriptsToRemove.forEach(script => {\n        if (script) {\n          var _document$head2;\n          (_document$head2 = document.head) === null || _document$head2 === void 0 ? void 0 : _document$head2.removeChild(script);\n        }\n      });\n    }\n  }\n}\nfunction hmrApply(bundle /*: ParcelRequire */, asset /*:  HMRAsset */) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n  if (asset.type === 'css') {\n    reloadCSS();\n  } else if (asset.type === 'js') {\n    let deps = asset.depsByBundle[bundle.HMR_BUNDLE_ID];\n    if (deps) {\n      if (modules[asset.id]) {\n        // Remove dependencies that are removed and will become orphaned.\n        // This is necessary so that if the asset is added back again, the cache is gone, and we prevent a full page reload.\n        let oldDeps = modules[asset.id][1];\n        for (let dep in oldDeps) {\n          if (!deps[dep] || deps[dep] !== oldDeps[dep]) {\n            let id = oldDeps[dep];\n            let parents = getParents(module.bundle.root, id);\n            if (parents.length === 1) {\n              hmrDelete(module.bundle.root, id);\n            }\n          }\n        }\n      }\n      if (supportsSourceURL) {\n        // Global eval. We would use `new Function` here but browser\n        // support for source maps is better with eval.\n        (0, eval)(asset.output);\n      }\n\n      // $FlowFixMe\n      let fn = global.parcelHotUpdate[asset.id];\n      modules[asset.id] = [fn, deps];\n    } else if (bundle.parent) {\n      hmrApply(bundle.parent, asset);\n    }\n  }\n}\nfunction hmrDelete(bundle, id) {\n  let modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n  if (modules[id]) {\n    // Collect dependencies that will become orphaned when this module is deleted.\n    let deps = modules[id][1];\n    let orphans = [];\n    for (let dep in deps) {\n      let parents = getParents(module.bundle.root, deps[dep]);\n      if (parents.length === 1) {\n        orphans.push(deps[dep]);\n      }\n    }\n\n    // Delete the module. This must be done before deleting dependencies in case of circular dependencies.\n    delete modules[id];\n    delete bundle.cache[id];\n\n    // Now delete the orphans.\n    orphans.forEach(id => {\n      hmrDelete(module.bundle.root, id);\n    });\n  } else if (bundle.parent) {\n    hmrDelete(bundle.parent, id);\n  }\n}\nfunction hmrAcceptCheck(bundle /*: ParcelRequire */, id /*: string */, depsByBundle /*: ?{ [string]: { [string]: string } }*/) {\n  if (hmrAcceptCheckOne(bundle, id, depsByBundle)) {\n    return true;\n  }\n\n  // Traverse parents breadth first. All possible ancestries must accept the HMR update, or we'll reload.\n  let parents = getParents(module.bundle.root, id);\n  let accepted = false;\n  while (parents.length > 0) {\n    let v = parents.shift();\n    let a = hmrAcceptCheckOne(v[0], v[1], null);\n    if (a) {\n      // If this parent accepts, stop traversing upward, but still consider siblings.\n      accepted = true;\n    } else {\n      // Otherwise, queue the parents in the next level upward.\n      let p = getParents(module.bundle.root, v[1]);\n      if (p.length === 0) {\n        // If there are no parents, then we've reached an entry without accepting. Reload.\n        accepted = false;\n        break;\n      }\n      parents.push(...p);\n    }\n  }\n  return accepted;\n}\nfunction hmrAcceptCheckOne(bundle /*: ParcelRequire */, id /*: string */, depsByBundle /*: ?{ [string]: { [string]: string } }*/) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n  if (depsByBundle && !depsByBundle[bundle.HMR_BUNDLE_ID]) {\n    // If we reached the root bundle without finding where the asset should go,\n    // there's nothing to do. Mark as \"accepted\" so we don't reload the page.\n    if (!bundle.parent) {\n      return true;\n    }\n    return hmrAcceptCheck(bundle.parent, id, depsByBundle);\n  }\n  if (checkedAssets[id]) {\n    return true;\n  }\n  checkedAssets[id] = true;\n  var cached = bundle.cache[id];\n  assetsToDispose.push([bundle, id]);\n  if (!cached || cached.hot && cached.hot._acceptCallbacks.length) {\n    assetsToAccept.push([bundle, id]);\n    return true;\n  }\n}\nfunction hmrDispose(bundle /*: ParcelRequire */, id /*: string */) {\n  var cached = bundle.cache[id];\n  bundle.hotData[id] = {};\n  if (cached && cached.hot) {\n    cached.hot.data = bundle.hotData[id];\n  }\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData[id]);\n    });\n  }\n  delete bundle.cache[id];\n}\nfunction hmrAccept(bundle /*: ParcelRequire */, id /*: string */) {\n  // Execute the module.\n  bundle(id);\n\n  // Run the accept callbacks in the new version of the module.\n  var cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      var assetsToAlsoAccept = cb(function () {\n        return getParents(module.bundle.root, id);\n      });\n      if (assetsToAlsoAccept && assetsToAccept.length) {\n        assetsToAlsoAccept.forEach(function (a) {\n          hmrDispose(a[0], a[1]);\n        });\n\n        // $FlowFixMe[method-unbinding]\n        assetsToAccept.push.apply(assetsToAccept, assetsToAlsoAccept);\n      }\n    });\n  }\n}","import Analytics from 'analytics'\r\nimport googleAnalytics from '@analytics/google-analytics'\r\n \r\nlet analytics\r\n\r\n/**\r\n * Create a new analytics instance for sending events\r\n * @param {String} name Unique name for the store cache\r\n * @param {id} id Unique Google ID\r\n */\r\nexport const setupReporting = (name=\"Interface\", id=\"G-1XT0GV0L6J\") => {\r\n\tanalytics = Analytics({\r\n\t\tapp: name,\r\n\t\tplugins: [\r\n\t\t\tgoogleAnalytics({\r\n\t\t\t\ttrackingId:id\r\n\t\t\t})\r\n\t\t]\r\n\t})\r\n\t\r\n\t// Track a page view \r\n\tanalytics.page()\r\n\t\r\n\treturn analytics\r\n\t\r\n\r\n\t// // Track a custom event \r\n\t// analytics.track('playedVideo', {\r\n\t// \tcategory: 'Videos',\r\n\t// \tlabel: 'Fall Campaign',\r\n\t// \tvalue: 42\r\n\t// })\r\n\t\r\n\t// // Identify a visitor\r\n\t// analytics.identify('user-id-xyz', {\r\n\t// \tfirstName: 'bill',\r\n\t// \tlastName: 'murray'\r\n\t// })\t\r\n}\r\n\r\n/**\r\n * Send a generic tracking event to Google Analytics\r\n * @param {String} name Tracking Name\r\n * @param {String} data Data to send\r\n */\r\nexport const track = (name, data) => {\r\n\tif (analytics)\r\n\t{\r\n\t\tanalytics.track(name, data)\t\t\r\n\t}\r\n}\r\n\r\n/**\r\n * Send a tracking event to Google Analytics to\r\n * signify that a user is laeving the site\r\n */\r\nexport const trackExit = () => {\r\n\t// // Track a custom event \r\n\t// analytics.track('playedVideo', {\r\n\t// \tcategory: 'Videos',\r\n\t// \tlabel: 'Fall Campaign',\r\n\t// \tvalue: 42\r\n\t// })\r\n}\r\n\r\n/**\r\n * Send a tracking event to Google Analytics of ERROR type\r\n * @param {String} error Short Error message\r\n * @param {Number} code Error Code\r\n * @param {String} category Error Category\r\n */\r\nexport const trackError = (error, code=42, category=\"Fails\") =>{ \r\n\tif (analytics)\r\n\t{\r\n\t\tanalytics.track('Error', {\r\n\t\t\tcategory:category,\r\n\t\t\tlabel:error,\r\n\t\t\tvalue:code\r\n\t\t})\t\t\r\n\t}\r\n}","import { Analytics } from '@analytics/core';\nexport { CONSTANTS, EVENTS } from '@analytics/core';\nimport storage from '@analytics/storage-utils';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction analyticsLib() {\n  var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var defaultSettings = {\n    storage: storage\n  };\n  return Analytics(_objectSpread2(_objectSpread2({}, defaultSettings), opts));\n}\n\nexport { analyticsLib as Analytics, analyticsLib as default, analyticsLib as init };\n",null,"export const FUNC = 'function'\nexport const UNDEF = 'undefined'\nexport const REDUCER = 'reducer'\n\nconst base = '@@redux/'\nexport const ACTION_INIT = base + 'INIT'\nexport const ACTION_TEST = base + Math.random().toString(36)\n","import { isObject } from '@analytics/type-utils'\nimport { FUNC, UNDEF, ACTION_INIT, REDUCER } from './utils/defs'\n\n// eslint-disable-next-line\nconst $$observable = /* #__PURE__ */ (() => (typeof Symbol === FUNC && Symbol.observable) || '@@observable')();\n\n/*\n * Creates a Redux store that holds the state tree.\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [preloadedState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is `applyMiddleware()`.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\nconst msg = ' != ' + FUNC\nexport default function createStore(reducer, preloadedState, enhancer) {\n  if (typeof preloadedState === FUNC && typeof enhancer === UNDEF) {\n    enhancer = preloadedState\n    preloadedState = undefined\n  }\n\n  if (typeof enhancer !== UNDEF) {\n    if (typeof enhancer !== FUNC) {\n      throw new Error('enhancer' + msg)\n    }\n\n    return enhancer(createStore)(reducer, preloadedState)\n  }\n\n  if (typeof reducer !== FUNC) {\n    throw new Error(REDUCER + msg)\n  }\n\n  let currentReducer = reducer\n  let currentState = preloadedState\n  let currentListeners = []\n  let nextListeners = currentListeners\n  let isDispatching = false\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice()\n    }\n  }\n\n  /*\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n  function getState() {\n    return currentState\n  }\n\n  /*\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n  function subscribe(listener) {\n    if (typeof listener !== FUNC) {\n      throw new Error('Listener' + msg)\n    }\n\n    let isSubscribed = true\n\n    ensureCanMutateNextListeners()\n    nextListeners.push(listener)\n\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return\n      }\n\n      isSubscribed = false\n\n      ensureCanMutateNextListeners()\n      const index = nextListeners.indexOf(listener)\n      nextListeners.splice(index, 1)\n    }\n  }\n\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing what changed. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n  function dispatch(action) {\n    /* // add default info to actions... \n    console.log('dispatch before', _action)\n    const action = {\n      ..._action,\n      ...{\n        action: {\n          ..._action.action,\n          ...{ customInfo: 'yoooo'} \n        }\n      }\n    }\n    console.log('dispatch after', action)\n    /** */\n\n    if (!isObject(action)) {\n      throw new Error('Act != obj')\n    }\n\n    if (typeof action.type === UNDEF) {\n      throw new Error('ActType ' + UNDEF)\n    }\n\n    if (isDispatching) {\n      throw new Error('Dispatch in ' + REDUCER)\n    }\n\n    try {\n      isDispatching = true\n      currentState = currentReducer(currentState, action)\n    } finally {\n      isDispatching = false\n    }\n\n    const listeners = currentListeners = nextListeners\n    for (let i = 0; i < listeners.length; i++) {\n      const listener = listeners[i]\n      listener()\n    }\n\n    return action\n  }\n\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== FUNC) {\n      throw new Error('next ' + REDUCER + msg)\n    }\n\n    currentReducer = nextReducer\n    dispatch({ type: ACTION_INIT })\n  }\n\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n  function observable() {\n    const outerSubscribe = subscribe\n    return {\n      /*\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe(observer) {\n        if (typeof observer !== 'object') {\n          throw new TypeError('Observer != obj')\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState())\n          }\n        }\n\n        observeState()\n        const unsubscribe = outerSubscribe(observeState)\n        return { unsubscribe }\n      },\n\n      [$$observable]() {\n        return this\n      }\n    }\n  }\n\n  // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n  dispatch({ type: ACTION_INIT })\n\n  return {\n    dispatch,\n    subscribe,\n    getState,\n    replaceReducer,\n    [$$observable]: observable\n  }\n}\n","import { isObject } from '@analytics/type-utils'\nimport warning from './utils/warning'\nimport { FUNC, UNDEF, REDUCER, ACTION_INIT, ACTION_TEST } from './utils/defs'\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  const actionType = action && action.type\n  const actionName = (actionType && actionType.toString()) || '?'\n\n  return ('action ' + actionName + REDUCER + ' ' + key + ' returns ' + UNDEF)\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  const reducerKeys = Object.keys(reducers)\n  const argumentName = action && action.type === ACTION_INIT ? 'preloadedState arg passed to createStore' : 'previous state received by ' + REDUCER\n\n  if (reducerKeys.length === 0) {\n    return ('Store has no valid reducers')\n  }\n\n  if (!isObject(inputState)) {\n    return (\n      `The ${argumentName} has unexpected type of \"` +\n      ({}).toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] +\n      `\". Expected argument to be an object with the following ` +\n      `keys: \"${reducerKeys.join('\", \"')}\"`\n    )\n  }\n\n  const unexpectedKeys = Object.keys(inputState).filter(key =>\n    !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key]\n  )\n\n  unexpectedKeys.forEach(key => {\n    unexpectedKeyCache[key] = true\n  })\n\n  if (unexpectedKeys.length > 0) {\n    return (\n      `Unexpected keys ${unexpectedKeys.join('\", \"')} in ${argumentName}. ` +\n      `Expected to find 1 of the known reducer keys instead: ${reducerKeys.join('\", \"')}`\n    )\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(key => {\n    const reducer = reducers[key]\n    const initialState = reducer(undefined, { type: ACTION_INIT })\n    if (\n      typeof initialState === UNDEF ||\n      typeof reducer(undefined, { type: ACTION_TEST }) === UNDEF\n    ) {\n      throw new Error(REDUCER + ' ' + key + ' ' + UNDEF)\n    }\n  })\n}\n\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\nexport default function combineReducers(reducers) {\n  const reducerKeys = Object.keys(reducers)\n  const finalReducers = {}\n  for (let i = 0; i < reducerKeys.length; i++) {\n    const key = reducerKeys[i]\n\n    if (NODE_ENV !== 'production') {\n      if (typeof reducers[key] === UNDEF) {\n        warning(`No reducer > ${key}`)\n      }\n    }\n\n    if (typeof reducers[key] === FUNC) {\n      finalReducers[key] = reducers[key]\n    }\n  }\n  const finalReducerKeys = Object.keys(finalReducers)\n\n  let unexpectedKeyCache\n  if (NODE_ENV !== 'production') {\n    unexpectedKeyCache = {}\n  }\n\n  let shapeAssertionError\n  try {\n    assertReducerShape(finalReducers)\n  } catch (e) {\n    shapeAssertionError = e\n  }\n\n  return function combination(state = {}, action) {\n    if (shapeAssertionError) {\n      throw shapeAssertionError\n    }\n\n    if (NODE_ENV !== 'production') {\n      const warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache)\n      if (warningMessage) {\n        warning(warningMessage)\n      }\n    }\n\n    let hasChanged = false\n    const nextState = {}\n    for (let i = 0; i < finalReducerKeys.length; i++) {\n      const key = finalReducerKeys[i]\n      const reducer = finalReducers[key]\n      const previousStateForKey = state[key]\n      const nextStateForKey = reducer(previousStateForKey, action)\n      if (typeof nextStateForKey === UNDEF) {\n        const errorMessage = getUndefinedStateErrorMessage(key, action)\n        throw new Error(errorMessage)\n      }\n      nextState[key] = nextStateForKey\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey\n    }\n    return hasChanged ? nextState : state\n  }\n}\n","/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\n\nexport default function compose(...funcs) {\n  if (funcs.length === 0) {\n    return arg => arg\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0]\n  }\n\n  return funcs.reduce((a, b) => (...args) => a(b(...args)))\n}\n","import compose from './compose'\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\nexport default function applyMiddleware(...middlewares) {\n  return (createStore) => (reducer, preloadedState, enhancer) => {\n    const store = createStore(reducer, preloadedState, enhancer)\n    let dispatch = store.dispatch\n    let chain = []\n\n    const middlewareAPI = {\n      getState: store.getState,\n      dispatch: (action) => dispatch(action)\n    }\n    chain = middlewares.map(middleware => middleware(middlewareAPI))\n    dispatch = compose(...chain)(store.dispatch)\n\n    return {\n      ...store,\n      dispatch\n    }\n  }\n}\n","/**\n * Core Analytic constants. These are exposed for third party plugins & listeners\n * @typedef {Object} constants\n * @property {ANON_ID} ANON_ID - Anonymous visitor Id localstorage key\n * @property {USER_ID} USER_ID - Visitor Id localstorage key\n * @property {USER_TRAITS} USER_TRAITS - Visitor traits localstorage key\n */\nimport { PREFIX } from '@analytics/type-utils'\n\n/**\n * Anonymous visitor Id localstorage key\n * @typedef {String} ANON_ID\n */\nexport const ANON_ID = PREFIX + 'anon_id' // __anon_id\n/**\n * Visitor Id localstorage key\n * @typedef {String} USER_ID\n */\nexport const USER_ID = PREFIX + 'user_id' // __user_id\n/**\n * Visitor traits localstorage key\n * @typedef {String} USER_TRAITS\n */\nexport const USER_TRAITS = PREFIX + 'user_traits' // __user_traits\n","\nexport const LIB_NAME = 'analytics'\n\nexport const ID = 'userId'\n\nexport const ANONID = 'anonymousId'\n\nexport const ERROR_URL = 'https://lytics.dev/errors/'","/* Core Analytic Events */\n\nexport const coreEvents = [\n  /**\n   * `bootstrap` - Fires when analytics library starts up.\n   * This is the first event fired. '.on/once' listeners are not allowed on bootstrap\n   * Plugins can attach logic to this event\n   */\n  'bootstrap',\n  /**\n   * `params` - Fires when analytics parses URL parameters\n   */\n  'params',\n  /**\n   * `campaign` - Fires if params contain \"utm\" parameters\n   */\n  'campaign',\n  /**\n   * `initializeStart` - Fires before 'initialize', allows for plugins to cancel loading of other plugins\n   */\n  'initializeStart',\n  /**\n   * `initialize` - Fires when analytics loads plugins\n   */\n  'initialize',\n  /**\n   * `initializeEnd` - Fires after initialize, allows for plugins to run logic after initialization methods run\n   */\n  'initializeEnd',\n  /**\n   * `ready` - Fires when all analytic providers are fully loaded. This waits for 'initialize' and 'loaded' to return true\n   */\n  'ready',\n  /**\n   * `resetStart` - Fires if analytic.reset() is called.\n   * Use this event to cancel reset based on a specific condition\n   */\n  'resetStart',\n  /**\n   * `reset` - Fires if analytic.reset() is called.\n   * Use this event to run custom cleanup logic (if needed)\n   */\n  'reset',\n  /**\n   * `resetEnd` - Fires after analytic.reset() is called.\n   * Use this event to run a callback after user data is reset\n   */\n  'resetEnd',\n  /******************\n   * Page Events\n   ******************/\n  /**\n   * `pageStart` - Fires before 'page' events fire.\n   *  This allows for dynamic page view cancellation based on current state of user or options passed in.\n   */\n  'pageStart',\n  /**\n   * `page` - Core analytics hook for page views.\n   *  If your plugin or integration tracks page views, this is the event to fire on.\n   */\n  'page',\n  /**\n   * `pageEnd` - Fires after all registered 'page' methods fire.\n   */\n  'pageEnd',\n  /**\n   * `pageAborted` - Fires if 'page' call is cancelled by a plugin\n   */\n  'pageAborted',\n  /****************\n   * Track Events\n   ***************/\n  /**\n   * `trackStart` - Called before the 'track' events fires.\n   *  This allows for dynamic page view cancellation based on current state of user or options passed in.\n   */\n  'trackStart',\n  /**\n   * `track` - Core analytics hook for event tracking.\n   *  If your plugin or integration tracks custom events, this is the event to fire on.\n   */\n  'track',\n  /**\n   * `trackEnd` - Fires after all registered 'track' events fire from plugins.\n   */\n  'trackEnd',\n  /**\n   * `trackAborted` - Fires if 'track' call is cancelled by a plugin\n   */\n  'trackAborted',\n  /******************\n   * Identify Events\n   ******************/\n  /**\n   * `identifyStart` - Called before the 'identify' events fires.\n   * This allows for dynamic page view cancellation based on current state of user or options passed in.\n   */\n  'identifyStart',\n  /**\n   * `identify` - Core analytics hook for user identification.\n   *  If your plugin or integration identifies users or user traits, this is the event to fire on.\n   */\n  'identify',\n  /**\n   * `identifyEnd` - Fires after all registered 'identify' events fire from plugins.\n   */\n  'identifyEnd',\n  /**\n   * `identifyAborted` - Fires if 'track' call is cancelled by a plugin\n   */\n  'identifyAborted',\n  /**\n   * `userIdChanged` - Fires when a user id is updated\n   */\n  'userIdChanged',\n  /******************\n   * Plugin Events\n   ******************/\n  /**\n   * `registerPlugins` - Fires when analytics is registering plugins\n   */\n  'registerPlugins',\n  /**\n   * `enablePlugin` - Fires when 'analytics.plugins.enable()' is called\n   */\n  'enablePlugin',\n  /**\n   * `disablePlugin` - Fires when 'analytics.plugins.disable()' is called\n   */\n  'disablePlugin',\n  /*\n   * `loadPlugin` - Fires when 'analytics.loadPlugin()' is called\n   */\n  // 'loadPlugin',\n  /******************\n   * Browser activity events\n   ******************/\n  /**\n   * `online` - Fires when browser network goes online.\n   * This fires only when coming back online from an offline state.\n   */\n  'online',\n  /**\n   * `offline` - Fires when browser network goes offline.\n   */\n  'offline',\n  /******************\n   * Storage events\n   ******************/\n  /**\n   * `setItemStart` - Fires when analytics.storage.setItem is initialized.\n   * This event gives plugins the ability to intercept keys & values and alter them before they are persisted.\n   */\n  'setItemStart',\n  /**\n   * `setItem` - Fires when analytics.storage.setItem is called.\n   * This event gives plugins the ability to intercept keys & values and alter them before they are persisted.\n   */\n  'setItem',\n  /**\n   * `setItemEnd` - Fires when setItem storage is complete.\n   */\n  'setItemEnd',\n  /**\n   * `setItemAborted` - Fires when setItem storage is cancelled by a plugin.\n   */\n  'setItemAborted',\n  /**\n   * `removeItemStart` - Fires when analytics.storage.removeItem is initialized.\n   * This event gives plugins the ability to intercept removeItem calls and abort / alter them.\n   */\n  'removeItemStart',\n  /**\n   * `removeItem` - Fires when analytics.storage.removeItem is called.\n   * This event gives plugins the ability to intercept removeItem calls and abort / alter them.\n   */\n  'removeItem',\n  /**\n   * `removeItemEnd` - Fires when removeItem storage is complete.\n   */\n  'removeItemEnd',\n  /**\n   * `removeItemAborted` - Fires when removeItem storage is cancelled by a plugin.\n   */\n  'removeItemAborted',\n]\n\n/* Keys on a plugin that are not considered events */\nexport const nonEvents = ['name', 'EVENTS', 'config', 'loaded']\n\nconst pluginEvents = {\n  registerPluginType: (name) => `registerPlugin:${name}`,\n  pluginReadyType: (name) => `ready:${name}`,\n}\n\nconst EVENTS = coreEvents.reduce((acc, curr) => {\n  acc[curr] = curr\n  return acc\n}, pluginEvents)\n\nexport default EVENTS\n\nexport function isReservedAction(type) {\n  return coreEvents.includes(type)\n}\n","/* eslint-disable camelcase */\nimport EVENTS from '../events'\nimport { ANON_ID, USER_ID, USER_TRAITS } from '../constants'\n\nconst utmRegex = /^utm_/\nconst propRegex = /^an_prop_/\nconst traitRegex = /^an_trait_/\n\n// Middleware runs during EVENTS.initialize\nexport default function initializeMiddleware(instance) {\n  const { setItem } = instance.storage\n  return store => next => action => {\n    /* Handle bootstrap event */\n    if (action.type === EVENTS.bootstrap) {\n      const { params, user, persistedUser, initialUser } = action\n      const isKnownId = persistedUser.userId === user.userId\n      /* 1. Set anonymous ID */\n      if (persistedUser.anonymousId !== user.anonymousId) {\n        setItem(ANON_ID, user.anonymousId)\n      }\n      /* 2. Set userId */\n      if (!isKnownId) {\n        setItem(USER_ID, user.userId)\n      }\n      /* 3. Set traits if they are different */\n      if (initialUser.traits) {\n         setItem(USER_TRAITS, {\n          ...(isKnownId && persistedUser.traits) ? persistedUser.traits : {},\n          ...initialUser.traits\n        })\n        /* TODO multi user setup\n        setItem(`${USER_TRAITS}.${user.userId}`, {\n          ...(isKnownId) ? existingTraits : {},\n          ...initialUser.traits\n        })\n        */\n      }\n      /* 4. Parse url params */\n      const paramsArray = Object.keys(action.params)\n      if (paramsArray.length) {\n        const { an_uid, an_event } = params\n        const groupedParams = paramsArray.reduce((acc, key) => {\n          // match utm params & dclid (display) & gclid (cpc)\n          if (key.match(utmRegex) || key.match(/^(d|g)clid/)) {\n            const cleanName = key.replace(utmRegex, '')\n            const keyName = (cleanName === 'campaign') ? 'name' : cleanName\n            acc.campaign[keyName] = params[key]\n          }\n          if (key.match(propRegex)) {\n            acc.props[key.replace(propRegex, '')] = params[key]\n          }\n          if (key.match(traitRegex)) {\n            acc.traits[key.replace(traitRegex, '')] = params[key]\n          }\n          return acc\n        }, {\n          campaign: {},\n          props: {},\n          traits: {}\n        })\n\n        store.dispatch({\n          type: EVENTS.params,\n          raw: params,\n          ...groupedParams,\n          ...(an_uid ? { userId: an_uid } : {}),\n        })\n\n        /* If userId set, call identify */\n        if (an_uid) {\n          // timeout to debounce and make sure integration is registered. Todo refactor\n          setTimeout(() => instance.identify(an_uid, groupedParams.traits), 0)\n        }\n\n        /* If tracking event set, call track */\n        if (an_event) {\n          // timeout to debounce and make sure integration is registered. Todo refactor\n          setTimeout(() => instance.track(an_event, groupedParams.props), 0)\n        }\n\n        // if url has utm params\n        if (Object.keys(groupedParams.campaign).length) {\n          store.dispatch({\n            type: EVENTS.campaign,\n            campaign: groupedParams.campaign\n          })\n        }\n      }\n    }\n    return next(action)\n  }\n}\n","import { get } from '@analytics/global-storage-utils'\nimport { isObject, PREFIX } from '@analytics/type-utils'\nimport { ANON_ID, USER_ID, USER_TRAITS } from '../constants'\nimport EVENTS from '../events'\n\n/* user reducer */\nexport default function userReducer(storage) {\n  return function user(state = {}, action = {}) {\n\n    if (action.type === EVENTS.setItemEnd) {\n      // Set anonymousId if changed by storage.setItem\n      if (action.key === ANON_ID) {\n        return { ...state, ...{ anonymousId: action.value }}\n      }\n      // Set userId if changed by storage.setItem\n      if (action.key === USER_ID) {\n        return { ...state, ...{ userId: action.value }}\n      }\n    }\n\n    switch (action.type) {\n      case EVENTS.identify:\n        return Object.assign({}, state, {\n          userId: action.userId,\n          traits: {\n            ...state.traits,\n            ...action.traits\n          }\n        })\n      case EVENTS.reset:\n        // Side effect to fix race condition in Node. TODO refactor\n        // This is from default storage.removeItem: (key) => globalContext[key] = undefined\n        [ USER_ID, ANON_ID, USER_TRAITS ].forEach((key) => {\n          // sync storage, not instance.storage\n          storage.removeItem(key)\n        })\n        return Object.assign({}, state, {\n          userId: null,\n          // TODO reset anon id automatically?\n          anonymousId: null,\n          traits: {},\n        })\n      default:\n        return state\n    }\n  }\n}\n\nexport function getPersistedUserData(storage) {\n  return {\n    userId: storage.getItem(USER_ID),\n    anonymousId: storage.getItem(ANON_ID),\n    traits: storage.getItem(USER_TRAITS)\n  }\n}\n\nexport const tempKey = (key) => PREFIX + 'TEMP' + PREFIX + key\n\nexport function getUserPropFunc(storage) {\n  return function getUserProp(key, instance, payload) {\n    /* 1. Try current state */\n    const currentId = instance.getState('user')[key]\n    if (currentId) {\n      /*\n      console.log(`from state ${key}`, currentId)\n      /** */\n      return currentId\n    }\n\n    /* 2. Try event payload */\n    if (payload && isObject(payload) && payload[key]) {\n      /*\n      console.log(`from payload ${key}`, payload[key])\n      /** */\n      return payload[key]\n    }\n\n    /* 3. Try persisted data */\n    const persistedInfo = getPersistedUserData(storage)[key]\n    if (persistedInfo) {\n      /*\n      console.log(`from persistedInfo ${key}`, persistedInfo)\n      /** */\n      return persistedInfo\n    }\n\n    /* 4. Else, try to get in memory placeholder. TODO watch this for future issues */\n    return get(tempKey(key)) || null\n  }\n}\n","import { uuid } from 'analytics-utils'\nimport { remove } from '@analytics/global-storage-utils'\nimport { tempKey } from '../modules/user'\nimport { USER_ID, USER_TRAITS, ANON_ID } from '../constants'\nimport { ID, ANONID } from '../utils/internalConstants'\nimport EVENTS from '../events'\n\nexport default function identifyMiddleware(instance) {\n  const { setItem, removeItem, getItem } = instance.storage\n  return store => next => action => {\n    const { userId, traits, options } = action\n    /* Reset user id and traits */\n    if (action.type === EVENTS.reset) {\n      // Remove stored data\n      [ USER_ID, USER_TRAITS, ANON_ID ].forEach((key) => {\n        // Fires async removeItem dispatch\n        removeItem(key)\n      });\n      [ ID, ANONID, 'traits' ].forEach((key) => {\n        // Remove from global context\n        remove(tempKey(key))\n      })\n    }\n\n    if (action.type === EVENTS.identify) {\n      /* If no anon id. Set it! */\n      if (!getItem(ANON_ID)) {\n        setItem(ANON_ID, uuid())\n      }\n\n      const currentId = getItem(USER_ID)\n      const currentTraits = getItem(USER_TRAITS) || {}\n\n      if (currentId && (currentId !== userId)) {\n        store.dispatch({\n          type: EVENTS.userIdChanged,\n          old: {\n            userId: currentId,\n            traits: currentTraits,\n          },\n          new: {\n            userId,\n            traits\n          },\n          options: options,\n        })\n      }\n\n      /* Save user id */\n      if (userId) {\n        setItem(USER_ID, userId)\n      }\n\n      /* Save user traits */\n      if (traits) {\n        setItem(USER_TRAITS, {\n          ...currentTraits,\n          ...traits\n        })\n      }\n    }\n    return next(action)\n  }\n}\n","import { isFunction } from '@analytics/type-utils'\n\n// Stack to temporarily hold deferred promises/callbacks\nconst stack = {}\n\nfunction runCallback(id, payload) {\n  if (stack[id] && isFunction(stack[id])) {\n    // console.log(`run ${id}`)\n    stack[id](payload)\n    delete stack[id]\n  }\n}\n\nexport { stack, runCallback }","/**\n * Wait until a given analytics provider is ready.\n * @param  {Object} data - passthrough resolve data\n * @param  {Function} predicate - function that resolves true\n * @param  {Number} timeout - max wait time\n * @return {Promise}\n */\nexport default function waitForReady(data, predicate, timeout) {\n  return new Promise((resolve, reject) => {\n    if (predicate()) {\n      return resolve(data)\n    }\n    // Timeout. Add to queue\n    if (timeout < 1) {\n      return reject({ ...data, queue: true }) // eslint-disable-line\n    }\n    // Else recursive retry\n    return pause(10).then(_ => {\n      return waitForReady(data, predicate, timeout - 10).then(resolve, reject)\n    })\n  })\n}\n\nfunction pause(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms))\n}\n","import { isFunction } from '@analytics/type-utils'\nimport { ID, ANONID } from './internalConstants'\n\nexport function processQueue(store, getPlugins, instance) {\n  const pluginMethods = getPlugins()\n  const { plugins, context, queue, user } = store.getState()\n  const isOnline = !context.offline\n  /* If network connection found and there is items in queue, process them all */\n  if (isOnline && queue && queue.actions && queue.actions.length) {\n    const pipeline = queue.actions.reduce((acc, item, index) => {\n      const isLoaded = plugins[item.plugin].loaded\n      if (isLoaded) {\n        acc.process.push(item)\n        acc.processIndex.push(index)\n      } else {\n        acc.requeue.push(item)\n        acc.requeueIndex.push(index)\n      }\n      return acc\n    }, {\n      processIndex: [],\n      process: [],\n      requeue: [],\n      requeueIndex: []\n    })\n\n    if (pipeline.processIndex && pipeline.processIndex.length) {\n      pipeline.processIndex.forEach((i) => {\n        const processAction = queue.actions[i]\n        // console.log('RePROCESS THIS>', processAction)\n        // Call methods directly right now\n        const currentPlugin = processAction.plugin\n        const currentMethod = processAction.payload.type\n        const method = pluginMethods[currentPlugin][currentMethod]\n        if (method && isFunction(method)) {\n          /* enrich queued payload with userId / anon id if missing */\n          /* TODO hoist enrich into where action queued? */\n          // console.log('before', processAction.payload)\n          const enrichedPayload = enrich(processAction.payload, user)\n          // console.log('user.userId', user.userId)\n          // console.log('user.anonymousId', user.anonymousId)\n          // console.log('after enrich', enrichedPayload)\n          method({\n            payload: enrichedPayload,\n            config: plugins[currentPlugin].config,\n            instance,\n          })\n\n          /* Then redispatch for .on listeners / other middleware */\n          const pluginEvent = `${currentMethod}:${currentPlugin}`\n          store.dispatch({\n            ...enrichedPayload,\n            type: pluginEvent,\n            /* Internal data for analytics engine */\n            _: {\n              called: pluginEvent,\n              from: 'queueDrain'\n            }\n          })\n        }\n      })\n\n      /* Removed processed actions */\n      const reQueueActions = queue.actions.filter((value, index) => {\n        // note !~ === return pipeline.processIndex.indexOf(index) === -1\n        return !~pipeline.processIndex.indexOf(index)\n      })\n\n      /* Set queue actions. TODO refactor to non mutatable or move out of redux */\n      queue.actions = reQueueActions\n    }\n  }\n}\n\n/* Heartbeat retries queued events */\nexport default function heartBeat(store, getPlugins, instance) {\n  // 3e3 === 3000 ms\n  return setInterval(() => processQueue(store, getPlugins, instance), 3e3)\n}\n\n// Assign userId && anonymousId values if present in payload but null\nfunction enrich(payload = {}, user = {}) {\n  return [ ID, ANONID ].reduce((acc, key) => {\n    if (payload.hasOwnProperty(key) && user[key] && (user[key] !== payload[key])) {\n      // console.log(`${key} stale update with ${user[key]}`)\n      acc[key] = user[key]\n    }\n    return acc\n  }, payload)\n}\n","import EVENTS from '../../events'\nimport fitlerDisabledPlugins from '../../utils/filterDisabled'\nimport { isFunction, isObject, isString } from '@analytics/type-utils'\nimport { runCallback } from '../../utils/callback-stack'\n\nconst endsWithStartRegex = /Start$/\nconst bootstrapRegex = /^bootstrap/\nconst readyRegex = /^ready/\n\nexport default async function (action, getPlugins, instance, store, eventsInfo) {\n  const pluginObject = isFunction(getPlugins) ? getPlugins() : getPlugins\n  const originalType = action.type\n  const updatedType = originalType.replace(endsWithStartRegex, '')\n\n  /* If action already dispatched exit early. This makes it so plugin methods are not fired twice. */\n  if (action._ && action._.called) {\n    // console.log('Already called', action._.called)\n    return action\n  }\n\n  const state = instance.getState()\n  /* Remove plugins that are disabled by options or by settings */\n  let activePlugins = fitlerDisabledPlugins(pluginObject, state.plugins, action.options)\n\n  /* If analytics.plugin.enable calls do special behavior */\n  if (originalType === EVENTS.initializeStart && action.fromEnable) {\n    // Return list of all enabled plugins that have NOT been initialized yet\n    activePlugins = Object.keys(state.plugins).filter((name) => {\n      const info = state.plugins[name]\n      return action.plugins.includes(name) && !info.initialized\n    }).map((name) => pluginObject[name])\n  }\n  // console.log(`engine activePlugins ${action.type}`, activePlugins)\n\n  const allActivePluginKeys = activePlugins.map((p) => p.name)\n  // console.log('allActivePluginKeys', allActivePluginKeys)\n  const allMatches = getAllMatchingCalls(originalType, activePlugins, pluginObject)\n  // console.log('allMatches', allMatches)\n\n  /* @TODO cache matches and purge on enable/disable/add plugin */\n\n  /**\n   * Process all 'actionBefore' hooks\n   * Example:\n   *  This is processes 'pageStart' methods from plugins and update the event to send through the chain\n   */\n  const actionBefore = await processEvent({\n    action: action,\n    data: {\n      exact: allMatches.before,\n      namespaced: allMatches.beforeNS\n    },\n    state: state,\n    allPlugins: pluginObject,\n    allMatches,\n    instance,\n    store,\n    EVENTS: eventsInfo\n  })\n  // console.log('____ actionBefore out', actionBefore)\n\n  /* Abort if eventBefore returns abort data */\n  if (shouldAbortAll(actionBefore, allActivePluginKeys.length)) {\n    return actionBefore\n  }\n\n  /* Filter over the plugin method calls and remove aborted plugin by name */\n  // const activeAndNonAbortedCalls = activePlugins.filter((plugin) => {\n  //   if (shouldAbort(actionBefore, plugin.name)) return false\n  //   return true\n  // })\n  // console.log(`activeAndNonAbortedCalls ${action.type}`, activeAndNonAbortedCalls)\n\n  let actionDuring\n  if (originalType === updatedType) {\n    /* If type the same don't double process */\n    actionDuring = actionBefore\n  } else {\n    /**\n     * Process all 'action' hooks\n     * Example: This is process 'page' methods from plugins and update the event to send through\n     */\n    actionDuring = await processEvent({\n      action: {\n        ...actionBefore,\n        type: updatedType\n      },\n      data: {\n        exact: allMatches.during,\n        namespaced: allMatches.duringNS\n      },\n      state: state,\n      allPlugins: pluginObject,\n      allMatches,\n      instance,\n      store,\n      EVENTS: eventsInfo\n    })\n  }\n  // console.log('____ actionDuring', actionDuring)\n\n  /**\n   * Process all 'actionEnd' hooks\n   * Example:\n   *  This is process 'pageEnd' methods from plugins and update the event to send through\n   */\n  // Only trigger `eventTypeEnd` if originalAction has Start ending.\n  if (originalType.match(endsWithStartRegex)) {\n    const afterName = `${updatedType}End`\n    const actionAfter = await processEvent({\n      action: {\n        ...actionDuring,\n        type: afterName\n      },\n      data: {\n        exact: allMatches.after,\n        namespaced: allMatches.afterNS\n      },\n      state: state,\n      allPlugins: pluginObject,\n      allMatches,\n      instance,\n      store,\n      EVENTS: eventsInfo\n    })\n    // console.log('____ actionAfter', actionAfter)\n\n    /* Fire callback if supplied */\n    if (actionAfter.meta && actionAfter.meta.hasCallback) {\n      /*\n      console.log('End of engine action has callback')\n      console.log(actionAfter.meta)\n      console.log('stack', stack)\n      /** */\n\n      // @TODO figure out exact args calls and .on will get\n      runCallback(actionAfter.meta.rid, { payload: actionAfter })\n    }\n  }\n\n  return actionBefore\n}\n\n/**\n * Async reduce over matched plugin methods\n * Fires plugin functions\n */\nasync function processEvent({\n  data,\n  action,\n  instance,\n  state,\n  allPlugins,\n  allMatches,\n  store,\n  EVENTS\n}) {\n  const { plugins, context } = state\n  const method = action.type\n  const isStartEvent = method.match(endsWithStartRegex)\n  // console.log(`data ${method}`, data)\n  // console.log(`data allMatches ${method}`, allMatches)\n  let abortable = data.exact.map((x) => {\n    return x.pluginName\n  })\n\n  /* If abort is called from xyzStart */\n  if (isStartEvent) {\n    abortable = allMatches.during.map((x) => {\n      return x.pluginName\n    })\n  }\n\n  /* make args for functions to concume */\n  const makeArgs = argumentFactory(instance, abortable)\n  // console.log('makeArgs', makeArgs)\n\n  /* Check if plugin loaded, if not mark action for queue */\n  const queueData = data.exact.reduce((acc, thing) => {\n    const { pluginName, methodName } = thing\n    let addToQueue = false\n    // Queue actions if plugin not loaded except for initialize and reset\n    if (!methodName.match(/^initialize/) && !methodName.match(/^reset/)) {\n      addToQueue = !plugins[pluginName].loaded\n    }\n    /* If offline and its a core method. Add to queue */\n    if (context.offline && (methodName.match(/^(page|track|identify)/))) {\n      addToQueue = true\n    }\n    acc[`${pluginName}`] = addToQueue\n    return acc\n  }, {})\n\n  /* generate plugin specific payloads */\n  const payloads = await data.exact.reduce(async (scoped, curr, i) => {\n    const { pluginName } = curr\n    const curScope = await scoped\n    if (data.namespaced && data.namespaced[pluginName]) {\n      const scopedPayload = await data.namespaced[pluginName].reduce(async (acc, p, count) => {\n        // await value\n        const curScopeData = await acc\n        if (!p.method || !isFunction(p.method)) {\n          return curScopeData\n        }\n\n        /* Make sure plugins dont call themselves */\n        validateMethod(p.methodName, p.pluginName)\n\n        function genAbort(currentAct, pname, otherPlug) {\n          return function (reason, plugins) {\n            const callsite = otherPlug || pname\n            // console.log(`__abort msg: ${reason}`)\n            // console.log(`__abort ${pname}`)\n            // console.log(`__abort xxx: ${plugins}`)\n            // console.log(`__abort otherPlug`, otherPlug)\n            return {\n              ...currentAct,\n              abort: {\n                reason: reason,\n                plugins: plugins || [pname],\n                caller: method,\n                from: callsite\n              }\n            }\n          }\n        }\n\n        const val = await p.method({\n          payload: curScopeData,\n          instance,\n          abort: genAbort(curScopeData, pluginName, p.pluginName),\n          config: getConfig(p.pluginName, plugins, allPlugins),\n          plugins: plugins\n        })\n        const returnValue = isObject(val) ? val : {}\n        return Promise.resolve({\n          ...curScopeData,\n          ...returnValue\n        })\n      }, Promise.resolve(action))\n\n      /* Set scoped payload */\n      curScope[pluginName] = scopedPayload\n    } else {\n      /* Set payload as default action */\n      curScope[pluginName] = action\n    }\n    return Promise.resolve(curScope)\n  }, Promise.resolve({}))\n  // console.log(`aaa scoped payloads ${action.type}`, payloads)\n\n  // Then call the normal methods with scoped payload\n  const resolvedAction = await data.exact.reduce(async (promise, curr, i) => {\n    const lastLoop = data.exact.length === (i + 1)\n    const { pluginName } = curr\n    const currentPlugin = allPlugins[pluginName]\n    const currentActionValue = await promise\n\n    let payloadValue = (payloads[pluginName]) ? payloads[pluginName] : {}\n    /* If eventStart, allow for value merging */\n    if (isStartEvent) {\n      payloadValue = currentActionValue\n    }\n\n    if (shouldAbort(payloadValue, pluginName)) {\n      // console.log(`> Abort from payload specific \"${pluginName}\" abort value`, payloadValue)\n      abortDispatch({\n        data: payloadValue,\n        method,\n        instance,\n        pluginName,\n        store\n      })\n      return Promise.resolve(currentActionValue)\n    }\n    if (shouldAbort(currentActionValue, pluginName)) {\n      // console.log(`> Abort from ${method} abort value`, currentActionValue)\n      if (lastLoop) {\n        abortDispatch({\n          data: currentActionValue,\n          method,\n          instance,\n          // pluginName,\n          store\n        })\n      }\n      return Promise.resolve(currentActionValue)\n    }\n\n    if (queueData.hasOwnProperty(pluginName) && queueData[pluginName] === true) {\n      // console.log('Queue this instead', pluginName)\n      store.dispatch({\n        type: `queue`,\n        plugin: pluginName,\n        payload: payloadValue,\n        /* Internal data for analytics engine */\n        _: {\n          called: `queue`,\n          from: 'queueMechanism' // for debugging\n        }\n      })\n      return Promise.resolve(currentActionValue)\n    }\n    /*\n    const checkForLoaded = () => {\n      const p = instance.getState('plugins')\n      return p[currentPlugin.name].loaded\n    }\n    // const p = instance.getState('plugins')\n    console.log(`loaded \"${currentPlugin.name}\" > ${method}:`, p[currentPlugin.name].loaded)\n    // await waitForReady(currentPlugin, checkForLoaded, 10000).then((d) => {\n    //   console.log(`Loaded ${method}`, currentPlugin.name)\n    // }).catch((e) => {\n    //   console.log(`Error ${method} ${currentPlugin.name}`, e)\n    //   // TODO dispatch failure\n    // })\n    */\n\n    // @TODO figure out if we want queuing semantics\n\n    const funcArgs = makeArgs(payloads[pluginName], allPlugins[pluginName])\n\n    // console.log(`funcArgs ${method} ${pluginName}`, funcArgs)\n\n    /* Run the plugin function */\n    const val = await currentPlugin[method]({\n      // currentPlugin: pluginName,\n      abort: funcArgs.abort,\n      // Send in original action value or scope payload\n      payload: payloadValue,\n      instance,\n      config: getConfig(pluginName, plugins, allPlugins),\n      plugins: plugins\n    })\n\n    const returnValue = isObject(val) ? val : {}\n    const merged = {\n      ...currentActionValue,\n      ...returnValue\n    }\n\n    const scopedPayload = payloads[pluginName] // || currentActionValue\n    if (shouldAbort(scopedPayload, pluginName)) {\n      // console.log(`>> HANDLE abort ${method} ${pluginName}`)\n      abortDispatch({\n        data: scopedPayload,\n        method,\n        instance,\n        pluginName,\n        store\n      })\n    } else {\n      const nameSpaceEvent = `${method}:${pluginName}`\n      const actionDepth = (nameSpaceEvent.match(/:/g) || []).length\n      if (actionDepth < 2 && !method.match(bootstrapRegex) && !method.match(readyRegex)) {\n        const updatedPayload = (isStartEvent) ? merged : payloadValue\n        // Dispatched for `.on('xyz') listeners.\n        instance.dispatch({\n          ...updatedPayload,\n          type: nameSpaceEvent,\n          _: {\n            called: nameSpaceEvent,\n            from: 'submethod'\n          }\n        })\n      }\n    }\n    // console.log('merged', merged)\n    return Promise.resolve(merged)\n  }, Promise.resolve(action))\n\n  // Dispatch End. Make sure actions don't get double dispatched. EG userIdChanged\n  if (!method.match(endsWithStartRegex) &&\n      !method.match(/^registerPlugin/) &&\n      // !method.match(/^disablePlugin/) &&\n      // !method.match(/^enablePlugin/) &&\n      !method.match(readyRegex) &&\n      !method.match(bootstrapRegex) &&\n      !method.match(/^params/) &&\n      !method.match(/^userIdChanged/)\n  ) {\n    if (EVENTS.plugins.includes(method)) {\n      // console.log(`Dont dispatch for ${method}`, resolvedAction)\n      // return resolvedAction\n    }\n    /*\n      Verify this original action setup.\n      It's intended to keep actions from double dispatching themselves\n    */\n    if (resolvedAction._ && resolvedAction._.originalAction === method) {\n      // console.log(`Dont dispatch for ${method}`, resolvedAction)\n      return resolvedAction\n    }\n\n    let endAction = {\n      ...resolvedAction,\n      ...{\n        _: {\n          originalAction: resolvedAction.type,\n          called: resolvedAction.type,\n          from: 'engineEnd'\n        }\n      }\n    }\n\n    /* If all plugins are aborted, dispatch xAborted */\n    if (shouldAbortAll(resolvedAction, data.exact.length) && !method.match(/End$/)) {\n      endAction = {\n        ...endAction,\n        ...{\n          type: resolvedAction.type + 'Aborted',\n        }\n      }\n    }\n\n    store.dispatch(endAction)\n  }\n\n  return resolvedAction\n}\n\nfunction abortDispatch({ data, method, instance, pluginName, store }) {\n  const postFix = (pluginName) ? ':' + pluginName : ''\n  const abortEvent = method + 'Aborted' + postFix\n  store.dispatch({\n    ...data,\n    type: abortEvent,\n    _: {\n      called: abortEvent,\n      from: 'abort'\n    }\n  })\n}\n\nfunction getConfig(name, pluginState, allPlugins) {\n  const pluginData = pluginState[name] || allPlugins[name]\n  if (pluginData && pluginData.config) {\n    return pluginData.config\n  }\n  return {}\n}\n\nfunction getPluginFunctions(methodName, plugins) {\n  return plugins.reduce((arr, plugin) => {\n    return (!plugin[methodName]) ? arr : arr.concat({\n      methodName: methodName,\n      pluginName: plugin.name,\n      method: plugin[methodName],\n    })\n  }, [])\n}\n\nfunction formatMethod(type) {\n  return type.replace(endsWithStartRegex, '')\n}\n\n/**\n * Return array of event names\n * @param  {String} eventType - original event type\n * @param  {String} namespace - optional namespace postfix\n * @return {array} - type, method, end\n */\nfunction getEventNames(eventType, namespace) {\n  const method = formatMethod(eventType)\n  const postFix = (namespace) ? `:${namespace}` : ''\n  // `typeStart:pluginName`\n  const type = `${eventType}${postFix}`\n  // `type:pluginName`\n  const methodName = `${method}${postFix}`\n  // `typeEnd:pluginName`\n  const end = `${method}End${postFix}`\n  return [ type, methodName, end ]\n}\n\n/* Collect all calls for a given event in the system */\nfunction getAllMatchingCalls(eventType, activePlugins, allPlugins) {\n  const eventNames = getEventNames(eventType)\n  // console.log('eventNames', eventNames)\n  // 'eventStart', 'event', & `eventEnd`\n  const core = eventNames.map((word) => {\n    return getPluginFunctions(word, activePlugins)\n  })\n  // Gather nameSpaced Events\n  return activePlugins.reduce((acc, plugin) => {\n    const { name } = plugin\n    const nameSpacedEvents = getEventNames(eventType, name)\n    // console.log('eventNames namespaced', nameSpacedEvents)\n    const [ beforeFuncs, duringFuncs, afterFuncs ] = nameSpacedEvents.map((word) => {\n      return getPluginFunctions(word, activePlugins)\n    })\n\n    if (beforeFuncs.length) {\n      acc.beforeNS[name] = beforeFuncs\n    }\n    if (duringFuncs.length) {\n      acc.duringNS[name] = duringFuncs\n    }\n    if (afterFuncs.length) {\n      acc.afterNS[name] = afterFuncs\n    }\n    return acc\n  }, {\n    before: core[0],\n    beforeNS: {},\n    during: core[1],\n    duringNS: {},\n    after: core[2],\n    afterNS: {}\n  })\n}\n\nfunction shouldAbort({ abort }, pluginName) {\n  if (!abort) return false\n  if (abort === true) return true\n  return includes(abort, pluginName) || (abort && includes(abort.plugins, pluginName))\n}\n\nfunction shouldAbortAll({ abort }, pluginsCount) {\n  if (!abort) return false\n  if (abort === true || isString(abort)) return true\n  const { plugins } = abort\n  return (isArray(abort) && (abort.length === pluginsCount)) || (isArray(plugins) && (plugins.length === pluginsCount))\n}\n\nfunction isArray(arr) {\n  return Array.isArray(arr)\n}\n\nfunction includes(arr, name) {\n  if (!arr || !isArray(arr)) return false\n  return arr.includes(name)\n}\n\n/**\n * Generate arguments to pass to plugin methods\n * @param  {Object} instance - analytics instance\n * @param  {array} abortablePlugins - plugins that can be cancelled by caller\n * @return {*} function to inject plugin params\n */\nfunction argumentFactory(instance, abortablePlugins) {\n  // console.log('abortablePlugins', abortablePlugins)\n  return function (action, plugin, otherPlugin) {\n    const { config, name } = plugin\n    let method = `${name}.${action.type}`\n    if (otherPlugin) {\n      method = otherPlugin.event\n    }\n\n    const abortF = (action.type.match(endsWithStartRegex))\n      ? abortFunction(name, method, abortablePlugins, otherPlugin, action)\n      : notAbortableError(action, method)\n\n    return {\n      /* self: plugin, for future maybe */\n      // clone objects to avoid reassign\n      payload: formatPayload(action),\n      instance: instance,\n      config: config || {},\n      abort: abortF\n    }\n  }\n}\n\nfunction abortFunction(pluginName, method, abortablePlugins, otherPlugin, action) {\n  return function (reason, plugins) {\n    const caller = (otherPlugin) ? otherPlugin.name : pluginName\n    let pluginsToAbort = (plugins && isArray(plugins)) ? plugins : abortablePlugins\n    if (otherPlugin) {\n      pluginsToAbort = (plugins && isArray(plugins)) ? plugins : [pluginName]\n      if (!pluginsToAbort.includes(pluginName) || pluginsToAbort.length !== 1) {\n        throw new Error(`Method ${method} can only abort ${pluginName} plugin. ${JSON.stringify(pluginsToAbort)} input valid`)\n      }\n    }\n    return {\n      ...action, //  todo verify this merge is ok\n      abort: {\n        reason: reason,\n        plugins: pluginsToAbort,\n        caller: method,\n        _: caller\n      }\n    }\n  }\n}\n\nfunction notAbortableError(action, method) {\n  return () => {\n    throw new Error(action.type + ' action not cancellable. Remove abort in ' + method)\n  }\n}\n\n/**\n * Verify plugin is not calling itself with whatever:myPluginName self refs\n */\nfunction validateMethod(actionName, pluginName) {\n  const text = getNameSpacedAction(actionName)\n  const methodCallMatchesPluginNamespace = text && (text.name === pluginName)\n  if (methodCallMatchesPluginNamespace) {\n    const sub = getNameSpacedAction(text.method)\n    const subText = (sub) ? 'or ' + sub.method : ''\n    throw new Error([ pluginName + ' plugin is calling method ' + actionName,\n      'Plugins cant call self',\n      `Use ${text.method} ${subText} in ${pluginName} plugin insteadof ${actionName}`]\n      .join('\\n')\n    )\n  }\n}\n\nfunction getNameSpacedAction(event) {\n  const split = event.match(/(.*):(.*)/)\n  if (!split) {\n    return false\n  }\n  return {\n    method: split[1],\n    name: split[2],\n  }\n}\n\nfunction formatPayload(action) {\n  return Object.keys(action).reduce((acc, key) => {\n    // redact type from { payload }\n    if (key === 'type') {\n      return acc\n    }\n    if (isObject(action[key])) {\n      acc[key] = Object.assign({}, action[key])\n    } else {\n      acc[key] = action[key]\n    }\n    return acc\n  }, {})\n}\n\n/*\nfunction getMatchingMethods(eventType, activePlugins) {\n  const exact = getPluginFunctions(eventType, activePlugins)\n  // console.log('exact', exact)\n  // Gather nameSpaced Events\n  return activePlugins.reduce((acc, plugin) => {\n    const { name } = plugin\n    const clean = getPluginFunctions(`${eventType}:${name}`, activePlugins)\n    if (clean.length) {\n      acc.namespaced[name] = clean\n    }\n    return acc\n  }, {\n    exact: exact,\n    namespaced: {}\n  })\n}\n*/\n","import EVENTS, { nonEvents } from '../../events'\nimport { runCallback, stack } from '../../utils/callback-stack'\nimport waitForReady from '../../utils/waitForReady'\nimport { processQueue } from '../../utils/heartbeat'\nimport runPlugins from './engine'\n\nexport default function pluginMiddleware(instance, getPlugins, systemEvents) {\n  const isReady = {}\n  return store => next => async action => {\n    const { type, abort, plugins } = action\n    let updatedAction = action\n\n    if (abort) {\n      return next(action)\n    }\n\n    /* Analytics.plugins.enable called, we need to init the plugins */\n    if (type === EVENTS.enablePlugin) {\n      store.dispatch({\n        type: EVENTS.initializeStart,\n        plugins: plugins,\n        disabled: [],\n        fromEnable: true,\n        meta: action.meta\n      })\n    }\n    \n    if (type === EVENTS.disablePlugin) {\n      // If cached callback, resolve promise/run callback. debounced to fix race condition\n      setTimeout(() => runCallback(action.meta.rid, { payload: action }), 0)\n    }\n\n    /* @TODO implement\n    if (type === EVENTS.loadPlugin) {\n      // Rerun initialize calls in plugins\n      const allPlugins = getPlugins()\n      const pluginsToLoad = Object.keys(allPlugins).filter((name) => {\n        return plugins.includes(name)\n      }).reduce((acc, curr) => {\n        acc[curr] = allPlugins[curr]\n        return acc\n      }, {})\n      const initializeAction = {\n        type: EVENTS.initializeStart,\n        plugins: plugins\n      }\n      const updated = await runPlugins(initializeAction, pluginsToLoad, instance, store, systemEvents)\n      return next(updated)\n    }\n    */\n\n    //  || type.match(/^initializeAbort:/)\n    if (type === EVENTS.initializeEnd) {\n      const allPlugins = getPlugins()\n      const pluginsArray = Object.keys(allPlugins)\n      const allRegisteredPlugins = pluginsArray.filter((name) => {\n        return plugins.includes(name)\n      }).map((name) => {\n        return allPlugins[name]\n      })\n      let completed = []\n      let failed = []\n      let disabled = action.disabled\n      // console.log('allRegisteredPlugins', allRegisteredPlugins)\n      const waitForPluginsToLoad = allRegisteredPlugins.map((plugin) => {\n        const { loaded, name, config } = plugin\n        const loadedFn = () => loaded({ config }) // @TODO add in more to api to match other funcs?\n        /* Plugins will abort trying to load after 10 seconds. 1e4 === 10000 MS */\n        return waitForReady(plugin, loadedFn, 1e4).then((d) => {\n          if (!isReady[name]) {\n            // only dispatch namespaced rdy once\n            store.dispatch({\n              type: EVENTS.pluginReadyType(name), // `ready:${name}`\n              name: name,\n              events: Object.keys(plugin).filter((name) => {\n                return !nonEvents.includes(name)\n              })\n            })\n            isReady[name] = true\n          }\n          completed = completed.concat(name)\n\n          return plugin\n          // It's loaded! run the command\n        }).catch((e) => {\n          // Timeout Add to queue\n          // console.log('Error generic waitForReady. Push this to queue', e)\n          if (e instanceof Error) {\n            throw new Error(e)\n          }\n          failed = failed.concat(e.name)\n          // Failed to fire, add to queue\n          return e\n        })\n      })\n\n      Promise.all(waitForPluginsToLoad).then((calls) => {\n        // setTimeout to ensure runs after 'page'\n        const payload = {\n          plugins: completed,\n          failed: failed,\n          disabled: disabled\n        }\n        setTimeout(() => {\n          if (pluginsArray.length === (waitForPluginsToLoad.length + disabled.length)) {\n            store.dispatch({\n              ...{ type: EVENTS.ready },\n              ...payload,\n              \n            })\n          }\n        }, 0)\n      })\n    }\n\n    /* New plugin system */\n    if (type !== EVENTS.bootstrap) {\n      if (/^ready:([^:]*)$/.test(type)) {\n        // Immediately flush queue\n        setTimeout(() => processQueue(store, getPlugins, instance), 0)\n      }\n      const updated = await runPlugins(action, getPlugins, instance, store, systemEvents)\n      return next(updated)\n    }\n\n    return next(updatedAction)\n  }\n}\n","import { isBoolean } from '@analytics/type-utils'\n\nexport default function fitlerDisabledPlugins(allPlugins, settings = {}, options = {}) {\n  return Object.keys(allPlugins).filter((name) => {\n    const fromCallOptions = options.plugins || {}\n    // If enabled/disabled by options. Override settings\n    if (isBoolean(fromCallOptions[name])) {\n      return fromCallOptions[name]\n    }\n    // If all: false disable everything unless true explicitly set\n    if (fromCallOptions.all === false) {\n      return false\n    }\n    // else use state.plugin settings\n    if (settings[name] && settings[name].enabled === false) {\n      return false\n    }\n    return true\n  }).map((name) => allPlugins[name])\n}\n","import EVENTS from '../events'\n\nexport default function storageMiddleware(storage) {\n  return store => next => action => {\n    const { type, key, value, options } = action\n    if (type === EVENTS.setItem || type === EVENTS.removeItem) {\n      if (action.abort) {\n        return next(action)\n      }\n      // Run storage set or remove\n      if (type === EVENTS.setItem) {\n        storage.setItem(key, value, options)\n      } else {\n        storage.removeItem(key, options)\n      }\n    }\n    return next(action)\n  }\n}\n\n/*\n  Todo: emit events for keys we care about\n  window.addEventListener('storage', (event) => console.log(event));\n*/\n","import { compose } from '../vendor/redux'\n\n/* Class to fix dynamic middlewares from conflicting with each other\nif more than one analytic instance is active */\nexport default class DynamicMiddleware {\n  before = []\n  after = []\n  addMiddleware = (middlewares, position) => {\n    this[position] = this[position].concat(middlewares)\n  }\n  removeMiddleware = (middleware, position) => {\n    const index = this[position].findIndex(d => d === middleware)\n    if (index === -1) return\n\n    this[position] = [\n      ...this[position].slice(0, index),\n      ...this[position].slice(index + 1),\n    ]\n  }\n  /* Not currently in use\n  resetMiddlewares = (position) => {\n    if (!position) {\n      this.before = []\n      this.after = []\n    } else {\n      this[position] = []\n    }\n  }\n  */\n  dynamicMiddlewares = (position) => {\n    return store => next => action => {\n      const middlewareAPI = {\n        getState: store.getState,\n        dispatch: (act) => store.dispatch(act),\n      }\n      const chain = this[position].map(middleware => middleware(middlewareAPI))\n      return compose(...chain)(next)(action)\n    }\n  }\n}\n","// Integrations Reducer. Follows ducks pattern http://bit.ly/2DnERMc\nimport EVENTS from '../events'\n\nexport default function createReducer(getPlugins) {\n  return function plugins(state = {}, action) {\n    let newState = {}\n    if (action.type === 'initialize:aborted') {\n      return state\n    }\n    if (/^registerPlugin:([^:]*)$/.test(action.type)) {\n      const name = getNameFromEventType(action.type, 'registerPlugin')\n      const plugin = getPlugins()[name]\n      if (!plugin || !name) {\n        return state\n      }\n      const isEnabled = action.enabled\n      const config = plugin.config\n      newState[name] = {\n        enabled: isEnabled,\n        /* if no initialization method. Set initialized true */\n        initialized: (isEnabled) ? Boolean(!plugin.initialize) : false,\n        /* If plugin enabled === false, set loaded to false, else check plugin.loaded function */\n        loaded: (isEnabled) ? Boolean(plugin.loaded({ config })) : false,\n        config\n      }\n      return { ...state, ...newState }\n    }\n    if (/^initialize:([^:]*)$/.test(action.type)) {\n      const name = getNameFromEventType(action.type, EVENTS.initialize)\n      const plugin = getPlugins()[name]\n      if (!plugin || !name) {\n        return state\n      }\n      const config = plugin.config\n      newState[name] = {\n        ...state[name],\n        ...{\n          initialized: true,\n          /* check plugin.loaded function */\n          loaded: Boolean(plugin.loaded({ config }))\n        }\n      }\n      return { ...state, ...newState }\n    }\n    if (/^ready:([^:]*)$/.test(action.type)) {\n      // const name = getNameFromEventType(action.type, 'ready')\n      newState[action.name] = {\n        ...state[action.name],\n        ...{ loaded: true }\n      }\n      return { ...state, ...newState }\n    }\n    switch (action.type) {\n      /* case EVENTS.pluginFailed:\n        // console.log('PLUGIN_FAILED', action.name)\n        newState[action.name] = {\n          ...state[action.name],\n          ...{ loaded: false }\n        }\n        return { ...state, ...newState }\n      */\n      /* When analytics.plugins.disable called */\n      case EVENTS.disablePlugin:\n        return { \n          ...state,\n          ...togglePluginStatus(action.plugins, false, state)\n        }\n      /* When analytics.plugins.enable called */\n      case EVENTS.enablePlugin:\n        return {\n          ...state, \n          ...togglePluginStatus(action.plugins, true, state)\n        }\n      default:\n        return state\n    }\n  }\n}\n\nfunction getNameFromEventType(type, baseName) {\n  return type.substring(baseName.length + 1, type.length)\n}\n\nfunction togglePluginStatus(plugins, status, currentState) {\n  return plugins.reduce((acc, pluginKey) => {\n    acc[pluginKey] = {\n      ...currentState[pluginKey],\n      ...{\n        enabled: status \n      }\n    }\n    return acc\n  }, currentState)\n}\n","export default function serialize(obj) {\n  try {\n   return JSON.parse(JSON.stringify(obj))\n  } catch (err) {}\n  return obj\n}","// Track Module. Follows ducks pattern http://bit.ly/2DnERMc\nimport EVENTS from '../events'\nimport serialize from '../utils/serialize'\n\n// Track State\nconst initialState = {\n  last: {},\n  history: [],\n}\n\n// track reducer\nexport default function trackReducer(state = initialState, action) {\n  const { type, event, properties, options, meta } = action\n\n  switch (type) {\n    case EVENTS.track:\n      const trackEvent = serialize({\n        event,\n        properties,\n        ...(Object.keys(options).length) && { options: options },\n        meta\n      })\n      return {\n        ...state,\n        ...{\n          last: trackEvent,\n          // Todo prevent LARGE arrays https://bit.ly/2MnBwPT\n          history: state.history.concat(trackEvent)\n        }\n      }\n    default:\n      return state\n  }\n}\n","import EVENTS from '../events'\n/*\nTODO figure out if this should live in state...\nQueue could be in mermory as well.\nBut also needs to be persisted to storage\n*/\n\nconst initialState = {\n  actions: [],\n}\n\nexport default function queueReducer(state = initialState, action) {\n  const { type, payload } = action\n\n  switch (type) {\n    case 'queue':\n      let actionChain\n      /* prioritize identify in event queue */\n      if (payload && payload.type && payload.type === EVENTS.identify) {\n        actionChain = [action].concat(state.actions)\n      } else {\n        actionChain = state.actions.concat(action)\n      }\n      return {\n        ...state,\n        actions: actionChain\n      }\n    case 'dequeue':\n      return []\n    // todo push events to history\n    default:\n      return state\n  }\n}\n\nexport const queueAction = (data, timestamp) => {\n  return {\n    type: 'queue',\n    timestamp: timestamp,\n    data: data\n  }\n}\n","// Page View Reducer. Follows ducks pattern http://bit.ly/2DnERMc\nimport { isBrowser } from '@analytics/type-utils'\nimport serialize from '../utils/serialize'\n\nimport EVENTS from '../events'\n\nconst hashRegex = /#.*$/\n\nfunction canonicalUrl() {\n  if (!isBrowser) return\n  const tags = document.getElementsByTagName('link')\n  for (var i = 0, tag; tag = tags[i]; i++) {\n    if (tag.getAttribute('rel') === 'canonical') {\n      return tag.getAttribute('href')\n    }\n  }\n}\n\nfunction urlPath(url) {\n  const regex = /(http[s]?:\\/\\/)?([^\\/\\s]+\\/)(.*)/g\n  const matches = regex.exec(url)\n  const pathMatch = (matches && matches[3]) ? matches[3].split('?')[0].replace(hashRegex, '') : ''\n  return '/' + pathMatch\n}\n\n/**\n * Return the canonical URL and rmove the hash.\n * @param  {string} search - search param\n * @return {string} return current canonical URL\n */\nfunction currentUrl(search) {\n  const canonical = canonicalUrl()\n  if (!canonical) return window.location.href.replace(hashRegex, '')\n  return canonical.match(/\\?/) ? canonical : canonical + search\n}\n\n/**\n * Page data for overides\n * @typedef {object} PageData\n * @property {string} [title] - Page title\n * @property {string} [url] - Page url\n * @property {string} [path] - Page path\n * @property {string} [search] - Page search\n * @property {string} [width] - Page width\n * @property {string} [height] - Page height\n*/\n\n/**\n * Get information about current page\n * @typedef {Function} getPageData\n * @param  {PageData} [pageData = {}] - Page data overides\n * @return {PageData} resolved page data\n */\nexport const getPageData = (pageData = {}) => {\n  if (!isBrowser) return pageData\n  const { title, referrer } = document\n  const { location, innerWidth, innerHeight } = window\n  const { hash, search } = location\n  const url = currentUrl(search)\n  const page = {\n    title: title,\n    url: url,\n    path: urlPath(url),\n    hash: hash,\n    search: search,\n    width: innerWidth,\n    height: innerHeight,\n  }\n  if (referrer && referrer !== '') {\n    page.referrer = referrer\n  }\n\n  return {\n    ...page,\n    /* .page() user overrrides */\n    ...pageData\n  }\n}\n\nconst initialState = {\n  last: {},\n  history: [],\n}\n\n// page reducer\nexport default function page(state = initialState, action) {\n  const { properties, options, meta } = action\n  switch (action.type) {\n    case EVENTS.page:\n      const viewData = serialize({\n        properties,\n        meta,\n        ...(Object.keys(options).length) && { options: options },\n      })\n      return {\n        ...state,\n        ...{\n          last: viewData,\n          // Todo prevent LARGE arrays https://bit.ly/2MnBwPT\n          history: state.history.concat(viewData)\n        }\n      }\n    default:\n      return state\n  }\n}\n","// Context Reducer.  Follows ducks pattern http://bit.ly/2DnERMc\nimport { getBrowserLocale, getTimeZone, uuid } from 'analytics-utils'\nimport { isBrowser } from '@analytics/type-utils'\nimport EVENTS from '../events'\nimport { LIB_NAME } from '../utils/internalConstants'\nimport getOSNameNode from '../utils/getOSName/node'\nimport getOSNameBrowser from '../utils/getOSName/browser'\n\nlet osName\nlet referrer\nlet locale\nlet timeZone\nif (BROWSER) {\n  osName = getOSNameBrowser()\n  referrer = (isBrowser) ? document.referrer : null\n  locale = getBrowserLocale()\n  timeZone = getTimeZone()\n} else {\n  osName = getOSNameNode()\n  referrer = {}\n}\n\nconst initialState = {\n  initialized: false,\n  sessionId: uuid(),\n  app: null,\n  version: null,\n  debug: false,\n  offline: (isBrowser) ? !navigator.onLine : false, // use node network is-online\n  os: {\n    name: osName,\n  },\n  userAgent: (isBrowser) ? navigator.userAgent : 'node', // https://github.com/bestiejs/platform.js\n  library: {\n    name: LIB_NAME,\n    // TODO fix version number. npm run publish:patch has wrong version\n    version: VERSION\n  },\n  timezone: timeZone,\n  locale: locale,\n  campaign: {},\n  referrer: referrer,\n}\n\n// context reducer\nexport default function context(state = initialState, action) {\n  const { initialized } = state\n  const { type, campaign } = action\n  switch (type) {\n    case EVENTS.campaign:\n      return {\n        ...state,\n        ...{ campaign: campaign }\n      }\n    case EVENTS.offline:\n      return {\n        ...state,\n        ...{ offline: true }\n      }\n    case EVENTS.online:\n      return {\n        ...state,\n        ...{ offline: false }\n      }\n    default:\n      if (!initialized) {\n        return {\n          ...initialState,\n          ...state,\n          ...{ initialized: true }\n        }\n      }\n      return state\n  }\n}\n\nconst excludeItems = ['plugins', 'reducers', 'storage']\n// Pull plugins and reducers off intital config\nexport function makeContext(config) {\n  return Object.keys(config).reduce((acc, current) => {\n    if (excludeItems.includes(current)) {\n      return acc\n    }\n    acc[current] = config[current]\n    return acc\n  }, {})\n}\n","import { isBrowser } from '@analytics/type-utils'\n\nexport default function getBrowserOS() {\n  if (!isBrowser) return false\n  const os = navigator.appVersion\n  // ~os bitwise operator to check if in navigator\n  if (~os.indexOf('Win')) return 'Windows'\n  if (~os.indexOf('Mac')) return 'MacOS'\n  if (~os.indexOf('X11')) return 'UNIX'\n  if (~os.indexOf('Linux')) return 'Linux'\n  // default\n  return 'Unknown OS'\n}\n","import { isBrowser } from '@analytics/type-utils'\n\nfunction listen(events, func, toAdd) {\n  if (!isBrowser) return\n  const fn = window[(toAdd ? 'add' : 'remove') + 'EventListener']\n  events.split(' ').forEach(ev => {\n    fn(ev, func)\n  })\n}\n\nexport function check() {\n  return Promise.resolve(!navigator.onLine)\n}\n\nexport function watch(cb) {\n  const fn = _ => check().then(cb)\n  const listener = listen.bind(null, 'online offline', fn)\n  listener(true)\n  // return unsubscribe function\n  return _ => listener(false)\n}\n","import { set, globalContext, KEY } from '@analytics/global-storage-utils'\nimport { compose } from '../vendor/redux'\nimport { LIB_NAME } from './internalConstants'\n\nexport function Debug() {\n  // Global key is window.__global__.analytics\n  set(LIB_NAME, [])\n  // Return debugger\n  return (createStore) => {\n    return (reducer, preloadedState, enhancer) => {\n      const store = createStore(reducer, preloadedState, enhancer)\n      const origDispatch = store.dispatch\n      const dispatch = (action) => {\n        const a = action.action || action\n        globalContext[KEY][LIB_NAME].push(a)\n        return origDispatch(action)\n      }\n      return Object.assign(store, { dispatch: dispatch })\n    }\n  }\n}\n\nexport function composeWithDebug(config) {\n  return function () {\n    return compose(compose.apply(null, arguments), Debug(config))\n  }\n}\n","import { isArray } from '@analytics/type-utils'\n\nexport default function ensureArray(singleOrArray) {\n  if (!singleOrArray) return []\n  if (isArray(singleOrArray)) return singleOrArray\n  return [singleOrArray] \n}","import getCallback from './getCallback'\nimport { stack } from './callback-stack'\nimport timestamp from './timestamp'\nimport { uuid } from 'analytics-utils'\n\n// Async promise resolver\nfunction deferredPromiseResolver(resolver, callback) {\n  return (data) => {\n    if (callback) callback(data)\n    resolver(data)\n  }\n}\n\nexport default function generateMeta(meta = {}, resolve, possibleCallbacks) {\n    const rid = uuid()\n    if (resolve) {\n      // stack[`${rid}-info`] = meta\n      stack[rid] = deferredPromiseResolver(resolve, getCallback(possibleCallbacks))\n    }\n    return {\n      ...meta,\n      rid: rid,\n      ts: timestamp(),\n      ...(!resolve) ? {} : { hasCallback: true },\n    }\n  }","import { isFunction } from '@analytics/type-utils'\n\n/**\n * Grab first function found from arguments\n * @param {array} [argArray] - arguments array to find first function\n * @returns {Function|undefined}\n */\nexport default function getCallbackFromArgs(argArray) {\n  const args = argArray || Array.prototype.slice.call(arguments)\n  let cb\n  for (let i = 0; i < args.length; i++) {\n    if (isFunction(args[i])) {\n      cb = args[i]; break;\n    }\n  }\n  return cb\n}","\nexport default function timeStamp() {\n  return new Date().getTime()\n}\n","import { uuid, paramsParse, dotProp } from 'analytics-utils'\nimport { get, set, remove } from '@analytics/global-storage-utils'\nimport { isBrowser, isFunction, isObject, isString } from '@analytics/type-utils'\nimport { createStore, combineReducers, applyMiddleware, compose } from './vendor/redux'\nimport * as CONSTANTS from './constants'\nimport { ID, ANONID, ERROR_URL } from './utils/internalConstants'\nimport EVENTS, { coreEvents, nonEvents, isReservedAction } from './events'\n// Middleware\nimport * as middleware from './middleware'\nimport DynamicMiddleware from './middleware/dynamic'\n// Modules\nimport pluginsMiddleware from './modules/plugins'\nimport track from './modules/track'\nimport queue from './modules/queue'\nimport page, { getPageData } from './modules/page'\nimport context, { makeContext } from './modules/context'\nimport user, { getUserPropFunc, tempKey, getPersistedUserData } from './modules/user'\n/* Utils */\nimport { watch } from './utils/handleNetworkEvents'\nimport { Debug, composeWithDebug } from './utils/debug'\nimport heartBeat from './utils/heartbeat'\nimport ensureArray from './utils/ensureArray'\nimport enrichMeta from './utils/enrichMeta'\nimport './pluginTypeDef'\n\n/**\n * Analytics library configuration\n *\n * After the library is initialized with config, the core API is exposed & ready for use in the application.\n *\n * @param {object} config - analytics core config\n * @param {string} [config.app] - Name of site / app\n * @param {string} [config.version] - Version of your app\n * @param {boolean} [config.debug] - Should analytics run in debug mode\n * @param {Array.<AnalyticsPlugin>}  [config.plugins] - Array of analytics plugins\n * @return {AnalyticsInstance} Analytics Instance\n * @example\n *\n * import Analytics from 'analytics'\n * import pluginABC from 'analytics-plugin-abc'\n * import pluginXYZ from 'analytics-plugin-xyz'\n *\n * // initialize analytics\n * const analytics = Analytics({\n *   app: 'my-awesome-app',\n *   plugins: [\n *     pluginABC,\n *     pluginXYZ\n *   ]\n * })\n *\n */\nfunction analytics(config = {}) {\n  const customReducers = config.reducers || {}\n  const initialUser = config.initialUser || {}\n  // @TODO add custom value reolvers for userId and anonId\n  // const resolvers = config.resolvers || {}\n  // if (BROWSER) {\n  //   console.log('INIT browser')\n  // }\n  // if (SERVER) {\n  //   console.log('INIT SERVER')\n  // }\n  \n  /* Parse plugins array */\n  const parsedOptions = (config.plugins || []).reduce((acc, plugin) => {\n    if (isFunction(plugin)) {\n      /* Custom redux middleware */\n      acc.middlewares = acc.middlewares.concat(plugin)\n      return acc\n    }\n    // Legacy plugin with name\n    if (plugin.NAMESPACE) plugin.name = plugin.NAMESPACE\n    if (!plugin.name) {\n      /* Plugins must supply a \"name\" property. See error url for more details */\n      throw new Error(ERROR_URL + '1')\n    }\n    // Set config if empty\n    if (!plugin.config) plugin.config = {}\n    // if plugin exposes EVENTS capture available events\n    const definedEvents = (plugin.EVENTS) ? Object.keys(plugin.EVENTS).map((k) => {\n      return plugin.EVENTS[k]\n    }) : []\n\n    const enabledFromMerge = !(plugin.enabled === false)\n    const enabledFromPluginConfig = !(plugin.config.enabled === false)\n    // top level { enabled: false } takes presidence over { config: enabled: false }\n    acc.pluginEnabled[plugin.name] = enabledFromMerge && enabledFromPluginConfig\n    delete plugin.enabled\n\n    if (plugin.methods) {\n      acc.methods[plugin.name] = Object.keys(plugin.methods).reduce((a, c) => {\n        // enrich methods with analytics instance\n        a[c] = appendArguments(plugin.methods[c])\n        return a\n      }, {})\n      // Remove additional methods from plugins\n      delete plugin.methods\n    }\n    // Convert available methods into events\n    const methodsToEvents = Object.keys(plugin)\n    // Combine events\n    const allEvents = methodsToEvents.concat(definedEvents)\n    // Dedupe events list\n    const allEventsUnique = new Set(acc.events.concat(allEvents))\n    acc.events = Array.from(allEventsUnique)\n\n    acc.pluginsArray = acc.pluginsArray.concat(plugin)\n\n    if (acc.plugins[plugin.name]) {\n      throw new Error(plugin.name + 'AlreadyLoaded')\n    }\n    acc.plugins[plugin.name] = plugin\n    if (!acc.plugins[plugin.name].loaded) {\n      // set default loaded func\n      acc.plugins[plugin.name].loaded = () => true\n    }\n    return acc\n  }, {\n    plugins: {},\n    pluginEnabled: {},\n    methods: {},\n    pluginsArray: [],\n    middlewares: [],\n    events: []\n  })\n  \n  /* Storage by default is set to global & is not persisted */\n  const storage = (config.storage) ? config.storage : {\n    getItem: get,\n    setItem: set,\n    removeItem: remove\n  }\n\n  const getUserProp = getUserPropFunc(storage)\n\n  // mutable intregrations object for dynamic loading\n  let customPlugins = parsedOptions.plugins\n\n  /* Grab all registered events from plugins loaded */\n  const allPluginEvents = parsedOptions.events.filter((name) => {\n    return !nonEvents.includes(name)\n  }).sort()\n  const uniqueEvents = new Set(allPluginEvents.concat(coreEvents).filter((name) => {\n    return !nonEvents.includes(name)\n  }))\n  const allSystemEvents = Array.from(uniqueEvents).sort()\n\n  /* plugin methods(functions) must be kept out of state. thus they live here */\n  const getPlugins = () => customPlugins\n\n  const {\n    addMiddleware,\n    removeMiddleware,\n    dynamicMiddlewares\n  } = new DynamicMiddleware()\n\n  const nonAbortable = () => {\n    // throw new Error(`${ERROR_URL}3`)\n    throw new Error('Abort disabled inListener')\n  }\n  \n  // Parse URL parameters\n  const params = paramsParse()\n  // Initialize visitor information\n  const persistedUser = getPersistedUserData(storage)\n  const visitorInfo = {\n    ...persistedUser,\n    ...initialUser,\n    ...(!params.an_uid) ? {} : { userId: params.an_uid },\n    ...(!params.an_aid) ? {} : { anonymousId: params.an_aid },\n  }\n  // If no anon id set, create one\n  if (!visitorInfo.anonymousId) {\n    visitorInfo.anonymousId = uuid()\n  }\n\n  /**\n   * Async Management methods for plugins. \n   * \n   * This is also where [custom methods](https://bit.ly/329vFXy) are loaded into the instance.\n   * @typedef {Object} Plugins\n   * @property {EnablePlugin} enable - Set storage value\n   * @property {DisablePlugin} disable - Remove storage value\n   * @example\n   *\n   * // Enable a plugin by namespace\n   * analytics.plugins.enable('keenio')\n   *\n   * // Disable a plugin by namespace\n   * analytics.plugins.disable('google-analytics')\n   */\n  const plugins = {\n    /**\n     * Enable analytics plugin\n     * @typedef {Function} EnablePlugin\n     * @param  {string|string[]} plugins - name of plugins(s) to disable\n     * @param  {Function} [callback] - callback after enable runs\n     * @returns {Promise}\n     * @example\n     *\n     * analytics.plugins.enable('google-analytics').then(() => {\n     *   console.log('do stuff')\n     * })\n     *\n     * // Enable multiple plugins at once\n     * analytics.plugins.enable(['google-analytics', 'segment']).then(() => {\n     *   console.log('do stuff')\n     * })\n     */\n    enable: (plugins, callback) => {\n      return new Promise((resolve) => {\n        store.dispatch({\n          type: EVENTS.enablePlugin,\n          plugins: ensureArray(plugins),\n          _: { originalAction: EVENTS.enablePlugin },\n        }, resolve, [ callback ])\n      })\n    },\n    /**\n     * Disable analytics plugin\n     * @typedef {Function} DisablePlugin\n     * @param  {string|string[]} plugins - name of integration(s) to disable\n     * @param  {Function} callback - callback after disable runs\n     * @returns {Promise}\n     * @example\n     *\n     * analytics.plugins.disable('google').then(() => {\n     *   console.log('do stuff')\n     * })\n     *\n     * analytics.plugins.disable(['google', 'segment']).then(() => {\n     *   console.log('do stuff')\n     * })\n     */\n    disable: (plugins, callback) => {\n      return new Promise((resolve) => {\n        store.dispatch({\n          type: EVENTS.disablePlugin,\n          plugins: ensureArray(plugins),\n          _: { originalAction: EVENTS.disablePlugin },\n        }, resolve, [callback])\n      })\n    },\n    /*\n     * Load registered analytic providers.\n     * @param  {String} plugins - integration namespace\n     *\n     * @example\n     * analytics.plugins.load('segment')\n     @TODO implement\n    load: (plugins) => {\n      store.dispatch({\n        type: EVENTS.loadPlugin,\n        // Todo handle multiple plugins via array\n        plugins: (plugins) ? [plugins] : Object.keys(getPlugins()),\n      })\n    },\n    */\n    /* @TODO if it stays, state loaded needs to be set. Re PLUGIN_INIT above\n    add: (newPlugin) => {\n      if (typeof newPlugin !== 'object') return false\n      // Set on global integration object\n      customPlugins = Object.assign({}, customPlugins, {\n        [`${newPlugin.name}`]: newPlugin\n      })\n      // then add it, and init state key\n      store.dispatch({\n        type: EVENTS.pluginRegister,\n        name: newPlugin.name,\n        plugin: newPlugin\n      })\n    }, */\n    // Merge in custom plugin methods\n    ...parsedOptions.methods\n  }\n  \n  let readyCalled = false\n  /**\n   * Analytic instance returned from initialization\n   * @typedef {Object} AnalyticsInstance\n   * @property {Identify} identify - Identify a user\n   * @property {Track} track - Track an analytics event\n   * @property {Page} page - Trigger page view\n   * @property {User} user - Get user data\n   * @property {Reset} reset - Clear information about user & reset analytics\n   * @property {Ready} ready - Fire callback on analytics ready event\n   * @property {On} on - Fire callback on analytics lifecycle events.\n   * @property {Once} once - Fire callback on analytics lifecycle events once.\n   * @property {GetState} getState - Get data about user, activity, or context.\n   * @property {Storage} storage - storage methods\n   * @property {Plugins} plugins - plugin methods\n   */\n  const instance = {\n    /**\n    * Identify a user. This will trigger `identify` calls in any installed plugins and will set user data in localStorage\n    * @typedef {Function} Identify\n    * @param  {String}   userId  - Unique ID of user\n    * @param  {Object}   [traits]  - Object of user traits\n    * @param  {Object}   [options] - Options to pass to identify call\n    * @param  {Function} [callback] - Callback function after identify completes\n    * @returns {Promise}\n    * @api public\n    *\n    * @example\n    *\n    * // Basic user id identify\n    * analytics.identify('xyz-123')\n    *\n    * // Identify with additional traits\n    * analytics.identify('xyz-123', {\n    *   name: 'steve',\n    *   company: 'hello-clicky'\n    * })\n    *\n    * // Fire callback with 2nd or 3rd argument\n    * analytics.identify('xyz-123', () => {\n    *   console.log('do this after identify')\n    * })\n    *\n    * // Disable sending user data to specific analytic tools\n    * analytics.identify('xyz-123', {}, {\n    *   plugins: {\n    *     // disable sending this identify call to segment\n    *     segment: false\n    *   }\n    * })\n    *\n    * // Send user data to only to specific analytic tools\n    * analytics.identify('xyz-123', {}, {\n    *   plugins: {\n    *     // disable this specific identify in all plugins except customerio\n    *     all: false,\n    *     customerio: true\n    *   }\n    * })\n    */\n    identify: async (userId, traits, options, callback) => {\n      const id = isString(userId) ? userId : null\n      const data = isObject(userId) ? userId : traits\n      const opts = options || {}\n      const user = instance.user()\n\n      /* sets temporary in memory id. Not to be relied on */\n      set(tempKey(ID), id)\n\n      const resolvedId = id || data.userId || getUserProp(ID, instance, data)\n\n      return new Promise((resolve) => {\n        store.dispatch({\n          type: EVENTS.identifyStart,\n          userId: resolvedId,\n          traits: data || {},\n          options: opts,\n          anonymousId: user.anonymousId,\n          // Add previousId if exists\n          ...(user.id && (user.id !== id) && { previousId: user.id }),\n        }, resolve, [traits, options, callback])\n      })\n    },\n    /**\n     * Track an analytics event. This will trigger `track` calls in any installed plugins\n     * @typedef {Function} Track\n     * @param  {String}   eventName - Event name\n     * @param  {Object}   [payload]   - Event payload\n     * @param  {Object}   [options]   - Event options\n     * @param  {Function} [callback]  - Callback to fire after tracking completes\n     * @returns {Promise}\n     * @api public\n     *\n     * @example\n     *\n     * // Basic event tracking\n     * analytics.track('buttonClicked')\n     *\n     * // Event tracking with payload\n     * analytics.track('itemPurchased', {\n     *   price: 11,\n     *   sku: '1234'\n     * })\n     *\n     * // Fire callback with 2nd or 3rd argument\n     * analytics.track('newsletterSubscribed', () => {\n     *   console.log('do this after track')\n     * })\n     *\n     * // Disable sending this event to specific analytic tools\n     * analytics.track('cartAbandoned', {\n     *   items: ['xyz', 'abc']\n     * }, {\n     *   plugins: {\n     *     // disable track event for segment\n     *     segment: false\n     *   }\n     * })\n     *\n     * // Send event to only to specific analytic tools\n     * analytics.track('customerIoOnlyEventExample', {\n     *   price: 11,\n     *   sku: '1234'\n     * }, {\n     *   plugins: {\n     *     // disable this specific track call all plugins except customerio\n     *     all: false,\n     *     customerio: true\n     *   }\n     * })\n     */\n    track: async (eventName, payload, options, callback) => {\n      const name = isObject(eventName) ? eventName.event : eventName\n      if (!name || !isString(name)) {\n        throw new Error('EventMissing')\n      }\n      const data = isObject(eventName) ? eventName : (payload || {})\n      const opts = isObject(options) ? options : {}\n\n      return new Promise((resolve) => {\n        store.dispatch({\n          type: EVENTS.trackStart,\n          event: name,\n          properties: data,\n          options: opts,\n          userId: getUserProp(ID, instance, payload),\n          anonymousId: getUserProp(ANONID, instance, payload),\n        }, resolve, [payload, options, callback])\n      })\n    },\n    /**\n     * Trigger page view. This will trigger `page` calls in any installed plugins\n     * @typedef {Function} Page\n     * @param  {PageData} [data] - Page data overrides.\n     * @param  {Object}   [options] - Page tracking options\n     * @param  {Function} [callback] - Callback to fire after page view call completes\n     * @returns {Promise}\n     * @api public\n     *\n     * @example\n     *\n     * // Basic page tracking\n     * analytics.page()\n     *\n     * // Page tracking with page data overrides\n     * analytics.page({\n     *   url: 'https://google.com'\n     * })\n     *\n     * // Fire callback with 1st, 2nd or 3rd argument\n     * analytics.page(() => {\n     *   console.log('do this after page')\n     * })\n     *\n     * // Disable sending this pageview to specific analytic tools\n     * analytics.page({}, {\n     *   plugins: {\n     *     // disable page tracking event for segment\n     *     segment: false\n     *   }\n     * })\n     *\n     * // Send pageview to only to specific analytic tools\n     * analytics.page({}, {\n     *   plugins: {\n     *     // disable this specific page in all plugins except customerio\n     *     all: false,\n     *     customerio: true\n     *   }\n     * })\n     */\n    page: async (data, options, callback) => {\n      const d = isObject(data) ? data : {}\n      const opts = isObject(options) ? options : {}\n\n      /*\n      // @TODO add custom value reolvers for userId and anonId\n      if (resolvers.getUserId) {\n        const asyncUserId = await resolvers.getUserId()\n        console.log('x', x)\n      }\n      */\n\n      return new Promise((resolve) => {\n        store.dispatch({\n          type: EVENTS.pageStart,\n          properties: getPageData(d),\n          options: opts,\n          userId: getUserProp(ID, instance, d),\n          anonymousId: getUserProp(ANONID, instance, d),\n        }, resolve, [data, options, callback])\n      })\n    },\n    /**\n     * Get user data\n     * @typedef {Function} User\n     * @param {string} [key] - dot.prop.path of user data. Example: 'traits.company.name'\n     * @returns {string|object} value of user data or null\n     *\n     * @example\n     *\n     * // Get all user data\n     * const userData = analytics.user()\n     *\n     * // Get user id\n     * const userId = analytics.user('userId')\n     *\n     * // Get user company name\n     * const companyName = analytics.user('traits.company.name')\n     */\n    user: (key) => {\n      if (key === ID || key === 'id') {\n        return getUserProp(ID, instance)\n      }\n      if (key === ANONID || key === 'anonId') {\n        return getUserProp(ANONID, instance)\n      }\n      const user = instance.getState('user')\n      if (!key) return user\n      return dotProp(user, key)\n    },\n    /**\n     * Clear all information about the visitor & reset analytic state.\n     * @typedef {Function} Reset\n     * @param {Function} [callback] - Handler to run after reset\n     * @returns {Promise}\n     * @example\n     *\n     * // Reset current visitor\n     * analytics.reset()\n     */\n    reset: (callback) => {\n      return new Promise((resolve) => {\n        store.dispatch({\n          type: EVENTS.resetStart\n        }, resolve, callback)\n      })\n    },\n    /**\n     * Fire callback on analytics ready event\n     * @typedef {Function} Ready\n     * @param  {Function} callback - function to trigger when all providers have loaded\n     * @returns {DetachListeners} - Function to detach listener\n     *\n     * @example\n     *\n     * analytics.ready((payload) => {\n     *   console.log('all plugins have loaded or were skipped', payload);\n     * })\n     */\n    ready: (callback) => {\n      // If ready already fired. Call callback immediately\n      if (readyCalled) callback({ plugins, instance })\n      return instance.on(EVENTS.ready, (x) => {\n        callback(x)\n        readyCalled = true\n      })\n    },\n    /**\n     * Attach an event handler function for analytics lifecycle events.\n     * @typedef {Function} On\n     * @param  {String}   name - Name of event to listen to\n     * @param  {Function} callback - function to fire on event\n     * @return {DetachListeners} - Function to detach listener\n     *\n     * @example\n     *\n     * // Fire function when 'track' calls happen\n     * analytics.on('track', ({ payload }) => {\n     *   console.log('track call just happened. Do stuff')\n     * })\n     *\n     * // Remove listener before it is called\n     * const removeListener = analytics.on('track', ({ payload }) => {\n     *   console.log('This will never get called')\n     * })\n     *\n     * // cleanup .on listener\n     * removeListener()\n     */\n    on: (name, callback) => {\n      if (!name || !isFunction(callback)) {\n        return false\n      }\n      if (name === EVENTS.bootstrap) {\n        throw new Error('.on disabled for ' + name)\n      }\n      const startRegex = /Start$|Start:/\n      if (name === '*') {\n        const beforeHandler = store => next => action => {\n          if (action.type.match(startRegex)) {\n            callback({ // eslint-disable-line\n              payload: action,\n              instance,\n              plugins: customPlugins\n            })\n          }\n          return next(action)\n        }\n        const afterHandler = store => next => action => {\n          if (!action.type.match(startRegex)) {\n            callback({ // eslint-disable-line\n              payload: action,\n              instance,\n              plugins: customPlugins\n            })\n          }\n          return next(action)\n        }\n        addMiddleware(beforeHandler, before)\n        addMiddleware(afterHandler, after)\n        /**\n         * Detach listeners\n         * @typedef {Function} DetachListeners\n         */\n        return () => {\n          removeMiddleware(beforeHandler, before)\n          removeMiddleware(afterHandler, after)\n        }\n      }\n\n      const position = (name.match(startRegex)) ? before : after // eslint-disable-line\n      const handler = store => next => action => {\n        // Subscribe to EVERYTHING\n        if (action.type === name) {\n          callback({ // eslint-disable-line\n            payload: action,\n            instance: instance,\n            plugins: customPlugins,\n            abort: nonAbortable\n          })\n        }\n        /* For future matching of event subpaths `track:*` etc\n        } else if (name.match(/\\*$/)) {\n          const match = (name === '*') ? '.' : name\n          const regex = new RegExp(`${match}`, 'g')\n        } */\n        return next(action)\n      }\n      addMiddleware(handler, position)\n      return () => removeMiddleware(handler, position)\n    },\n    /**\n     * Attach a handler function to an event and only trigger it once.\n     * @typedef {Function} Once\n     * @param  {String} name - Name of event to listen to\n     * @param  {Function} callback - function to fire on event\n     * @return {DetachListeners} - Function to detach listener\n     *\n     * @example\n     *\n     * // Fire function only once per 'track'\n     * analytics.once('track', ({ payload }) => {\n     *   console.log('This is only triggered once when analytics.track() fires')\n     * })\n     *\n     * // Remove listener before it is called\n     * const listener = analytics.once('track', ({ payload }) => {\n     *   console.log('This will never get called b/c listener() is called')\n     * })\n     *\n     * // cleanup .once listener before it fires\n     * listener()\n     */\n    once: (name, callback) => {\n      if (!name || !isFunction(callback)) {\n        return false\n      }\n      if (name === EVENTS.bootstrap) {\n        throw new Error('.once disabled for ' + name)\n      }\n      const detachListener = instance.on(name, ({ payload }) => {\n        callback({ // eslint-disable-line\n          payload: payload,\n          instance: instance,\n          plugins: customPlugins,\n          abort: nonAbortable\n        })\n        // detach listener after its called once\n        detachListener()\n      })\n      return detachListener\n    },\n    /**\n     * Get data about user, activity, or context. Access sub-keys of state with `dot.prop` syntax.\n     * @typedef {Function} GetState\n     * @param  {string} [key] - dot.prop.path value of state\n     * @return {any}\n     *\n     * @example\n     *\n     * // Get the current state of analytics\n     * analytics.getState()\n     *\n     * // Get a subpath of state\n     * analytics.getState('context.offline')\n     */\n    getState: (key) => {\n      const state = store.getState()\n      if (key) return dotProp(state, key)\n      return Object.assign({}, state)\n    },\n    /*\n     * Emit events for other plugins or middleware to react to.\n     * @param  {Object} action - event to dispatch\n     */\n    dispatch: (action) => {\n      const actionData = isString(action) ? { type: action } : action\n      if (isReservedAction(actionData.type)) {\n        throw new Error('reserved action ' + actionData.type)\n      }\n      const _private = action._ || {}\n      // Dispatch actionStart\n      // const autoPrefixType = `${actionData.type.replace(/Start$/, '')}Start`\n\n      const dispatchData = {\n        ...actionData,\n        _: {\n          originalAction: actionData.type,\n          ..._private\n        }\n        // type: `${autoPrefixType}`\n      }\n      store.dispatch(dispatchData)\n    },\n    // Do not use. Will be removed. Here for Backwards compatiblity.\n    // Moved to analytics.plugins.enable\n    enablePlugin: plugins.enable,\n    /// Do not use. Will be removed. Here for Backwards compatiblity.\n    /// Moved to analytics.plugins.disable\n    disablePlugin: plugins.disable,\n    // Do not use. Will be removed. Here for Backwards compatiblity.\n    // New plugins api\n    plugins: plugins,\n    /**\n     * Storage utilities for persisting data.\n     * These methods will allow you to save data in localStorage, cookies, or to the window.\n     * @typedef {Object} Storage\n     * @property {GetItem} getItem - Get value from storage\n     * @property {SetItem} setItem - Set storage value\n     * @property {RemoveItem} removeItem - Remove storage value\n     *\n     * @example\n     *\n     * // Pull storage off analytics instance\n     * const { storage } = analytics\n     *\n     * // Get value\n     * storage.getItem('storage_key')\n     *\n     * // Set value\n     * storage.setItem('storage_key', 'value')\n     *\n     * // Remove value\n     * storage.removeItem('storage_key')\n     */\n    storage: {\n      /**\n       * Get value from storage\n       * @typedef {Function} GetItem\n       * @param {String} key - storage key\n       * @param {Object} [options] - storage options\n       * @return {Any}\n       *\n       * @example\n       *\n       * analytics.storage.getItem('storage_key')\n       */\n      getItem: storage.getItem,\n      /**\n       * Set storage value\n       * @typedef {Function} SetItem\n       * @param {String} key - storage key\n       * @param {any} value - storage value\n       * @param {Object} [options] - storage options\n       *\n       * @example\n       *\n       * analytics.storage.setItem('storage_key', 'value')\n       */\n      setItem: (key, value, options) => {\n        store.dispatch({\n          type: EVENTS.setItemStart,\n          key: key,\n          value: value,\n          options: options\n        })\n      },\n      /**\n       * Remove storage value\n       * @typedef {Function} RemoveItem\n       * @param {String} key - storage key\n       * @param {Object} [options] - storage options\n       *\n       * @example\n       *\n       * analytics.storage.removeItem('storage_key')\n       */\n      removeItem: (key, options) => {\n        store.dispatch({\n          type: EVENTS.removeItemStart,\n          key: key,\n          options: options\n        })\n      },\n    },\n    /*\n     * Set the anonymous ID of the visitor\n     * @param {String} anonymousId - anonymous Id to set\n     * @param {Object} [options] - storage options\n     *\n     * @example\n     *\n     * // Set anonymous ID\n     * analytics.setAnonymousId('1234567')\n     */\n    setAnonymousId: (anonymousId, options) => {\n      /* sets temporary in memory id. Not to be relied on */\n      // set(tempKey(ANONID), anonymousId)\n      instance.storage.setItem(CONSTANTS.ANON_ID, anonymousId, options)\n    },\n    /*\n     * Events exposed by core analytics library and all loaded plugins\n     * @type {Array}\n     */\n    events: {\n      core: coreEvents,\n      plugins: allPluginEvents,\n      // byType: (type) => {} @Todo grab logic from engine and give inspectable events\n    }\n  }\n  const enrichMiddleware = storeAPI => next => action => {\n    if (!action.meta) {\n      action.meta = enrichMeta()\n    }\n    return next(action)\n  }\n  const middlewares = parsedOptions.middlewares.concat([\n    enrichMiddleware,\n    /* Core analytics middleware */\n    dynamicMiddlewares(before), // Before dynamic middleware <-- fixed pageStart .on listener\n    /* Plugin engine */\n    middleware.plugins(instance, getPlugins, {\n      all: allSystemEvents,\n      plugins: allPluginEvents\n    }),\n    middleware.storage(storage),\n    middleware.initialize(instance),\n    middleware.identify(instance, storage),\n    /* after dynamic middleware */\n    dynamicMiddlewares(after)\n  ])\n\n  /* Initial analytics state keys */\n  const coreReducers = {\n    context: context,\n    user: user(storage),\n    page: page,\n    track: track,\n    plugins: pluginsMiddleware(getPlugins),\n    queue: queue\n  }\n\n  let composeEnhancers = compose\n  let composeWithGlobalDebug = compose\n  if (isBrowser && config.debug) {\n    const devTools = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n    if (devTools) {\n      composeEnhancers = devTools({ trace: true, traceLimit: 25 })\n    }\n    composeWithGlobalDebug = function() {\n      if (arguments.length === 0) return Debug()\n      if (isObject(typeof arguments[0])) return composeWithDebug(arguments[0])\n      return composeWithDebug().apply(null, arguments)\n    }\n  }\n\n  const initialConfig = makeContext(config)\n\n  const intialPluginState = parsedOptions.pluginsArray.reduce((acc, plugin) => {\n    const { name, config, loaded } = plugin\n    const isEnabled = parsedOptions.pluginEnabled[name]\n    acc[name] = {\n      enabled: isEnabled,\n      // If plugin enabled & has no initialize method, set initialized to true, else false\n      initialized: (isEnabled) ? Boolean(!plugin.initialize) : false,\n      loaded: Boolean(loaded({ config })),\n      config\n    }\n    return acc\n  }, {})\n  \n  const initialState = {\n    context: initialConfig,\n    user: visitorInfo,\n    plugins: intialPluginState,\n    // Todo allow for more userland defined initial state?\n  }\n\n  /* Create analytics store! */\n  const store = createStore(\n    // register reducers\n    combineReducers({ ...coreReducers, ...customReducers }),\n    // set user defined initial state\n    initialState,\n    // register middleware & plugins used\n    composeWithGlobalDebug(\n      composeEnhancers(\n        applyMiddleware(...middlewares),\n      )\n    )\n  )\n\n  /* Supe up dispatch with callback promise resolver. Happens in enrichMeta */\n  function enhanceDispatch(fn) {\n    return function (event, resolver, callbacks) {\n      // console.log('original event', event)\n      const meta = enrichMeta(event.meta, resolver, ensureArray(callbacks))\n      // if (resolver) console.log('dispatch resolver', resolver)\n      // if (callbacks) console.log('dispatch callbacks', callbacks)\n      const newEvent = { ...event, ...{ meta: meta } }\n      // console.log('newEvent', newEvent)\n      return fn.apply(null, [ newEvent ])\n    }\n  }\n\n  // Automatically apply meta to dispatch calls\n  store.dispatch = enhanceDispatch(store.dispatch)\n\n  /* Synchronously call bootstrap & register Plugin methods */\n  const pluginKeys = Object.keys(customPlugins)\n\n  /* Bootstrap analytic plugins */\n  store.dispatch({\n    type: EVENTS.bootstrap,\n    plugins: pluginKeys,\n    config: initialConfig,\n    params: params,\n    user: visitorInfo,\n    initialUser,\n    persistedUser\n  })\n\n  const enabledPlugins = pluginKeys.filter((name) => parsedOptions.pluginEnabled[name])\n  const disabledPlugins = pluginKeys.filter((name) => !parsedOptions.pluginEnabled[name])\n \n  /* Register analytic plugins */\n  store.dispatch({\n    type: EVENTS.registerPlugins,\n    plugins: pluginKeys,\n    enabled: parsedOptions.pluginEnabled,\n  })\n\n  /* dispatch register for individual plugins */\n  parsedOptions.pluginsArray.map((plugin, i) => {\n    const { bootstrap, config, name } = plugin\n    if (bootstrap && isFunction(bootstrap)) {\n      bootstrap({ instance, config, payload: plugin })\n    }\n    /* Register plugins */\n    store.dispatch({\n      type: EVENTS.registerPluginType(name),\n      name: name,\n      enabled: parsedOptions.pluginEnabled[name],\n      plugin: plugin\n    })\n\n    /* All plugins registered initialize, is last loop */\n    if (parsedOptions.pluginsArray.length === (i + 1)) {\n      store.dispatch({\n        type: EVENTS.initializeStart,\n        plugins: enabledPlugins,\n        disabled: disabledPlugins\n      })\n    }\n  })\n\n  if (BROWSER) {\n    /* Watch for network events */\n    watch((offline) => {\n      store.dispatch({\n        type: (offline) ? EVENTS.offline : EVENTS.online,\n      })\n    })\n    /* Tick heartbeat for queued events */\n    heartBeat(store, getPlugins, instance)\n  }\n\n  function appendArguments(fn) {\n    return function () {\n      /* Get original args */\n      const args = Array.prototype.slice.call(arguments)\n      /* Create clone of args */\n      let newArgs = new Array(fn.length)\n      for (let i = 0; i < args.length; i++) {\n        newArgs[i] = args[i]\n      }\n      /* Append new arg to end */\n      newArgs[newArgs.length] = instance\n      // Set instance on extended methods\n      return fn.apply({ instance }, newArgs)\n    }\n  }\n\n  /* Return analytics instance */\n  return instance\n}\n\n// Duplicated strings\nconst before = 'before'\nconst after = 'after'\n\nexport default analytics\n\n/*\n * analytics.init exported for standalone browser build\n * CDN build exposes global _analytics variable\n *\n * Initialize instance with _analytics.init() or _analytics['default']()\n */\nexport { analytics as init }\n\n/*\n * analytics.Analytics exported for node usage\n *\n * Initialize instance with _analytics.init() or _analytics['default']()\n */\nexport { analytics as Analytics }\n/*\n * Core Analytic events. These are exposed for third party plugins & listeners\n * Use these magic strings to attach functions to event names.\n * @type {Object}\n */\nexport { EVENTS }\n\nexport { CONSTANTS }\n",null,"/**\n * Decode URI string\n *\n * @param {String} s string to decode\n * @returns {String} decoded string\n * @example\n * decode(\"Bought%20keyword)\n * => \"Bought keyword\"\n */\nexport function decodeUri(s) {\n  try {\n    return decodeURIComponent(s.replace(/\\+/g, ' '))\n  } catch (e) {\n    return null\n  }\n}\n","import { isBrowser } from '@analytics/type-utils'\n\n/**\n * @returns {string | undefined}\n */\nexport function getBrowserLocale() {\n  if (!isBrowser) return\n  const { language, languages, userLanguage } = navigator\n  if (userLanguage) return userLanguage // IE only\n  return (languages && languages.length) ? languages[0] : language\n}\n","\n/**\n * @returns {string | undefined}\n */\nexport function getTimeZone() {\n  try {\n    return Intl.DateTimeFormat().resolvedOptions().timeZone\n  } catch (error) {}\n}\n","import { isBrowser } from '@analytics/type-utils'\n\n/**\n * @param {string | null | undefined} ref\n * @returns {boolean | undefined}\n */\nexport function isExternalReferrer(ref) {\n  if (!isBrowser) return false\n  const referrer = ref || document.referrer\n  if (referrer) {\n    const port = window.document.location.port\n    let ref = referrer.split('/')[2]\n    if (port) {\n      ref = ref.replace(`:${port}`, '')\n    }\n    return ref !== window.location.hostname\n  }\n  return false\n}\n","import { isBrowser, isString, isRegex } from '@analytics/type-utils'\n\n/**\n * Check if a script is loaded\n * @param  {String|RegExp} script - Script src as string or regex\n * @return {Boolean} is script loaded\n */\nexport function isScriptLoaded(script) {\n  if (!isBrowser) return true\n  const scripts = document.getElementsByTagName('script')\n  return !!Object.keys(scripts).filter((key) => {\n    const { src } = scripts[key]\n    if (isString(script)) {\n      return src.indexOf(script) !== -1\n    } else if (isRegex(script)) {\n      return src.match(script)\n    }\n    return false\n  }).length\n}\n","\n/**\n * Strip a query parameter from a url string\n * @param  {string} url   - url with query parameters\n * @param  {string} param - parameter to strip\n * @return {string} cleaned url\n */\nexport function paramsClean(url, param) {\n  const search = (url.split('?') || [ , ])[1] // eslint-disable-line\n  if (!search || search.indexOf(param) === -1) {\n    return url\n  }\n  // remove all utm params from URL search\n  const regex = new RegExp(`(\\\\&|\\\\?)${param}([_A-Za-z0-9\"+=.\\\\/\\\\-@%]+)`, 'g')\n  const cleanSearch = `?${search}`.replace(regex, '').replace(/^&/, '?')\n  // replace search params with clean params\n  const cleanURL = url.replace(`?${search}`, cleanSearch)\n  // use browser history API to clean the params\n  return cleanURL\n}\n","import {decodeUri} from './decodeUri'\n\n/**\n * Get a given query parameter value\n * @param  {string} param - Key of parameter to find\n * @param  {string} url - url to search\n * @return {string} match\n */\nexport function paramsGet(param, url) {\n  return decodeUri((RegExp(`${param}=(.+?)(&|$)`).exec(url) || [, ''])[1])\n}\n","import { isBrowser } from '@analytics/type-utils'\nimport { decodeUri } from './decodeUri'\n\n/**\n * Get search string from given url\n * @param  {string} [url] - optional url string. If no url, window.location.search will be used\n * @return {string} url search string\n */\nfunction getSearchString(url) {\n  if (url) {\n    const p = url.match(/\\?(.*)/)\n    return (p && p[1]) ? p[1].split('#')[0] : ''\n  }\n  return isBrowser && window.location.search.substring(1)\n}\n\n/**\n * Parse url parameters into javascript object\n * @param  {string} [url] - URI to parse. If no url supplied window.location will be used\n * @return {object} parsed url parameters\n */\nexport function paramsParse(url) {\n  return getParamsAsObject(getSearchString(url))\n}\n\n/*\n?first=abc&a[]=123&a[]=false&b[]=str&c[]=3.5&a[]=last\nhttps://random.url.com?Target=Report&Method=getStats&fields%5B%5D=Offer.name&fields%5B%5D=Advertiser.company&fields%5B%5D=Stat.clicks&fields%5B%5D=Stat.conversions&fields%5B%5D=Stat.cpa&fields%5B%5D=Stat.payout&fields%5B%5D=Stat.date&fields%5B%5D=Stat.offer_id&fields%5B%5D=Affiliate.company&groups%5B%5D=Stat.offer_id&groups%5B%5D=Stat.date&filters%5BStat.affiliate_id%5D%5Bconditional%5D=EQUAL_TO&filters%5BStat.affiliate_id%5D%5Bvalues%5D=1831&limit=9999\nhttps://random.url.com?Target=Offer&Method=findAll&filters%5Bhas_goals_enabled%5D%5BTRUE%5D=1&filters%5Bstatus%5D=active&fields%5B%5D=id&fields%5B%5D=name&fields%5B%5D=default_goal_name\nhttp://localhost:3000/?Target=Offer&Method=findAll&filters[has_goals_enabled][TRUE]=1&filters[status]=active&filters[wow]arr[]=yaz&filters[wow]arr[]=naz&fields[]=id&fields[]=name&fields[]=default_goal_name */\n\n\n\nfunction getParamsAsObject(query) {\n  let params = Object.create(null)\n  let temp\n  const re = /([^&=]+)=?([^&]*)/g\n\n  while (temp = re.exec(query)) {\n    var k = decodeUri(temp[1])\n    var v = decodeUri(temp[2])\n    if (k.substring(k.length - 2) === '[]') {\n      k = k.substring(0, k.length - 2);\n      (params[k] || (params[k] = [])).push(v)\n    } else {\n      params[k] = (v === '') ? true : v\n    }\n  }\n\n  for (var prop in params) {\n    var arr = prop.split('[')\n    if (arr.length > 1) {\n      assign(params, arr.map((x) => x.replace(/[?[\\]\\\\ ]/g, '')), params[prop])\n      delete params[prop]\n    }\n  }\n  return params\n}\n\nfunction assign(obj, keyPath, value) {\n  var lastKeyIndex = keyPath.length - 1\n  for (var i = 0; i < lastKeyIndex; ++i) {\n    var key = keyPath[i]\n    if (key === '__proto__' || key === 'constructor') {\n      break;\n    }\n    if (!(key in obj)) { \n      obj[key] = {} \n    }\n    obj = obj[key]\n  }\n  obj[keyPath[lastKeyIndex]] = value\n}\n\n\n/*\nhttps://github.com/choojs/nanoquery/blob/791cbdfe49cc380f0b2f93477572128946171b46/browser.js\nvar reg = /([^?=&]+)(=([^&]*))?/g\n\nfunction qs (url) {\n  var obj = {}\n  url.replace(/^.*\\?/, '').replace(reg, function (a0, a1, a2, a3) {\n    var value = decodeURIComponent(a3)\n    var key = decodeURIComponent(a1)\n    if (obj.hasOwnProperty(key)) {\n      if (Array.isArray(obj[key])) obj[key].push(value)\n      else obj[key] = [obj[key], value]\n    } else {\n      obj[key] = value\n    }\n  })\n  return obj\n}\n*/","import { isBrowser } from '@analytics/type-utils'\nimport { paramsClean } from './paramsClean'\n\n/**\n * Removes params from url in browser\n * @param  {string}   param       - param key to remove from current URL\n * @param  {() => void} [callback]  - callback function to run. Only runs in browser\n * @return {PromiseLike<void>}\n */\nexport function paramsRemove(param, callback) {\n  if (!isBrowser) return Promise.resolve()\n\n  return new Promise((resolve, reject) => {\n    if (window.history && window.history.replaceState) {\n      const url = window.location.href\n      const cleanUrl = paramsClean(url, param)\n      if (url !== cleanUrl) {\n        /* replace URL with history API */\n        // eslint-disable-next-line no-restricted-globals\n        history.replaceState({}, '', cleanUrl)\n      }\n    }\n\n    if (callback) callback()\n\n    return resolve()\n  })\n}\n","import { isBrowser } from '@analytics/type-utils'\n\n/**\n * Get host domain of url\n * @param  {String} url - href of page\n * @return {String} hostname of page\n *\n * @example\n *  getDomainHost('https://subdomain.my-site.com/')\n *  > subdomain.my-site.com\n */\nexport function getDomainHost(url) {\n  if (!isBrowser) return null\n  const a = document.createElement('a')\n  a.setAttribute('href', url)\n  return a.hostname\n}\n\n/**\n * Get host domain of url\n * @param  {String} url - href of page\n * @return {String} base hostname of page\n *\n * @example\n *  getDomainBase('https://subdomain.my-site.com/')\n *  > my-site.com\n */\nexport function getDomainBase(url) {\n  const host = getDomainHost(url) || ''\n  return host.split('.').slice(-2).join('.')\n}\n\n/**\n * Remove TLD from domain string\n * @param  {String} baseDomain - host name of site\n * @return {String}\n * @example\n *  trimTld('google.com')\n *  > google\n */\nexport function trimTld(baseDomain) {\n  const arr = baseDomain.split('.')\n  return (arr.length > 1) ? arr.slice(0, -1).join('.') : baseDomain\n}\n\nexport default {\n  trimTld,\n  getDomainBase,\n  getDomainHost\n}\n","import { isBrowser } from '@analytics/type-utils'\nimport { paramsParse } from './paramsParse'\nimport { isExternalReferrer } from './isExternalReferrer'\nimport { trimTld, getDomainBase } from './url'\n\nconst googleKey = 'google'\n\n/**\n * @typedef {{\n *  campaign: string,\n *  referrer?: string,\n * } & DomainObject & Object.<string, any>} ReferrerObject\n */\n\n/**\n * Checks a given url and parses referrer data\n * @param  {String} [referrer] - (optional) referring URL\n * @param  {String} [currentUrl] - (optional) the current url\n * @return {ReferrerObject}     [description]\n */\nexport function parseReferrer(referrer, currentUrl) {\n  if (!isBrowser) return false\n  // default referral data\n  let refData = {\n    'source': '(direct)',\n    'medium': '(none)',\n    'campaign': '(not set)'\n  }\n  // Add raw ref url if external\n  if (referrer && isExternalReferrer(referrer)) {\n    refData.referrer = referrer\n  }\n\n  const domainInfo = parseDomain(referrer)\n  // Read referrer URI and infer source\n  if (domainInfo && Object.keys(domainInfo).length) {\n    refData = Object.assign({}, refData, domainInfo)\n  }\n\n  // Read URI params and use set utm params\n  const params = paramsParse(currentUrl)\n  const paramKeys = Object.keys(params)\n  if (!paramKeys.length) {\n    return refData\n  }\n\n  // set campaign params off GA matches\n  const gaParams = paramKeys.reduce((acc, key) => {\n    // match utm params & dclid (display) & gclid (cpc)\n    if (key.match(/^utm_/)) {\n      acc[`${key.replace(/^utm_/, '')}`] = params[key]\n    }\n    // https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters\n    // dclid - cpc Cost-Per-Thousand Impressions\n    // gclid - cpc Cost per Click\n    if (key.match(/^(d|g)clid/)) {\n      acc['source'] = googleKey\n      acc['medium'] = (params.gclid) ? 'cpc' : 'cpm'\n      acc[key] = params[key]\n    }\n    return acc\n  }, {})\n\n  return Object.assign({}, refData, gaParams)\n}\n\n/**\n * @typedef {{\n *  source: string,\n *  medium: string,\n *  term?: string\n * }} DomainObject\n */\n\n/**\n * Client side domain parser for determining marketing data.\n * @param  {String} referrer - ref url\n * @return {DomainObject | boolean}\n */\nfunction parseDomain(referrer) {\n  if (!referrer || !isBrowser) return false\n\n  let referringDomain = getDomainBase(referrer)\n  const a = document.createElement('a')\n  a.href = referrer\n\n  // Shim for the billion google search engines\n  if (a.hostname.indexOf(googleKey) > -1) {\n    referringDomain = googleKey\n  }\n\n  // If is search engine\n  if (searchEngines[referringDomain]) {\n    const searchEngine = searchEngines[referringDomain]\n    const queryParam = (typeof searchEngine === 'string') ? searchEngine : searchEngine.p\n    const termRegex = new RegExp(queryParam + '=.*?([^&#]*|$)', 'gi')\n    const term = a.search.match(termRegex)\n\n    return {\n      source: searchEngine.n || trimTld(referringDomain),\n      medium: 'organic',\n      term: (term ? term[0].split('=')[1] : '') || '(not provided)'\n    }\n  }\n\n  // Default\n  const medium = (!isExternalReferrer(referrer)) ? 'internal' : 'referral'\n  return {\n    source: a.hostname,\n    medium: medium\n  }\n}\n\n/**\n * Search engine query string data\n * @type {Object}\n */\nconst Q = 'q'\nconst QUERY = 'query'\nconst searchEngines = {\n  'daum.net': Q,\n  'eniro.se': 'search_word',\n  'naver.com': QUERY,\n  'yahoo.com': 'p',\n  'msn.com': Q,\n  'aol.com': Q,\n  'ask.com': Q,\n  'baidu.com': 'wd',\n  'yandex.com': 'text',\n  'rambler.ru': 'words',\n  'google': Q,\n  'bing.com': {\n    'p': Q,\n    'n': 'live'\n  },\n}\n","/* ref: http://bit.ly/2daP79j */\n/**\n * @return {string}\n */\nexport function uuid() {\n  var u = '',\n  m = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx',\n  i = 0,\n  rb = Math.random() * 0xffffffff|0;\n\n  while (i++<36) {\n    var c = m [i-1],\n    r = rb&0xf,\n    v = c=='x' ? r : (r&0x3|0x8);\n\n    u += (c=='-' || c=='4') ? c : v.toString(16);\n    rb = i%8==0 ? Math.random() * 0xffffffff|0 : rb>>4\n  }\n  return u\n}\n","/**\n * @template {Function} F;\n * @param {F} func;\n * @param {number} wait;\n * @return {F};\n */\nexport function throttle(func, wait) {\n  var context, args, result\n  var timeout = null\n  var previous = 0\n  var later = function () {\n    previous = new Date()\n    timeout = null\n    result = func.apply(context, args)\n  };\n  return function () {\n    var now = new Date()\n    if (!previous) {\n      previous = now\n    }\n    var remaining = wait - (now - previous)\n    context = this\n    args = arguments\n    if (remaining <= 0) {\n      clearTimeout(timeout)\n      timeout = null\n      previous = now\n      result = func.apply(context, args)\n    } else if (!timeout) {\n      timeout = setTimeout(later, remaining)\n    }\n    return result\n  }\n}\n",null,"export default function dlv(obj, key, def, p, undef) {\n\tkey = key.split ? key.split('.') : key;\n\tfor (p = 0; p < key.length; p++) {\n\t\tobj = obj ? obj[key[p]] : undef;\n\t}\n\treturn obj === undef ? def : obj;\n}\n",null,"\n/*\n  Constants for reuse\n*/\n\nexport const FUNCTION = 'function'\nexport const STRING = 'string'\nexport const UNDEFINED = 'undefined'\nexport const BOOLEAN = 'boolean'\nexport const OBJECT = 'object'\nexport const ARRAY = 'array'\nexport const NUMBER = 'number'\nexport const SYMBOL = 'symbol'\nexport const NULL = 'null'\nexport const ERROR = 'error'\nexport const TYPE_ERROR = 'typeError'\nexport const SYNTAX_ERROR = 'syntaxError'\nexport const ASYNC_FUNCTION = 'asyncFunction'\nexport const GENERATOR_FUNCTION = 'generatorFunction'\nexport const ASYNC_GENERATOR_FUNCTION = 'asyncGeneratorFunction'\n\nexport const noOp = () => {}\nexport const ANY = 'any'\nexport const ALL = '*'\nexport const NONE = 'none'\nexport const HIDDEN = 'hidden'\nexport const PREFIX = '__'\n\n/* DOM Constants */\nexport const FORM = 'form'\nexport const INPUT = 'input'\nexport const BUTTON = 'button'\nexport const SELECT = 'select'\nexport const CHANGE = 'change'\nexport const SUBMIT = 'submit'\n\n/* Regex patterns */\nexport const REGEX_ISO = /^\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d+([+-][0-2]\\d:[0-5]\\d|Z)$/\nexport const REGEX_EMAIL = /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/\nexport const REGEX_JSON = /^\\{[\\s\\S]*\\}$|^\\[[\\s\\S]*\\]$/\n\n/* \nEnvironment checks\n */\n// alt implementations \n// - https://github.com/MikeKovarik/platform-detect\n/** @type {Object} */\nconst PROCESS = typeof process !== UNDEFINED ? process : {}\n\n/** @type {String} */\nexport const ENV = (PROCESS.env && PROCESS.env.NODE_ENV) || ''\n\n/** @type {Boolean} */\nexport const isProd = ENV === 'production'\n\n/** @type {Boolean} */\nexport const isStaging = ENV === 'staging'\n\n/** @type {Boolean} */\nexport const isDev = ENV === 'development'\n\n/** @type {Boolean} */\nexport const isBrowser = typeof document !== UNDEFINED\n/** @type {Boolean} */\nexport const isLocalHost = isBrowser && window.location.hostname === 'localhost'\n\n/** @type {Boolean} */\nexport const isNode = PROCESS.versions != null && PROCESS.versions.node != null\n\n/** @type {Boolean} */\nexport const isDeno = typeof Deno !== UNDEFINED && typeof Deno.core !== UNDEFINED;\n\n/** @type {Boolean} */\nexport const isWebWorker = typeof self === OBJECT && self.constructor && self.constructor.name === 'DedicatedWorkerGlobalScope'\n\n/** @type {Boolean} */\nexport const isJsDom = (isBrowser && window.name === 'nodejs') || (typeof navigator !== UNDEFINED && typeof navigator.userAgent !== UNDEFINED && (navigator.userAgent.includes('Node.js') || navigator.userAgent.includes('jsdom')))\n\n/* \nType checks\n */\n\nfunction text(method, s) {\n  return s.charAt(0)[method]() + s.slice(1)\n}\n\nconst upper = text.bind(null, 'toUpperCase')\nconst lower = text.bind(null, 'toLowerCase')\n\n/**\n * Returns the object type of the given payload\n * @param {*} val\n * @returns {string}\n */\nexport function getTypeName(val) {\n  if (isNull(val)) return upper(NULL)\n  return (typeof val === OBJECT) ? ctorName(val) : Object.prototype.toString.call(val).slice(8, -1)\n}\n\n/**\n * Returns the object type of the given payload\n * @param {*} val\n * @returns {string}\n */\nexport function getType(val, toLowerCase = true) {\n  const type = getTypeName(val)\n  // console.log('type', type)\n  return (toLowerCase) ? lower(type) : type\n}\n\n// export function getType(val) {\n//   if (isNull(val)) return NULL\n//   const type = typeof val\n//   if (type === OBJECT) return ctorName(val).toLowerCase()\n//   return type\n// }\n\nfunction typeOf(kind, val) {\n  return typeof val === kind\n}\n\n/** \n * Check if value is function.\n * @param x\n * @return {x is Function}\n */\nexport const isFunction = typeOf.bind(null, FUNCTION)\n\n/** \n * Check if value is string.\n * @param x\n * @return {x is string}\n */\nexport const isString = typeOf.bind(null, STRING)\n\n/** \n * Check if value is undefined.\n * @param x\n * @return {x is undefined}\n */\nexport const isUndefined = typeOf.bind(null, UNDEFINED)\n\n/** \n * Check if value is not undefined.\n * @param x\n * @return {x is undefined}\n */\nexport function isDefined(x) {\n  return !isUndefined(x)\n}\n\n/** \n * @param x\n * @return {x is boolean}\n */\nexport const isBoolean = typeOf.bind(null, BOOLEAN)\n\n/** \n * @param x\n * @return {x is symobl}\n */\nexport const isSymbol = typeOf.bind(null, SYMBOL)\n\n/** \n * @param x\n * @return {x is boolean}\n * @example\n * isNull(null)\n * // true\n */\nexport function isNull(x) {\n  return x === null\n}\n\n/** \n * Check if value is number.\n * @param n\n * @return {boolean}\n * @example\n * > isNumber(0)\n * true\n * > isNumber(1)\n * true\n * > isNumber(1.1)\n * true\n * > isNumber(0xff)\n * true\n * > isNumber(0644)\n * true\n * > isNumber(6.2e5)\n * true\n * > isNumber(NaN)\n * false\n * > isNumber(Infinity)\n * true\n */\nexport function isNumber(n) {\n  return getType(n) === NUMBER && !isNaN(n)\n}\n\nexport function isNumberLike(n) {\n  return !isNaN(parseFloat(n))\n}\n\n/** \n * Check if value is ES2015 `class`.\n * @param x\n * @return {x is Class}\n */\nexport function isClass(x) {\n  if (isFunction(x)) {\n    return /^class /.test(Function.prototype.toString.call(x))\n  }\n  return false\n}\n\n/** \n * @template T\n * @param x\n * @return {x is Array<T>}\n */\nexport function isArray(x) {\n  return getType(x) === ARRAY\n}\n\n/** \n * @param obj\n * @return {obj is Object}\n */\nexport function isObject(obj) {\n  if (!isObjectLike(obj)) return false\n\n  let proto = obj\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto)\n  }\n\n  return Object.getPrototypeOf(obj) === proto\n}\n\nexport function isObjectLike(obj) {\n  return obj && (typeof obj === OBJECT || obj !== null)\n}\n\n/**\n* Tests if a value is a parseable JSON string.\n* @param {*} x - value to test\n* @returns {boolean} boolean indicating if a value is a parseable JSON string\n* @example\n* isJson('{\"a\":5}') // returns true\n* isJson('[]') // returns true\n* isJson('{a\":5}') // returns false\n*/\nexport function isJson(x) {\n  if (!isString(x) || !REGEX_JSON.test(x)) return false\n  try {\n    JSON.parse(x)\n  } catch (e) { \n    return false\n  }\n  return true\n}\n\n/**\n * Is primative scalar value\n * @param x\n * @return {boolean}\n * @example\n   isPrimitive(true) =>  true\n   isPrimitive({}) => false\n   isPrimitive(0) =>  true\n   isPrimitive('1') =>  true\n   isPrimitive(1.1) =>  true\n   isPrimitive(NaN) =>  true\n   isPrimitive(Infinity) =>  true\n   isPrimitive(function() {}) => false\n   isPrimitive(Date), => false\n   isPrimitive(null) =>  true\n   isPrimitive(undefined) =>  true\n */\nexport function isPrimitive(x) {\n  if (isNull(x)) return true\n  // if (isNaN(x)) return false\n  switch (typeof x) {\n    case STRING:\n    case NUMBER:\n    case SYMBOL:\n    case UNDEFINED:\n    case BOOLEAN:\n      return true\n    default:\n      return false\n  }\n}\n\n/**\n* Tests if an object has a specified method name.\n* @param {*} value - value to test\n* @param {*} property - property to test\n* @returns {boolean} boolean indicating if an object has a specified method name\n* @example\n* const obj = {\n*   key: myFunc,\n*   keyTwo: 'foobar'\n* }\n* isMethod(obj, 'key' ) // returns true\n* isMethod(obj, 'keyTwo' ) // returns false\n* isMethod(obj, 'otherThing' ) // returns false\n*/\nexport function isMethod(value, prop) {\n  return isObject(value) && isFunction(value[prop])\n}\n\n/**\n * Returns true if the input is a Promise.\n * @param {*} x - The input to test\n * @returns {boolean}\n */\nexport function isPromise(x) {\n  if (!x) return false\n  return !!(!isUndefined(Promise) && x instanceof Promise || x.then && isFunction(x.then))\n}\n\n/**\n * Returns true if the input is a generator.\n * @param {*} x - The input to test\n * @returns {boolean}\n */\nexport function isGenerator(x) {\n  return isObjectLike(x) && isFunction(x.throw) && isFunction(x.return) && isFunction(x.next)\n}\n\n/** \n * Is generator function\n * @param x\n * @return {boolean}\n * @example\n   isGeneratorFunction(() => {}) =>  false\n   isGeneratorFunction(function* () => {}) =>  true\n   isGeneratorFunction(function * () {\n     yield 'my-val'\n   }))\n */\nexport function isGeneratorFunction(x) {\n  return getType(x) === GENERATOR_FUNCTION\n}\n\n/** \n * Is async function\n * @param x\n * @return {boolean}\n * @example\n   isAsyncFunction(() => {}) =>  false\n   isAsyncFunction(async () => {}) =>  true\n */\nexport function isAsyncFunction(x) {\n  return getType(x) === ASYNC_FUNCTION\n}\n\n\nexport function ctorName(x) {\n  return isFunction(x.constructor) ? x.constructor.name : null\n}\n\n/**\n * Returns true if the input is a Set.\n * @param {*} x - The input to test\n * @returns {boolean}\n */\nexport function isSet(value) {\n  return value instanceof Set\n}\n\n/**\n * Returns true if the input is a Map.\n * @param {*} x - The input to test\n * @returns {boolean}\n */\nexport function isMap(value) {\n  return value instanceof Map\n}\n\n/**\n * Check if value is regexp\n * @param {*} value - Value to check\n * @return {boolean} \n */\nexport function isRegex(value) {\n  return value instanceof RegExp\n}\n\n/**\n * Check if value is Buffer\n * @param {*} value - Value to check\n * @return {boolean} \n */\nexport function isBuffer(val) {\n  if (val.constructor && isFunction(val.constructor.isBuffer)) {\n    return val.constructor.isBuffer(val)\n  }\n  return false\n}\n\n/**\n * Check if value is Error\n * @param x - Object to check\n * @return {Boolean} If value is error\n * @example\n * isError(new Error()) // True\n */\nexport function isError(x) {\n  return x instanceof Error || (isString(x.message) && x.constructor && isNumber(x.constructor.stackTraceLimit))\n}\n\n/**\n * Check if value error like (i.e has the name and message properties, both of which are strings)\n * @param obj - Object to check\n * @return {Boolean} If object is error-like\n * via https://github.com/Luke-zhang-04/utils/blob/master/src/typeGuards.ts#L62\n * @example\n *\n * ```js\n * isErrorLike(new Error()) // True\n * isErrorLike({name: \"Error!\", message: \"This is an error\", other: 0}) // True\n * isErrorLike({}) // False\n * isErrorLike({name: \"Error\", message: null}) // False\n *\n * // Works as a typguard\n * const something = {name: \"Error\", message: \"This is an error\"} as unknown\n *\n * if (isErrorLike(something)) {\n *   console.log(something.name) // No Typescript error\n * }\n * ```\n */\nexport function isErrorLike(obj) {\n  return isObjectLike(obj) && isString(obj.message) && isString(obj.name)\n}\n\nfunction errorType(ErrKind, value) {\n  if (typeof value !== 'object' || isNull(value)) return false\n  // Check for `TypeError` objects from the same realm (same Node.js `vm` or same `Window` object)...\n  if (value instanceof ErrKind) return true\n  const typeName = getType(new ErrKind(''))\n  // All `TypeError` objects are `Error` objects...\n  if (isError(value)) {\n    while (value) {\n      if (getType(value) === typeName) {\n        return true\n      }\n        value = Object.getPrototypeOf(value)\n    }\n  }\n  return false\n}\n\nexport const isTypeError = errorType.bind(null, TypeError)\n\nexport const isSyntaxError = errorType.bind(null, SyntaxError)\n\n/** \n * @param func - function to check if noOp\n * @return {Boolean} - is noOp\n * @examples\n   function foo() {}\n   isNoOp(foo) // true\n   isNoOp(() => { }) // true\n   isNoOp(() => { console.log('hi') }) // false\n */\nexport function isNoOp(func) {\n  if (!isFunction(func)) return false\n  const emptyFunc = /{(\\r|\\n|\\s)*}/gm\n  const noOpStr = noOp + ''\n  const funcString = (func.toString().match(emptyFunc) || [''])[0].replace(emptyFunc, noOpStr)\n  return noOpStr === funcString\n}\n\n/**\n * Check if value is function arguments\n * @param {*} val \n * @returns \n */\nexport function isArguments(val) {\n  try {\n    if (isNumber(val.length) && isFunction(val.callee)) return true\n  } catch (err) {\n    if (err.message.indexOf('callee') !== -1) return true\n  }\n  return false\n}\n\n/**\n * Check if value is truthy\n * @param {*} value \n * @return {Boolean} - is truthy value\n */\nexport function isTruthy(v) {\n  if (isString(v) && v.toLowerCase() === 'false') return false\n  return !!v\n}\n\n/**\n * Check if value is falsy\n * @param {*} x \n * @return {Boolean} - is falsy value\n * @example\n * isFalsy(false) // returns true\n * isFalsy(null) // returns true\n * isFalsy('') // returns true\n * isFalsy(0) // returns true\n * isFalsy(void 0) // returns true\n * isFalsy(NaN) // returns true\n * isFalsy([]) // returns false\n */\nexport function isFalsy(x) {\n  return x ? false : true\n}\n\n// ^ future updates https://github.com/thenativeweb/boolean\n\n/**\n * Check if value is true\n * @param {*} x \n * @return {Boolean} - is true\n */\nexport function isTrue(x) {\n  return x === true\n}\n\n/**\n * Check if value is true\n * @param {*} x \n * @return {Boolean} - is true\n */\nexport function isFalse(x) {\n  return x === false\n}\n\n/**\n * Check if value is email\n * @param {*} x \n * @return {Boolean} - is email like value\n */\nexport function isEmail(x) {\n  if (x.length > 320) return false\n  return REGEX_EMAIL.test(x)\n}\n\n/**\n * Check if valie is date\n * @param {*} val \n * @returns {Boolean}\n */\nexport function isDate(x) {\n  if (x instanceof Date) return true\n  return isFunction(x.toDateString) && isFunction(x.getDate) && isFunction(x.setDate)\n}\n\n/**\n * Check if value is ISO date e.g. '2022-01-02T06:45:28.547Z'\n * @param {*} x\n * @return {Boolean} - is email like value\n */\nexport function isIsoDate(x) {\n  return REGEX_ISO.test(x)\n}\n\n/**\n * Is value empty\n * @param {*} x \n * @returns {Boolean}\n * @example\n * isEmpty(null)\n *\n * isEmpty([1, 2, 3])\n * // => false\n *\n * isEmpty('abc')\n * // => false\n *\n * isEmpty({ 'a': 1 })\n * // => false\n */\nexport function isEmpty(x) {\n  if (isNull(x)) return true\n  if (isArray(x)) return !x.length\n  if (isSet(x) || isMap(x)) return !x.size\n  if (isObject(x)) return !Object.keys(x).length\n  return true\n}\n\n/* \nHTML Element checks\n */\n\n/** \n * @param obj\n * @return {obj is NodeList}\n */\nexport function isNodeList(obj) {\n  return NodeList.prototype.isPrototypeOf(obj)\n}\n\n/**\n * Check if input is DOM element\n * @param {HTMLElement|*} element\n * @return {boolean} \n */\nexport function isElement(element, type) {\n  const isEl = element instanceof Element || element instanceof HTMLDocument\n  if (!isEl || !type) return isEl\n  return isNodeType(element, type)\n}\n\n/**\n * Check if element is specific DOMNode type\n * @param {HTMLElement|*} element\n * @param {String} type\n * @return {boolean}\n */\nexport function isNodeType(element, type = '') {\n  return element && element.nodeName === type.toUpperCase()\n}\n\nfunction bindArgs(fn, ...boundArgs) {\n  return function(...args) {\n    return fn(...args, ...boundArgs)\n  }\n}\n\n/**\n * Check if element is form element\n * @param {HTMLElement} element\n * @return {boolean} \n */\nexport const isForm = bindArgs(isElement, FORM)\n\n/**\n * Check if element is button element\n * @param {HTMLElement} element\n * @return {boolean} \n */\nexport const isButton = bindArgs(isElement, BUTTON)\n\n/**\n * Check if element is input element\n * @param {HTMLElement} element\n * @return {boolean} \n */\nexport const isInput = bindArgs(isElement, INPUT)\n\n/**\n * Check if element is select element\n * @param {HTMLElement} element\n * @return {boolean} \n */\nexport const isSelect = bindArgs(isElement, SELECT)\n\n/**\n * Check if DOM element is hidden\n * @param {HTMLElement|null|undefined} element\n * @param {HTMLElement|null|undefined} until\n * @return {boolean}\n */\nexport function isHidden(element, until) {\n  if (!element || getComputedStyle(element).visibility === HIDDEN) return true\n\n  while (element) {\n    if (until != null && element === until) return false\n    if (getComputedStyle(element).display === NONE) return true\n    element = element.parentElement\n  }\n\n  return false\n}\n\n/* \nEnsure Values\n */\n\n/**\n * Ensure value returned is Array\n * @param {*} singleOrArray \n * @returns [*]\n */\nexport function ensureArray(singleOrArray) {\n  if (!singleOrArray) return []\n  if (isArray(singleOrArray)) return singleOrArray\n  return [singleOrArray]\n}\n",null,"import { OBJECT, PREFIX, UNDEFINED } from '@analytics/type-utils'\n\nexport const GLOBAL = 'global'\n\nexport const KEY = PREFIX + GLOBAL + PREFIX\n\nexport const globalContext = (typeof self === OBJECT && self.self === self && self) || (typeof global === OBJECT && global[GLOBAL] === global && global) || this\n\n/* initialize global object */\nif (!globalContext[KEY]) {\n  globalContext[KEY] = {}\n}\n/**\n * Get value from global context\n * @param {string} key - Key of value to get\n * @returns {*} value\n */\nexport function get(key) {\n  return globalContext[KEY][key]\n}\n\n/**\n * Set value to global context\n * @param {string} key - Key of value to set\n * @param {*} value \n * @returns value\n */\nexport function set(key, value) {\n  return globalContext[KEY][key] = value\n}\n\n/**\n * Remove value to global context\n * @param {string} key - Key of value to remove\n */\nexport function remove(key) {\n  delete globalContext[KEY][key]\n}\n\n/**\n * Wrap localStorage & session storage checks\n * @param {string} type - localStorage or sessionStorage\n * @param {string} storageOperation - getItem, setItem, removeItem\n * @param {function} fallbackFunction - fallback function\n */\nexport function wrap(type, operation, fallback) {\n  let fn\n  try {\n    if (hasSupport(type)) {\n      const storage = window[type]\n      fn = storage[operation].bind(storage)\n    }\n  } catch(e) {}\n  return fn || fallback\n}\n\nconst cache = {}\nexport function hasSupport(type) {\n  if (typeof cache[type] !== UNDEFINED) {\n    return cache[type]\n  }\n  try {\n    const storage = window[type]\n    // test for private safari\n    storage.setItem(UNDEFINED, UNDEFINED)\n    storage.removeItem(UNDEFINED)\n  } catch (err) {\n    return cache[type] = false\n  }\n  return cache[type] = true\n}\n\n/*\n// () => localStorage)\n// () => sessionStorage)\nexport function isSupported(getStorage) {\n  try {\n    const testKey = '__' + undef\n    getStorage().setItem(testKey, testKey)\n    getStorage().removeItem(testKey)\n    return true\n  } catch (e) {\n    return false\n  }\n}\n*/\n",null,"import { isObject } from '@analytics/type-utils'\n/**\n * Safe JSON parse\n * @param  {*} input - value to parse\n * @return {*} parsed input\n */\nexport default function parse(input) {\n  let value = input\n  try {\n    value = JSON.parse(input)\n    if (value === 'true') return true\n    if (value === 'false') return false\n    if (isObject(value)) return value\n    if (parseFloat(value) === value) {\n      value = parseFloat(value)\n    }\n  } catch (e) { }\n  if (value === null || value === \"\") {\n    return\n  }\n  return value\n}\n","import { set, get, remove, globalContext, GLOBAL } from '@analytics/global-storage-utils'\nimport { getCookie, setCookie, removeCookie, hasCookies, COOKIE } from '@analytics/cookie-utils'\nimport { hasLocalStorage, LOCAL_STORAGE } from '@analytics/localstorage-utils'\nimport { hasSessionStorage, SESSION_STORAGE } from '@analytics/session-storage-utils'\nimport { isUndefined, isString, ANY, ALL } from '@analytics/type-utils'\nimport parse from './utils/parse'\n\n// Verify support\nconst hasStorage = hasLocalStorage()\nconst hasSessionSupport = hasSessionStorage()\nconst hasCookiesSupport = hasCookies()\n\n/**\n * Get storage item from localStorage, cookie, or window\n * @param  {string} key - key of item to get\n * @param  {object|string} [options] - storage options. If string location of where to get storage\n * @param  {string} [options.storage] - Define type of storage to pull from.\n * @return {Any}  the value of key\n */\nexport function getItem(key, options) {\n  if (!key) return\n  const type = getStorageType(options)\n  const getFirst = !useAll(type)\n\n  /* 1. Try localStorage */\n  const localValue = useLocal(type) ? parse(localStorage.getItem(key)) : undefined\n  if (getFirst && !isUndefined(localValue)) {\n    return localValue\n  }\n\n  /* 2. Fallback to cookie */\n  const cookieVal = useCookie(type) ? parse(getCookie(key)) : undefined\n  if (getFirst && cookieVal) {\n    return cookieVal\n  }\n\n  /* 3. Fallback to sessionStorage */\n  const sessionVal = useSession(type) ? parse(sessionStorage.getItem(key)) : undefined\n  if (getFirst && sessionVal) {\n    return sessionVal\n  }\n\n  /* 4. Fallback to window/global. */\n  const globalValue = get(key)\n\n  return getFirst ? globalValue : {\n    localStorage: localValue,\n    sessionStorage: sessionVal,\n    cookie: cookieVal,\n    global: globalValue\n  }\n}\n\n/**\n * Store values in localStorage, cookie, or window\n * @param {string} key - key of item to set\n * @param {*} value - value of item to set\n * @param {object|string} [options] - storage options. If string location of where to get storage\n * @param {string} [options.storage] - Define type of storage to pull from.\n * @returns {object} returns old value, new values, & location of storage\n */\nexport function setItem(key, value, options) {\n  if (!key || isUndefined(value)) {\n    return\n  }\n  const data = {}\n  const type = getStorageType(options)\n  const saveValue = JSON.stringify(value)\n  const setFirst = !useAll(type)\n\n  /* 1. Try localStorage */\n  if (useLocal(type)) {\n    // console.log('SET as localstorage', saveValue)\n    data[LOCAL_STORAGE] = format(LOCAL_STORAGE, value, parse(localStorage.getItem(key)))\n    // Set LocalStorage item\n    localStorage.setItem(key, saveValue)\n    if (setFirst) {\n      return data[LOCAL_STORAGE]\n    }\n  }\n\n  /* 2. Fallback to cookie */\n  if (useCookie(type)) {\n    // console.log('SET as cookie', saveValue)\n    data[COOKIE] = format(COOKIE, value, parse(getCookie(key)))\n    // Set Cookie\n    setCookie(key, saveValue)\n    if (setFirst) {\n      return data[COOKIE]\n    }\n  }\n\n  /* 3. Try sessionStorage */\n  if (useSession(type)) {\n    // console.log('SET as localstorage', saveValue)\n    data[SESSION_STORAGE] = format(SESSION_STORAGE, value, parse(sessionStorage.getItem(key)))\n    // Set sessionStorage item\n    sessionStorage.setItem(key, saveValue)\n    if (setFirst) {\n      return data[SESSION_STORAGE]\n    }\n  }\n\n  /* 4. Fallback to window/global */\n  data[GLOBAL] = format(GLOBAL, value, get(key))\n  // Set global value\n  set(key, value)\n  // Return set value(s)\n  return (setFirst) ? data[GLOBAL] : data\n}\n\n/**\n * Remove values from localStorage, cookie, or window\n * @param {string} key - key of item to set\n * @param {object|string} [options] - storage options. If string location of where to get storage\n * @param {string} [options.storage] - Define type of storage to pull from.\n */\nexport function removeItem(key, options) {\n  if (!key) return\n  const type = getStorageType(options)\n  const values = getItem(key, ALL)\n\n  const data = {}\n  /* 1. Try localStorage */\n  if (!isUndefined(values.localStorage) && useLocal(type)) {\n    localStorage.removeItem(key)\n    data[LOCAL_STORAGE] = values.localStorage\n  }\n  /* 2. Fallback to cookie */\n  if (!isUndefined(values.cookie) && useCookie(type)) {\n    removeCookie(key)\n    data[COOKIE] = values.cookie\n  }\n  /* 3. Try sessionStorage */\n  if (!isUndefined(values.sessionStorage) && useSession(type)) {\n    sessionStorage.removeItem(key)\n    data[SESSION_STORAGE] = values.sessionStorage\n  }\n  /* 4. Fallback to window/global */\n  if (!isUndefined(values.global) && useGlobal(type)) {\n    remove(key)\n    data[GLOBAL] = values.global\n  }\n  return data\n}\n\nfunction getStorageType(opts) {\n  if (!opts) return ANY\n  return isString(opts) ? opts : opts.storage\n}\n\nfunction useGlobal(storage) {\n  return useType(storage, GLOBAL)\n}\n\nfunction useLocal(storage) {\n  // If has localStorage and storage option not defined, or is set to 'localStorage' or '*'\n  return hasStorage && useType(storage, LOCAL_STORAGE)\n}\n\nfunction useCookie(storage) {\n  // If has cookies and storage option not defined, or is set to 'cookies' or '*'\n  return hasCookiesSupport && useType(storage, COOKIE)\n}\n\nfunction useSession(storage) {\n  // If has sessionStorage and storage option not defined, or is set to 'sessionStorage' or '*'\n  return hasSessionSupport && useType(storage, SESSION_STORAGE)\n}\n\nfunction useAll(storage) {\n  return storage === ALL || storage === 'all'\n}\n\nfunction useType(storage, type) {\n  return (storage === ANY || storage === type || useAll(storage))\n}\n\n/**\n * Format response\n * @param {string} location \n * @param {*} current - current value\n * @param {*} previous - previous value\n * @returns \n */\nfunction format(location, current, previous) {\n  return { location, current, previous }\n}\n\n// const TYPES = {\n//   ALL,\n//   ANY,\n//   GLOBAL,\n//   COOKIE,\n//   LOCAL_STORAGE,\n//   SESSION_STORAGE,   \n// }\n\nexport {\n  ALL,\n  ANY,\n  GLOBAL,\n  COOKIE,\n  LOCAL_STORAGE,\n  SESSION_STORAGE,\n  getCookie,\n  setCookie,\n  removeCookie,\n  globalContext,\n  hasSessionStorage,\n  hasLocalStorage,\n  hasCookies\n}\n\nexport default {\n  setItem,\n  getItem,\n  removeItem\n}",null,"import { get, set, remove } from '@analytics/global-storage-utils'\n\nexport const COOKIE = 'cookie'\n\nlet isSupported = hasCookies()\n\n/**\n * Get a cookie value\n * @param  {string} name - key of cookie\n * @return {string} value of cookie\n */\nexport const getCookie = cookie\n\n/**\n * Set a cookie value\n * @param {string} name  - key of cookie\n * @param {string} value - value of cookie\n * @param {string} days  - days to keep cookie\n */\nexport const setCookie = cookie\n\n/**\n * Remove a cookie value.\n * @param {string} name  - key of cookie\n */\nexport function removeCookie(name) {\n  return isSupported ? cookie(name, '', -1) : remove(name) \n}\n\n/**\n * Check if browser has cookie support\n * @returns {boolean}\n */\nexport function hasCookies() {\n  if (typeof isSupported !== 'undefined') {\n    return isSupported\n  }\n  const tmp = COOKIE + COOKIE\n  try {\n    // Try to set cookie\n    cookie(tmp, tmp)\n    isSupported = document.cookie.indexOf(tmp) !== -1\n    // Cleanup cookie\n    removeCookie(tmp)\n  } catch (e) {\n    isSupported = false\n  }\n  return isSupported\n}\n\n/** \n  * Cookie setter & getter\n  * @version    1.0.4\n  * @date       2015-03-13\n  * @stability  3 - Stable\n  * @author     Lauri Rooden <lauri@rooden.ee>\n  * @license    MIT License\n  * Modified by David Wells\n  * @param {string} name \n  * @param {*} value \n  * @param {*} ttl - Time to live in seconds\n  * @param {*} path - Cookie domain\n  * @param {*} domain - Cookie domain\n  * @param {Boolean} secure - secure cookie\n  * @returns {*} value\n  * @example\n    cookie('test', 'a') // set\n    cookie('test', 'a', 60*60*24, '/api', '*.example.com', true) // complex set - cookie(name, value, ttl, path, domain, secure)\n    cookie('test') // get\n    cookie('test', '', -1) // destroy\n*/\nfunction cookie(name, value, ttl, path, domain, secure) {\n  if (typeof window === 'undefined') return\n  const isSet = arguments.length > 1\n  /* If cookies not supported fallback to global */\n  if (isSupported === false) (isSet) ? set(name, value) : get(name)\n  /* Set values */\n  if (isSet) {\n    return document.cookie = name + '=' + encodeURIComponent(value) +\n      /* Set TTL set expiration on cookie */\n      ((!ttl) ? '' : '; expires=' + new Date(+new Date() + (ttl * 1000)).toUTCString() +\n      // If path set path\n      ((!path) ? '' : '; path=' + path) +\n      // If domain set domain\n      ((!domain) ? '' : '; domain=' + domain) +\n      // If secure set secure\n      ((!secure) ? '' : '; secure'))\n  }\n  /* Get values */\n  return decodeURIComponent((('; ' + document.cookie).split('; ' + name + '=')[1] || '').split(';')[0])\n}\n",null,"import { get, set, remove, hasSupport, wrap } from '@analytics/global-storage-utils'\n\nconst LOCAL_STORAGE = 'localStorage'\n\n/**\n * Check if browser has access to LocalStorage\n * @returns {Boolean}\n */\nconst hasLocalStorage = hasSupport.bind(null, LOCAL_STORAGE)\n\n/**\n * Get value from localStorage or fallback to global window\n * @param {string} key - Key of value to get\n * @returns {*} value\n */\nconst getItem = wrap(LOCAL_STORAGE, 'getItem', get)\n\n/**\n * Set value to localStorage or fallback to global window\n * @param {string} key - Key of value to set\n * @param {*} value \n * @returns value\n */\nconst setItem = wrap(LOCAL_STORAGE, 'setItem', set)\n\n/**\n * Remove value from localStorage or fallback to global window\n * @param {string} key - Key of value to remove\n */\nconst removeItem = wrap(LOCAL_STORAGE, 'removeItem', remove)\n\nexport {\n  LOCAL_STORAGE,\n  hasLocalStorage,\n  getItem,\n  setItem,\n  removeItem\n}",null,"import { get, set, remove, hasSupport, wrap } from '@analytics/global-storage-utils'\n\nconst SESSION_STORAGE = 'sessionStorage'\n\n/**\n * Check if browser has access to sessionStorage\n * @returns {Boolean}\n */\nconst hasSessionStorage = hasSupport.bind(null, SESSION_STORAGE)\n\n/**\n * Get value from sessionStorage or fallback to global window\n * @param {string} key - Key of value to get\n * @returns {*} value\n */\nconst getSessionItem = wrap(SESSION_STORAGE, 'getItem', get)\n\n/**\n * Set value to sessionStorage or fallback to global window\n * @param {string} key - Key of value to set\n * @param {*} value \n * @returns value\n */\nconst setSessionItem = wrap(SESSION_STORAGE, 'setItem', set)\n\n/**\n * Remove value from sessionStorage or fallback to global window\n * @param {string} key - Key of value to remove\n */\nconst removeSessionItem = wrap(SESSION_STORAGE, 'removeItem', remove)\n\nexport {\n  SESSION_STORAGE,\n  hasSessionStorage,\n  getSessionItem,\n  setSessionItem,\n  removeSessionItem\n}","function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/* global, window */\nvar loadedInstances = {};\n/* Location of gtag script */\n\nvar gtagScriptSource = 'https://www.googletagmanager.com/gtag/js'; // See https://developers.google.com/analytics/devguides/collection/ga4/reference/config\n\nvar defaultGtagConf = {\n  // https://support.google.com/analytics/answer/7201382?hl=en#zippy=%2Cglobal-site-tag-websites\n  debug_mode: false,\n\n  /**\n   * Disable automatic sending of page views, instead let analytics.page() do this\n   * https://developers.google.com/analytics/devguides/collection/gtagjs\n   */\n  send_page_view: false,\n  // https://developers.google.com/analytics/devguides/collection/gtagjs/ip-anonymization\n  anonymize_ip: false,\n\n  /**\n   * Disable All Advertising\n   * https://developers.google.com/analytics/devguides/collection/ga4/display-features#disable_all_advertising_features\n   */\n  allow_google_signals: true,\n\n  /**\n   * Disable Advertising Personalization\n   * https://developers.google.com/analytics/devguides/collection/ga4/display-features#disable_advertising_personalization\n   */\n  allow_ad_personalization_signals: true,\n\n  /**\n   * https://developers.google.com/analytics/devguides/collection/gtagjs/cookies-user-id#configure_cookie_field_settings\n   */\n  // cookie_domain: 'auto',\n  // cookie_expires\n  // cookie_prefix\n  // cookie_update\n  // cookie_flags\n\n  /**\n   * Cookie Flags\n   * https://developers.google.com/analytics/devguides/collection/ga4/cookies-user-id#cookie_flags\n   */\n  cookie_flags: ''\n};\nvar defaultConfig = {\n  gtagName: 'gtag',\n  dataLayerName: 'ga4DataLayer',\n  measurementIds: [],\n  gtagConfig: defaultGtagConf\n};\n/**\n * Google analytics plugin\n * @link https://getanalytics.io/plugins/google-analytics/\n * @link https://analytics.google.com/analytics/web/\n * @link https://developers.google.com/analytics/devguides/collection/analyticsjs\n * @param {object}  pluginConfig - Plugin settings\n * @param {string[]} pluginConfig.measurementIds - Google Analytics MEASUREMENT IDs\n * @param {boolean} [pluginConfig.debug] - Enable Google Analytics debug mode\n * @param {string}  [pluginConfig.dataLayerName=ga4DataLayer] - The optional name for dataLayer object. Defaults to ga4DataLayer.\n * @param {string}  [pluginConfig.gtagName=gtag] - The optional name for dataLayer object. Defaults to `gtag`.\n * @param {boolean} [pluginConfig.gtagConfig.anonymize_ip] - Enable [Anonymizing IP addresses](https://bit.ly/3c660Rd) sent to Google Analytics.\n * @param {object}  [pluginConfig.gtagConfig.cookie_domain] - Additional cookie properties for configuring the [ga cookie](https://developers.google.com/analytics/devguides/collection/analyticsjs/cookies-user-id#configuring_cookie_field_settings)\n * @param {object}  [pluginConfig.gtagConfig.cookie_expires] - Additional cookie properties for configuring the [ga cookie](https://developers.google.com/analytics/devguides/collection/analyticsjs/cookies-user-id#configuring_cookie_field_settings)\n * @param {object}  [pluginConfig.gtagConfig.cookie_prefix] - Additional cookie properties for configuring the [ga cookie](https://developers.google.com/analytics/devguides/collection/analyticsjs/cookies-user-id#configuring_cookie_field_settings)\n * @param {object}  [pluginConfig.gtagConfig.cookie_update] - Additional cookie properties for configuring the [ga cookie](https://developers.google.com/analytics/devguides/collection/analyticsjs/cookies-user-id#configuring_cookie_field_settings)\n * @param {object}  [pluginConfig.gtagConfig.cookie_flags] - Additional cookie properties for configuring the [ga cookie](https://developers.google.com/analytics/devguides/collection/analyticsjs/cookies-user-id#configuring_cookie_field_settings)\n * @param {string}  [pluginConfig.customScriptSrc] - Custom URL for google analytics script, if proxying calls\n * @return {*}\n * @example\n *\n * googleAnalytics({\n *   measurementIds: ['G-abc123']\n * })\n */\n\nfunction googleAnalytics() {\n  var pluginConfig = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var pageCallCount = 0;\n  var measurementIds = getIds(pluginConfig.measurementIds);\n\n  var initConfig = _objectSpread(_objectSpread({}, defaultConfig), pluginConfig);\n\n  return {\n    name: 'google-analytics',\n    config: initConfig,\n    // Load gtag.js and define gtag\n    initialize: function initialize(_ref) {\n      var config = _ref.config,\n          instance = _ref.instance;\n      var dataLayerName = config.dataLayerName,\n          customScriptSrc = config.customScriptSrc,\n          gtagName = config.gtagName,\n          gtagConfig = config.gtagConfig,\n          debug = config.debug;\n      /* Inject google gtag.js script if not found */\n\n      /* If other gtags are loaded already, add ours anyway */\n\n      var customLayerName = dataLayerName ? \"&l=\".concat(dataLayerName) : \"\";\n      var src = customScriptSrc || \"\".concat(gtagScriptSource, \"?id=\").concat(measurementIds[0]).concat(customLayerName);\n\n      if (!scriptLoaded(src)) {\n        var script = document.createElement('script');\n        script.async = true;\n        script.src = src;\n        document.body.appendChild(script);\n      }\n      /* Set up gtag and datalayer */\n\n\n      if (!window[dataLayerName]) {\n        window[dataLayerName] = window[dataLayerName] || [];\n      }\n\n      if (!window[gtagName]) {\n        window[gtagName] = function () {\n          window[dataLayerName].push(arguments);\n        };\n      }\n\n      window[gtagName]('js', new Date()); // Initialize tracker instances on page\n\n      var gtagConf = _objectSpread(_objectSpread({}, defaultGtagConf), gtagConfig ? gtagConfig : {}); // You must explicitly delete the debug_mode parameter or all sessions will fire in debug more. Setting it false is not enough.\n      // https://support.google.com/analytics/answer/7201382?hl=en&ref_topic=9303319#zippy=%2Cgoogle-tag-websites:~:text=To%20disable%20debug%20mode%2C%20exclude%20the%20%27debug_mode%27%20parameter%3B%20setting%20the%20parameter%20to%20false%20doesn%27t%20disable%20debug%20mode.\n\n\n      if (debug === true) {\n        gtagConf.debug_mode = true;\n      } else {\n        delete gtagConf.debug_mode;\n      }\n      /* set custom dimensions from user traits */\n\n\n      var user = instance.user() || {};\n      var traits = user.traits || {};\n\n      if (Object.keys(traits).length) {\n        window[gtagName]('set', 'user_properties', traits);\n      }\n      /* Initialize all measurementIds */\n\n\n      for (var i = 0; i < measurementIds.length; i++) {\n        if (!loadedInstances[measurementIds[i]]) {\n          window[gtagName]('config', measurementIds[i], gtagConf);\n          loadedInstances[measurementIds[i]] = true;\n        }\n      }\n    },\n    // Set parameter scope at user level with 'set' method\n    identify: function identify(_ref2) {\n      var payload = _ref2.payload,\n          config = _ref2.config;\n      var gtagName = config.gtagName;\n      if (!window[gtagName] || !measurementIds.length) return;\n\n      if (payload.userId) {\n        // https://developers.google.com/analytics/devguides/collection/ga4/user-id?platform=websites#send_user_ids\n        window[gtagName]('set', {\n          user_id: payload.userId\n        }); // console.log('Set userid', payload.userId)\n      } // TODO verify this\n      // https://developers.google.com/analytics/devguides/collection/ga4/user-properties?technology=websites\n\n\n      if (Object.keys(payload.traits).length) {\n        /* gtag('set', 'user_properties', {\n          favorite_composer: 'Mahler',\n          favorite_instrument: 'double bass',\n          season_ticketholder: 'true'\n        }) */\n        window[gtagName]('set', 'user_properties', payload.traits); // console.log('Set userprops', payload.traits)\n      }\n    },\n    // Set parameter scope at page level with 'config' method\n    page: function page(_ref3) {\n      var payload = _ref3.payload,\n          config = _ref3.config,\n          instance = _ref3.instance;\n      var gtagName = config.gtagName,\n          gtagConfig = config.gtagConfig;\n      if (!window[gtagName] || !measurementIds.length) return;\n      var properties = payload.properties;\n      var send_to = properties.send_to;\n      var campaign = instance.getState('context.campaign'); // console.log('ga page properties', properties)\n\n      /* Create pageview-related properties */\n\n      var pageView = {\n        page_title: properties.title,\n        page_location: properties.url,\n        page_path: properties.path || document.location.pathname,\n        page_hash: properties.hash,\n        page_search: properties.page_search,\n        page_referrer: properties.referrer\n      };\n      var campaignData = addCampaignData(campaign);\n      var userId = instance.user('userId');\n\n      var finalPayload = _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, send_to ? {\n        send_to: send_to\n      } : {}), pageView), campaignData), userId ? {\n        user_id: userId\n      } : {});\n      /* If send_page_view true, ignore first analytics.page call */\n\n\n      if (gtagConfig && gtagConfig.send_page_view && pageCallCount === 0) {\n        pageCallCount++; // console.log('ignore first pageCallCount', pageCallCount)\n\n        return;\n      } // console.log('Send page_view payload', finalPayload)\n\n\n      window[gtagName]('event', 'page_view', finalPayload); // Set after initial page view\n\n      pageCallCount++;\n    },\n    // Set parameter scope at event level with 'event' method\n    track: function track(_ref4) {\n      var payload = _ref4.payload,\n          config = _ref4.config,\n          instance = _ref4.instance;\n      var properties = payload.properties,\n          event = payload.event;\n      var campaign = instance.getState('context.campaign');\n      var gtagName = config.gtagName;\n      if (!window[gtagName] || !measurementIds.length) return;\n      var campaignData = addCampaignData(campaign);\n      var userId = instance.user('userId'); // Limits https://support.google.com/analytics/answer/9267744\n\n      var finalPayload = _objectSpread(_objectSpread(_objectSpread({}, properties), campaignData), userId ? {\n        user_id: userId\n      } : {});\n      /*\n        console.log('finalPayload', finalPayload)\n        console.log('event', event)\n      */\n\n      /* Send data to Google Analytics\n        Signature gtag('event', '<event_name>', {\n          <event_params>key: value,\n        })\n      */\n\n\n      window[gtagName]('event', event, finalPayload);\n    },\n\n    /* Verify gtag loaded and ready to use */\n    loaded: function loaded() {\n      var dataLayerName = initConfig.dataLayerName,\n          customScriptSrc = initConfig.customScriptSrc;\n      var hasDataLayer = dataLayerName && window[dataLayerName] && Array.prototype.push === window[dataLayerName].push;\n      return scriptLoaded(customScriptSrc || gtagScriptSource) && hasDataLayer;\n    },\n\n    /* Custom methods */\n    methods: {\n      addTag: function addTag(tagId) {\n        var settings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n        // https://developers.google.com/tag-platform/devguides/install-gtagjs#add_products_to_your_tag\n        if (window[initConfig.gtagName]) {\n          window[initConfig.gtagName]('config', tagId, settings); // Add tag id\n\n          if (measurementIds && !measurementIds.includes(tagId)) {\n            measurementIds = measurementIds.concat(tagId);\n          }\n        }\n      },\n\n      /* Disable gtag for user */\n      disable: function disable(ids) {\n        var gaIds = ids ? getIds(ids) : measurementIds;\n\n        for (var i = 0; i < measurementIds.length; i++) {\n          var gaId = measurementIds[i];\n\n          if (gaIds.includes(gaId)) {\n            // https://developers.google.com/analytics/devguides/collection/gtagjs/user-opt-out\n            window[\"ga-disable-\".concat(gaId)] = true;\n          }\n        }\n      },\n\n      /* Enable gtag for user */\n      enable: function enable(ids) {\n        var gaIds = ids ? getIds(ids) : measurementIds;\n\n        for (var i = 0; i < measurementIds.length; i++) {\n          var gaId = measurementIds[i];\n\n          if (gaIds.includes(gaId)) {\n            // https://developers.google.com/analytics/devguides/collection/gtagjs/user-opt-out\n            window[\"ga-disable-\".concat(gaId)] = false;\n          }\n        }\n      }\n    }\n  };\n}\n\nfunction getIds(measurementIds) {\n  if (!measurementIds) throw new Error('No GA Measurement ID defined');\n\n  if (Array.isArray(measurementIds)) {\n    return measurementIds;\n  }\n\n  if (typeof measurementIds === 'string') {\n    return [measurementIds];\n  }\n\n  throw new Error('GA Measurement ID must be string or array of strings');\n}\n/**\n * Add campaign data to GA payload https://bit.ly/34qFCPn\n * @param {Object} [campaignData={}] [description]\n * @param {String} [campaignData.campaignName] - Name of campaign\n * @param {String} [campaignData.campaignSource] - Source of campaign\n * @param {String} [campaignData.campaignMedium] - Medium of campaign\n * @param {String} [campaignData.campaignContent] - Content of campaign\n * @param {String} [campaignData.campaignKeyword] - Keyword of campaign\n */\n\n\nfunction addCampaignData() {\n  var campaignData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var campaign = {};\n  var id = campaignData.id,\n      name = campaignData.name,\n      source = campaignData.source,\n      medium = campaignData.medium,\n      content = campaignData.content,\n      keyword = campaignData.keyword;\n  if (id) campaign.campaignId = id;\n  if (name) campaign.campaignName = name;\n  if (source) campaign.campaignSource = source;\n  if (medium) campaign.campaignMedium = medium;\n  if (content) campaign.campaignContent = content;\n  if (keyword) campaign.campaignKeyword = keyword;\n  return campaign;\n}\n\nfunction scriptLoaded(scriptSrc) {\n  var scripts = document.querySelectorAll('script[src]');\n  var regex = new RegExp(\"^\".concat(scriptSrc));\n  return Boolean(Object.values(scripts).filter(function (value) {\n    return regex.test(value.src);\n  }).length);\n}\n\n/* This module will shake out unused code + work in browser and node  */\n\nvar index = googleAnalytics ;\n/* init for CDN usage. globalName.init() */\n\nvar init = googleAnalytics ;\n\nexport { index as default, init };\n"],"names":["FUNC","UNDEF","ACTION_TEST","Math","random","toString","$$observable","Symbol","observable","msg","createStore","reducer","preloadedState","enhancer","undefined","Error","currentReducer","currentState","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","slice","getState","subscribe","listener","isSubscribed","push","index","indexOf","splice","dispatch","action","isObject","type","listeners","i","length","base","replaceReducer","nextReducer","outerSubscribe","observer","TypeError","observeState","next","unsubscribe","getUndefinedStateErrorMessage","key","actionType","compose","funcs","arg","reduce","a","b","applyMiddleware","chain","store","middlewareAPI","map","middleware","ANON_ID","PREFIX","USER_ID","USER_TRAITS","ID","ANONID","coreEvents","nonEvents","acc","curr","registerPluginType","name","pluginReadyType","utmRegex","propRegex","traitRegex","initializeMiddleware","instance","setItem","storage","EVENTS","bootstrap","params","user","persistedUser","initialUser","isKnownId","userId","anonymousId","traits","paramsArray","Object","keys","an_uid","an_event","groupedParams","match","cleanName","replace","campaign","props","raw","setTimeout","identify","track","userReducer","state","setItemEnd","value","assign","reset","forEach","removeItem","getPersistedUserData","getItem","tempKey","identifyMiddleware","options","remove","uuid","currentId","currentTraits","userIdChanged","old","new","stack","runCallback","id","payload","isFunction","waitForReady","data","predicate","timeout","Promise","resolve","reject","queue","then","_","processQueue","getPlugins","pluginMethods","plugins","context","offline","actions","pipeline","item","plugin","loaded","process","processIndex","requeue","requeueIndex","processAction","currentPlugin","currentMethod","method","enrichedPayload","hasOwnProperty","enrich","config","pluginEvent","called","from","reQueueActions","filter","processEvent","allPlugins","allMatches","isStartEvent","endsWithStartRegex","abortable","exact","x","pluginName","during","makeArgs","abortablePlugins","otherPlugin","event","abortF","reason","caller","pluginsToAbort","isArray","includes","JSON","stringify","abort","abortFunction","notAbortableError","formatPayload","argumentFactory","queueData","thing","methodName","addToQueue","scoped","curScope","namespaced","p","count","curScopeData","actionName","text","getNameSpacedAction","sub","join","validateMethod","currentAct","pname","otherPlug","getConfig","val","returnValue","scopedPayload","payloads","promise","lastLoop","currentActionValue","payloadValue","shouldAbort","abortDispatch","funcArgs","merged","nameSpaceEvent","bootstrapRegex","readyRegex","resolvedAction","originalAction","endAction","shouldAbortAll","abortEvent","pluginState","pluginData","getPluginFunctions","arr","concat","getEventNames","eventType","namespace","postFix","pluginsCount","isString","Array","split","pluginMiddleware","systemEvents","isReady","updatedAction","enablePlugin","initializeStart","disabled","fromEnable","meta","disablePlugin","rid","initializeEnd","pluginsArray","allRegisteredPlugins","completed","failed","waitForPluginsToLoad","d","events","e","all","calls","ready","test","eventsInfo","pluginObject","originalType","updatedType","activePlugins","settings","fromCallOptions","isBoolean","enabled","info","initialized","allActivePluginKeys","core","word","beforeFuncs","duringFuncs","afterFuncs","beforeNS","duringNS","afterNS","before","after","getAllMatchingCalls","actionBefore","actionDuring","actionAfter","hasCallback","runPlugins","updated","storageMiddleware","DynamicMiddleware","addMiddleware","middlewares","position","_this","removeMiddleware","findIndex","dynamicMiddlewares","act","createReducer","newState","getNameFromEventType","isEnabled","Boolean","initialize","togglePluginStatus","baseName","substring","status","pluginKey","serialize","obj","parse","err","initialState","last","history","trackReducer","trackEvent","properties","queueReducer","actionChain","hashRegex","urlPath","url","matches","exec","osName","referrer","locale","timeZone","getPageData","pageData","isBrowser","document","title","window","location","innerWidth","innerHeight","hash","search","canonical","tag","tags","getElementsByTagName","getAttribute","canonicalUrl","href","currentUrl","page","path","width","height","viewData","os","navigator","appVersion","getOSNameBrowser","getBrowserLocale","getTimeZone","sessionId","app","version","debug","onLine","userAgent","library","timezone","online","excludeItems","listen","func","toAdd","fn","ev","watch","cb","bind","Debug","set","origDispatch","globalContext","KEY","composeWithDebug","apply","arguments","ensureArray","singleOrArray","generateMeta","possibleCallbacks","resolver","callback","argArray","args","prototype","call","getCallback","ts","Date","getTime","analytics","customReducers","reducers","parsedOptions","NAMESPACE","ERROR_URL","definedEvents","k","pluginEnabled","methods","c","newArgs","allEvents","allEventsUnique","Set","get","getUserProp","getUserPropFunc","customPlugins","allPluginEvents","sort","uniqueEvents","allSystemEvents","nonAbortable","paramsParse","visitorInfo","an_aid","enable","disable","readyCalled","opts","resolvedId","identifyStart","previousId","eventName","trackStart","pageStart","dotProp","resetStart","on","startRegex","beforeHandler","afterHandler","handler","once","detachListener","actionData","dispatchData","setItemStart","removeItemStart","setAnonymousId","CONSTANTS","storeAPI","enrichMeta","coreReducers","pluginsMiddleware","composeEnhancers","composeWithGlobalDebug","devTools","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","trace","traceLimit","initialConfig","current","makeContext","intialPluginState","reducerKeys","finalReducers","shapeAssertionError","finalReducerKeys","REDUCER","assertReducerShape","hasChanged","nextState","previousStateForKey","nextStateForKey","errorMessage","combineReducers","callbacks","newEvent","pluginKeys","enabledPlugins","disabledPlugins","registerPlugins","setInterval","heartBeat","decodeUri","s","decodeURIComponent","languages","userLanguage","language","Intl","DateTimeFormat","resolvedOptions","error","isExternalReferrer","ref","port","hostname","isScriptLoaded","script","scripts","src","isRegex","paramsClean","param","regex","RegExp","cleanSearch","paramsGet","query","temp","create","re","v","prop","getParamsAsObject","getSearchString","keyPath","lastKeyIndex","paramsRemove","replaceState","cleanUrl","getDomainHost","createElement","setAttribute","getDomainBase","trimTld","baseDomain","parseReferrer","refData","source","medium","domainInfo","referringDomain","searchEngines","searchEngine","termRegex","term","n","parseDomain","paramKeys","gaParams","gclid","Q","google","u","rb","r","throttle","wait","result","previous","later","now","remaining","this","clearTimeout","def","undef","FUNCTION","STRING","UNDEFINED","BOOLEAN","OBJECT","ARRAY","NUMBER","SYMBOL","NULL","ERROR","TYPE_ERROR","SYNTAX_ERROR","ASYNC_FUNCTION","GENERATOR_FUNCTION","ASYNC_GENERATOR_FUNCTION","noOp","ANY","ALL","NONE","HIDDEN","FORM","INPUT","BUTTON","SELECT","CHANGE","SUBMIT","REGEX_ISO","REGEX_EMAIL","REGEX_JSON","PROCESS","ENV","env","NODE_ENV","isProd","isStaging","isDev","isLocalHost","isNode","versions","node","isDeno","Deno","isWebWorker","self","constructor","isJsDom","charAt","upper","lower","getTypeName","isNull","ctorName","getType","toLowerCase","typeOf","kind","isUndefined","isDefined","isSymbol","isNumber","isNaN","isNumberLike","parseFloat","isClass","Function","isObjectLike","proto","getPrototypeOf","isJson","isPrimitive","isMethod","isPromise","isGenerator","isGeneratorFunction","isAsyncFunction","isSet","isMap","Map","isBuffer","isError","message","stackTraceLimit","isErrorLike","errorType","ErrKind","typeName","isTypeError","isSyntaxError","SyntaxError","isNoOp","emptyFunc","noOpStr","isArguments","callee","isTruthy","isFalsy","isTrue","isFalse","isEmail","isDate","toDateString","getDate","setDate","isIsoDate","isEmpty","size","isNodeList","NodeList","isPrototypeOf","isElement","element","isEl","Element","HTMLDocument","isNodeType","nodeName","toUpperCase","bindArgs","boundArgs","isForm","isButton","isInput","isSelect","isHidden","until","getComputedStyle","visibility","display","parentElement","GLOBAL","global","wrap","operation","fallback","hasSupport","cache","input","hasStorage","hasLocalStorage","hasSessionSupport","hasSessionStorage","hasCookiesSupport","hasCookies","getStorageType","getFirst","useAll","localValue","useLocal","localStorage","cookieVal","useCookie","getCookie","sessionVal","useSession","sessionStorage","globalValue","cookie","saveValue","setFirst","LOCAL_STORAGE","format","COOKIE","setCookie","SESSION_STORAGE","values","removeCookie","useType","isSupported","tmp","ttl","domain","secure","encodeURIComponent","toUTCString","getSessionItem","setSessionItem","removeSessionItem"],"version":3,"file":"reporting.87270bcb.js.map","sourceRoot":"/__parcel_source_root/"}